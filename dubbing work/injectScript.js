var injectscript=function(){"use strict";var t$=Object.defineProperty;var r$=(Ls,gn,ha)=>gn in Ls?t$(Ls,gn,{enumerable:!0,configurable:!0,writable:!0,value:ha}):Ls[gn]=ha;var fe=(Ls,gn,ha)=>r$(Ls,typeof gn!="symbol"?gn+"":gn,ha);function Ls(i){return i==null||typeof i=="function"?{main:i}:i}const gn=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(i=>[i.name,i]),ha=new Map(gn);class Ah extends Error{constructor(t){super(Ah._prepareSuperMessage(t));fe(this,"name","NonError")}static _prepareSuperMessage(t){try{return JSON.stringify(t)}catch{return String(t)}}}const GT=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],xh=new WeakSet,qT=i=>{xh.add(i);const e=i.toJSON();return xh.delete(i),e},Z0=i=>ha.get(i)??Error,Sh=({from:i,seen:e,to:t,forceEnumerable:r,maxDepth:n,depth:s,useToJSON:a,serialize:o})=>{if(!t)if(Array.isArray(i))t=[];else if(!o&&em(i)){const l=Z0(i.name);t=new l}else t={};if(e.push(i),s>=n)return t;if(a&&typeof i.toJSON=="function"&&!xh.has(i))return qT(i);const u=l=>Sh({from:l,seen:[...e],forceEnumerable:r,maxDepth:n,depth:s,useToJSON:a,serialize:o});for(const[l,h]of Object.entries(i)){if(h&&h instanceof Uint8Array&&h.constructor.name==="Buffer"){t[l]="[object Buffer]";continue}if(h!==null&&typeof h=="object"&&typeof h.pipe=="function"){t[l]="[object Stream]";continue}if(typeof h!="function"){if(!h||typeof h!="object"){try{t[l]=h}catch{}continue}if(!e.includes(i[l])){s++,t[l]=u(i[l]);continue}t[l]="[Circular]"}}for(const{property:l,enumerable:h}of GT)typeof i[l]<"u"&&i[l]!==null&&Object.defineProperty(t,l,{value:em(i[l])?u(i[l]):i[l],enumerable:r?!0:h,configurable:!0,writable:!0});return t};function HT(i,e={}){const{maxDepth:t=Number.POSITIVE_INFINITY,useToJSON:r=!0}=e;return typeof i=="object"&&i!==null?Sh({from:i,seen:[],forceEnumerable:!0,maxDepth:t,depth:0,useToJSON:r,serialize:!0}):typeof i=="function"?`[Function: ${i.name||"anonymous"}]`:i}function VT(i,e={}){const{maxDepth:t=Number.POSITIVE_INFINITY}=e;if(i instanceof Error)return i;if(KT(i)){const r=Z0(i.name);return Sh({from:i,seen:[],to:new r,maxDepth:t,depth:0,serialize:!1})}return new Ah(i)}function em(i){return!!i&&typeof i=="object"&&"name"in i&&"message"in i&&"stack"in i}function KT(i){return!!i&&typeof i=="object"&&"message"in i&&!Array.isArray(i)}var WT=Object.defineProperty,YT=Object.defineProperties,XT=Object.getOwnPropertyDescriptors,Hl=Object.getOwnPropertySymbols,tm=Object.prototype.hasOwnProperty,rm=Object.prototype.propertyIsEnumerable,im=(i,e,t)=>e in i?WT(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,bh=(i,e)=>{for(var t in e||(e={}))tm.call(e,t)&&im(i,t,e[t]);if(Hl)for(var t of Hl(e))rm.call(e,t)&&im(i,t,e[t]);return i},Th=(i,e)=>YT(i,XT(e)),zT=(i,e)=>{var t={};for(var r in i)tm.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&Hl)for(var r of Hl(i))e.indexOf(r)<0&&rm.call(i,r)&&(t[r]=i[r]);return t},nm=(i,e,t)=>new Promise((r,n)=>{var s=u=>{try{o(t.next(u))}catch(l){n(l)}},a=u=>{try{o(t.throw(u))}catch(l){n(l)}},o=u=>u.done?r(u.value):Promise.resolve(u.value).then(s,a);o((t=t.apply(i,e)).next())});function jT(i){let e,t={};function r(){Object.entries(t).length===0&&(e==null||e(),e=void 0)}let n=Math.floor(Math.random()*1e4);function s(){return n++}return{sendMessage(a,o,...u){return nm(this,null,function*(){var l,h,d,p;const g={id:s(),type:a,data:o,timestamp:Date.now()},m=(h=yield(l=i.verifyMessageData)==null?void 0:l.call(i,g))!=null?h:g;(d=i.logger)==null||d.debug(`[messaging] sendMessage {id=${m.id}} ─ᐅ`,m,...u);const v=yield i.sendMessage(m,...u),{res:E,err:x}=v??{err:new Error("No response")};if((p=i.logger)==null||p.debug(`[messaging] sendMessage {id=${m.id}} ᐊ─`,{res:E,err:x}),x!=null)throw VT(x);return E})},onMessage(a,o){var u,l,h;if(e==null&&((u=i.logger)==null||u.debug(`[messaging] "${a}" initialized the message listener for this context`),e=i.addRootListener(d=>{var p,g;if(typeof d.type!="string"||typeof d.timestamp!="number"){if(i.breakError)return;const E=Error(`[messaging] Unknown message format, must include the 'type' & 'timestamp' fields, received: ${JSON.stringify(d)}`);throw(p=i.logger)==null||p.error(E),E}(g=i==null?void 0:i.logger)==null||g.debug("[messaging] Received message",d);const m=t[d.type];if(m==null)return;const v=m(d);return Promise.resolve(v).then(E=>{var x,T;return(T=(x=i.verifyMessageData)==null?void 0:x.call(i,E))!=null?T:E}).then(E=>{var x;return(x=i==null?void 0:i.logger)==null||x.debug(`[messaging] onMessage {id=${d.id}} ─ᐅ`,{res:E}),{res:E}}).catch(E=>{var x;return(x=i==null?void 0:i.logger)==null||x.debug(`[messaging] onMessage {id=${d.id}} ─ᐅ`,{err:E}),{err:HT(E)}})})),t[a]!=null){const d=Error(`[messaging] In this JS context, only one listener can be setup for ${a}`);throw(l=i.logger)==null||l.error(d),d}return t[a]=o,(h=i.logger)==null||h.log(`[messaging] Added listener for ${a}`),()=>{delete t[a],r()}},removeAllListeners(){Object.keys(t).forEach(a=>{delete t[a]}),r()}}}for(var _s=256,sm=[],am=256,Vl;_s--;)sm[_s]=(_s+256).toString(16).substring(1);function JT(i){var e=0,t=11;if(!Vl||_s+t>am*2)for(Vl="",_s=0;e<am;e++)Vl+=sm[Math.random()*256|0];return Vl.substring(_s,_s+++t)}function om(i,e={targetScope:window??void 0}){return typeof cloneInto<"u"?cloneInto(i,e.targetScope):i}var Dh="@webext-core/messaging/custom-events",Rh="@webext-core/messaging/custom-events/response";function QT(i){const e=i.namespace,t=JT(),r=[],n=a=>new Promise(o=>{const u=l=>{const{detail:h}=l;h.namespace===e&&h.instanceId!==t&&h.message.type===a.detail.message.type&&o(h.response)};r.push(()=>window.removeEventListener(Rh,u)),window.addEventListener(Rh,u),window.dispatchEvent(a)}),s=jT(Th(bh({},i),{sendMessage(a){const o={message:a,namespace:e,instanceId:t},u=new CustomEvent(Dh,{detail:om(o)});return n(u)},addRootListener(a){const o=u=>nm(this,null,function*(){const l=u,{detail:h}=l,d=zT(l,["detail"]);if(h.namespace!==e||h.instanceId===t)return;const p=Th(bh({},h.message),{event:d}),m={response:yield a(p),message:p,instanceId:t,namespace:e},v=new CustomEvent(Rh,{detail:om(m)});window.dispatchEvent(v)});return window.addEventListener(Dh,o),()=>window.removeEventListener(Dh,o)},verifyMessageData(a){return structuredClone(a)}}));return Th(bh({},s),{removeAllListeners(){s.removeAllListeners(),r.forEach(a=>a())}})}const ZT="test";window.pageContentRpc||(window.pageContentRpc=QT({namespace:"kocjgbieikboloadkgcijaceaadcegnl"}));const pn=Symbol.for("@ts-pattern/matcher"),eD=Symbol.for("@ts-pattern/isVariadic"),Kl="@ts-pattern/anonymous-select-key",Ih=i=>!!(i&&typeof i=="object"),Wl=i=>i&&!!i[pn],Fi=(i,e,t)=>{if(Wl(i)){const r=i[pn](),{matched:n,selections:s}=r.match(e);return n&&s&&Object.keys(s).forEach(a=>t(a,s[a])),n}if(Ih(i)){if(!Ih(e))return!1;if(Array.isArray(i)){if(!Array.isArray(e))return!1;let r=[],n=[],s=[];for(const a of i.keys()){const o=i[a];Wl(o)&&o[eD]?s.push(o):s.length?n.push(o):r.push(o)}if(s.length){if(s.length>1)throw new Error("Pattern error: Using `...P.array(...)` several times in a single pattern is not allowed.");if(e.length<r.length+n.length)return!1;const a=e.slice(0,r.length),o=n.length===0?[]:e.slice(-n.length),u=e.slice(r.length,n.length===0?1/0:-n.length);return r.every((l,h)=>Fi(l,a[h],t))&&n.every((l,h)=>Fi(l,o[h],t))&&(s.length===0||Fi(s[0],u,t))}return i.length===e.length&&i.every((a,o)=>Fi(a,e[o],t))}return Reflect.ownKeys(i).every(r=>{const n=i[r];return(r in e||Wl(s=n)&&s[pn]().matcherType==="optional")&&Fi(n,e[r],t);var s})}return Object.is(e,i)},Wn=i=>{var e,t,r;return Ih(i)?Wl(i)?(e=(t=(r=i[pn]()).getSelectionKeys)==null?void 0:t.call(r))!=null?e:[]:Array.isArray(i)?Mo(i,Wn):Mo(Object.values(i),Wn):[]},Mo=(i,e)=>i.reduce((t,r)=>t.concat(e(r)),[]);function li(i){return Object.assign(i,{optional:()=>tD(i),and:e=>Pt(i,e),or:e=>rD(i,e),select:e=>e===void 0?lm(i):lm(e,i)})}function tD(i){return li({[pn]:()=>({match:e=>{let t={};const r=(n,s)=>{t[n]=s};return e===void 0?(Wn(i).forEach(n=>r(n,void 0)),{matched:!0,selections:t}):{matched:Fi(i,e,r),selections:t}},getSelectionKeys:()=>Wn(i),matcherType:"optional"})})}function Pt(...i){return li({[pn]:()=>({match:e=>{let t={};const r=(n,s)=>{t[n]=s};return{matched:i.every(n=>Fi(n,e,r)),selections:t}},getSelectionKeys:()=>Mo(i,Wn),matcherType:"and"})})}function rD(...i){return li({[pn]:()=>({match:e=>{let t={};const r=(n,s)=>{t[n]=s};return Mo(i,Wn).forEach(n=>r(n,void 0)),{matched:i.some(n=>Fi(n,e,r)),selections:t}},getSelectionKeys:()=>Mo(i,Wn),matcherType:"or"})})}function vt(i){return{[pn]:()=>({match:e=>({matched:!!i(e)})})}}function lm(...i){const e=typeof i[0]=="string"?i[0]:void 0,t=i.length===2?i[1]:typeof i[0]=="string"?void 0:i[0];return li({[pn]:()=>({match:r=>{let n={[e??Kl]:r};return{matched:t===void 0||Fi(t,r,(s,a)=>{n[s]=a}),selections:n}},getSelectionKeys:()=>[e??Kl].concat(t===void 0?[]:Wn(t))})})}function Bi(i){return typeof i=="number"}function Yn(i){return typeof i=="string"}function Xn(i){return typeof i=="bigint"}li(vt(function(i){return!0}));const zn=i=>Object.assign(li(i),{startsWith:e=>{return zn(Pt(i,(t=e,vt(r=>Yn(r)&&r.startsWith(t)))));var t},endsWith:e=>{return zn(Pt(i,(t=e,vt(r=>Yn(r)&&r.endsWith(t)))));var t},minLength:e=>zn(Pt(i,(t=>vt(r=>Yn(r)&&r.length>=t))(e))),length:e=>zn(Pt(i,(t=>vt(r=>Yn(r)&&r.length===t))(e))),maxLength:e=>zn(Pt(i,(t=>vt(r=>Yn(r)&&r.length<=t))(e))),includes:e=>{return zn(Pt(i,(t=e,vt(r=>Yn(r)&&r.includes(t)))));var t},regex:e=>{return zn(Pt(i,(t=e,vt(r=>Yn(r)&&!!r.match(t)))));var t}});zn(vt(Yn));const Ui=i=>Object.assign(li(i),{between:(e,t)=>Ui(Pt(i,((r,n)=>vt(s=>Bi(s)&&r<=s&&n>=s))(e,t))),lt:e=>Ui(Pt(i,(t=>vt(r=>Bi(r)&&r<t))(e))),gt:e=>Ui(Pt(i,(t=>vt(r=>Bi(r)&&r>t))(e))),lte:e=>Ui(Pt(i,(t=>vt(r=>Bi(r)&&r<=t))(e))),gte:e=>Ui(Pt(i,(t=>vt(r=>Bi(r)&&r>=t))(e))),int:()=>Ui(Pt(i,vt(e=>Bi(e)&&Number.isInteger(e)))),finite:()=>Ui(Pt(i,vt(e=>Bi(e)&&Number.isFinite(e)))),positive:()=>Ui(Pt(i,vt(e=>Bi(e)&&e>0))),negative:()=>Ui(Pt(i,vt(e=>Bi(e)&&e<0)))});Ui(vt(Bi));const jn=i=>Object.assign(li(i),{between:(e,t)=>jn(Pt(i,((r,n)=>vt(s=>Xn(s)&&r<=s&&n>=s))(e,t))),lt:e=>jn(Pt(i,(t=>vt(r=>Xn(r)&&r<t))(e))),gt:e=>jn(Pt(i,(t=>vt(r=>Xn(r)&&r>t))(e))),lte:e=>jn(Pt(i,(t=>vt(r=>Xn(r)&&r<=t))(e))),gte:e=>jn(Pt(i,(t=>vt(r=>Xn(r)&&r>=t))(e))),positive:()=>jn(Pt(i,vt(e=>Xn(e)&&e>0))),negative:()=>jn(Pt(i,vt(e=>Xn(e)&&e<0)))});jn(vt(Xn)),li(vt(function(i){return typeof i=="boolean"})),li(vt(function(i){return typeof i=="symbol"})),li(vt(function(i){return i==null})),li(vt(function(i){return i!=null}));let iD=class extends Error{constructor(e){let t;try{t=JSON.stringify(e)}catch{t=e}super(`Pattern matching error: no pattern matches value ${t}`),this.input=void 0,this.input=e}};const wh={matched:!1,value:void 0};function da(i){return new nD(i,wh)}let nD=class J0{constructor(e,t){this.input=void 0,this.state=void 0,this.input=e,this.state=t}with(...e){if(this.state.matched)return this;const t=e[e.length-1],r=[e[0]];let n;e.length===3&&typeof e[1]=="function"?n=e[1]:e.length>2&&r.push(...e.slice(1,e.length-1));let s=!1,a={};const o=(l,h)=>{s=!0,a[l]=h},u=!r.some(l=>Fi(l,this.input,o))||n&&!n(this.input)?wh:{matched:!0,value:t(s?Kl in a?a[Kl]:a:this.input,this.input)};return new J0(this.input,u)}when(e,t){if(this.state.matched)return this;const r=!!e(this.input);return new J0(this.input,r?{matched:!0,value:t(this.input,this.input)}:wh)}otherwise(e){return this.state.matched?this.state.value:e(this.input)}exhaustive(e=sD){return this.state.matched?this.state.value:e(this.input)}run(){return this.exhaustive()}returnType(){return this}};function sD(i){throw new iD(i)}var Ch=function(i,e){return Ch=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])},Ch(i,e)};function $i(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ch(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function aD(i,e,t,r){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{l(r.next(h))}catch(d){a(d)}}function u(h){try{l(r.throw(h))}catch(d){a(d)}}function l(h){h.done?s(h.value):n(h.value).then(o,u)}l((r=r.apply(i,e||[])).next())})}function um(i,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,n,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(l){return function(h){return u([l,h])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(t=0)),t;)try{if(r=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,n=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){t.label=l[1];break}if(l[0]===6&&t.label<s[1]){t.label=s[1],s=l;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(l);break}s[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(i,t)}catch(h){l=[6,h],n=0}finally{r=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function fa(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],r=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Jn(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var r=t.call(i),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=r.next()).done;)s.push(n.value)}catch(o){a={error:o}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s}function Ms(i,e,t){if(t||arguments.length===2)for(var r=0,n=e.length,s;r<n;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return i.concat(s||Array.prototype.slice.call(e))}function ga(i){return this instanceof ga?(this.v=i,this):new ga(i)}function oD(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,x){s.push([g,v,E,x])>1||u(g,v)})},m&&(n[g]=m(n[g])))}function u(g,m){try{l(r[g](m))}catch(v){p(s[0][3],v)}}function l(g){g.value instanceof ga?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){u("next",g)}function d(g){u("throw",g)}function p(g,m){g(m),s.shift(),s.length&&u(s[0][0],s[0][1])}}function lD(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof fa=="function"?fa(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,u){a=i[s](a),n(o,u,a.done,a.value)})}}function n(s,a,o,u){Promise.resolve(u).then(function(l){s({value:l,done:o})},a)}}typeof SuppressedError=="function"&&SuppressedError;function bt(i){return typeof i=="function"}function Yl(i){var e=function(r){Error.call(r),r.stack=new Error().stack},t=i(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Nh=Yl(function(i){return function(t){i(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(r,n){return n+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function Xl(i,e){if(i){var t=i.indexOf(e);0<=t&&i.splice(t,1)}}var Oo=function(){function i(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return i.prototype.unsubscribe=function(){var e,t,r,n,s;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=fa(a),u=o.next();!u.done;u=o.next()){var l=u.value;l.remove(this)}}catch(v){e={error:v}}finally{try{u&&!u.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else a.remove(this);var h=this.initialTeardown;if(bt(h))try{h()}catch(v){s=v instanceof Nh?v.errors:[v]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var p=fa(d),g=p.next();!g.done;g=p.next()){var m=g.value;try{dm(m)}catch(v){s=s??[],v instanceof Nh?s=Ms(Ms([],Jn(s)),Jn(v.errors)):s.push(v)}}}catch(v){r={error:v}}finally{try{g&&!g.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}}if(s)throw new Nh(s)}},i.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)dm(e);else{if(e instanceof i){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},i.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},i.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},i.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Xl(t,e)},i.prototype.remove=function(e){var t=this._finalizers;t&&Xl(t,e),e instanceof i&&e._removeParent(this)},i.EMPTY=function(){var e=new i;return e.closed=!0,e}(),i}(),cm=Oo.EMPTY;function hm(i){return i instanceof Oo||i&&"closed"in i&&bt(i.remove)&&bt(i.add)&&bt(i.unsubscribe)}function dm(i){bt(i)?i():i.unsubscribe()}var uD={Promise:void 0},cD={setTimeout:function(i,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setTimeout.apply(void 0,Ms([i,e],Jn(t)))},clearTimeout:function(i){return clearTimeout(i)},delegate:void 0};function fm(i){cD.setTimeout(function(){throw i})}function Lh(){}function zl(i){i()}var _h=function(i){$i(e,i);function e(t){var r=i.call(this)||this;return r.isStopped=!1,t?(r.destination=t,hm(t)&&t.add(r)):r.destination=fD,r}return e.create=function(t,r,n){return new pa(t,r,n)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,i.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Oo),hD=function(){function i(e){this.partialObserver=e}return i.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){jl(r)}},i.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){jl(r)}else jl(e)},i.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){jl(t)}},i}(),pa=function(i){$i(e,i);function e(t,r,n){var s=i.call(this)||this,a;return bt(t)||!t?a={next:t??void 0,error:r??void 0,complete:n??void 0}:a=t,s.destination=new hD(a),s}return e}(_h);function jl(i){fm(i)}function dD(i){throw i}var fD={closed:!0,next:Lh,error:dD,complete:Lh},Mh=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function ma(i){return i}function gD(i){return i.length===0?ma:i.length===1?i[0]:function(t){return i.reduce(function(r,n){return n(r)},t)}}var dr=function(){function i(e){e&&(this._subscribe=e)}return i.prototype.lift=function(e){var t=new i;return t.source=this,t.operator=e,t},i.prototype.subscribe=function(e,t,r){var n=this,s=mD(e)?e:new pa(e,t,r);return zl(function(){var a=n,o=a.operator,u=a.source;s.add(o?o.call(s,u):u?n._subscribe(s):n._trySubscribe(s))}),s},i.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},i.prototype.forEach=function(e,t){var r=this;return t=gm(t),new t(function(n,s){var a=new pa({next:function(o){try{e(o)}catch(u){s(u),a.unsubscribe()}},error:s,complete:n});r.subscribe(a)})},i.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},i.prototype[Mh]=function(){return this},i.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return gD(e)(this)},i.prototype.toPromise=function(e){var t=this;return e=gm(e),new e(function(r,n){var s;t.subscribe(function(a){return s=a},function(a){return n(a)},function(){return r(s)})})},i.create=function(e){return new i(e)},i}();function gm(i){var e;return(e=i??uD.Promise)!==null&&e!==void 0?e:Promise}function pD(i){return i&&bt(i.next)&&bt(i.error)&&bt(i.complete)}function mD(i){return i&&i instanceof _h||pD(i)&&hm(i)}function yD(i){return bt(i==null?void 0:i.lift)}function Er(i){return function(e){if(yD(e))return e.lift(function(t){try{return i(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function nr(i,e,t,r,n){return new vD(i,e,t,r,n)}var vD=function(i){$i(e,i);function e(t,r,n,s,a,o){var u=i.call(this,t)||this;return u.onFinalize=a,u.shouldUnsubscribe=o,u._next=r?function(l){try{r(l)}catch(h){t.error(h)}}:i.prototype._next,u._error=s?function(l){try{s(l)}catch(h){t.error(h)}finally{this.unsubscribe()}}:i.prototype._error,u._complete=n?function(){try{n()}catch(l){t.error(l)}finally{this.unsubscribe()}}:i.prototype._complete,u}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;i.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(_h),ED=Yl(function(i){return function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Os=function(i){$i(e,i);function e(){var t=i.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var r=new pm(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new ED},e.prototype.next=function(t){var r=this;zl(function(){var n,s;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var a=fa(r.currentObservers),o=a.next();!o.done;o=a.next()){var u=o.value;u.next(t)}}catch(l){n={error:l}}finally{try{o&&!o.done&&(s=a.return)&&s.call(a)}finally{if(n)throw n.error}}}})},e.prototype.error=function(t){var r=this;zl(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var n=r.observers;n.length;)n.shift().error(t)}})},e.prototype.complete=function(){var t=this;zl(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),i.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,n=this,s=n.hasError,a=n.isStopped,o=n.observers;return s||a?cm:(this.currentObservers=null,o.push(t),new Oo(function(){r.currentObservers=null,Xl(o,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,n=r.hasError,s=r.thrownError,a=r.isStopped;n?t.error(s):a&&t.complete()},e.prototype.asObservable=function(){var t=new dr;return t.source=this,t},e.create=function(t,r){return new pm(t,r)},e}(dr),pm=function(i){$i(e,i);function e(t,r){var n=i.call(this)||this;return n.destination=t,n.source=r,n}return e.prototype.next=function(t){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.next)===null||n===void 0||n.call(r,t)},e.prototype.error=function(t){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.error)===null||n===void 0||n.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,n;return(n=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&n!==void 0?n:cm},e}(Os),mm=function(i){$i(e,i);function e(t){var r=i.call(this)||this;return r._value=t,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var r=i.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},e.prototype.getValue=function(){var t=this,r=t.hasError,n=t.thrownError,s=t._value;if(r)throw n;return this._throwIfClosed(),s},e.prototype.next=function(t){i.prototype.next.call(this,this._value=t)},e}(Os),Oh={now:function(){return(Oh.delegate||Date).now()},delegate:void 0},AD=function(i){$i(e,i);function e(t,r,n){t===void 0&&(t=1/0),r===void 0&&(r=1/0),n===void 0&&(n=Oh);var s=i.call(this)||this;return s._bufferSize=t,s._windowTime=r,s._timestampProvider=n,s._buffer=[],s._infiniteTimeWindow=!0,s._infiniteTimeWindow=r===1/0,s._bufferSize=Math.max(1,t),s._windowTime=Math.max(1,r),s}return e.prototype.next=function(t){var r=this,n=r.isStopped,s=r._buffer,a=r._infiniteTimeWindow,o=r._timestampProvider,u=r._windowTime;n||(s.push(t),!a&&s.push(o.now()+u)),this._trimBuffer(),i.prototype.next.call(this,t)},e.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(t),n=this,s=n._infiniteTimeWindow,a=n._buffer,o=a.slice(),u=0;u<o.length&&!t.closed;u+=s?1:2)t.next(o[u]);return this._checkFinalizedStatuses(t),r},e.prototype._trimBuffer=function(){var t=this,r=t._bufferSize,n=t._timestampProvider,s=t._buffer,a=t._infiniteTimeWindow,o=(a?1:2)*r;if(r<1/0&&o<s.length&&s.splice(0,s.length-o),!a){for(var u=n.now(),l=0,h=1;h<s.length&&s[h]<=u;h+=2)l=h;l&&s.splice(0,l+1)}},e}(Os),xD=function(i){$i(e,i);function e(t,r){return i.call(this)||this}return e.prototype.schedule=function(t,r){return this},e}(Oo),ym={setInterval:function(i,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setInterval.apply(void 0,Ms([i,e],Jn(t)))},clearInterval:function(i){return clearInterval(i)},delegate:void 0},SD=function(i){$i(e,i);function e(t,r){var n=i.call(this,t,r)||this;return n.scheduler=t,n.work=r,n.pending=!1,n}return e.prototype.schedule=function(t,r){var n;if(r===void 0&&(r=0),this.closed)return this;this.state=t;var s=this.id,a=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(a,s,r)),this.pending=!0,this.delay=r,this.id=(n=this.id)!==null&&n!==void 0?n:this.requestAsyncId(a,this.id,r),this},e.prototype.requestAsyncId=function(t,r,n){return n===void 0&&(n=0),ym.setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,r,n){if(n===void 0&&(n=0),n!=null&&this.delay===n&&this.pending===!1)return r;r!=null&&ym.clearInterval(r)},e.prototype.execute=function(t,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,r);if(n)return n;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,r){var n=!1,s;try{this.work(t)}catch(a){n=!0,s=a||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),s},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,r=t.id,n=t.scheduler,s=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Xl(s,this),r!=null&&(this.id=this.recycleAsyncId(n,r,null)),this.delay=null,i.prototype.unsubscribe.call(this)}},e}(xD),vm=function(){function i(e,t){t===void 0&&(t=i.now),this.schedulerActionCtor=e,this.now=t}return i.prototype.schedule=function(e,t,r){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},i.now=Oh.now,i}(),bD=function(i){$i(e,i);function e(t,r){r===void 0&&(r=vm.now);var n=i.call(this,t,r)||this;return n.actions=[],n._active=!1,n}return e.prototype.flush=function(t){var r=this.actions;if(this._active){r.push(t);return}var n;this._active=!0;do if(n=t.execute(t.state,t.delay))break;while(t=r.shift());if(this._active=!1,n){for(;t=r.shift();)t.unsubscribe();throw n}},e}(vm),Ph=new bD(SD),TD=Ph,kh=new dr(function(i){return i.complete()});function Em(i){return i&&bt(i.schedule)}function DD(i){return i[i.length-1]}function Am(i){return Em(DD(i))?i.pop():void 0}var Fh=function(i){return i&&typeof i.length=="number"&&typeof i!="function"};function xm(i){return bt(i==null?void 0:i.then)}function Sm(i){return bt(i[Mh])}function bm(i){return Symbol.asyncIterator&&bt(i==null?void 0:i[Symbol.asyncIterator])}function Tm(i){return new TypeError("You provided "+(i!==null&&typeof i=="object"?"an invalid object":"'"+i+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function RD(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Dm=RD();function Rm(i){return bt(i==null?void 0:i[Dm])}function Im(i){return oD(this,arguments,function(){var t,r,n,s;return um(this,function(a){switch(a.label){case 0:t=i.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,ga(t.read())];case 3:return r=a.sent(),n=r.value,s=r.done,s?[4,ga(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,ga(n)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function wm(i){return bt(i==null?void 0:i.getReader)}function $r(i){if(i instanceof dr)return i;if(i!=null){if(Sm(i))return ID(i);if(Fh(i))return wD(i);if(xm(i))return CD(i);if(bm(i))return Cm(i);if(Rm(i))return ND(i);if(wm(i))return LD(i)}throw Tm(i)}function ID(i){return new dr(function(e){var t=i[Mh]();if(bt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function wD(i){return new dr(function(e){for(var t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}function CD(i){return new dr(function(e){i.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,fm)})}function ND(i){return new dr(function(e){var t,r;try{for(var n=fa(i),s=n.next();!s.done;s=n.next()){var a=s.value;if(e.next(a),e.closed)return}}catch(o){t={error:o}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}e.complete()})}function Cm(i){return new dr(function(e){_D(i,e).catch(function(t){return e.error(t)})})}function LD(i){return Cm(Im(i))}function _D(i,e){var t,r,n,s;return aD(this,void 0,void 0,function(){var a,o;return um(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),t=lD(i),u.label=1;case 1:return[4,t.next()];case 2:if(r=u.sent(),!!r.done)return[3,4];if(a=r.value,e.next(a),e.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=u.sent(),n={error:o},[3,11];case 6:return u.trys.push([6,,9,10]),r&&!r.done&&(s=t.return)?[4,s.call(t)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(n)throw n.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Qn(i,e,t,r,n){r===void 0&&(r=0),n===void 0&&(n=!1);var s=e.schedule(function(){t(),n?i.add(this.schedule(null,r)):this.unsubscribe()},r);if(i.add(s),!n)return s}function Nm(i,e){return e===void 0&&(e=0),Er(function(t,r){t.subscribe(nr(r,function(n){return Qn(r,i,function(){return r.next(n)},e)},function(){return Qn(r,i,function(){return r.complete()},e)},function(n){return Qn(r,i,function(){return r.error(n)},e)}))})}function Lm(i,e){return e===void 0&&(e=0),Er(function(t,r){r.add(i.schedule(function(){return t.subscribe(r)},e))})}function MD(i,e){return $r(i).pipe(Lm(e),Nm(e))}function OD(i,e){return $r(i).pipe(Lm(e),Nm(e))}function PD(i,e){return new dr(function(t){var r=0;return e.schedule(function(){r===i.length?t.complete():(t.next(i[r++]),t.closed||this.schedule())})})}function kD(i,e){return new dr(function(t){var r;return Qn(t,e,function(){r=i[Dm](),Qn(t,e,function(){var n,s,a;try{n=r.next(),s=n.value,a=n.done}catch(o){t.error(o);return}a?t.complete():t.next(s)},0,!0)}),function(){return bt(r==null?void 0:r.return)&&r.return()}})}function _m(i,e){if(!i)throw new Error("Iterable cannot be null");return new dr(function(t){Qn(t,e,function(){var r=i[Symbol.asyncIterator]();Qn(t,e,function(){r.next().then(function(n){n.done?t.complete():t.next(n.value)})},0,!0)})})}function FD(i,e){return _m(Im(i),e)}function BD(i,e){if(i!=null){if(Sm(i))return MD(i,e);if(Fh(i))return PD(i,e);if(xm(i))return OD(i,e);if(bm(i))return _m(i,e);if(Rm(i))return kD(i,e);if(wm(i))return FD(i,e)}throw Tm(i)}function Gr(i,e){return e?BD(i,e):$r(i)}function Rr(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];var t=Am(i);return Gr(i,t)}function Mm(i,e){var t=bt(i)?i:function(){return i},r=function(n){return n.error(t())};return new dr(r)}var UD=Yl(function(i){return function(){i(this),this.name="EmptyError",this.message="no elements in sequence"}});function Bh(i,e){return new Promise(function(t,r){var n=new pa({next:function(s){t(s),n.unsubscribe()},error:r,complete:function(){r(new UD)}});i.subscribe(n)})}function Om(i){return i instanceof Date&&!isNaN(i)}var Pm=Yl(function(i){return function(t){t===void 0&&(t=null),i(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}});function km(i,e){var t=Om(i)?{first:i}:typeof i=="number"?{each:i}:i,r=t.first,n=t.each,s=t.with,a=s===void 0?$D:s,o=t.scheduler,u=o===void 0?Ph:o,l=t.meta,h=l===void 0?null:l;if(r==null&&n==null)throw new TypeError("No timeout provided.");return Er(function(d,p){var g,m,v=null,E=0,x=function(T){m=Qn(p,u,function(){try{g.unsubscribe(),$r(a({meta:h,lastValue:v,seen:E})).subscribe(p)}catch(R){p.error(R)}},T)};g=d.subscribe(nr(p,function(T){m==null||m.unsubscribe(),E++,p.next(v=T),n>0&&x(n)},void 0,void 0,function(){m!=null&&m.closed||m==null||m.unsubscribe(),v=null})),!E&&x(r!=null?typeof r=="number"?r:+r-u.now():n)})}function $D(i){throw new Pm(i)}function fr(i,e){return Er(function(t,r){var n=0;t.subscribe(nr(r,function(s){r.next(i.call(e,s,n++))}))})}var GD=Array.isArray;function qD(i,e){return GD(e)?i.apply(void 0,Ms([],Jn(e))):i(e)}function HD(i){return fr(function(e){return qD(i,e)})}function VD(i,e,t,r,n,s,a,o){var u=[],l=0,h=0,d=!1,p=function(){d&&!u.length&&!l&&e.complete()},g=function(v){return l<r?m(v):u.push(v)},m=function(v){l++;var E=!1;$r(t(v,h++)).subscribe(nr(e,function(x){e.next(x)},function(){E=!0},void 0,function(){if(E)try{l--;for(var x=function(){var T=u.shift();a||m(T)};u.length&&l<r;)x();p()}catch(T){e.error(T)}}))};return i.subscribe(nr(e,g,function(){d=!0,p()})),function(){}}function Jl(i,e,t){return t===void 0&&(t=1/0),bt(e)?Jl(function(r,n){return fr(function(s,a){return e(r,s,n,a)})($r(i(r,n)))},t):(typeof e=="number"&&(t=e),Er(function(r,n){return VD(r,n,i,t)}))}function KD(i){return Jl(ma,i)}function WD(){return KD(1)}function Fm(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];return WD()(Gr(i,Am(i)))}var YD=["addListener","removeListener"],XD=["addEventListener","removeEventListener"],zD=["on","off"];function Uh(i,e,t,r){if(bt(t)&&(r=t,t=void 0),r)return Uh(i,e,t).pipe(HD(r));var n=Jn(QD(i)?XD.map(function(o){return function(u){return i[o](e,u,t)}}):jD(i)?YD.map(Bm(i,e)):JD(i)?zD.map(Bm(i,e)):[],2),s=n[0],a=n[1];if(!s&&Fh(i))return Jl(function(o){return Uh(o,e,t)})($r(i));if(!s)throw new TypeError("Invalid event target");return new dr(function(o){var u=function(){for(var l=[],h=0;h<arguments.length;h++)l[h]=arguments[h];return o.next(1<l.length?l:l[0])};return s(u),function(){return a(u)}})}function Bm(i,e){return function(t){return function(r){return i[t](e,r)}}}function jD(i){return bt(i.addListener)&&bt(i.removeListener)}function JD(i){return bt(i.on)&&bt(i.off)}function QD(i){return bt(i.addEventListener)&&bt(i.removeEventListener)}function ZD(i,e,t){return new dr(function(r){var n=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];return r.next(a.length===1?a[0]:a)},s=i(n);return bt(e)?function(){return e(n,s)}:void 0})}function $h(i,e,t){i===void 0&&(i=0),t===void 0&&(t=TD);var r=-1;return e!=null&&(Em(e)?t=e:r=e),new dr(function(n){var s=Om(i)?+i-t.now():i;s<0&&(s=0);var a=0;return t.schedule(function(){n.closed||(n.next(a++),0<=r?this.schedule(void 0,r):n.complete())},s)})}function ya(i,e){return i===void 0&&(i=0),e===void 0&&(e=Ph),i<0&&(i=0),$h(i,i,e)}function Jt(i,e){return Er(function(t,r){var n=0;t.subscribe(nr(r,function(s){return i.call(e,s,n++)&&r.next(s)}))})}function eR(i){return function(e){for(var t=[],r=function(s){t.push($r(i[s]).subscribe(nr(e,function(a){if(t){for(var o=0;o<t.length;o++)o!==s&&t[o].unsubscribe();t=null}e.next(a)})))},n=0;t&&!e.closed&&n<i.length;n++)r(n)}}function tR(i){return Er(function(e,t){var r=null,n=null,s=function(){n==null||n.unsubscribe();var a=r;r=[],a&&t.next(a),$r(i()).subscribe(n=nr(t,s,Lh))};s(),e.subscribe(nr(t,function(a){return r==null?void 0:r.push(a)},function(){r&&t.next(r),t.complete()},void 0,function(){return r=n=null}))})}function Gh(i){return Er(function(e,t){var r=null,n=!1,s;r=e.subscribe(nr(t,void 0,void 0,function(a){s=$r(i(a,Gh(i)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):n=!0})),n&&(r.unsubscribe(),r=null,s.subscribe(t))})}function Ps(i){return i<=0?function(){return kh}:Er(function(e,t){var r=0;e.subscribe(nr(t,function(n){++r<=i&&(t.next(n),i<=r&&t.complete())}))})}function rR(i,e){return e===void 0&&(e=ma),i=i??iR,Er(function(t,r){var n,s=!0;t.subscribe(nr(r,function(a){var o=e(a);(s||!i(n,o))&&(s=!1,n=o,r.next(a))}))})}function iR(i,e){return i===e}function nR(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];return i.length?Er(function(t,r){eR(Ms([t],Jn(i)))(r)}):ma}function sR(i){i===void 0&&(i=1/0);var e;i&&typeof i=="object"?e=i:e={count:i};var t=e.count,r=t===void 0?1/0:t,n=e.delay,s=e.resetOnSuccess,a=s===void 0?!1:s;return r<=0?ma:Er(function(o,u){var l=0,h,d=function(){var p=!1;h=o.subscribe(nr(u,function(g){a&&(l=0),u.next(g)},void 0,function(g){if(l++<r){var m=function(){h?(h.unsubscribe(),h=null,d()):p=!0};if(n!=null){var v=typeof n=="number"?$h(n):$r(n(g,l)),E=nr(u,function(){E.unsubscribe(),m()},function(){u.complete()});v.subscribe(E)}else m()}else u.error(g)})),p&&(h.unsubscribe(),h=null,d())};d()})}function aR(i){i===void 0&&(i={});var e=i.connector,t=e===void 0?function(){return new Os}:e,r=i.resetOnError,n=r===void 0?!0:r,s=i.resetOnComplete,a=s===void 0?!0:s,o=i.resetOnRefCountZero,u=o===void 0?!0:o;return function(l){var h,d,p,g=0,m=!1,v=!1,E=function(){d==null||d.unsubscribe(),d=void 0},x=function(){E(),h=p=void 0,m=v=!1},T=function(){var R=h;x(),R==null||R.unsubscribe()};return Er(function(R,_){g++,!v&&!m&&E();var F=p=p??t();_.add(function(){g--,g===0&&!v&&!m&&(d=qh(T,u))}),F.subscribe(_),!h&&g>0&&(h=new pa({next:function(N){return F.next(N)},error:function(N){v=!0,E(),d=qh(x,n,N),F.error(N)},complete:function(){m=!0,E(),d=qh(x,a),F.complete()}}),$r(R).subscribe(h))})(l)}}function qh(i,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];if(e===!0){i();return}if(e!==!1){var n=new pa({next:function(){n.unsubscribe(),i()}});return $r(e.apply(void 0,Ms([],Jn(t)))).subscribe(n)}}function oR(i,e,t){var r,n=!1;return r=i,aR({connector:function(){return new AD(r,e,t)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:n})}function Ar(i,e){return Er(function(t,r){var n=null,s=0,a=!1,o=function(){return a&&!n&&r.complete()};t.subscribe(nr(r,function(u){n==null||n.unsubscribe();var l=0,h=s++;$r(i(u,h)).subscribe(n=nr(r,function(d){return r.next(e?e(u,d,h,l++):d)},function(){n=null,o()}))},function(){a=!0,o()}))})}function lR(i,e){return e===void 0&&(e=!1),Er(function(t,r){var n=0;t.subscribe(nr(r,function(s){var a=i(s,n++);(a||e)&&r.next(s),!a&&r.complete()}))})}function va(i,e,t){var r=bt(i)||e||t?{next:i,error:e,complete:t}:i;return r?Er(function(n,s){var a;(a=r.subscribe)===null||a===void 0||a.call(r);var o=!0;n.subscribe(nr(s,function(u){var l;(l=r.next)===null||l===void 0||l.call(r,u),s.next(u)},function(){var u;o=!1,(u=r.complete)===null||u===void 0||u.call(r),s.complete()},function(u){var l;o=!1,(l=r.error)===null||l===void 0||l.call(r,u),s.error(u)},function(){var u,l;o&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):ma}class Ti{constructor(e,t,r){fe(this,"matchResult");fe(this,"parsedQs");fe(this,"map",new Map);this.media=e,this.tabTitle=t,this.data=r}computeUrlMatchResultIfAbsent(e){return this.matchResult??(this.matchResult=e())}computeParsedQsIfAbsent(e){return this.parsedQs??(this.parsedQs=e())}setParam(e,t){this.map.set(e,t)}getParam(e){return this.map.get(e)}}class Vt extends Error{}class Zn extends Error{}var ks=function(i,e,t,r){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{l(r.next(h))}catch(d){a(d)}}function u(h){try{l(r.throw(h))}catch(d){a(d)}}function l(h){h.done?s(h.value):n(h.value).then(o,u)}l((r=r.apply(i,e||[])).next())})},Gi=function(i){return this instanceof Gi?(this.v=i,this):new Gi(i)},Um=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,x){s.push([g,v,E,x])>1||u(g,v)})},m&&(n[g]=m(n[g])))}function u(g,m){try{l(r[g](m))}catch(v){p(s[0][3],v)}}function l(g){g.value instanceof Gi?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){u("next",g)}function d(g){u("throw",g)}function p(g,m){g(m),s.shift(),s.length&&u(s[0][0],s[0][1])}},sr;(function(i){i[i.SHORTEST=0]="SHORTEST",i[i.LONGEST=1]="LONGEST",i[i.STRICT_EQUAL=2]="STRICT_EQUAL"})(sr||(sr={}));function*Ea(i,e,...t){if(t.length===0)return;const r=[];for(const n of t)r.push(ly(n));e:for(;;){const n=id.map(r,u=>u.next()),s=[];let a=!0,o=!1;for(const u of n){let l;u.done?(a=!1,l=e):(o=!0,l=u.value),s.push(l)}if(!a&&o)switch(i){case sr.SHORTEST:break e;case sr.STRICT_EQUAL:throw new Zn("Iterators must have equal lengths")}if(!o)break;yield s}}function Aa(i,e,...t){return Um(this,arguments,function*(){if(t.length===0)return yield Gi(void 0);const n=[];for(const s of t)n.push(uy(s));e:for(;;){const s=[];for(const l of n){const h=yield Gi(l.next());s.push(h)}const a=[];let o=!0,u=!1;for(const l of s){let h;l.done?(o=!1,h=e):(u=!0,h=l.value),a.push(h)}if(!o&&u)switch(i){case sr.SHORTEST:break e;case sr.STRICT_EQUAL:throw new Zn("Iterators must have equal lengths")}if(!u)break;yield yield Gi(a)}})}class Ql{constructor(){this.addedMap=new Map,this.deletedMap=new Map}addUsage(e,t){this.addedMap.has(e)||this.addedMap.set(e,new Map);const r=this.addedMap.get(e);r.has(t)||r.set(t,0),r.set(t,r.get(t)+1)}deleteUsage(e){this.deletedMap.has(e)?this.deletedMap.set(e,this.deletedMap.get(e)+1):this.deletedMap.set(e,1)}getOwnersCount(e){var t,r;const n=(t=this.deletedMap.get(e))!==null&&t!==void 0?t:0;return Ii.of((r=this.addedMap.get(e))!==null&&r!==void 0?r:new Map).map(s=>s[1]).filter(s=>s>n).toValue(s=>s+1,0)}getUsagesCount(e,t=1){var r,n;const s=(r=this.deletedMap.get(e))!==null&&r!==void 0?r:0;let a=Ii.of((n=this.addedMap.get(e))!==null&&n!==void 0?n:new Map).map(o=>o[1]).map(o=>o-s).filter(o=>o>0).toArray();for(;a.length>t;){const o=Yy.toMin(a);a=Ii.of(a).map(u=>u-o).filter(u=>u>0).toArray()}return Yy.toSum(a)}}class xr{}class uR{constructor(e,t){this.related=[],this.positions=[],this.cache=new Map,this.lastCacheIndex=0,this.isValid=!0,this.iterator=e;for(let r=0;r<t;++r)this.related.push(new cR(this,r)),this.positions.push(0);this.cacheNextValue()}current(e){const t=this.getPosition(e);return this.cache.get(t)}next(e){const[t,r,n]=[this.getPosition(e),Math.min(...this.positions),Math.max(...this.positions)];t===n&&this.cacheNextValue(),this.positions[e.getId()]++,r<Math.min(...this.positions)&&this.cache.delete(r)}valid(e){return this.getPosition(e)<this.lastCacheIndex||this.isValid}getRelatedIterables(){return this.related}cacheNextValue(){const e=this.iterator.next();e.done||this.cache.set(this.lastCacheIndex++,e.value),this.isValid=!e.done}getPosition(e){return this.positions[e.getId()]}}class cR{constructor(e,t){this.parent=e,this.id=t}getId(){return this.id}valid(){return this.parent.valid(this)}next(){const e={value:this.current(),done:!this.valid()};return e.done||this.parent.next(this),e}current(){return this.parent.valid(this)?this.parent.current(this):void 0}*[Symbol.iterator](){for(;this.parent.valid(this);)yield this.parent.current(this),this.parent.next(this)}}class hR{constructor(e,t){this.related=[],this.positions=[],this.cache=new Map,this.lastCacheIndex=0,this.isValid=!0,this.isFirstIteration=!0,this.iterator=e;for(let r=0;r<t;++r)this.related.push(new dR(this,r)),this.positions.push(0)}current(e){return ks(this,void 0,void 0,function*(){this.isFirstIteration&&(yield this.cacheNextValue());const t=this.getPosition(e);return this.cache.get(t)})}next(e){return ks(this,void 0,void 0,function*(){const[t,r,n]=[this.getPosition(e),Math.min(...this.positions),Math.max(...this.positions)];t===n&&(yield this.cacheNextValue()),this.positions[e.getId()]++,r<Math.min(...this.positions)&&this.cache.delete(r)})}valid(e){return ks(this,void 0,void 0,function*(){return this.isFirstIteration&&(yield this.cacheNextValue()),this.getPosition(e)<this.lastCacheIndex||this.isValid})}getRelatedIterables(){return this.related}cacheNextValue(){return ks(this,void 0,void 0,function*(){const e=yield this.iterator.next();e.done||this.cache.set(this.lastCacheIndex++,e.value),this.isFirstIteration=!1,this.isValid=!e.done})}getPosition(e){return this.positions[e.getId()]}}class dR{constructor(e,t){this.parent=e,this.id=t}getId(){return this.id}valid(){return ks(this,void 0,void 0,function*(){return yield this.parent.valid(this)})}next(){return ks(this,void 0,void 0,function*(){const e={value:yield this.current(),done:!(yield this.valid())};return e.done||(yield this.parent.next(this)),e})}current(){return ks(this,void 0,void 0,function*(){return(yield this.parent.valid(this))?yield this.parent.current(this):void 0})}[Symbol.asyncIterator](){return Um(this,arguments,function*(){for(;yield Gi(this.parent.valid(this));)yield yield Gi(yield Gi(this.parent.current(this))),yield Gi(this.parent.next(this))})}}var Po=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,u){a=i[s](a),n(o,u,a.done,a.value)})}}function n(s,a,o,u){Promise.resolve(u).then(function(l){s({value:l,done:o})},a)}},ar=function(i){return this instanceof ar?(this.v=i,this):new ar(i)},ko=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,x){s.push([g,v,E,x])>1||u(g,v)})},m&&(n[g]=m(n[g])))}function u(g,m){try{l(r[g](m))}catch(v){p(s[0][3],v)}}function l(g){g.value instanceof ar?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){u("next",g)}function d(g){u("throw",g)}function p(g,m){g(m),s.shift(),s.length&&u(s[0][0],s[0][1])}};function*$m(...i){for(const e of Ea(sr.SHORTEST,void 0,...i))yield e}function Gm(...i){return ko(this,arguments,function*(){var t,r,n,s;try{for(var a=!0,o=Po(Aa(sr.SHORTEST,void 0,...i)),u;u=yield ar(o.next()),t=u.done,!t;a=!0)s=u.value,a=!1,yield yield ar(s)}catch(l){r={error:l}}finally{try{!a&&!t&&(n=o.return)&&(yield ar(n.call(o)))}finally{if(r)throw r.error}}})}function*fR(i,...e){for(const t of Ea(sr.LONGEST,i,...e))yield t}function gR(i,...e){return ko(this,arguments,function*(){var r,n,s,a;try{for(var o=!0,u=Po(Aa(sr.LONGEST,i,...e)),l;l=yield ar(u.next()),r=l.done,!r;o=!0)a=l.value,o=!1,yield yield ar(a)}catch(h){n={error:h}}finally{try{!o&&!r&&(s=u.return)&&(yield ar(s.call(u)))}finally{if(n)throw n.error}}})}function*pR(...i){for(const e of Ea(sr.LONGEST,void 0,...i))yield e}function mR(...i){return ko(this,arguments,function*(){var t,r,n,s;try{for(var a=!0,o=Po(Aa(sr.LONGEST,void 0,...i)),u;u=yield ar(o.next()),t=u.done,!t;a=!0)s=u.value,a=!1,yield yield ar(s)}catch(l){r={error:l}}finally{try{!a&&!t&&(n=o.return)&&(yield ar(n.call(o)))}finally{if(r)throw r.error}}})}function*qm(...i){for(const e of Ea(sr.STRICT_EQUAL,void 0,...i))yield e}function Hm(...i){return ko(this,arguments,function*(){var t,r,n,s;try{for(var a=!0,o=Po(Aa(sr.STRICT_EQUAL,void 0,...i)),u;u=yield ar(o.next()),t=u.done,!t;a=!0)s=u.value,a=!1,yield yield ar(s)}catch(l){r={error:l}}finally{try{!a&&!t&&(n=o.return)&&(yield ar(n.call(o)))}finally{if(r)throw r.error}}})}function*yR(...i){for(const e of i)for(const t of Je(e))yield t}function vR(...i){return ko(this,arguments,function*(){var t,r,n,s;for(const l of i)try{for(var a=!0,o=(r=void 0,Po(Ye(l))),u;u=yield ar(o.next()),t=u.done,!t;a=!0)s=u.value,a=!1,yield yield ar(s)}catch(h){r={error:h}}finally{try{!a&&!t&&(n=o.return)&&(yield ar(n.call(o)))}finally{if(r)throw r.error}}})}var Ir=function(i,e,t,r){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{l(r.next(h))}catch(d){a(d)}}function u(h){try{l(r.throw(h))}catch(d){a(d)}}function l(h){h.done?s(h.value):n(h.value).then(o,u)}l((r=r.apply(i,e||[])).next())})},Zl=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,u){a=i[s](a),n(o,u,a.done,a.value)})}}function n(s,a,o,u){Promise.resolve(u).then(function(l){s({value:l,done:o})},a)}};function Di(i,e,t){let r=t;for(const n of Je(i))r=e(r,n);return r}function Ri(i,e,t){return Ir(this,void 0,void 0,function*(){var r,n,s,a;let o=t;try{for(var u=!0,l=Zl(Ye(i)),h;h=yield l.next(),r=h.done,!r;u=!0)a=h.value,u=!1,o=yield e(o,a)}catch(d){n={error:d}}finally{try{!u&&!r&&(s=l.return)&&(yield s.call(l))}finally{if(n)throw n.error}}return o})}function Vm(i){const[e,t]=Di(i,(r,n)=>{const[s,a]=r;return[s+1,a+Number(n)]},[0,0]);return e?t/e:void 0}function Km(i){return Ir(this,void 0,void 0,function*(){const[e,t]=yield Ri(i,(r,n)=>{const[s,a]=r;return[s+1,a+Number(n)]},[0,0]);return e?t/e:void 0})}function Wm(i,e){return e!==void 0?Di(i,(t,r)=>e(r)>e(t??r)?r:t??r):Di(i,(t,r)=>{const n=t??r,s=r;return n>=s?n:s})}function Ym(i,e){return Ir(this,void 0,void 0,function*(){return e!==void 0?yield Ri(i,(t,r)=>Ir(this,void 0,void 0,function*(){return(yield e(r))>(yield e(t??r))?r:t??r})):yield Ri(i,(t,r)=>{const n=t??r,s=r;return n>=s?n:s})})}function Xm(i,e){return e!==void 0?Di(i,(t,r)=>e(r)<e(t??r)?r:t??r):Di(i,(t,r)=>{const n=t??r,s=r;return n<=s?n:s})}function zm(i,e){return Ir(this,void 0,void 0,function*(){return e!==void 0?yield Ri(i,(t,r)=>Ir(this,void 0,void 0,function*(){return(yield e(r))<(yield e(t??r))?r:t??r})):yield Ri(i,(t,r)=>{const n=t??r,s=r;return n<=s?n:s})})}function Hh(i,e){const t=e!==void 0?e:r=>r;return Di(i,(r,n)=>{var s,a,o,u;return r=r,[t(n)<=t((s=r[0])!==null&&s!==void 0?s:n)?n:(a=r[0])!==null&&a!==void 0?a:n,t(n)>=t((o=r[1])!==null&&o!==void 0?o:n)?n:(u=r[1])!==null&&u!==void 0?u:n]},[void 0,void 0])}function Vh(i,e){return Ir(this,void 0,void 0,function*(){const t=e!==void 0?e:r=>r;return yield Ri(i,(r,n)=>Ir(this,void 0,void 0,function*(){var s,a,o,u;return r=r,[(yield t(n))<=(yield t((s=r[0])!==null&&s!==void 0?s:n))?n:(a=r[0])!==null&&a!==void 0?a:n,(yield t(n))>=(yield t((o=r[1])!==null&&o!==void 0?o:n))?n:(u=r[1])!==null&&u!==void 0?u:n]}),[void 0,void 0])})}function jm(i){const[e,t]=Hh(ru(i,r=>Number(r)));return(t??0)-(e??0)}function Jm(i){return Ir(this,void 0,void 0,function*(){const[e,t]=yield Vh($o(i,r=>Number(r)));return(t??0)-(e??0)})}function Qm(i){return Di(i,(e,t)=>e+Number(t),0)}function Zm(i){return Ir(this,void 0,void 0,function*(){return yield Ri(i,(e,t)=>e+Number(t),0)})}function ey(i){return Di(i,(e,t)=>(e??1)*t)}function ty(i){return Ir(this,void 0,void 0,function*(){return yield Ri(i,(e,t)=>(e??1)*t)})}function eu(i){switch(!0){case i instanceof Array:return i.length;case xa(i):return i.length;case i instanceof Set:return i.size;case i instanceof Map:return i.size}return Di(i,e=>e+1,0)}function Kh(i){return Ir(this,void 0,void 0,function*(){switch(!0){case i instanceof Array:case xa(i):case i instanceof Set:case i instanceof Map:return eu(i)}return yield Ri(i,e=>e+1,0)})}function ry(i){for(const e of Je(i))return e;throw new Zn("Collection is empty")}function iy(i){return Ir(this,void 0,void 0,function*(){var e,t,r,n;try{for(var s=!0,a=Zl(Ye(i)),o;o=yield a.next(),e=o.done,!e;s=!0)return n=o.value,s=!1,n}catch(u){t={error:u}}finally{try{!s&&!e&&(r=a.return)&&(yield r.call(a))}finally{if(t)throw t.error}}throw new Zn("Collection is empty")})}function ny(i){let e=!0,t;for(const r of Je(i))t=r,e=!1;if(e)throw new Zn("Collection is empty");return t}function sy(i){return Ir(this,void 0,void 0,function*(){var e,t,r,n;let s=!0,a;try{for(var o=!0,u=Zl(Ye(i)),l;l=yield u.next(),e=l.done,!e;o=!0)n=l.value,o=!1,a=n,s=!1}catch(h){t={error:h}}finally{try{!o&&!e&&(r=u.return)&&(yield r.call(u))}finally{if(t)throw t.error}}if(s)throw new Zn("Collection is empty");return a})}function ay(i){let e=xr,t=xr;for(const r of Je(i))e===xr&&(e=r),t=r;if(e===xr)throw new Zn("Collection is empty");return[e,t]}function oy(i){return Ir(this,void 0,void 0,function*(){var e,t,r,n;let s=xr,a=xr;try{for(var o=!0,u=Zl(Ye(i)),l;l=yield u.next(),e=l.done,!e;o=!0){n=l.value,o=!1;const h=n;s===xr&&(s=h),a=h}}catch(h){t={error:h}}finally{try{!o&&!e&&(r=u.return)&&(yield r.call(u))}finally{if(t)throw t.error}}if(s===xr)throw new Zn("Collection is empty");return[s,a]})}var qi=function(i,e,t,r){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{l(r.next(h))}catch(d){a(d)}}function u(h){try{l(r.throw(h))}catch(d){a(d)}}function l(h){h.done?s(h.value):n(h.value).then(o,u)}l((r=r.apply(i,e||[])).next())})},es=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,u){a=i[s](a),n(o,u,a.done,a.value)})}}function n(s,a,o,u){Promise.resolve(u).then(function(l){s({value:l,done:o})},a)}};function ER(i,e){for(const t of Je(i))if(!e(t))return!1;return!0}function AR(i,e){return qi(this,void 0,void 0,function*(){var t,r,n,s;try{for(var a=!0,o=es(Ye(i)),u;u=yield o.next(),t=u.done,!t;a=!0)if(s=u.value,a=!1,!(yield e(s)))return!1}catch(l){r={error:l}}finally{try{!a&&!t&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return!0})}function xR(i){const e=new Set;for(const t of Je(i)){if(e.has(t))return!1;e.add(t)}return!0}function SR(i){return qi(this,void 0,void 0,function*(){var e,t,r,n;const s=new Set;try{for(var a=!0,o=es(Ye(i)),u;u=yield o.next(),e=u.done,!e;a=!0){n=u.value,a=!1;const l=n;if(s.has(l))return!1;s.add(l)}}catch(l){t={error:l}}finally{try{!a&&!e&&(r=o.return)&&(yield r.call(o))}finally{if(t)throw t.error}}return!0})}function bR(i,e){for(const t of Je(i))if(e(t))return!0;return!1}function TR(i,e){return qi(this,void 0,void 0,function*(){var t,r,n,s;try{for(var a=!0,o=es(Ye(i)),u;u=yield o.next(),t=u.done,!t;a=!0)if(s=u.value,a=!1,yield e(s))return!0}catch(l){r={error:l}}finally{try{!a&&!t&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return!1})}function DR(i,e,t){if(e<0)return!1;t===void 0&&(t=n=>!!n);let r=0;for(const n of Je(i))if(t(n)&&(r++,r>e))return!1;return r===e}function RR(i,e,t){return qi(this,void 0,void 0,function*(){var r,n,s,a;if(e<0)return!1;t===void 0&&(t=d=>!!d);let o=0;try{for(var u=!0,l=es(Ye(i)),h;h=yield l.next(),r=h.done,!r;u=!0)if(a=h.value,u=!1,(yield t(a))&&(o++,o>e))return!1}catch(d){n={error:d}}finally{try{!u&&!r&&(s=l.return)&&(yield s.call(l))}finally{if(n)throw n.error}}return o===e})}function Hi(i){return i==null?!1:typeof i[Symbol.iterator]=="function"}function Fo(i){return i==null?!1:typeof i[Symbol.asyncIterator]=="function"}function ts(i){return i==null?!1:i.next!==void 0&&typeof i.next=="function"}function IR(i){for(const[e,t]of ba(Je(i)))if(e<t)return!1;return!0}function wR(i){return qi(this,void 0,void 0,function*(){var e,t,r,n;try{for(var s=!0,a=es(su(Ye(i))),o;o=yield a.next(),e=o.done,!e;s=!0){n=o.value,s=!1;const[u,l]=n;if(u<l)return!1}}catch(u){t={error:u}}finally{try{!s&&!e&&(r=a.return)&&(yield r.call(a))}finally{if(t)throw t.error}}return!0})}function CR(i){for(const[e,t]of ba(Je(i)))if(e>t)return!1;return!0}function NR(i){return qi(this,void 0,void 0,function*(){var e,t,r,n;try{for(var s=!0,a=es(su(Ye(i))),o;o=yield a.next(),e=o.done,!e;s=!0){n=o.value,s=!1;const[u,l]=n;if(u>l)return!1}}catch(u){t={error:u}}finally{try{!s&&!e&&(r=a.return)&&(yield r.call(a))}finally{if(t)throw t.error}}return!0})}function xa(i){return typeof i=="string"||i instanceof String}function LR(i,e){for(const t of Je(i))if(e(t))return!1;return!0}function _R(i,e){return qi(this,void 0,void 0,function*(){var t,r,n,s;try{for(var a=!0,o=es(Ye(i)),u;u=yield o.next(),t=u.done,!t;a=!0)if(s=u.value,a=!1,yield e(s))return!1}catch(l){r={error:l}}finally{try{!a&&!t&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return!0})}function MR(...i){try{for(const e of qm(...i))for(const[t,r]of ba(e))if(t!==r)return!1}catch{return!1}return!0}function OR(...i){return qi(this,void 0,void 0,function*(){var e,t,r,n;try{try{for(var s=!0,a=es(Hm(...i)),o;o=yield a.next(),e=o.done,!e;s=!0){n=o.value,s=!1;const u=n;for(const[l,h]of ba(u))if(l!==h)return!1}}catch(u){t={error:u}}finally{try{!s&&!e&&(r=a.return)&&(yield r.call(a))}finally{if(t)throw t.error}}}catch{return!1}return!0})}function PR(...i){if(i.length<=1)return!0;const e=i.map(t=>eu(t));return new Set(e).size===1}function kR(...i){return qi(this,void 0,void 0,function*(){if(i.length<=1)return!0;const e=yield $o(i,t=>qi(this,void 0,void 0,function*(){return yield Kh(t)}));return new Set(yield Fs(e)).size===1})}var Wh=function(i,e,t,r){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{l(r.next(h))}catch(d){a(d)}}function u(h){try{l(r.throw(h))}catch(d){a(d)}}function l(h){h.done?s(h.value):n(h.value).then(o,u)}l((r=r.apply(i,e||[])).next())})},Vi=function(i){return this instanceof Vi?(this.v=i,this):new Vi(i)},Yh=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,x){s.push([g,v,E,x])>1||u(g,v)})},m&&(n[g]=m(n[g])))}function u(g,m){try{l(r[g](m))}catch(v){p(s[0][3],v)}}function l(g){g.value instanceof Vi?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){u("next",g)}function d(g){u("throw",g)}function p(g,m){g(m),s.shift(),s.length&&u(s[0][0],s[0][1])}},tu=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,u){a=i[s](a),n(o,u,a.done,a.value)})}}function n(s,a,o,u){Promise.resolve(u).then(function(l){s({value:l,done:o})},a)}};function Je(i){if(Hi(i))return i;if(ts(i))return{[Symbol.iterator](){return i}};if(typeof i=="object"&&i!==null)return function*(){for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&(yield[e,i[e]])}();throw new Vt("Given collection is not iterable or iterator.")}function Ye(i){if(Fo(i))return i;if(ts(i))return{[Symbol.asyncIterator](){return Yh(this,arguments,function*(){for(;;){const t=yield Vi(i.next());if(t.done)return yield Vi(void 0);yield yield Vi(t.value)}})}};if(typeof i=="object"&&i!==null&&(i=Je(i)),Hi(i))return{[Symbol.asyncIterator](){return Yh(this,arguments,function*(){for(const t of i)yield yield Vi(t)})}};throw new Vt("Given collection is not async iterable or iterator.")}function ly(i){if(ts(i))return i;if(Hi(i))return function*(){for(const e of i)yield e}();throw new Vt("Given collection is not iterable or iterator.")}function uy(i){if((ts(i)||Hi(i))&&(i=Ye(i)),Fo(i))return function(){return Yh(this,arguments,function*(){var e,t,r,n;try{for(var s=!0,a=tu(i),o;o=yield Vi(a.next()),e=o.done,!e;s=!0)n=o.value,s=!1,yield yield Vi(n)}catch(u){t={error:u}}finally{try{!s&&!e&&(r=a.return)&&(yield Vi(r.call(a)))}finally{if(t)throw t.error}}})}();throw new Vt("Given collection is not iterable or iterator.")}function Sa(i){if(Array.isArray(i))return i;const e=[];for(const t of Je(i))e.push(t);return e}function Fs(i){return Wh(this,void 0,void 0,function*(){var e,t,r,n;if(Array.isArray(i))return i;const s=[];try{for(var a=!0,o=tu(Ye(i)),u;u=yield o.next(),e=u.done,!e;a=!0){n=u.value,a=!1;const l=n;s.push(l)}}catch(l){t={error:l}}finally{try{!a&&!e&&(r=o.return)&&(yield r.call(o))}finally{if(t)throw t.error}}return s})}function FR(i){const e=new Map;for(const[t,r]of Je(i))e.set(t,r);return e}function BR(i){return Wh(this,void 0,void 0,function*(){var e,t,r,n;const s=new Map;try{for(var a=!0,o=tu(Ye(i)),u;u=yield o.next(),e=u.done,!e;a=!0){n=u.value,a=!1;const[l,h]=n;s.set(l,h)}}catch(l){t={error:l}}finally{try{!a&&!e&&(r=o.return)&&(yield r.call(o))}finally{if(t)throw t.error}}return s})}function UR(i){const e=new Set;for(const t of Je(i))e.add(t);return e}function $R(i){return Wh(this,void 0,void 0,function*(){var e,t,r,n;const s=new Set;try{for(var a=!0,o=tu(Ye(i)),u;u=yield o.next(),e=u.done,!e;a=!0){n=u.value,a=!1;const l=n;s.add(l)}}catch(l){t={error:l}}finally{try{!a&&!e&&(r=o.return)&&(yield r.call(o))}finally{if(t)throw t.error}}return s})}function Xh(i,e){return new uR(ly(i),e).getRelatedIterables()}function zh(i,e){return new hR(uy(i),e).getRelatedIterables()}var gr=function(i){return this instanceof gr?(this.v=i,this):new gr(i)},Bo=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,u){a=i[s](a),n(o,u,a.done,a.value)})}}function n(s,a,o,u){Promise.resolve(u).then(function(l){s({value:l,done:o})},a)}},Uo=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,x){s.push([g,v,E,x])>1||u(g,v)})},m&&(n[g]=m(n[g])))}function u(g,m){try{l(r[g](m))}catch(v){p(s[0][3],v)}}function l(g){g.value instanceof gr?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){u("next",g)}function d(g){u("throw",g)}function p(g,m){g(m),s.shift(),s.length&&u(s[0][0],s[0][1])}},cy=function(i){var e,t;return e={},r("next"),r("throw",function(n){throw n}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(n,s){e[n]=i[n]?function(a){return(t=!t)?{value:gr(i[n](a)),done:!1}:s?s(a):a}:s}};function*jh(i,e){const t=new Set;if(i instanceof Map){e===void 0&&(e=r=>r[1]);for(const r of i){const n=e(r);t.has(n)||(yield r,t.add(n))}}else{e===void 0&&(e=r=>r);for(const r of Je(i)){const n=e(r);t.has(n)||(yield r,t.add(n))}}}function hy(i,e){return Uo(this,arguments,function*(){var r,n,s,a;const o=new Set;if(i instanceof Map)for(const d of jh(i,e))yield yield gr(yield gr(d));else{e===void 0&&(e=d=>d);try{for(var u=!0,l=Bo(Ye(i)),h;h=yield gr(l.next()),r=h.done,!r;u=!0){a=h.value,u=!1;const d=a,p=e(d);o.has(p)||(yield yield gr(d),o.add(p))}}catch(d){n={error:d}}finally{try{!u&&!r&&(s=l.return)&&(yield gr(s.call(l)))}finally{if(n)throw n.error}}}})}function*GR(...i){yield*Jh(i.length,...i)}function qR(...i){return Uo(this,arguments,function*(){yield gr(yield*cy(Bo(Qh(i.length,...i))))})}function*Jh(i,...e){const t=new Ql,r=Ea(sr.LONGEST,xr,...e);for(const n of r)for(const[s,a]of Ta(n))a!==xr&&(t.addUsage(a,`${s}`),t.getOwnersCount(a)===i&&(yield a,t.deleteUsage(a)))}function Qh(i,...e){return Uo(this,arguments,function*(){var r,n,s,a;const o=new Ql,u=Aa(sr.LONGEST,xr,...e);try{for(var l=!0,h=Bo(u),d;d=yield gr(h.next()),r=d.done,!r;l=!0){a=d.value,l=!1;const p=a;for(const[g,m]of Ta(p))m!==xr&&(o.addUsage(m,`${g}`),o.getOwnersCount(m)===i&&(yield yield gr(m),o.deleteUsage(m)))}}catch(p){n={error:p}}finally{try{!l&&!r&&(s=h.return)&&(yield gr(s.call(h)))}finally{if(n)throw n.error}}})}function*HR(...i){const e=new Ql,t=new Set,r=Ea(sr.LONGEST,xr,...i);for(const n of r)for(const[s,a]of Ta(n))a!==xr&&(e.addUsage(a,`${s}`),t.add(a),e.getOwnersCount(a)===i.length&&e.deleteUsage(a));for(const n of t)for(const s of id.repeat(n,e.getUsagesCount(n)))yield s}function VR(...i){return Uo(this,arguments,function*(){var t,r,n,s;const a=new Ql,o=new Set,u=Aa(sr.LONGEST,xr,...i);try{for(var l=!0,h=Bo(u),d;d=yield gr(h.next()),t=d.done,!t;l=!0){s=d.value,l=!1;const p=s;for(const[g,m]of Ta(p))m!==xr&&(a.addUsage(m,`${g}`),o.add(m),a.getOwnersCount(m)===i.length&&a.deleteUsage(m))}}catch(p){r={error:p}}finally{try{!l&&!t&&(n=h.return)&&(yield gr(n.call(h)))}finally{if(r)throw r.error}}for(const p of o)for(const g of id.repeat(p,a.getUsagesCount(p)))yield yield gr(g)})}function*KR(...i){yield*Jh(1,...i)}function WR(...i){return Uo(this,arguments,function*(){yield gr(yield*cy(Bo(Qh(1,...i))))})}var Xt=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,u){a=i[s](a),n(o,u,a.done,a.value)})}}function n(s,a,o,u){Promise.resolve(u).then(function(l){s({value:l,done:o})},a)}},Se=function(i){return this instanceof Se?(this.v=i,this):new Se(i)},Qt=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,x){s.push([g,v,E,x])>1||u(g,v)})},m&&(n[g]=m(n[g])))}function u(g,m){try{l(r[g](m))}catch(v){p(s[0][3],v)}}function l(g){g.value instanceof Se?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){u("next",g)}function d(g){u("throw",g)}function p(g,m){g(m),s.shift(),s.length&&u(s[0][0],s[0][1])}};function*ru(i,e){for(const t of Je(i))yield e(t)}function $o(i,e){return Qt(this,arguments,function*(){var r,n,s,a;try{for(var o=!0,u=Xt(Ye(i)),l;l=yield Se(u.next()),r=l.done,!r;o=!0)a=l.value,o=!1,yield yield Se(yield Se(e(a)))}catch(h){n={error:h}}finally{try{!o&&!r&&(s=u.return)&&(yield Se(s.call(u)))}finally{if(n)throw n.error}}})}function*dy(i,e){for(const[t,r]of $m(i,e))r&&(yield t)}function fy(i,e){return Qt(this,arguments,function*(){var r,n,s,a;try{for(var o=!0,u=Xt(Gm(i,e)),l;l=yield Se(u.next()),r=l.done,!r;o=!0){a=l.value,o=!1;const[h,d]=a;d&&(yield yield Se(h))}}catch(h){n={error:h}}finally{try{!o&&!r&&(s=u.return)&&(yield Se(s.call(u)))}finally{if(n)throw n.error}}})}function*gy(i,e){let t=!0;for(const r of Je(i)){if(t){if(!e(r)){t=!1,yield r;continue}continue}yield r}}function py(i,e){return Qt(this,arguments,function*(){var r,n,s,a;let o=!0;try{for(var u=!0,l=Xt(Ye(i)),h;h=yield Se(l.next()),r=h.done,!r;u=!0){a=h.value,u=!1;const d=a;if(o){if(!(yield Se(e(d)))){o=!1,yield yield Se(d);continue}continue}yield yield Se(d)}}catch(d){n={error:d}}finally{try{!u&&!r&&(s=l.return)&&(yield Se(s.call(l)))}finally{if(n)throw n.error}}})}function*my(i,e){for(const t of Je(i))if(e(t))yield t;else break}function yy(i,e){return Qt(this,arguments,function*(){var r,n,s,a;try{for(var o=!0,u=Xt(Ye(i)),l;l=yield Se(u.next()),r=l.done,!r;o=!0){a=l.value,o=!1;const h=a;if(yield Se(e(h)))yield yield Se(h);else break}}catch(h){n={error:h}}finally{try{!o&&!r&&(s=u.return)&&(yield Se(s.call(u)))}finally{if(n)throw n.error}}})}function*YR(i,e){if(e<0)throw new Vt(`Number of repetitions cannot be negative: ${e}`);for(let t=e;t>0;--t)yield i}function XR(i,e){return Qt(this,arguments,function*(){if(e<0)throw new Vt(`Number of repetitions cannot be negative: ${e}`);const r=yield Se(i);for(let n=e;n>0;--n)yield yield Se(r)})}function*vy(i,e){for(const t of Je(i)){const r=e(t,e);if(Hi(r))for(const n of Je(r))yield n;else yield r}}function Ey(i,e){return Qt(this,arguments,function*(){var r,n,s,a,o,u,l,h;try{for(var d=!0,p=Xt(Ye(i)),g;g=yield Se(p.next()),r=g.done,!r;d=!0){a=g.value,d=!1;const T=yield Se(e(a,e));if(Hi(T)||Fo(T))try{for(var m=!0,v=(u=void 0,Xt(Ye(T))),E;E=yield Se(v.next()),o=E.done,!o;m=!0)h=E.value,m=!1,yield yield Se(h)}catch(R){u={error:R}}finally{try{!m&&!o&&(l=v.return)&&(yield Se(l.call(v)))}finally{if(u)throw u.error}}else yield yield Se(T)}}catch(x){n={error:x}}finally{try{!d&&!r&&(s=p.return)&&(yield Se(s.call(p)))}finally{if(n)throw n.error}}})}function*Zh(i,e=1/0){if(e<1){for(let t of Je(i))i instanceof Map&&(t=t[1]),yield t;return}for(let t of Je(i))if(i instanceof Map&&(t=t[1]),(Hi(t)||ts(t))&&!xa(t))for(const r of Zh(t,e-1))yield r;else yield t}function ed(i){return Qt(this,arguments,function*(t,r=1/0){var n,s,a,o,u,l,h,d,p,g,m,v;if(r<1){try{for(var E=!0,x=Xt(Ye(t)),T;T=yield Se(x.next()),n=T.done,!n;E=!0){o=T.value,E=!1;let L=o;t instanceof Map&&(L=L[1]),yield yield Se(L)}}catch(L){s={error:L}}finally{try{!E&&!n&&(a=x.return)&&(yield Se(a.call(x)))}finally{if(s)throw s.error}}return yield Se(void 0)}try{for(var R=!0,_=Xt(Ye(t)),F;F=yield Se(_.next()),u=F.done,!u;R=!0){d=F.value,R=!1;let L=d;if(t instanceof Map&&(L=L[1]),(Fo(L)||Hi(L)||ts(L))&&!xa(L))try{for(var N=!0,C=(g=void 0,Xt(ed(L,r-1))),M;M=yield Se(C.next()),p=M.done,!p;N=!0)v=M.value,N=!1,yield yield Se(v)}catch(I){g={error:I}}finally{try{!N&&!p&&(m=C.return)&&(yield Se(m.call(C)))}finally{if(g)throw g.error}}else yield yield Se(L)}}catch(L){l={error:L}}finally{try{!R&&!u&&(h=_.return)&&(yield Se(h.call(_)))}finally{if(l)throw l.error}}})}function*Ay(i,e){for(const t of Je(i))e(t)&&(yield t)}function xy(i,e){return Qt(this,arguments,function*(){var r,n,s,a;try{for(var o=!0,u=Xt(Ye(i)),l;l=yield Se(u.next()),r=l.done,!r;o=!0){a=l.value,o=!1;const h=a;(yield Se(e(h)))&&(yield yield Se(h))}}catch(h){n={error:h}}finally{try{!o&&!r&&(s=u.return)&&(yield Se(s.call(u)))}finally{if(n)throw n.error}}})}function*iu(i,e,t,r=!0){if(e<1)throw new Vt(`Chunk size must be ≥ 1. Got ${e}`);if(t>=e)throw new Vt("Overlap size must be less than chunk size");let n=[],s=!1;for(const a of Je(i))s=!1,n.push(a),n.length===e&&(yield n,n=n.slice(e-t),s=!0);!s&&n.length>0&&r&&(yield n)}function nu(i,e,t){return Qt(this,arguments,function*(n,s,a,o=!0){var u,l,h,d;if(s<1)throw new Vt(`Chunk size must be ≥ 1. Got ${s}`);if(a>=s)throw new Vt("Overlap size must be less than chunk size");let p=[],g=!1;try{for(var m=!0,v=Xt(Ye(n)),E;E=yield Se(v.next()),u=E.done,!u;m=!0){d=E.value,m=!1;const x=d;g=!1,p.push(x),p.length===s&&(yield yield Se(p),p=p.slice(s-a),g=!0)}}catch(x){l={error:x}}finally{try{!m&&!u&&(h=v.return)&&(yield Se(h.call(v)))}finally{if(l)throw l.error}}!g&&p.length>0&&o&&(yield yield Se(p))})}function*Sy(i,e){for(const t of iu(i,e,0))yield t}function by(i,e){return Qt(this,arguments,function*(){var r,n,s,a;try{for(var o=!0,u=Xt(nu(i,e,0)),l;l=yield Se(u.next()),r=l.done,!r;o=!0)a=l.value,o=!1,yield yield Se(a)}catch(h){n={error:h}}finally{try{!o&&!r&&(s=u.return)&&(yield Se(s.call(u)))}finally{if(n)throw n.error}}})}function*ba(i){const e=iu(i,2,1,!1);for(const t of e)yield t}function su(i){return Qt(this,arguments,function*(){var t,r,n,s;const a=nu(i,2,1,!1);try{for(var o=!0,u=Xt(a),l;l=yield Se(u.next()),t=l.done,!t;o=!0)s=l.value,o=!1,yield yield Se(s)}catch(h){r={error:h}}finally{try{!o&&!t&&(n=u.return)&&(yield Se(n.call(u)))}finally{if(r)throw r.error}}})}function*Ty(i,e){if(e<0)throw new Vt(`Limit must be ≥ 0. Got ${e}`);let t=0;for(const r of Je(i)){if(t>=e)return;yield r,++t}}function Dy(i,e){return Qt(this,arguments,function*(){var r,n,s,a;if(e<0)throw new Vt(`Limit must be ≥ 0. Got ${e}`);let o=0;try{for(var u=!0,l=Xt(Ye(i)),h;h=yield Se(l.next()),r=h.done,!r;u=!0){a=h.value,u=!1;const d=a;if(o>=e)return yield Se(void 0);yield yield Se(d),++o}}catch(d){n={error:d}}finally{try{!u&&!r&&(s=l.return)&&(yield Se(s.call(l)))}finally{if(n)throw n.error}}})}function*Ta(i){let e=0;for(const t of Je(i))yield[e++,t]}function Ry(i){return Qt(this,arguments,function*(){var t,r,n,s;let a=0;try{for(var o=!0,u=Xt(Ye(i)),l;l=yield Se(u.next()),t=l.done,!t;o=!0){s=l.value,o=!1;const h=s;yield yield Se([a++,h])}}catch(h){r={error:h}}finally{try{!o&&!t&&(n=u.return)&&(yield Se(n.call(u)))}finally{if(r)throw r.error}}})}function*Iy(i,e=0,t,r=1){if(e<0)throw new Vt("Parameter 'start' cannot be negative");if(t!==void 0&&t<0)throw new Vt("Parameter 'count' cannot be negative");if(r<=0)throw new Vt("Parameter 'step' must be positive");let n=0,s=0;for(const a of Je(i))if(!(n++<e||(n-e-1)%r!==0)){if(s++===t&&t!==void 0)break;yield a}}function wy(i){return Qt(this,arguments,function*(t,r=0,n,s=1){var a,o,u,l;if(r<0)throw new Vt("Parameter 'start' cannot be negative");if(n!==void 0&&n<0)throw new Vt("Parameter 'count' cannot be negative");if(s<=0)throw new Vt("Parameter 'step' must be positive");let h=0,d=0;try{for(var p=!0,g=Xt(Ye(t)),m;m=yield Se(g.next()),a=m.done,!a;p=!0){l=m.value,p=!1;const v=l;if(!(h++<r||(h-r-1)%s!==0)){if(d++===n&&n!==void 0)break;yield yield Se(v)}}}catch(v){o={error:v}}finally{try{!p&&!a&&(u=g.return)&&(yield Se(u.call(g)))}finally{if(o)throw o.error}}})}function*Cy(i){for(const[e]of Je(i))yield e}function Ny(i){return Qt(this,arguments,function*(){var t,r,n,s;try{for(var a=!0,o=Xt(Ye(i)),u;u=yield Se(o.next()),t=u.done,!t;a=!0){s=u.value,a=!1;const[l]=s;yield yield Se(l)}}catch(l){r={error:l}}finally{try{!a&&!t&&(n=o.return)&&(yield Se(n.call(o)))}finally{if(r)throw r.error}}})}function*Ly(i,e,t=0){if(e<0||t<0)throw new Vt;let r=-t;for(const n of Je(i))(r<0||r>=e)&&(yield n),++r}function _y(i,e){return Qt(this,arguments,function*(r,n,s=0){var a,o,u,l;if(n<0||s<0)throw new Vt;let h=-s;try{for(var d=!0,p=Xt(Ye(r)),g;g=yield Se(p.next()),a=g.done,!a;d=!0){l=g.value,d=!1;const m=l;(h<0||h>=n)&&(yield yield Se(m)),++h}}catch(m){o={error:m}}finally{try{!d&&!a&&(u=p.return)&&(yield Se(u.call(p)))}finally{if(o)throw o.error}}})}function*My(i){for(const[,e]of Je(i))yield e}function Oy(i){return Qt(this,arguments,function*(){var t,r,n,s;try{for(var a=!0,o=Xt(Ye(i)),u;u=yield Se(o.next()),t=u.done,!t;a=!0){s=u.value,a=!1;const[,l]=s;yield yield Se(l)}}catch(l){r={error:l}}finally{try{!a&&!t&&(n=o.return)&&(yield Se(n.call(o)))}finally{if(r)throw r.error}}})}function*Py(i,e,t){const r=new Map,n=s=>{r.has(s)||(t!==void 0?r.set(s,{}):r.set(s,[]))};for(const s of Je(i)){const a=e(s),o=t!==void 0?t(s):void 0,u=(Hi(a)||ts(a))&&!xa(a)?a:[a];for(const l of jh(u))n(l),o===void 0?r.get(l).push(s):r.get(l)[o]=s}for(const s of r)yield s}function ky(i,e,t){return Qt(this,arguments,function*(){var n,s,a,o,u,l,h,d;const p=new Map,g=_=>{p.has(_)||(t!==void 0?p.set(_,{}):p.set(_,[]))};try{for(var m=!0,v=Xt(Ye(i)),E;E=yield Se(v.next()),n=E.done,!n;m=!0){o=E.value,m=!1;const _=o,F=yield Se(e(_)),N=t!==void 0?yield Se(t(_)):void 0,C=(Fo(F)||Hi(F)||ts(F))&&!xa(F)?F:[F];try{for(var x=!0,T=(l=void 0,Xt(hy(C))),R;R=yield Se(T.next()),u=R.done,!u;x=!0){d=R.value,x=!1;const M=d;g(M),N===void 0?p.get(M).push(_):p.get(M)[N]=_}}catch(M){l={error:M}}finally{try{!x&&!u&&(h=T.return)&&(yield Se(h.call(T)))}finally{if(l)throw l.error}}}}catch(_){s={error:_}}finally{try{!m&&!n&&(a=v.return)&&(yield Se(a.call(v)))}finally{if(s)throw s.error}}for(const _ of p)yield yield Se(_)})}function*Fy(i,e){const t=Sa(i);e!==void 0?t.sort(e):t.sort();for(const r of t)yield r}function By(i,e){return Qt(this,arguments,function*(){const r=yield Se(Fs(i));e!==void 0?r.sort(e):r.sort();for(const n of r)yield yield Se(n)})}var Uy=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,u){a=i[s](a),n(o,u,a.done,a.value)})}}function n(s,a,o,u){Promise.resolve(u).then(function(l){s({value:l,done:o})},a)}},rs=function(i){return this instanceof rs?(this.v=i,this):new rs(i)},zR=function(i){var e,t;return e={},r("next"),r("throw",function(n){throw n}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(n,s){e[n]=i[n]?function(a){return(t=!t)?{value:rs(i[n](a)),done:!1}:s?s(a):a}:s}},jR=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,x){s.push([g,v,E,x])>1||u(g,v)})},m&&(n[g]=m(n[g])))}function u(g,m){try{l(r[g](m))}catch(v){p(s[0][3],v)}}function l(g){g.value instanceof rs?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){u("next",g)}function d(g){u("throw",g)}function p(g,m){g(m),s.shift(),s.length&&u(s[0][0],s[0][1])}};function*JR(i=1,e=1){for(let t=i;;t+=e)yield t}function*$y(i){const e=[...Je(i)];if(e.length!==0)for(;;)for(const t of e)yield t}function QR(i){return jR(this,arguments,function*(){var t,r,n,s;const a=[];try{for(var o=!0,u=Uy(Ye(i)),l;l=yield rs(u.next()),t=l.done,!t;o=!0){s=l.value,o=!1;const h=s;a.push(h),yield yield rs(h)}}catch(h){r={error:h}}finally{try{!o&&!t&&(n=u.return)&&(yield rs(n.call(u)))}finally{if(r)throw r.error}}yield rs(yield*zR(Uy($y(a))))})}function*ZR(i){for(;;)yield i}var Da=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,u){a=i[s](a),n(o,u,a.done,a.value)})}}function n(s,a,o,u){Promise.resolve(u).then(function(l){s({value:l,done:o})},a)}},Nt=function(i){return this instanceof Nt?(this.v=i,this):new Nt(i)},Ra=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,x){s.push([g,v,E,x])>1||u(g,v)})},m&&(n[g]=m(n[g])))}function u(g,m){try{l(r[g](m))}catch(v){p(s[0][3],v)}}function l(g){g.value instanceof Nt?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){u("next",g)}function d(g){u("throw",g)}function p(g,m){g(m),s.shift(),s.length&&u(s[0][0],s[0][1])}};function*eI(i,e){let t=0;for(const r of Gy(Je(i),e))t++,yield r/t}function tI(i,e){return Ra(this,arguments,function*(){var r,n,s,a;let o=0;try{for(var u=!0,l=Da(qy(Ye(i),e)),h;h=yield Nt(l.next()),r=h.done,!r;u=!0){a=h.value,u=!1;const d=a;o++,yield yield Nt(d/o)}}catch(d){n={error:d}}finally{try{!u&&!r&&(s=l.return)&&(yield Nt(s.call(l)))}finally{if(n)throw n.error}}})}function*rI(i,e){e!==void 0&&(yield e);let t=e??0;for(const r of Je(i))t-=Number(r),yield t}function iI(i,e){return Ra(this,arguments,function*(){var r,n,s,a;e!==void 0&&(yield yield Nt(e));let o=e??0;try{for(var u=!0,l=Da(Ye(i)),h;h=yield Nt(l.next()),r=h.done,!r;u=!0)a=h.value,u=!1,o-=Number(a),yield yield Nt(o)}catch(d){n={error:d}}finally{try{!u&&!r&&(s=l.return)&&(yield Nt(s.call(l)))}finally{if(n)throw n.error}}})}function*nI(i,e){e!==void 0&&(yield e);let t=e??-1/0;for(const r of Je(i))t=Math.max(t,r),yield t}function sI(i,e){return Ra(this,arguments,function*(){var r,n,s,a;e!==void 0&&(yield yield Nt(e));let o=e??-1/0;try{for(var u=!0,l=Da(Ye(i)),h;h=yield Nt(l.next()),r=h.done,!r;u=!0)a=h.value,u=!1,o=Math.max(o,a),yield yield Nt(o)}catch(d){n={error:d}}finally{try{!u&&!r&&(s=l.return)&&(yield Nt(s.call(l)))}finally{if(n)throw n.error}}})}function*aI(i,e){e!==void 0&&(yield e);let t=e??1/0;for(const r of Je(i))t=Math.min(t,r),yield t}function oI(i,e){return Ra(this,arguments,function*(){var r,n,s,a;e!==void 0&&(yield yield Nt(e));let o=e??1/0;try{for(var u=!0,l=Da(Ye(i)),h;h=yield Nt(l.next()),r=h.done,!r;u=!0)a=h.value,u=!1,o=Math.min(o,a),yield yield Nt(o)}catch(d){n={error:d}}finally{try{!u&&!r&&(s=l.return)&&(yield Nt(s.call(l)))}finally{if(n)throw n.error}}})}function*lI(i,e){e!==void 0&&(yield e);let t=e??1;for(const r of Je(i))t*=Number(r),yield t}function uI(i,e){return Ra(this,arguments,function*(){var r,n,s,a;e!==void 0&&(yield yield Nt(e));let o=e??1;try{for(var u=!0,l=Da(Ye(i)),h;h=yield Nt(l.next()),r=h.done,!r;u=!0)a=h.value,u=!1,o*=Number(a),yield yield Nt(o)}catch(d){n={error:d}}finally{try{!u&&!r&&(s=l.return)&&(yield Nt(s.call(l)))}finally{if(n)throw n.error}}})}function*Gy(i,e){e!==void 0&&(yield e);let t=e??0;for(const r of Je(i))t+=Number(r),yield t}function qy(i,e){return Ra(this,arguments,function*(){var r,n,s,a;e!==void 0&&(yield yield Nt(e));let o=e??0;try{for(var u=!0,l=Da(Ye(i)),h;h=yield Nt(l.next()),r=h.done,!r;u=!0)a=h.value,u=!1,o+=Number(a),yield yield Nt(o)}catch(d){n={error:d}}finally{try{!u&&!r&&(s=l.return)&&(yield Nt(s.call(l)))}finally{if(n)throw n.error}}})}var cI=function(i,e,t,r){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{l(r.next(h))}catch(d){a(d)}}function u(h){try{l(r.throw(h))}catch(d){a(d)}}function l(h){h.done?s(h.value):n(h.value).then(o,u)}l((r=r.apply(i,e||[])).next())})},wr=function(i){return this instanceof wr?(this.v=i,this):new wr(i)},td=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,u){a=i[s](a),n(o,u,a.done,a.value)})}}function n(s,a,o,u){Promise.resolve(u).then(function(l){s({value:l,done:o})},a)}},rd=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,x){s.push([g,v,E,x])>1||u(g,v)})},m&&(n[g]=m(n[g])))}function u(g,m){try{l(r[g](m))}catch(v){p(s[0][3],v)}}function l(g){g.value instanceof wr?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){u("next",g)}function d(g){u("throw",g)}function p(g,m){g(m),s.shift(),s.length&&u(s[0][0],s[0][1])}},Hy=function(i){var e,t;return e={},r("next"),r("throw",function(n){throw n}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(n,s){e[n]=i[n]?function(a){return(t=!t)?{value:wr(i[n](a)),done:!1}:s?s(a):a}:s}};function*hI(...i){if(i.length===0)return;if(i.length===1){for(const r of Je(i[0]))yield[r];return}const t=Sa(ru(i,r=>Sa(r))).reduce((r,n)=>r.flatMap(s=>n.map(a=>[...s,a])),[[]]);for(const r of t)yield r}function dI(...i){return rd(this,arguments,function*(){var t,r,n,s;if(i.length===0)return yield wr(void 0);if(i.length===1){try{for(var a=!0,o=td(Ye(i[0])),u;u=yield wr(o.next()),t=u.done,!t;a=!0)s=u.value,a=!1,yield yield wr([s])}catch(d){r={error:d}}finally{try{!a&&!t&&(n=o.return)&&(yield wr(n.call(o)))}finally{if(r)throw r.error}}return yield wr(void 0)}const h=(yield wr(Fs($o(i,d=>cI(this,void 0,void 0,function*(){return yield Fs(d)}))))).reduce((d,p)=>d.flatMap(g=>p.map(m=>[...g,m])),[[]]);for(const d of h)yield yield wr(d)})}function*Vy(i,e){if(e<0)throw new Vt("Parameter 'length' cannot be negative");const t=Sa(i);function*r(n,s){if(n.length===e)yield n.slice();else for(let a=0;a<s.length;a++){const o=[...n,s[a]],u=s.slice(0,a).concat(s.slice(a+1));yield*r(o,u)}}yield*r([],t)}function fI(i,e){return rd(this,arguments,function*(){yield wr(yield*Hy(td(Vy(yield wr(Fs(i)),e))))})}function*Ky(i,e){if(e<0)throw new Vt("Parameter 'length' cannot be negative");const t=Sa(i),r=t.length;if(e===0){yield[];return}if(e>r||e<0)return;const n=Array.from({length:e},(s,a)=>a);for(yield n.map(s=>t[s]);;){let s=e-1;for(;s>=0&&n[s]===s+r-e;)s--;if(s<0)break;n[s]++;for(let a=s+1;a<e;a++)n[a]=n[a-1]+1;yield n.map(a=>t[a])}}function gI(i,e){return rd(this,arguments,function*(){yield wr(yield*Hy(td(Ky(yield wr(Fs(i)),e))))})}let Ii=class Ns{static of(e){return new Ns(Je(e))}static ofEmpty(){return new Ns([])}static ofCount(e=1,t=1){return new Ns(wa.count(e,t))}static ofCycle(e){return new Ns(wa.cycle(e))}static ofRepeat(e){return new Ns(wa.repeat(e))}zipWith(...e){return this.data=$m(this.data,...e),this}zipFilledWith(e,...t){return this.data=fR(e,this.data,...t),this}zipLongestWith(...e){return this.data=pR(this.data,...e),this}zipEqualWith(...e){return this.data=qm(this.data,...e),this}chainWith(...e){return this.data=yR(this.data,...e),this}chunkwiseOverlap(e,t,r=!0){return this.data=iu(this.data,e,t,r),this}chunkwise(e){return this.data=Sy(this.data,e),this}compress(e){return this.data=dy(this.data,e),this}dropWhile(e){return this.data=gy(this.data,e),this}filter(e){return this.data=Ay(this.data,e),this}enumerate(){return this.data=Ta(this.data),this}keys(){return this.data=Cy(this.data),this}limit(e){return this.data=Ty(this.data,e),this}map(e){return this.data=ru(this.data,e),this}flatMap(e){return this.data=vy(this.data,e),this}flatten(e=1/0){return this.data=Zh(this.data,e),this}groupBy(e,t){return this.data=Py(this.data,e,t),this}pairwise(){return this.data=ba(this.data),this}runningAverage(e){return this.data=eI(this.data,e),this}runningDifference(e){return this.data=rI(this.data,e),this}runningMax(e){return this.data=nI(this.data,e),this}runningMin(e){return this.data=aI(this.data,e),this}runningProduct(e){return this.data=lI(this.data,e),this}runningTotal(e){return this.data=Gy(this.data,e),this}skip(e,t=0){return this.data=Ly(this.data,e,t),this}slice(e=0,t,r=1){return this.data=Iy(this.data,e,t,r),this}takeWhile(e){return this.data=my(this.data,e),this}values(){return this.data=My(this.data),this}sort(e){return this.data=Fy(this.data,e),this}distinct(e){return this.data=jh(this.data,e),this}intersectionWith(...e){return this.data=GR(this.data,...e),this}partialIntersectionWith(e,...t){return this.data=Jh(e,this.data,...t),this}symmetricDifferenceWith(...e){return this.data=HR(this.data,...e),this}unionWith(...e){return this.data=KR(this.data,...e),this}cartesianProductWith(...e){return this.data=hI(this.data,...e),this}permutations(e){return this.data=Vy(this.data,e),this}combinations(e){return this.data=Ky(this.data,e),this}peek(e){const[t,r]=Xh(this.data,2);this.data=t;for(const n of r)e(n);return this}peekStream(e){const[t,r]=Xh(this.data,2);return this.data=t,e(Ns.of(r)),this}toValue(e,t){return Di(this,e,t)}toAverage(){return Vm(this)}toCount(){return eu(this)}toMax(e){return Wm(this,e)}toMin(e){return Xm(this,e)}toMinMax(e){return Hh(this,e)}toFirst(){return ry(this)}toFirstAndLast(){return ay(this)}toLast(){return ny(this)}toSum(){return Qm(this)}toProduct(){return ey(this)}toRange(){return jm(this)}allMatch(e){return ER(this,e)}allUnique(){return xR(this)}anyMatch(e){return bR(this,e)}exactlyN(e,t){return DR(this,e,t)}isSorted(){return CR(this)}isReversed(){return IR(this)}noneMatch(e){return LR(this,e)}sameWith(...e){return MR(this.data,...e)}sameCountWith(...e){return PR(this.data,...e)}tee(e){return Xh(this.data,e).map(t=>new Ns(t))}toArray(){return Sa(this)}toMap(){return FR(this)}toSet(){return UR(this)}*[Symbol.iterator](){for(const e of this.data)yield e}constructor(e){this.data=e}};var _t=function(i,e,t,r){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{l(r.next(h))}catch(d){a(d)}}function u(h){try{l(r.throw(h))}catch(d){a(d)}}function l(h){h.done?s(h.value):n(h.value).then(o,u)}l((r=r.apply(i,e||[])).next())})},Wy=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,u){a=i[s](a),n(o,u,a.done,a.value)})}}function n(s,a,o,u){Promise.resolve(u).then(function(l){s({value:l,done:o})},a)}},Ia=function(i){return this instanceof Ia?(this.v=i,this):new Ia(i)},pI=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,x){s.push([g,v,E,x])>1||u(g,v)})},m&&(n[g]=m(n[g])))}function u(g,m){try{l(r[g](m))}catch(v){p(s[0][3],v)}}function l(g){g.value instanceof Ia?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){u("next",g)}function d(g){u("throw",g)}function p(g,m){g(m),s.shift(),s.length&&u(s[0][0],s[0][1])}};class mn{static of(e){return new mn(Ye(e))}static ofEmpty(){return new mn(Ye([]))}static ofCount(e=1,t=1){return new mn(Ye(wa.count(e,t)))}static ofCycle(e){return new mn(wa.cycleAsync(e))}static ofRepeat(e){return new mn(Ye(wa.repeat(e)))}zipWith(...e){return this.data=Gm(this.data,...e),this}zipFilledWith(e,...t){return this.data=gR(e,this.data,...t),this}zipLongestWith(...e){return this.data=mR(this.data,...e),this}zipEqualWith(...e){return this.data=Hm(this.data,...e),this}chainWith(...e){return this.data=vR(this.data,...e),this}chunkwiseOverlap(e,t,r=!0){return this.data=nu(this.data,e,t,r),this}chunkwise(e){return this.data=by(this.data,e),this}compress(e){return this.data=fy(this.data,e),this}dropWhile(e){return this.data=py(this.data,e),this}filter(e){return this.data=xy(this.data,e),this}enumerate(){return this.data=Ry(this.data),this}keys(){return this.data=Ny(this.data),this}limit(e){return this.data=Dy(this.data,e),this}map(e){return this.data=$o(this.data,e),this}flatMap(e){return this.data=Ey(this.data,e),this}flatten(e=1/0){return this.data=ed(this.data,e),this}groupBy(e,t){return this.data=ky(this.data,e,t),this}pairwise(){return this.data=su(this.data),this}runningAverage(e){return this.data=tI(this.data,e),this}runningDifference(e){return this.data=iI(this.data,e),this}runningMax(e){return this.data=sI(this.data,e),this}runningMin(e){return this.data=oI(this.data,e),this}runningProduct(e){return this.data=uI(this.data,e),this}runningTotal(e){return this.data=qy(this.data,e),this}skip(e,t=0){return this.data=_y(this.data,e,t),this}slice(e=0,t,r=1){return this.data=wy(this.data,e,t,r),this}takeWhile(e){return this.data=yy(this.data,e),this}values(){return this.data=Oy(this.data),this}sort(e){return this.data=By(this.data,e),this}distinct(e){return this.data=hy(this.data,e),this}intersectionWith(...e){return this.data=qR(this.data,...e),this}partialIntersectionWith(e,...t){return this.data=Qh(e,this.data,...t),this}symmetricDifferenceWith(...e){return this.data=VR(this.data,...e),this}unionWith(...e){return this.data=WR(this.data,...e),this}cartesianProductWith(...e){return this.data=dI(this.data,...e),this}permutations(e){return this.data=fI(this.data,e),this}combinations(e){return this.data=gI(this.data,e),this}peek(e){const[t,r]=zh(this.data,2);return this.data=t,_t(this,void 0,void 0,function*(){var n,s,a,o;try{for(var u=!0,l=Wy(r),h;h=yield l.next(),n=h.done,!n;u=!0)o=h.value,u=!1,e(o)}catch(d){s={error:d}}finally{try{!u&&!n&&(a=l.return)&&(yield a.call(l))}finally{if(s)throw s.error}}}),this}peekStream(e){const[t,r]=zh(this.data,2);return this.data=t,e(mn.of(r)),this}toValue(e,t){return _t(this,void 0,void 0,function*(){return yield Ri(this,e,t)})}toAverage(){return _t(this,void 0,void 0,function*(){return yield Km(this)})}toCount(){return _t(this,void 0,void 0,function*(){return yield Kh(this)})}toMax(e){return _t(this,void 0,void 0,function*(){return yield Ym(this,e)})}toMin(e){return _t(this,void 0,void 0,function*(){return yield zm(this,e)})}toMinMax(e){return _t(this,void 0,void 0,function*(){return yield Vh(this,e)})}toFirst(){return _t(this,void 0,void 0,function*(){return yield iy(this)})}toFirstAndLast(){return _t(this,void 0,void 0,function*(){return yield oy(this)})}toLast(){return _t(this,void 0,void 0,function*(){return yield sy(this)})}toSum(){return _t(this,void 0,void 0,function*(){return yield Zm(this)})}toProduct(){return _t(this,void 0,void 0,function*(){return yield ty(this)})}toRange(){return _t(this,void 0,void 0,function*(){return yield Jm(this)})}allMatch(e){return _t(this,void 0,void 0,function*(){return yield AR(this,e)})}allUnique(){return _t(this,void 0,void 0,function*(){return yield SR(this)})}anyMatch(e){return _t(this,void 0,void 0,function*(){return yield TR(this,e)})}exactlyN(e,t){return _t(this,void 0,void 0,function*(){return RR(this,e,t)})}isSorted(){return _t(this,void 0,void 0,function*(){return yield NR(this)})}isReversed(){return _t(this,void 0,void 0,function*(){return yield wR(this)})}noneMatch(e){return _t(this,void 0,void 0,function*(){return yield _R(this,e)})}sameWith(...e){return _t(this,void 0,void 0,function*(){return yield OR(this.data,...e)})}sameCountWith(...e){return _t(this,void 0,void 0,function*(){return yield kR(this.data,...e)})}tee(e){return zh(this.data,e).map(t=>new mn(t))}toArray(){return _t(this,void 0,void 0,function*(){return yield Fs(this)})}toMap(){return _t(this,void 0,void 0,function*(){return yield BR(this)})}toSet(){return _t(this,void 0,void 0,function*(){return yield $R(this)})}[Symbol.asyncIterator](){return pI(this,arguments,function*(){var t,r,n,s;try{for(var a=!0,o=Wy(this.data),u;u=yield Ia(o.next()),t=u.done,!t;a=!0)s=u.value,a=!1,yield yield Ia(s)}catch(l){r={error:l}}finally{try{!a&&!t&&(n=o.return)&&(yield Ia(n.call(o)))}finally{if(r)throw r.error}}})}constructor(e){this.data=e}}const id={chunkwise:Sy,chunkwiseOverlap:iu,compress:dy,dropWhile:gy,enumerate:Ta,filter:Ay,flatMap:vy,flatten:Zh,groupBy:Py,keys:Cy,limit:Ty,map:ru,pairwise:ba,repeat:YR,skip:Ly,slice:Iy,sort:Fy,takeWhile:my,values:My,chunkwiseAsync:by,chunkwiseOverlapAsync:nu,compressAsync:fy,dropWhileAsync:py,enumerateAsync:Ry,filterAsync:xy,flatMapAsync:Ey,flattenAsync:ed,groupByAsync:ky,keysAsync:Ny,limitAsync:Dy,mapAsync:$o,pairwiseAsync:su,repeatAsync:XR,skipAsync:_y,sliceAsync:wy,sortAsync:By,takeWhileAsync:yy,valuesAsync:Oy},wa={count:JR,cycle:$y,cycleAsync:QR,repeat:ZR},Yy={toAverage:Vm,toCount:eu,toFirst:ry,toFirstAndLast:ay,toLast:ny,toMax:Wm,toMin:Xm,toMinMax:Hh,toProduct:ey,toRange:jm,toSum:Qm,toValue:Di,toAverageAsync:Km,toCountAsync:Kh,toFirstAsync:iy,toFirstAndLastAsync:oy,toLastAsync:sy,toMaxAsync:Ym,toMinAsync:zm,toMinMaxAsync:Vh,toProductAsync:ty,toRangeAsync:Jm,toSumAsync:Zm,toValueAsync:Ri};var mI={763:()=>{}},Xy={};function Bs(i){var e=Xy[i];if(e!==void 0)return e.exports;var t=Xy[i]={exports:{}};return mI[i](t,t.exports,Bs),t.exports}Bs.d=(i,e)=>{for(var t in e)Bs.o(e,t)&&!Bs.o(i,t)&&Object.defineProperty(i,t,{enumerable:!0,get:e[t]})},Bs.o=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);var lt={};Bs.d(lt,{MG:()=>Mt,fr:()=>bd,sR:()=>Ev,Zo:()=>Gs,iH:()=>bv,rt:()=>An,jB:()=>Dv,M8:()=>mv,$t:()=>pu,aq:()=>vv,pG:()=>Ko,eP:()=>Cd,KU:()=>Oa,zW:()=>Ld,IX:()=>dt,mY:()=>ui,a7:()=>lu,JG:()=>kt,ay:()=>Ft,X2:()=>fu,WU:()=>wd,Uw:()=>yv,gw:()=>gu,iX:()=>_d,re:()=>fv,Pg:()=>Md,tD:()=>gv,R$:()=>Zt,Dj:()=>xn,m7:()=>Us,NZ:()=>Go,xo:()=>Ki,ou:()=>Ee,qC:()=>mu,mD:()=>yn,Ay:()=>VI});let Ee=class{constructor(){this.source=null,this.type=null,this.channel=null,this.start=null,this.stop=null,this.tokenIndex=null,this.line=null,this.column=null,this._text=null}getTokenSource(){return this.source[0]}getInputStream(){return this.source[1]}get text(){return this._text}set text(e){this._text=e}};function Ca(i,e){if(!Array.isArray(i)||!Array.isArray(e))return!1;if(i===e)return!0;if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!(i[t]===e[t]||i[t].equals&&i[t].equals(e[t])))return!1;return!0}Ee.INVALID_TYPE=0,Ee.EPSILON=-2,Ee.MIN_USER_TOKEN_TYPE=1,Ee.EOF=-1,Ee.DEFAULT_CHANNEL=0,Ee.HIDDEN_CHANNEL=1;const yI=Math.round(Math.random()*Math.pow(2,32));function zy(i){if(!i)return 0;const e=typeof i,t=e==="string"?i:!(e!=="object"||!i.toString)&&i.toString();if(!t)return 0;let r,n;const s=3&t.length,a=t.length-s;let o=yI;const u=3432918353,l=461845907;let h=0;for(;h<a;)n=255&t.charCodeAt(h)|(255&t.charCodeAt(++h))<<8|(255&t.charCodeAt(++h))<<16|(255&t.charCodeAt(++h))<<24,++h,n=(65535&n)*u+(((n>>>16)*u&65535)<<16)&4294967295,n=n<<15|n>>>17,n=(65535&n)*l+(((n>>>16)*l&65535)<<16)&4294967295,o^=n,o=o<<13|o>>>19,r=5*(65535&o)+((5*(o>>>16)&65535)<<16)&4294967295,o=27492+(65535&r)+((58964+(r>>>16)&65535)<<16);switch(n=0,s){case 3:n^=(255&t.charCodeAt(h+2))<<16;case 2:n^=(255&t.charCodeAt(h+1))<<8;case 1:n^=255&t.charCodeAt(h),n=(65535&n)*u+(((n>>>16)*u&65535)<<16)&4294967295,n=n<<15|n>>>17,n=(65535&n)*l+(((n>>>16)*l&65535)<<16)&4294967295,o^=n}return o^=t.length,o^=o>>>16,o=2246822507*(65535&o)+((2246822507*(o>>>16)&65535)<<16)&4294967295,o^=o>>>13,o=3266489909*(65535&o)+((3266489909*(o>>>16)&65535)<<16)&4294967295,o^=o>>>16,o>>>0}class zr{constructor(){this.count=0,this.hash=0}update(){for(let e=0;e<arguments.length;e++){const t=arguments[e];if(t!=null)if(Array.isArray(t))this.update.apply(this,t);else{let r=0;switch(typeof t){case"undefined":case"function":continue;case"number":case"boolean":r=t;break;case"string":r=zy(t);break;default:t.updateHashCode?t.updateHashCode(this):console.log("No updateHashCode for "+t.toString());continue}r*=3432918353,r=r<<15|r>>>17,r*=461845907,this.count=this.count+1;let n=this.hash^r;n=n<<13|n>>>19,n=5*n+3864292196,this.hash=n}}}finish(){let e=this.hash^4*this.count;return e^=e>>>16,e*=2246822507,e^=e>>>13,e*=3266489909,e^=e>>>16,e}static hashStuff(){const e=new zr;return e.update.apply(e,arguments),e.finish()}}function jy(i){return i?typeof i=="string"?zy(i):i.hashCode():-1}function Jy(i,e){return i&&i.equals?i.equals(e):i===e}function vI(i){return i===null?"null":i}function yn(i){return Array.isArray(i)?"["+i.map(vI).join(", ")+"]":"null"}let jr=class{constructor(e,t){this.buckets=new Array(16),this.threshold=Math.floor(12),this.itemCount=0,this.hashFunction=e||jy,this.equalsFunction=t||Jy}get(e){if(e==null)return e;const t=this._getBucket(e);if(!t)return null;for(const r of t)if(this.equalsFunction(r,e))return r;return null}add(e){return this.getOrAdd(e)===e}getOrAdd(e){this._expand();const t=this._getSlot(e);let r=this.buckets[t];if(!r)return r=[e],this.buckets[t]=r,this.itemCount++,e;for(const n of r)if(this.equalsFunction(n,e))return n;return r.push(e),this.itemCount++,e}has(e){return this.get(e)!=null}values(){return this.buckets.filter(e=>e!=null).flat(1)}toString(){return yn(this.values())}get length(){return this.itemCount}_getSlot(e){return this.hashFunction(e)&this.buckets.length-1}_getBucket(e){return this.buckets[this._getSlot(e)]}_expand(){if(this.itemCount<=this.threshold)return;const e=this.buckets,t=2*this.buckets.length;this.buckets=new Array(t),this.threshold=Math.floor(.75*t);for(const r of e)if(r)for(const n of r){const s=this._getSlot(n);let a=this.buckets[s];a||(a=[],this.buckets[s]=a),a.push(n)}}};class pt{hashCode(){const e=new zr;return this.updateHashCode(e),e.finish()}evaluate(e,t){}evalPrecedence(e,t){return this}static andContext(e,t){if(e===null||e===pt.NONE)return t;if(t===null||t===pt.NONE)return e;const r=new EI(e,t);return r.opnds.length===1?r.opnds[0]:r}static orContext(e,t){if(e===null)return t;if(t===null)return e;if(e===pt.NONE||t===pt.NONE)return pt.NONE;const r=new AI(e,t);return r.opnds.length===1?r.opnds[0]:r}}let EI=class vh extends pt{constructor(e,t){super();const r=new jr;e instanceof vh?e.opnds.map(function(s){r.add(s)}):r.add(e),t instanceof vh?t.opnds.map(function(s){r.add(s)}):r.add(t);const n=Qy(r);if(n.length>0){let s=null;n.map(function(a){(s===null||a.precedence<s.precedence)&&(s=a)}),r.add(s)}this.opnds=Array.from(r.values())}equals(e){return this===e||e instanceof vh&&Ca(this.opnds,e.opnds)}updateHashCode(e){e.update(this.opnds,"AND")}evaluate(e,t){for(let r=0;r<this.opnds.length;r++)if(!this.opnds[r].evaluate(e,t))return!1;return!0}evalPrecedence(e,t){let r=!1;const n=[];for(let a=0;a<this.opnds.length;a++){const o=this.opnds[a],u=o.evalPrecedence(e,t);if(r|=u!==o,u===null)return null;u!==pt.NONE&&n.push(u)}if(!r)return this;if(n.length===0)return pt.NONE;let s=null;return n.map(function(a){s=s===null?a:pt.andContext(s,a)}),s}toString(){const e=this.opnds.map(t=>t.toString());return(e.length>3?e.slice(3):e).join("&&")}},AI=class Eh extends pt{constructor(e,t){super();const r=new jr;e instanceof Eh?e.opnds.map(function(s){r.add(s)}):r.add(e),t instanceof Eh?t.opnds.map(function(s){r.add(s)}):r.add(t);const n=Qy(r);if(n.length>0){const s=n.sort(function(o,u){return o.compareTo(u)}),a=s[s.length-1];r.add(a)}this.opnds=Array.from(r.values())}equals(e){return this===e||e instanceof Eh&&Ca(this.opnds,e.opnds)}updateHashCode(e){e.update(this.opnds,"OR")}evaluate(e,t){for(let r=0;r<this.opnds.length;r++)if(this.opnds[r].evaluate(e,t))return!0;return!1}evalPrecedence(e,t){let r=!1;const n=[];for(let s=0;s<this.opnds.length;s++){const a=this.opnds[s],o=a.evalPrecedence(e,t);if(r|=o!==a,o===pt.NONE)return pt.NONE;o!==null&&n.push(o)}return r?(n.length===0,null):this}toString(){const e=this.opnds.map(t=>t.toString());return(e.length>3?e.slice(3):e).join("||")}};function Qy(i){const e=[];return i.values().map(function(t){t instanceof pt.PrecedencePredicate&&e.push(t)}),e}function Zy(i,e){if(i===null){const t={state:null,alt:null,context:null,semanticContext:null};return e&&(t.reachesIntoOuterContext=0),t}{const t={};return t.state=i.state||null,t.alt=i.alt===void 0?null:i.alt,t.context=i.context||null,t.semanticContext=i.semanticContext||null,e&&(t.reachesIntoOuterContext=i.reachesIntoOuterContext||0,t.precedenceFilterSuppressed=i.precedenceFilterSuppressed||!1),t}}class Kt{constructor(e,t){this.checkContext(e,t),e=Zy(e),t=Zy(t,!0),this.state=e.state!==null?e.state:t.state,this.alt=e.alt!==null?e.alt:t.alt,this.context=e.context!==null?e.context:t.context,this.semanticContext=e.semanticContext!==null?e.semanticContext:t.semanticContext!==null?t.semanticContext:pt.NONE,this.reachesIntoOuterContext=t.reachesIntoOuterContext,this.precedenceFilterSuppressed=t.precedenceFilterSuppressed}checkContext(e,t){e.context!==null&&e.context!==void 0||t!==null&&t.context!==null&&t.context!==void 0||(this.context=null)}hashCode(){const e=new zr;return this.updateHashCode(e),e.finish()}updateHashCode(e){e.update(this.state.stateNumber,this.alt,this.context,this.semanticContext)}equals(e){return this===e||e instanceof Kt&&this.state.stateNumber===e.state.stateNumber&&this.alt===e.alt&&(this.context===null?e.context===null:this.context.equals(e.context))&&this.semanticContext.equals(e.semanticContext)&&this.precedenceFilterSuppressed===e.precedenceFilterSuppressed}hashCodeForConfigSet(){const e=new zr;return e.update(this.state.stateNumber,this.alt,this.semanticContext),e.finish()}equalsForConfigSet(e){return this===e||e instanceof Kt&&this.state.stateNumber===e.state.stateNumber&&this.alt===e.alt&&this.semanticContext.equals(e.semanticContext)}toString(){return"("+this.state+","+this.alt+(this.context!==null?",["+this.context.toString()+"]":"")+(this.semanticContext!==pt.NONE?","+this.semanticContext.toString():"")+(this.reachesIntoOuterContext>0?",up="+this.reachesIntoOuterContext:"")+")"}}let dt=class UT{constructor(e,t){this.start=e,this.stop=t}clone(){return new UT(this.start,this.stop)}contains(e){return e>=this.start&&e<this.stop}toString(){return this.start===this.stop-1?this.start.toString():this.start.toString()+".."+(this.stop-1).toString()}get length(){return this.stop-this.start}};dt.INVALID_INTERVAL=new dt(-1,-2);let ui=class $T{constructor(){this.intervals=null,this.readOnly=!1}first(e){return this.intervals===null||this.intervals.length===0?Ee.INVALID_TYPE:this.intervals[0].start}addOne(e){this.addInterval(new dt(e,e+1))}addRange(e,t){this.addInterval(new dt(e,t+1))}addInterval(e){if(this.intervals===null)this.intervals=[],this.intervals.push(e.clone());else{for(let t=0;t<this.intervals.length;t++){const r=this.intervals[t];if(e.stop<r.start)return void this.intervals.splice(t,0,e);if(e.stop===r.start)return void(this.intervals[t]=new dt(e.start,r.stop));if(e.start<=r.stop)return this.intervals[t]=new dt(Math.min(r.start,e.start),Math.max(r.stop,e.stop)),void this.reduce(t)}this.intervals.push(e.clone())}}addSet(e){return e.intervals!==null&&e.intervals.forEach(t=>this.addInterval(t),this),this}reduce(e){if(e<this.intervals.length-1){const t=this.intervals[e],r=this.intervals[e+1];t.stop>=r.stop?(this.intervals.splice(e+1,1),this.reduce(e)):t.stop>=r.start&&(this.intervals[e]=new dt(t.start,r.stop),this.intervals.splice(e+1,1))}}complement(e,t){const r=new $T;return r.addInterval(new dt(e,t+1)),this.intervals!==null&&this.intervals.forEach(n=>r.removeRange(n)),r}contains(e){if(this.intervals===null)return!1;for(let t=0;t<this.intervals.length;t++)if(this.intervals[t].contains(e))return!0;return!1}removeRange(e){if(e.start===e.stop-1)this.removeOne(e.start);else if(this.intervals!==null){let t=0;for(let r=0;r<this.intervals.length;r++){const n=this.intervals[t];if(e.stop<=n.start)return;if(e.start>n.start&&e.stop<n.stop){this.intervals[t]=new dt(n.start,e.start);const s=new dt(e.stop,n.stop);return void this.intervals.splice(t,0,s)}e.start<=n.start&&e.stop>=n.stop?(this.intervals.splice(t,1),t-=1):e.start<n.stop?this.intervals[t]=new dt(n.start,e.start):e.stop<n.stop&&(this.intervals[t]=new dt(e.stop,n.stop)),t+=1}}}removeOne(e){if(this.intervals!==null)for(let t=0;t<this.intervals.length;t++){const r=this.intervals[t];if(e<r.start)return;if(e===r.start&&e===r.stop-1)return void this.intervals.splice(t,1);if(e===r.start)return void(this.intervals[t]=new dt(r.start+1,r.stop));if(e===r.stop-1)return void(this.intervals[t]=new dt(r.start,r.stop-1));if(e<r.stop-1){const n=new dt(r.start,e);return r.start=e+1,void this.intervals.splice(t,0,n)}}}toString(e,t,r){return e=e||null,t=t||null,r=r||!1,this.intervals===null?"{}":e!==null||t!==null?this.toTokenString(e,t):r?this.toCharString():this.toIndexString()}toCharString(){const e=[];for(let t=0;t<this.intervals.length;t++){const r=this.intervals[t];r.stop===r.start+1?r.start===Ee.EOF?e.push("<EOF>"):e.push("'"+String.fromCharCode(r.start)+"'"):e.push("'"+String.fromCharCode(r.start)+"'..'"+String.fromCharCode(r.stop-1)+"'")}return e.length>1?"{"+e.join(", ")+"}":e[0]}toIndexString(){const e=[];for(let t=0;t<this.intervals.length;t++){const r=this.intervals[t];r.stop===r.start+1?r.start===Ee.EOF?e.push("<EOF>"):e.push(r.start.toString()):e.push(r.start.toString()+".."+(r.stop-1).toString())}return e.length>1?"{"+e.join(", ")+"}":e[0]}toTokenString(e,t){const r=[];for(let n=0;n<this.intervals.length;n++){const s=this.intervals[n];for(let a=s.start;a<s.stop;a++)r.push(this.elementName(e,t,a))}return r.length>1?"{"+r.join(", ")+"}":r[0]}elementName(e,t,r){return r===Ee.EOF?"<EOF>":r===Ee.EPSILON?"<EPSILON>":e[r]||t[r]}get length(){return this.intervals.map(e=>e.length).reduce((e,t)=>e+t)}};class Pe{constructor(){this.atn=null,this.stateNumber=Pe.INVALID_STATE_NUMBER,this.stateType=null,this.ruleIndex=0,this.epsilonOnlyTransitions=!1,this.transitions=[],this.nextTokenWithinRule=null}toString(){return this.stateNumber}equals(e){return e instanceof Pe&&this.stateNumber===e.stateNumber}isNonGreedyExitState(){return!1}addTransition(e,t){t===void 0&&(t=-1),this.transitions.length===0?this.epsilonOnlyTransitions=e.isEpsilon:this.epsilonOnlyTransitions!==e.isEpsilon&&(this.epsilonOnlyTransitions=!1),t===-1?this.transitions.push(e):this.transitions.splice(t,1,e)}}Pe.INVALID_TYPE=0,Pe.BASIC=1,Pe.RULE_START=2,Pe.BLOCK_START=3,Pe.PLUS_BLOCK_START=4,Pe.STAR_BLOCK_START=5,Pe.TOKEN_START=6,Pe.RULE_STOP=7,Pe.BLOCK_END=8,Pe.STAR_LOOP_BACK=9,Pe.STAR_LOOP_ENTRY=10,Pe.PLUS_LOOP_BACK=11,Pe.LOOP_END=12,Pe.serializationNames=["INVALID","BASIC","RULE_START","BLOCK_START","PLUS_BLOCK_START","STAR_BLOCK_START","TOKEN_START","RULE_STOP","BLOCK_END","STAR_LOOP_BACK","STAR_LOOP_ENTRY","PLUS_LOOP_BACK","LOOP_END"],Pe.INVALID_STATE_NUMBER=-1;class Cr extends Pe{constructor(){return super(),this.stateType=Pe.RULE_STOP,this}}class _e{constructor(e){if(e==null)throw"target cannot be null.";this.target=e,this.isEpsilon=!1,this.label=null}}_e.EPSILON=1,_e.RANGE=2,_e.RULE=3,_e.PREDICATE=4,_e.ATOM=5,_e.ACTION=6,_e.SET=7,_e.NOT_SET=8,_e.WILDCARD=9,_e.PRECEDENCE=10,_e.serializationNames=["INVALID","EPSILON","RANGE","RULE","PREDICATE","ATOM","ACTION","SET","NOT_SET","WILDCARD","PRECEDENCE"],_e.serializationTypes={EpsilonTransition:_e.EPSILON,RangeTransition:_e.RANGE,RuleTransition:_e.RULE,PredicateTransition:_e.PREDICATE,AtomTransition:_e.ATOM,ActionTransition:_e.ACTION,SetTransition:_e.SET,NotSetTransition:_e.NOT_SET,WildcardTransition:_e.WILDCARD,PrecedencePredicateTransition:_e.PRECEDENCE};class au extends _e{constructor(e,t,r,n){super(e),this.ruleIndex=t,this.precedence=r,this.followState=n,this.serializationType=_e.RULE,this.isEpsilon=!0}matches(e,t,r){return!1}}let nd=class extends _e{constructor(e,t){super(e),this.serializationType=_e.SET,t!=null?this.label=t:(this.label=new ui,this.label.addOne(Ee.INVALID_TYPE))}matches(e,t,r){return this.label.contains(e)}toString(){return this.label.toString()}},sd=class extends nd{constructor(e,t){super(e,t),this.serializationType=_e.NOT_SET}matches(e,t,r){return e>=t&&e<=r&&!super.matches(e,t,r)}toString(){return"~"+super.toString()}};class ev extends _e{constructor(e){super(e),this.serializationType=_e.WILDCARD}matches(e,t,r){return e>=t&&e<=r}toString(){return"."}}class ad extends _e{constructor(e){super(e)}}class xI{}class SI extends xI{}let tv=class extends SI{},Go=class extends tv{get ruleContext(){throw new Error("missing interface implementation")}},Ki=class extends tv{},ou=class extends Ki{};const vn={toStringTree:function(i,e,t){e=e||null,(t=t||null)!==null&&(e=t.ruleNames);let r=vn.getNodeText(i,e);r=function(a){return a=a.replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r")}(r);const n=i.getChildCount();if(n===0)return r;let s="("+r+" ";n>0&&(r=vn.toStringTree(i.getChild(0),e),s=s.concat(r));for(let a=1;a<n;a++)r=vn.toStringTree(i.getChild(a),e),s=s.concat(" "+r);return s=s.concat(")"),s},getNodeText:function(i,e,t){if(e=e||null,(t=t||null)!==null&&(e=t.ruleNames),e!==null){if(i instanceof Go){const n=i.ruleContext.getAltNumber();return n!=0?e[i.ruleIndex]+":"+n:e[i.ruleIndex]}if(i instanceof ou)return i.toString();if(i instanceof Ki&&i.symbol!==null)return i.symbol.text}const r=i.getPayload();return r instanceof Ee?r.text:i.getPayload().toString()},getChildren:function(i){const e=[];for(let t=0;t<i.getChildCount();t++)e.push(i.getChild(t));return e},getAncestors:function(i){let e=[];for(i=i.getParent();i!==null;)e=[i].concat(e),i=i.getParent();return e},findAllTokenNodes:function(i,e){return vn.findAllNodes(i,e,!0)},findAllRuleNodes:function(i,e){return vn.findAllNodes(i,e,!1)},findAllNodes:function(i,e,t){const r=[];return vn._findAllNodes(i,e,t,r),r},_findAllNodes:function(i,e,t,r){t&&i instanceof Ki?i.symbol.type===e&&r.push(i):!t&&i instanceof Go&&i.ruleIndex===e&&r.push(i);for(let n=0;n<i.getChildCount();n++)vn._findAllNodes(i.getChild(n),e,t,r)},descendants:function(i){let e=[i];for(let t=0;t<i.getChildCount();t++)e=e.concat(vn.descendants(i.getChild(t)));return e}},rv=vn;class Us extends Go{constructor(e,t){super(),this.parentCtx=e||null,this.invokingState=t||-1}depth(){let e=0,t=this;for(;t!==null;)t=t.parentCtx,e+=1;return e}isEmpty(){return this.invokingState===-1}getSourceInterval(){return dt.INVALID_INTERVAL}get ruleContext(){return this}getPayload(){return this}getText(){return this.getChildCount()===0?"":this.children.map(function(e){return e.getText()}).join("")}getAltNumber(){return 0}setAltNumber(e){}getChild(e){return null}getChildCount(){return 0}accept(e){return e.visitChildren(this)}toStringTree(e,t){return rv.toStringTree(this,e,t)}toString(e,t){e=e||null,t=t||null;let r=this,n="[";for(;r!==null&&r!==t;){if(e===null)r.isEmpty()||(n+=r.invokingState);else{const s=r.ruleIndex;n+=s>=0&&s<e.length?e[s]:""+s}r.parentCtx===null||e===null&&r.parentCtx.isEmpty()||(n+=" "),r=r.parentCtx}return n+="]",n}}class We{constructor(e){this.cachedHashCode=e}isEmpty(){return this===We.EMPTY}hasEmptyPath(){return this.getReturnState(this.length-1)===We.EMPTY_RETURN_STATE}hashCode(){return this.cachedHashCode}updateHashCode(e){e.update(this.cachedHashCode)}}We.EMPTY=null,We.EMPTY_RETURN_STATE=2147483647,We.globalNodeCount=1,We.id=We.globalNodeCount,We.trace_atn_sim=!1;class Wi extends We{constructor(e,t){const r=new zr;return r.update(e,t),super(r.finish()),this.parents=e,this.returnStates=t,this}isEmpty(){return this.returnStates[0]===We.EMPTY_RETURN_STATE}getParent(e){return this.parents[e]}getReturnState(e){return this.returnStates[e]}equals(e){return this===e||e instanceof Wi&&this.hashCode()===e.hashCode()&&Ca(this.returnStates,e.returnStates)&&Ca(this.parents,e.parents)}toString(){if(this.isEmpty())return"[]";{let e="[";for(let t=0;t<this.returnStates.length;t++)t>0&&(e+=", "),this.returnStates[t]!==We.EMPTY_RETURN_STATE?(e+=this.returnStates[t],this.parents[t]!==null?e=e+" "+this.parents[t]:e+="null"):e+="$";return e+"]"}}get length(){return this.returnStates.length}}class Nr extends We{constructor(e,t){let r=0;const n=new zr;e!==null?n.update(e,t):n.update(1),r=n.finish(),super(r),this.parentCtx=e,this.returnState=t}getParent(e){return this.parentCtx}getReturnState(e){return this.returnState}equals(e){return this===e||e instanceof Nr&&this.hashCode()===e.hashCode()&&this.returnState===e.returnState&&(this.parentCtx==null?e.parentCtx==null:this.parentCtx.equals(e.parentCtx))}toString(){const e=this.parentCtx===null?"":this.parentCtx.toString();return e.length===0?this.returnState===We.EMPTY_RETURN_STATE?"$":""+this.returnState:this.returnState+" "+e}get length(){return 1}static create(e,t){return t===We.EMPTY_RETURN_STATE&&e===null?We.EMPTY:new Nr(e,t)}}let od=class extends Nr{constructor(){super(null,We.EMPTY_RETURN_STATE)}isEmpty(){return!0}getParent(e){return null}getReturnState(e){return this.returnState}equals(e){return this===e}toString(){return"$"}};We.EMPTY=new od;class qo{constructor(e,t){this.buckets=new Array(16),this.threshold=Math.floor(12),this.itemCount=0,this.hashFunction=e||jy,this.equalsFunction=t||Jy}set(e,t){this._expand();const r=this._getSlot(e);let n=this.buckets[r];if(!n)return n=[[e,t]],this.buckets[r]=n,this.itemCount++,t;const s=n.find(a=>this.equalsFunction(a[0],e),this);if(s){const a=s[1];return s[1]=t,a}return n.push([e,t]),this.itemCount++,t}containsKey(e){const t=this._getBucket(e);return!!t&&!!t.find(r=>this.equalsFunction(r[0],e),this)}get(e){const t=this._getBucket(e);if(!t)return null;const r=t.find(n=>this.equalsFunction(n[0],e),this);return r?r[1]:null}entries(){return this.buckets.filter(e=>e!=null).flat(1)}getKeys(){return this.entries().map(e=>e[0])}getValues(){return this.entries().map(e=>e[1])}toString(){return"["+this.entries().map(e=>"{"+e[0]+":"+e[1]+"}").join(", ")+"]"}get length(){return this.itemCount}_getSlot(e){return this.hashFunction(e)&this.buckets.length-1}_getBucket(e){return this.buckets[this._getSlot(e)]}_expand(){if(this.itemCount<=this.threshold)return;const e=this.buckets,t=2*this.buckets.length;this.buckets=new Array(t),this.threshold=Math.floor(.75*t);for(const r of e)if(r)for(const n of r){const s=this._getSlot(n[0]);let a=this.buckets[s];a||(a=[],this.buckets[s]=a),a.push(n)}}}function ld(i,e){if(e==null&&(e=Us.EMPTY),e.parentCtx===null||e===Us.EMPTY)return We.EMPTY;const t=ld(i,e.parentCtx),r=i.states[e.invokingState].transitions[0];return Nr.create(t,r.followState.stateNumber)}function iv(i,e,t){if(i.isEmpty())return i;let r=t.get(i)||null;if(r!==null)return r;if(r=e.get(i),r!==null)return t.set(i,r),r;let n=!1,s=[];for(let o=0;o<s.length;o++){const u=iv(i.getParent(o),e,t);if(n||u!==i.getParent(o)){if(!n){s=[];for(let l=0;l<i.length;l++)s[l]=i.getParent(l);n=!0}s[o]=u}}if(!n)return e.add(i),t.set(i,i),i;let a=null;return a=s.length===0?We.EMPTY:s.length===1?Nr.create(s[0],i.getReturnState(0)):new Wi(s,i.returnStates),e.add(a),t.set(a,a),t.set(i,a),a}function ud(i,e,t,r){if(i===e)return i;if(i instanceof Nr&&e instanceof Nr)return function(n,s,a,o){if(o!==null){let l=o.get(n,s);if(l!==null||(l=o.get(s,n),l!==null))return l}const u=function(l,h,d){if(d){if(l===We.EMPTY||h===We.EMPTY)return We.EMPTY}else{if(l===We.EMPTY&&h===We.EMPTY)return We.EMPTY;if(l===We.EMPTY){const p=[h.returnState,We.EMPTY_RETURN_STATE],g=[h.parentCtx,null];return new Wi(g,p)}if(h===We.EMPTY){const p=[l.returnState,We.EMPTY_RETURN_STATE],g=[l.parentCtx,null];return new Wi(g,p)}}return null}(n,s,a);if(u!==null)return o!==null&&o.set(n,s,u),u;if(n.returnState===s.returnState){const l=ud(n.parentCtx,s.parentCtx,a,o);if(l===n.parentCtx)return n;if(l===s.parentCtx)return s;const h=Nr.create(l,n.returnState);return o!==null&&o.set(n,s,h),h}{let l=null;if((n===s||n.parentCtx!==null&&n.parentCtx===s.parentCtx)&&(l=n.parentCtx),l!==null){const g=[n.returnState,s.returnState];n.returnState>s.returnState&&(g[0]=s.returnState,g[1]=n.returnState);const m=new Wi([l,l],g);return o!==null&&o.set(n,s,m),m}const h=[n.returnState,s.returnState];let d=[n.parentCtx,s.parentCtx];n.returnState>s.returnState&&(h[0]=s.returnState,h[1]=n.returnState,d=[s.parentCtx,n.parentCtx]);const p=new Wi(d,h);return o!==null&&o.set(n,s,p),p}}(i,e,t,r);if(t){if(i instanceof od)return i;if(e instanceof od)return e}return i instanceof Nr&&(i=new Wi([i.getParent()],[i.returnState])),e instanceof Nr&&(e=new Wi([e.getParent()],[e.returnState])),function(n,s,a,o){if(o!==null){let m=o.get(n,s);if(m!==null||(m=o.get(s,n),m!==null))return We.trace_atn_sim&&console.log("mergeArrays a="+n+",b="+s+" -> previous"),m}let u=0,l=0,h=0,d=new Array(n.returnStates.length+s.returnStates.length).fill(0),p=new Array(n.returnStates.length+s.returnStates.length).fill(null);for(;u<n.returnStates.length&&l<s.returnStates.length;){const m=n.parents[u],v=s.parents[l];if(n.returnStates[u]===s.returnStates[l]){const E=n.returnStates[u];E===We.EMPTY_RETURN_STATE&&m===null&&v===null||m!==null&&v!==null&&m===v?(p[h]=m,d[h]=E):(p[h]=ud(m,v,a,o),d[h]=E),u+=1,l+=1}else n.returnStates[u]<s.returnStates[l]?(p[h]=m,d[h]=n.returnStates[u],u+=1):(p[h]=v,d[h]=s.returnStates[l],l+=1);h+=1}if(u<n.returnStates.length)for(let m=u;m<n.returnStates.length;m++)p[h]=n.parents[m],d[h]=n.returnStates[m],h+=1;else for(let m=l;m<s.returnStates.length;m++)p[h]=s.parents[m],d[h]=s.returnStates[m],h+=1;if(h<p.length){if(h===1){const m=Nr.create(p[0],d[0]);return o!==null&&o.set(n,s,m),m}p=p.slice(0,h),d=d.slice(0,h)}const g=new Wi(p,d);return g.equals(n)?(o!==null&&o.set(n,s,n),We.trace_atn_sim&&console.log("mergeArrays a="+n+",b="+s+" -> a"),n):g.equals(s)?(o!==null&&o.set(n,s,s),We.trace_atn_sim&&console.log("mergeArrays a="+n+",b="+s+" -> b"),s):(function(m){const v=new qo;for(let E=0;E<m.length;E++){const x=m[E];v.containsKey(x)||v.set(x,x)}for(let E=0;E<m.length;E++)m[E]=v.get(m[E])}(p),o!==null&&o.set(n,s,g),We.trace_atn_sim&&console.log("mergeArrays a="+n+",b="+s+" -> "+g),g)}(i,e,t,r)}class Lr{constructor(){this.data=new Uint32Array(1)}set(e){Lr._checkIndex(e),this._resize(e),this.data[e>>>5]|=1<<e%32}get(e){Lr._checkIndex(e);const t=e>>>5;return!(t>=this.data.length||!(this.data[t]&1<<e%32))}clear(e){Lr._checkIndex(e);const t=e>>>5;t<this.data.length&&(this.data[t]&=~(1<<e))}or(e){const t=Math.min(this.data.length,e.data.length);for(let r=0;r<t;++r)this.data[r]|=e.data[r];if(this.data.length<e.data.length){this._resize((e.data.length<<5)-1);const r=e.data.length;for(let n=t;n<r;++n)this.data[n]=e.data[n]}}values(){const e=new Array(this.length);let t=0;const r=this.data.length;for(let n=0;n<r;++n){let s=this.data[n];for(;s!==0;){const a=s&-s;e[t++]=(n<<5)+Lr._bitCount(a-1),s^=a}}return e}minValue(){for(let e=0;e<this.data.length;++e){let t=this.data[e];if(t!==0){let r=0;for(;!(1&t);)r++,t>>=1;return r+32*e}}return 0}hashCode(){return zr.hashStuff(this.values())}equals(e){return e instanceof Lr&&Ca(this.data,e.data)}toString(){return"{"+this.values().join(", ")+"}"}get length(){return this.data.map(e=>Lr._bitCount(e)).reduce((e,t)=>e+t,0)}_resize(e){const t=e+32>>>5;if(t<=this.data.length)return;const r=new Uint32Array(t);r.set(this.data),r.fill(0,this.data.length),this.data=r}static _checkIndex(e){if(e<0)throw new RangeError("index cannot be negative")}static _bitCount(e){return e=(e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135,e+=e>>8,0+(e+=e>>16)&63}}let lu=class Q0{constructor(e){this.atn=e}getDecisionLookahead(e){if(e===null)return null;const t=e.transitions.length,r=[];for(let n=0;n<t;n++){r[n]=new ui;const s=new jr;this._LOOK(e.transition(n).target,null,We.EMPTY,r[n],s,new Lr,!1,!1),(r[n].length===0||r[n].contains(Q0.HIT_PRED))&&(r[n]=null)}return r}LOOK(e,t,r){const n=new ui,s=(r=r||null)!==null?ld(e.atn,r):null;return this._LOOK(e,t,s,n,new jr,new Lr,!0,!0),n}_LOOK(e,t,r,n,s,a,o,u){const l=new Kt({state:e,alt:0,context:r},null);if(!s.has(l)){if(s.add(l),e===t){if(r===null)return void n.addOne(Ee.EPSILON);if(r.isEmpty()&&u)return void n.addOne(Ee.EOF)}if(e instanceof Cr){if(r===null)return void n.addOne(Ee.EPSILON);if(r.isEmpty()&&u)return void n.addOne(Ee.EOF);if(r!==We.EMPTY){const h=a.get(e.ruleIndex);try{a.clear(e.ruleIndex);for(let d=0;d<r.length;d++){const p=this.atn.states[r.getReturnState(d)];this._LOOK(p,t,r.getParent(d),n,s,a,o,u)}}finally{h&&a.set(e.ruleIndex)}return}}for(let h=0;h<e.transitions.length;h++){const d=e.transitions[h];if(d.constructor===au){if(a.get(d.target.ruleIndex))continue;const p=Nr.create(r,d.followState.stateNumber);try{a.set(d.target.ruleIndex),this._LOOK(d.target,t,p,n,s,a,o,u)}finally{a.clear(d.target.ruleIndex)}}else if(d instanceof ad)o?this._LOOK(d.target,t,r,n,s,a,o,u):n.addOne(Q0.HIT_PRED);else if(d.isEpsilon)this._LOOK(d.target,t,r,n,s,a,o,u);else if(d.constructor===ev)n.addRange(Ee.MIN_USER_TOKEN_TYPE,this.atn.maxTokenType);else{let p=d.label;p!==null&&(d instanceof sd&&(p=p.complement(Ee.MIN_USER_TOKEN_TYPE,this.atn.maxTokenType)),n.addSet(p))}}}}};lu.HIT_PRED=Ee.INVALID_TYPE;let Mt=class{constructor(e,t){this.grammarType=e,this.maxTokenType=t,this.states=[],this.decisionToState=[],this.ruleToStartState=[],this.ruleToStopState=null,this.modeNameToStartState={},this.ruleToTokenType=null,this.lexerActions=null,this.modeToStartState=[]}nextTokensInContext(e,t){return new lu(this).LOOK(e,null,t)}nextTokensNoContext(e){return e.nextTokenWithinRule!==null||(e.nextTokenWithinRule=this.nextTokensInContext(e,null),e.nextTokenWithinRule.readOnly=!0),e.nextTokenWithinRule}nextTokens(e,t){return t===void 0?this.nextTokensNoContext(e):this.nextTokensInContext(e,t)}addState(e){e!==null&&(e.atn=this,e.stateNumber=this.states.length),this.states.push(e)}removeState(e){this.states[e.stateNumber]=null}defineDecisionState(e){return this.decisionToState.push(e),e.decision=this.decisionToState.length-1,e.decision}getDecisionState(e){return this.decisionToState.length===0?null:this.decisionToState[e]}getExpectedTokens(e,t){if(e<0||e>=this.states.length)throw"Invalid state number.";const r=this.states[e];let n=this.nextTokens(r);if(!n.contains(Ee.EPSILON))return n;const s=new ui;for(s.addSet(n),s.removeOne(Ee.EPSILON);t!==null&&t.invokingState>=0&&n.contains(Ee.EPSILON);){const a=this.states[t.invokingState].transitions[0];n=this.nextTokens(a.followState),s.addSet(n),s.removeOne(Ee.EPSILON),t=t.parentCtx}return n.contains(Ee.EPSILON)&&s.addOne(Ee.EOF),s}};Mt.INVALID_ALT_NUMBER=0;class nv extends Pe{constructor(){super(),this.stateType=Pe.BASIC}}class Na extends Pe{constructor(){return super(),this.decision=-1,this.nonGreedy=!1,this}}class La extends Na{constructor(){return super(),this.endState=null,this}}let cd=class extends Pe{constructor(){return super(),this.stateType=Pe.BLOCK_END,this.startState=null,this}};class _a extends Pe{constructor(){return super(),this.stateType=Pe.LOOP_END,this.loopBackState=null,this}}class sv extends Pe{constructor(){return super(),this.stateType=Pe.RULE_START,this.stopState=null,this.isPrecedenceRule=!1,this}}class bI extends Na{constructor(){return super(),this.stateType=Pe.TOKEN_START,this}}class av extends Na{constructor(){return super(),this.stateType=Pe.PLUS_LOOP_BACK,this}}class hd extends Pe{constructor(){return super(),this.stateType=Pe.STAR_LOOP_BACK,this}}class $s extends Na{constructor(){return super(),this.stateType=Pe.STAR_LOOP_ENTRY,this.loopBackState=null,this.isPrecedenceDecision=null,this}}class dd extends La{constructor(){return super(),this.stateType=Pe.PLUS_BLOCK_START,this.loopBackState=null,this}}class fd extends La{constructor(){return super(),this.stateType=Pe.STAR_BLOCK_START,this}}class ov extends La{constructor(){return super(),this.stateType=Pe.BLOCK_START,this}}class gd extends _e{constructor(e,t){super(e),this.label_=t,this.label=this.makeLabel(),this.serializationType=_e.ATOM}makeLabel(){const e=new ui;return e.addOne(this.label_),e}matches(e,t,r){return this.label_===e}toString(){return this.label_}}class TI extends _e{constructor(e,t,r){super(e),this.serializationType=_e.RANGE,this.start=t,this.stop=r,this.label=this.makeLabel()}makeLabel(){const e=new ui;return e.addRange(this.start,this.stop),e}matches(e,t,r){return e>=this.start&&e<=this.stop}toString(){return"'"+String.fromCharCode(this.start)+"'..'"+String.fromCharCode(this.stop)+"'"}}class lv extends _e{constructor(e,t,r,n){super(e),this.serializationType=_e.ACTION,this.ruleIndex=t,this.actionIndex=r===void 0?-1:r,this.isCtxDependent=n!==void 0&&n,this.isEpsilon=!0}matches(e,t,r){return!1}toString(){return"action_"+this.ruleIndex+":"+this.actionIndex}}class Ho extends _e{constructor(e,t){super(e),this.serializationType=_e.EPSILON,this.isEpsilon=!0,this.outermostPrecedenceReturn=t}matches(e,t,r){return!1}toString(){return"epsilon"}}class uu extends pt{constructor(e,t,r){super(),this.ruleIndex=e===void 0?-1:e,this.predIndex=t===void 0?-1:t,this.isCtxDependent=r!==void 0&&r}evaluate(e,t){const r=this.isCtxDependent?t:null;return e.sempred(r,this.ruleIndex,this.predIndex)}updateHashCode(e){e.update(this.ruleIndex,this.predIndex,this.isCtxDependent)}equals(e){return this===e||e instanceof uu&&this.ruleIndex===e.ruleIndex&&this.predIndex===e.predIndex&&this.isCtxDependent===e.isCtxDependent}toString(){return"{"+this.ruleIndex+":"+this.predIndex+"}?"}}pt.NONE=new uu;class uv extends ad{constructor(e,t,r,n){super(e),this.serializationType=_e.PREDICATE,this.ruleIndex=t,this.predIndex=r,this.isCtxDependent=n,this.isEpsilon=!0}matches(e,t,r){return!1}getPredicate(){return new uu(this.ruleIndex,this.predIndex,this.isCtxDependent)}toString(){return"pred_"+this.ruleIndex+":"+this.predIndex}}class cu extends pt{constructor(e){super(),this.precedence=e===void 0?0:e}evaluate(e,t){return e.precpred(t,this.precedence)}evalPrecedence(e,t){return e.precpred(t,this.precedence)?pt.NONE:null}compareTo(e){return this.precedence-e.precedence}updateHashCode(e){e.update(this.precedence)}equals(e){return this===e||e instanceof cu&&this.precedence===e.precedence}toString(){return"{"+this.precedence+">=prec}?"}}pt.PrecedencePredicate=cu;class DI extends ad{constructor(e,t){super(e),this.serializationType=_e.PRECEDENCE,this.precedence=t,this.isEpsilon=!0}matches(e,t,r){return!1}getPredicate(){return new cu(this.precedence)}toString(){return this.precedence+" >= _p"}}class Vo{constructor(e){e===void 0&&(e=null),this.readOnly=!1,this.verifyATN=e===null||e.verifyATN,this.generateRuleBypassTransitions=e!==null&&e.generateRuleBypassTransitions}}Vo.defaultOptions=new Vo,Vo.defaultOptions.readOnly=!0;class En{constructor(e){this.actionType=e,this.isPositionDependent=!1}hashCode(){const e=new zr;return this.updateHashCode(e),e.finish()}updateHashCode(e){e.update(this.actionType)}equals(e){return this===e}}class pd extends En{constructor(){super(6)}execute(e){e.skip()}toString(){return"skip"}}pd.INSTANCE=new pd;class md extends En{constructor(e){super(0),this.channel=e}execute(e){e._channel=this.channel}updateHashCode(e){e.update(this.actionType,this.channel)}equals(e){return this===e||e instanceof md&&this.channel===e.channel}toString(){return"channel("+this.channel+")"}}class yd extends En{constructor(e,t){super(1),this.ruleIndex=e,this.actionIndex=t,this.isPositionDependent=!0}execute(e){e.action(null,this.ruleIndex,this.actionIndex)}updateHashCode(e){e.update(this.actionType,this.ruleIndex,this.actionIndex)}equals(e){return this===e||e instanceof yd&&this.ruleIndex===e.ruleIndex&&this.actionIndex===e.actionIndex}}class vd extends En{constructor(){super(3)}execute(e){e.more()}toString(){return"more"}}vd.INSTANCE=new vd;class Ed extends En{constructor(e){super(7),this.type=e}execute(e){e.type=this.type}updateHashCode(e){e.update(this.actionType,this.type)}equals(e){return this===e||e instanceof Ed&&this.type===e.type}toString(){return"type("+this.type+")"}}class Ad extends En{constructor(e){super(5),this.mode=e}execute(e){e.pushMode(this.mode)}updateHashCode(e){e.update(this.actionType,this.mode)}equals(e){return this===e||e instanceof Ad&&this.mode===e.mode}toString(){return"pushMode("+this.mode+")"}}class xd extends En{constructor(){super(4)}execute(e){e.popMode()}toString(){return"popMode"}}xd.INSTANCE=new xd;class Sd extends En{constructor(e){super(2),this.mode=e}execute(e){e.setMode(this.mode)}updateHashCode(e){e.update(this.actionType,this.mode)}equals(e){return this===e||e instanceof Sd&&this.mode===e.mode}toString(){return"mode("+this.mode+")"}}function hu(i,e){const t=[];return t[i-1]=e,t.map(function(r){return e})}class bd{constructor(e){e==null&&(e=Vo.defaultOptions),this.deserializationOptions=e,this.stateFactories=null,this.actionFactories=null}deserialize(e){const t=this.reset(e);this.checkVersion(t),t&&this.skipUUID();const r=this.readATN();this.readStates(r,t),this.readRules(r,t),this.readModes(r);const n=[];return this.readSets(r,n,this.readInt.bind(this)),t&&this.readSets(r,n,this.readInt32.bind(this)),this.readEdges(r,n),this.readDecisions(r),this.readLexerActions(r,t),this.markPrecedenceDecisions(r),this.verifyATN(r),this.deserializationOptions.generateRuleBypassTransitions&&r.grammarType===1&&(this.generateRuleBypassTransitions(r),this.verifyATN(r)),r}reset(e){if((e.charCodeAt?e.charCodeAt(0):e[0])===3){const t=function(n){const s=n.charCodeAt(0);return s>1?s-2:s+65534},r=e.split("").map(t);return r[0]=e.charCodeAt(0),this.data=r,this.pos=0,!0}return this.data=e,this.pos=0,!1}skipUUID(){let e=0;for(;e++<8;)this.readInt()}checkVersion(e){const t=this.readInt();if(!e&&t!==4)throw"Could not deserialize ATN with version "+t+" (expected 4)."}readATN(){const e=this.readInt(),t=this.readInt();return new Mt(e,t)}readStates(e,t){let r,n,s;const a=[],o=[],u=this.readInt();for(let d=0;d<u;d++){const p=this.readInt();if(p===Pe.INVALID_TYPE){e.addState(null);continue}let g=this.readInt();t&&g===65535&&(g=-1);const m=this.stateFactory(p,g);if(p===Pe.LOOP_END){const v=this.readInt();a.push([m,v])}else if(m instanceof La){const v=this.readInt();o.push([m,v])}e.addState(m)}for(r=0;r<a.length;r++)n=a[r],n[0].loopBackState=e.states[n[1]];for(r=0;r<o.length;r++)n=o[r],n[0].endState=e.states[n[1]];let l=this.readInt();for(r=0;r<l;r++)s=this.readInt(),e.states[s].nonGreedy=!0;let h=this.readInt();for(r=0;r<h;r++)s=this.readInt(),e.states[s].isPrecedenceRule=!0}readRules(e,t){let r;const n=this.readInt();for(e.grammarType===0&&(e.ruleToTokenType=hu(n,0)),e.ruleToStartState=hu(n,0),r=0;r<n;r++){const s=this.readInt();if(e.ruleToStartState[r]=e.states[s],e.grammarType===0){let a=this.readInt();t&&a===65535&&(a=Ee.EOF),e.ruleToTokenType[r]=a}}for(e.ruleToStopState=hu(n,0),r=0;r<e.states.length;r++){const s=e.states[r];s instanceof Cr&&(e.ruleToStopState[s.ruleIndex]=s,e.ruleToStartState[s.ruleIndex].stopState=s)}}readModes(e){const t=this.readInt();for(let r=0;r<t;r++){let n=this.readInt();e.modeToStartState.push(e.states[n])}}readSets(e,t,r){const n=this.readInt();for(let s=0;s<n;s++){const a=new ui;t.push(a);const o=this.readInt();this.readInt()!==0&&a.addOne(-1);for(let u=0;u<o;u++){const l=r(),h=r();a.addRange(l,h)}}}readEdges(e,t){let r,n,s,a,o;const u=this.readInt();for(r=0;r<u;r++){const l=this.readInt(),h=this.readInt(),d=this.readInt(),p=this.readInt(),g=this.readInt(),m=this.readInt();a=this.edgeFactory(e,d,l,h,p,g,m,t),e.states[l].addTransition(a)}for(r=0;r<e.states.length;r++)for(s=e.states[r],n=0;n<s.transitions.length;n++){const l=s.transitions[n];if(!(l instanceof au))continue;let h=-1;e.ruleToStartState[l.target.ruleIndex].isPrecedenceRule&&l.precedence===0&&(h=l.target.ruleIndex),a=new Ho(l.followState,h),e.ruleToStopState[l.target.ruleIndex].addTransition(a)}for(r=0;r<e.states.length;r++){if(s=e.states[r],s instanceof La){if(s.endState===null||s.endState.startState!==null)throw"IllegalState";s.endState.startState=s}if(s instanceof av)for(n=0;n<s.transitions.length;n++)o=s.transitions[n].target,o instanceof dd&&(o.loopBackState=s);else if(s instanceof hd)for(n=0;n<s.transitions.length;n++)o=s.transitions[n].target,o instanceof $s&&(o.loopBackState=s)}}readDecisions(e){const t=this.readInt();for(let r=0;r<t;r++){const n=this.readInt(),s=e.states[n];e.decisionToState.push(s),s.decision=r}}readLexerActions(e,t){if(e.grammarType===0){const r=this.readInt();e.lexerActions=hu(r,null);for(let n=0;n<r;n++){const s=this.readInt();let a=this.readInt();t&&a===65535&&(a=-1);let o=this.readInt();t&&o===65535&&(o=-1),e.lexerActions[n]=this.lexerActionFactory(s,a,o)}}}generateRuleBypassTransitions(e){let t;const r=e.ruleToStartState.length;for(t=0;t<r;t++)e.ruleToTokenType[t]=e.maxTokenType+t+1;for(t=0;t<r;t++)this.generateRuleBypassTransition(e,t)}generateRuleBypassTransition(e,t){let r,n;const s=new ov;s.ruleIndex=t,e.addState(s);const a=new cd;a.ruleIndex=t,e.addState(a),s.endState=a,e.defineDecisionState(s),a.startState=s;let o=null,u=null;if(e.ruleToStartState[t].isPrecedenceRule){for(u=null,r=0;r<e.states.length;r++)if(n=e.states[r],this.stateIsEndStateFor(n,t)){u=n,o=n.loopBackState.transitions[0];break}if(o===null)throw"Couldn't identify final state of the precedence rule prefix section."}else u=e.ruleToStopState[t];for(r=0;r<e.states.length;r++){n=e.states[r];for(let p=0;p<n.transitions.length;p++){const g=n.transitions[p];g!==o&&g.target===u&&(g.target=a)}}const l=e.ruleToStartState[t],h=l.transitions.length;for(;h>0;)s.addTransition(l.transitions[h-1]),l.transitions=l.transitions.slice(-1);e.ruleToStartState[t].addTransition(new Ho(s)),a.addTransition(new Ho(u));const d=new nv;e.addState(d),d.addTransition(new gd(a,e.ruleToTokenType[t])),s.addTransition(new Ho(d))}stateIsEndStateFor(e,t){if(e.ruleIndex!==t||!(e instanceof $s))return null;const r=e.transitions[e.transitions.length-1].target;return r instanceof _a&&r.epsilonOnlyTransitions&&r.transitions[0].target instanceof Cr?e:null}markPrecedenceDecisions(e){for(let t=0;t<e.states.length;t++){const r=e.states[t];if(r instanceof $s&&e.ruleToStartState[r.ruleIndex].isPrecedenceRule){const n=r.transitions[r.transitions.length-1].target;n instanceof _a&&n.epsilonOnlyTransitions&&n.transitions[0].target instanceof Cr&&(r.isPrecedenceDecision=!0)}}}verifyATN(e){if(this.deserializationOptions.verifyATN)for(let t=0;t<e.states.length;t++){const r=e.states[t];if(r!==null)if(this.checkCondition(r.epsilonOnlyTransitions||r.transitions.length<=1),r instanceof dd)this.checkCondition(r.loopBackState!==null);else if(r instanceof $s)if(this.checkCondition(r.loopBackState!==null),this.checkCondition(r.transitions.length===2),r.transitions[0].target instanceof fd)this.checkCondition(r.transitions[1].target instanceof _a),this.checkCondition(!r.nonGreedy);else{if(!(r.transitions[0].target instanceof _a))throw"IllegalState";this.checkCondition(r.transitions[1].target instanceof fd),this.checkCondition(r.nonGreedy)}else r instanceof hd?(this.checkCondition(r.transitions.length===1),this.checkCondition(r.transitions[0].target instanceof $s)):r instanceof _a?this.checkCondition(r.loopBackState!==null):r instanceof sv?this.checkCondition(r.stopState!==null):r instanceof La?this.checkCondition(r.endState!==null):r instanceof cd?this.checkCondition(r.startState!==null):r instanceof Na?this.checkCondition(r.transitions.length<=1||r.decision>=0):this.checkCondition(r.transitions.length<=1||r instanceof Cr)}}checkCondition(e,t){if(!e)throw t==null&&(t="IllegalState"),t}readInt(){return this.data[this.pos++]}readInt32(){return this.readInt()|this.readInt()<<16}edgeFactory(e,t,r,n,s,a,o,u){const l=e.states[n];switch(t){case _e.EPSILON:return new Ho(l);case _e.RANGE:return new TI(l,o!==0?Ee.EOF:s,a);case _e.RULE:return new au(e.states[s],a,o,l);case _e.PREDICATE:return new uv(l,s,a,o!==0);case _e.PRECEDENCE:return new DI(l,s);case _e.ATOM:return new gd(l,o!==0?Ee.EOF:s);case _e.ACTION:return new lv(l,s,a,o!==0);case _e.SET:return new nd(l,u[s]);case _e.NOT_SET:return new sd(l,u[s]);case _e.WILDCARD:return new ev(l);default:throw"The specified transition type: "+t+" is not valid."}}stateFactory(e,t){if(this.stateFactories===null){const r=[];r[Pe.INVALID_TYPE]=null,r[Pe.BASIC]=()=>new nv,r[Pe.RULE_START]=()=>new sv,r[Pe.BLOCK_START]=()=>new ov,r[Pe.PLUS_BLOCK_START]=()=>new dd,r[Pe.STAR_BLOCK_START]=()=>new fd,r[Pe.TOKEN_START]=()=>new bI,r[Pe.RULE_STOP]=()=>new Cr,r[Pe.BLOCK_END]=()=>new cd,r[Pe.STAR_LOOP_BACK]=()=>new hd,r[Pe.STAR_LOOP_ENTRY]=()=>new $s,r[Pe.PLUS_LOOP_BACK]=()=>new av,r[Pe.LOOP_END]=()=>new _a,this.stateFactories=r}if(e>this.stateFactories.length||this.stateFactories[e]===null)throw"The specified state type "+e+" is not valid.";{const r=this.stateFactories[e]();if(r!==null)return r.ruleIndex=t,r}}lexerActionFactory(e,t,r){if(this.actionFactories===null){const n=[];n[0]=(s,a)=>new md(s),n[1]=(s,a)=>new yd(s,a),n[2]=(s,a)=>new Sd(s),n[3]=(s,a)=>vd.INSTANCE,n[4]=(s,a)=>xd.INSTANCE,n[5]=(s,a)=>new Ad(s),n[6]=(s,a)=>pd.INSTANCE,n[7]=(s,a)=>new Ed(s),this.actionFactories=n}if(e>this.actionFactories.length||this.actionFactories[e]===null)throw"The specified lexer action type "+e+" is not valid.";return this.actionFactories[e](t,r)}}class Ko{syntaxError(e,t,r,n,s,a){}reportAmbiguity(e,t,r,n,s,a,o){}reportAttemptingFullContext(e,t,r,n,s,a){}reportContextSensitivity(e,t,r,n,s,a){}}class Td extends Ko{constructor(){super()}syntaxError(e,t,r,n,s,a){console.error("line "+r+":"+n+" "+s)}}Td.INSTANCE=new Td;class RI extends Ko{constructor(e){if(super(),e===null)throw"delegates";return this.delegates=e,this}syntaxError(e,t,r,n,s,a){this.delegates.map(o=>o.syntaxError(e,t,r,n,s,a))}reportAmbiguity(e,t,r,n,s,a,o){this.delegates.map(u=>u.reportAmbiguity(e,t,r,n,s,a,o))}reportAttemptingFullContext(e,t,r,n,s,a){this.delegates.map(o=>o.reportAttemptingFullContext(e,t,r,n,s,a))}reportContextSensitivity(e,t,r,n,s,a){this.delegates.map(o=>o.reportContextSensitivity(e,t,r,n,s,a))}}class du{constructor(){this._listeners=[Td.INSTANCE],this._interp=null,this._stateNumber=-1}checkVersion(e){const t="4.13.2";t!==e&&console.log("ANTLR runtime and generated code versions disagree: "+t+"!="+e)}addErrorListener(e){this._listeners.push(e)}removeErrorListeners(){this._listeners=[]}getLiteralNames(){return Object.getPrototypeOf(this).constructor.literalNames||[]}getSymbolicNames(){return Object.getPrototypeOf(this).constructor.symbolicNames||[]}getTokenNames(){if(!this.tokenNames){const e=this.getLiteralNames(),t=this.getSymbolicNames(),r=e.length>t.length?e.length:t.length;this.tokenNames=[];for(let n=0;n<r;n++)this.tokenNames[n]=e[n]||t[n]||"<INVALID"}return this.tokenNames}getTokenTypeMap(){const e=this.getTokenNames();if(e===null)throw"The current recognizer does not provide a list of token names.";let t=this.tokenTypeMapCache[e];return t===void 0&&(t=e.reduce(function(r,n,s){r[n]=s}),t.EOF=Ee.EOF,this.tokenTypeMapCache[e]=t),t}getRuleIndexMap(){const e=this.ruleNames;if(e===null)throw"The current recognizer does not provide a list of rule names.";let t=this.ruleIndexMapCache[e];return t===void 0&&(t=e.reduce(function(r,n,s){r[n]=s}),this.ruleIndexMapCache[e]=t),t}getTokenType(e){const t=this.getTokenTypeMap()[e];return t!==void 0?t:Ee.INVALID_TYPE}getErrorHeader(e){return"line "+e.getOffendingToken().line+":"+e.getOffendingToken().column}getTokenErrorDisplay(e){if(e===null)return"<no token>";let t=e.text;return t===null&&(t=e.type===Ee.EOF?"<EOF>":"<"+e.type+">"),t=t.replace(`
`,"\\n").replace("\r","\\r").replace("	","\\t"),"'"+t+"'"}getErrorListenerDispatch(){return console.warn("Calling deprecated method in Recognizer class: getErrorListenerDispatch()"),this.getErrorListener()}getErrorListener(){return new RI(this._listeners)}sempred(e,t,r){return!0}precpred(e,t){return!0}get atn(){return this._interp.atn}get state(){return this._stateNumber}set state(e){this._stateNumber=e}}du.tokenTypeMapCache={},du.ruleIndexMapCache={};class An extends Ee{constructor(e,t,r,n,s){super(),this.source=e!==void 0?e:An.EMPTY_SOURCE,this.type=t!==void 0?t:null,this.channel=r!==void 0?r:Ee.DEFAULT_CHANNEL,this.start=n!==void 0?n:-1,this.stop=s!==void 0?s:-1,this.tokenIndex=-1,this.source[0]!==null?(this.line=e[0].line,this.column=e[0].column):this.column=-1}clone(){const e=new An(this.source,this.type,this.channel,this.start,this.stop);return e.tokenIndex=this.tokenIndex,e.line=this.line,e.column=this.column,e.text=this.text,e}cloneWithType(e){const t=new An(this.source,e,this.channel,this.start,this.stop);return t.tokenIndex=this.tokenIndex,t.line=this.line,t.column=this.column,e===Ee.EOF&&(t.text=""),t}toString(){let e=this.text;return e=e!==null?e.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t"):"<no text>","[@"+this.tokenIndex+","+this.start+":"+this.stop+"='"+e+"',<"+this.type+">"+(this.channel>0?",channel="+this.channel:"")+","+this.line+":"+this.column+"]"}get text(){if(this._text!==null)return this._text;const e=this.getInputStream();if(e===null)return null;const t=e.size;return this.start<t&&this.stop<t?e.getText(this.start,this.stop):"<EOF>"}set text(e){this._text=e}}An.EMPTY_SOURCE=[null,null];class II{}class Dd extends II{constructor(e){super(),this.copyText=e!==void 0&&e}create(e,t,r,n,s,a,o,u){const l=new An(e,t,n,s,a);return l.line=o,l.column=u,r!==null?l.text=r:this.copyText&&e[1]!==null&&(l.text=e[1].getText(s,a)),l}createThin(e,t){const r=new An(null,e);return r.text=t,r}}Dd.DEFAULT=new Dd;class xn extends Error{constructor(e){super(e.message),Error.captureStackTrace&&Error.captureStackTrace(this,xn),this.message=e.message,this.recognizer=e.recognizer,this.input=e.input,this.ctx=e.ctx,this.offendingToken=null,this.offendingState=-1,this.recognizer!==null&&(this.offendingState=this.recognizer.state)}getExpectedTokens(){return this.recognizer!==null?this.recognizer.atn.getExpectedTokens(this.offendingState,this.ctx):null}toString(){return this.message}}class Rd extends xn{constructor(e,t,r,n){super({message:"",recognizer:e,input:t,ctx:null}),this.startIndex=r,this.deadEndConfigs=n}toString(){let e="";return this.startIndex>=0&&this.startIndex<this.input.size&&(e=this.input.getText(new dt(this.startIndex,this.startIndex))),"LexerNoViableAltException"+e}}class kt extends du{constructor(e){super(),this._input=e,this._factory=Dd.DEFAULT,this._tokenFactorySourcePair=[this,e],this._interp=null,this._token=null,this._tokenStartCharIndex=-1,this._tokenStartLine=-1,this._tokenStartColumn=-1,this._hitEOF=!1,this._channel=Ee.DEFAULT_CHANNEL,this._type=Ee.INVALID_TYPE,this._modeStack=[],this._mode=kt.DEFAULT_MODE,this._text=null}reset(){this._input!==null&&this._input.seek(0),this._token=null,this._type=Ee.INVALID_TYPE,this._channel=Ee.DEFAULT_CHANNEL,this._tokenStartCharIndex=-1,this._tokenStartColumn=-1,this._tokenStartLine=-1,this._text=null,this._hitEOF=!1,this._mode=kt.DEFAULT_MODE,this._modeStack=[],this._interp.reset()}nextToken(){if(this._input===null)throw"nextToken requires a non-null input stream.";const e=this._input.mark();try{for(;;){if(this._hitEOF)return this.emitEOF(),this._token;this._token=null,this._channel=Ee.DEFAULT_CHANNEL,this._tokenStartCharIndex=this._input.index,this._tokenStartColumn=this._interp.column,this._tokenStartLine=this._interp.line,this._text=null;let t=!1;for(;;){this._type=Ee.INVALID_TYPE;let r=kt.SKIP;try{r=this._interp.match(this._input,this._mode)}catch(n){if(!(n instanceof xn))throw console.log(n.stack),n;this.notifyListeners(n),this.recover(n)}if(this._input.LA(1)===Ee.EOF&&(this._hitEOF=!0),this._type===Ee.INVALID_TYPE&&(this._type=r),this._type===kt.SKIP){t=!0;break}if(this._type!==kt.MORE)break}if(!t)return this._token===null&&this.emit(),this._token}}finally{this._input.release(e)}}skip(){this._type=kt.SKIP}more(){this._type=kt.MORE}mode(e){console.warn("Calling deprecated method in Lexer class: mode(...)"),this.setMode(e)}setMode(e){this._mode=e}getMode(){return this._mode}getModeStack(){return this._modeStack}pushMode(e){this._interp.debug&&console.log("pushMode "+e),this._modeStack.push(this._mode),this.setMode(e)}popMode(){if(this._modeStack.length===0)throw"Empty Stack";return this._interp.debug&&console.log("popMode back to "+this._modeStack.slice(0,-1)),this.setMode(this._modeStack.pop()),this._mode}emitToken(e){this._token=e}emit(){const e=this._factory.create(this._tokenFactorySourcePair,this._type,this._text,this._channel,this._tokenStartCharIndex,this.getCharIndex()-1,this._tokenStartLine,this._tokenStartColumn);return this.emitToken(e),e}emitEOF(){const e=this.column,t=this.line,r=this._factory.create(this._tokenFactorySourcePair,Ee.EOF,null,Ee.DEFAULT_CHANNEL,this._input.index,this._input.index-1,t,e);return this.emitToken(r),r}getCharIndex(){return this._input.index}getAllTokens(){const e=[];let t=this.nextToken();for(;t.type!==Ee.EOF;)e.push(t),t=this.nextToken();return e}notifyListeners(e){const t=this._tokenStartCharIndex,r=this._input.index,n=this._input.getText(t,r),s="token recognition error at: '"+this.getErrorDisplay(n)+"'";this.getErrorListener().syntaxError(this,null,this._tokenStartLine,this._tokenStartColumn,s,e)}getErrorDisplay(e){const t=[];for(let r=0;r<e.length;r++)t.push(e[r]);return t.join("")}getErrorDisplayForChar(e){return e.charCodeAt(0)===Ee.EOF?"<EOF>":e===`
`?"\\n":e==="	"?"\\t":e==="\r"?"\\r":e}getCharErrorDisplay(e){return"'"+this.getErrorDisplayForChar(e)+"'"}recover(e){this._input.LA(1)!==Ee.EOF&&(e instanceof Rd?this._interp.consume(this._input):this._input.consume())}get inputStream(){return this._input}set inputStream(e){this._input=null,this._tokenFactorySourcePair=[this,this._input],this.reset(),this._input=e,this._tokenFactorySourcePair=[this,this._input]}get sourceName(){return this._input.sourceName}get type(){return this._type}set type(e){this._type=e}get line(){return this._interp.line}set line(e){this._interp.line=e}get column(){return this._interp.column}set column(e){this._interp.column=e}get text(){return this._text!==null?this._text:this._interp.getText(this._input)}set text(e){this._text=e}}function wI(i){return i.hashCodeForConfigSet()}function CI(i,e){return i===e||i!==null&&e!==null&&i.equalsForConfigSet(e)}kt.DEFAULT_MODE=0,kt.MORE=-2,kt.SKIP=-3,kt.DEFAULT_TOKEN_CHANNEL=Ee.DEFAULT_CHANNEL,kt.HIDDEN=Ee.HIDDEN_CHANNEL,kt.MIN_CHAR_VALUE=0,kt.MAX_CHAR_VALUE=1114111;class _r{constructor(e){this.configLookup=new jr(wI,CI),this.fullCtx=e===void 0||e,this.readOnly=!1,this.configs=[],this.uniqueAlt=0,this.conflictingAlts=null,this.hasSemanticContext=!1,this.dipsIntoOuterContext=!1,this.cachedHashCode=-1}add(e,t){if(t===void 0&&(t=null),this.readOnly)throw"This set is readonly";e.semanticContext!==pt.NONE&&(this.hasSemanticContext=!0),e.reachesIntoOuterContext>0&&(this.dipsIntoOuterContext=!0);const r=this.configLookup.getOrAdd(e);if(r===e)return this.cachedHashCode=-1,this.configs.push(e),!0;const n=!this.fullCtx,s=ud(r.context,e.context,n,t);return r.reachesIntoOuterContext=Math.max(r.reachesIntoOuterContext,e.reachesIntoOuterContext),e.precedenceFilterSuppressed&&(r.precedenceFilterSuppressed=!0),r.context=s,!0}getStates(){const e=new jr;for(let t=0;t<this.configs.length;t++)e.add(this.configs[t].state);return e}getPredicates(){const e=[];for(let t=0;t<this.configs.length;t++){const r=this.configs[t].semanticContext;r!==pt.NONE&&e.push(r.semanticContext)}return e}optimizeConfigs(e){if(this.readOnly)throw"This set is readonly";if(this.configLookup.length!==0)for(let t=0;t<this.configs.length;t++){const r=this.configs[t];r.context=e.getCachedContext(r.context)}}addAll(e){for(let t=0;t<e.length;t++)this.add(e[t]);return!1}equals(e){return this===e||e instanceof _r&&Ca(this.configs,e.configs)&&this.fullCtx===e.fullCtx&&this.uniqueAlt===e.uniqueAlt&&this.conflictingAlts===e.conflictingAlts&&this.hasSemanticContext===e.hasSemanticContext&&this.dipsIntoOuterContext===e.dipsIntoOuterContext}hashCode(){const e=new zr;return e.update(this.configs),e.finish()}updateHashCode(e){this.readOnly?(this.cachedHashCode===-1&&(this.cachedHashCode=this.hashCode()),e.update(this.cachedHashCode)):e.update(this.hashCode())}isEmpty(){return this.configs.length===0}contains(e){if(this.configLookup===null)throw"This method is not implemented for readonly sets.";return this.configLookup.contains(e)}containsFast(e){if(this.configLookup===null)throw"This method is not implemented for readonly sets.";return this.configLookup.containsFast(e)}clear(){if(this.readOnly)throw"This set is readonly";this.configs=[],this.cachedHashCode=-1,this.configLookup=new jr}setReadonly(e){this.readOnly=e,e&&(this.configLookup=null)}toString(){return yn(this.configs)+(this.hasSemanticContext?",hasSemanticContext="+this.hasSemanticContext:"")+(this.uniqueAlt!==Mt.INVALID_ALT_NUMBER?",uniqueAlt="+this.uniqueAlt:"")+(this.conflictingAlts!==null?",conflictingAlts="+this.conflictingAlts:"")+(this.dipsIntoOuterContext?",dipsIntoOuterContext":"")}get items(){return this.configs}get length(){return this.configs.length}}class Sn{constructor(e,t){return e===null&&(e=-1),t===null&&(t=new _r),this.stateNumber=e,this.configs=t,this.edges=null,this.isAcceptState=!1,this.prediction=0,this.lexerActionExecutor=null,this.requiresFullContext=!1,this.predicates=null,this}getAltSet(){const e=new jr;if(this.configs!==null)for(let t=0;t<this.configs.length;t++){const r=this.configs[t];e.add(r.alt)}return e.length===0?null:e}equals(e){return this===e||e instanceof Sn&&this.configs.equals(e.configs)}toString(){let e=this.stateNumber+":"+this.configs;return this.isAcceptState&&(e+="=>",this.predicates!==null?e+=this.predicates:e+=this.prediction),e}hashCode(){const e=new zr;return e.update(this.configs),e.finish()}}class Yi{constructor(e,t){return this.atn=e,this.sharedContextCache=t,this}getCachedContext(e){if(this.sharedContextCache===null)return e;const t=new qo;return iv(e,this.sharedContextCache,t)}}Yi.ERROR=new Sn(2147483647,new _r);class cv extends _r{constructor(){super(),this.configLookup=new jr}}class qr extends Kt{constructor(e,t){super(e,t);const r=e.lexerActionExecutor||null;return this.lexerActionExecutor=r||(t!==null?t.lexerActionExecutor:null),this.passedThroughNonGreedyDecision=t!==null&&this.checkNonGreedyDecision(t,this.state),this.hashCodeForConfigSet=qr.prototype.hashCode,this.equalsForConfigSet=qr.prototype.equals,this}updateHashCode(e){e.update(this.state.stateNumber,this.alt,this.context,this.semanticContext,this.passedThroughNonGreedyDecision,this.lexerActionExecutor)}equals(e){return this===e||e instanceof qr&&this.passedThroughNonGreedyDecision===e.passedThroughNonGreedyDecision&&(this.lexerActionExecutor?this.lexerActionExecutor.equals(e.lexerActionExecutor):!e.lexerActionExecutor)&&super.equals(e)}checkNonGreedyDecision(e,t){return e.passedThroughNonGreedyDecision||t instanceof Na&&t.nonGreedy}}class Wo extends En{constructor(e,t){super(t.actionType),this.offset=e,this.action=t,this.isPositionDependent=!0}execute(e){this.action.execute(e)}updateHashCode(e){e.update(this.actionType,this.offset,this.action)}equals(e){return this===e||e instanceof Wo&&this.offset===e.offset&&this.action===e.action}}class Ma{constructor(e){return this.lexerActions=e===null?[]:e,this.cachedHashCode=zr.hashStuff(e),this}fixOffsetBeforeMatch(e){let t=null;for(let r=0;r<this.lexerActions.length;r++)!this.lexerActions[r].isPositionDependent||this.lexerActions[r]instanceof Wo||(t===null&&(t=this.lexerActions.concat([])),t[r]=new Wo(e,this.lexerActions[r]));return t===null?this:new Ma(t)}execute(e,t,r){let n=!1;const s=t.index;try{for(let a=0;a<this.lexerActions.length;a++){let o=this.lexerActions[a];if(o instanceof Wo){const u=o.offset;t.seek(r+u),o=o.action,n=r+u!==s}else o.isPositionDependent&&(t.seek(s),n=!1);o.execute(e)}}finally{n&&t.seek(s)}}hashCode(){return this.cachedHashCode}updateHashCode(e){e.update(this.cachedHashCode)}equals(e){if(this===e)return!0;if(e instanceof Ma){if(this.cachedHashCode!=e.cachedHashCode||this.lexerActions.length!=e.lexerActions.length)return!1;{const t=this.lexerActions.length;for(let r=0;r<t;++r)if(!this.lexerActions[r].equals(e.lexerActions[r]))return!1;return!0}}return!1}static append(e,t){if(e===null)return new Ma([t]);const r=e.lexerActions.concat([t]);return new Ma(r)}}function hv(i){i.index=-1,i.line=0,i.column=-1,i.dfaState=null}class NI{constructor(){hv(this)}reset(){hv(this)}}class Ft extends Yi{constructor(e,t,r,n){super(t,n),this.decisionToDFA=r,this.recog=e,this.startIndex=-1,this.line=1,this.column=0,this.mode=kt.DEFAULT_MODE,this.prevAccept=new NI}copyState(e){this.column=e.column,this.line=e.line,this.mode=e.mode,this.startIndex=e.startIndex}match(e,t){this.mode=t;const r=e.mark();try{this.startIndex=e.index,this.prevAccept.reset();const n=this.decisionToDFA[t];return n.s0===null?this.matchATN(e):this.execATN(e,n.s0)}finally{e.release(r)}}reset(){this.prevAccept.reset(),this.startIndex=-1,this.line=1,this.column=0,this.mode=kt.DEFAULT_MODE}matchATN(e){const t=this.atn.modeToStartState[this.mode];Ft.debug&&console.log("matchATN mode "+this.mode+" start: "+t);const r=this.mode,n=this.computeStartState(e,t),s=n.hasSemanticContext;n.hasSemanticContext=!1;const a=this.addDFAState(n);s||(this.decisionToDFA[this.mode].s0=a);const o=this.execATN(e,a);return Ft.debug&&console.log("DFA after matchATN: "+this.decisionToDFA[r].toLexerString()),o}execATN(e,t){Ft.debug&&console.log("start state closure="+t.configs),t.isAcceptState&&this.captureSimState(this.prevAccept,e,t);let r=e.LA(1),n=t;for(;;){Ft.debug&&console.log("execATN loop starting closure: "+n.configs);let s=this.getExistingTargetState(n,r);if(s===null&&(s=this.computeTargetState(e,n,r)),s===Yi.ERROR||(r!==Ee.EOF&&this.consume(e),s.isAcceptState&&(this.captureSimState(this.prevAccept,e,s),r===Ee.EOF)))break;r=e.LA(1),n=s}return this.failOrAccept(this.prevAccept,e,n.configs,r)}getExistingTargetState(e,t){if(e.edges===null||t<Ft.MIN_DFA_EDGE||t>Ft.MAX_DFA_EDGE)return null;let r=e.edges[t-Ft.MIN_DFA_EDGE];return r===void 0&&(r=null),Ft.debug&&r!==null&&console.log("reuse state "+e.stateNumber+" edge to "+r.stateNumber),r}computeTargetState(e,t,r){const n=new cv;return this.getReachableConfigSet(e,t.configs,n,r),n.items.length===0?(n.hasSemanticContext||this.addDFAEdge(t,r,Yi.ERROR),Yi.ERROR):this.addDFAEdge(t,r,null,n)}failOrAccept(e,t,r,n){if(this.prevAccept.dfaState!==null){const s=e.dfaState.lexerActionExecutor;return this.accept(t,s,this.startIndex,e.index,e.line,e.column),e.dfaState.prediction}if(n===Ee.EOF&&t.index===this.startIndex)return Ee.EOF;throw new Rd(this.recog,t,this.startIndex,r)}getReachableConfigSet(e,t,r,n){let s=Mt.INVALID_ALT_NUMBER;for(let a=0;a<t.items.length;a++){const o=t.items[a],u=o.alt===s;if(!u||!o.passedThroughNonGreedyDecision){Ft.debug&&console.log(`testing %s at %s
`,this.getTokenName(n),o.toString(this.recog,!0));for(let l=0;l<o.state.transitions.length;l++){const h=o.state.transitions[l],d=this.getReachableTarget(h,n);if(d!==null){let p=o.lexerActionExecutor;p!==null&&(p=p.fixOffsetBeforeMatch(e.index-this.startIndex));const g=n===Ee.EOF,m=new qr({state:d,lexerActionExecutor:p},o);this.closure(e,m,r,u,!0,g)&&(s=o.alt)}}}}}accept(e,t,r,n,s,a){Ft.debug&&console.log(`ACTION %s
`,t),e.seek(n),this.line=s,this.column=a,t!==null&&this.recog!==null&&t.execute(this.recog,e,r)}getReachableTarget(e,t){return e.matches(t,0,kt.MAX_CHAR_VALUE)?e.target:null}computeStartState(e,t){const r=We.EMPTY,n=new cv;for(let s=0;s<t.transitions.length;s++){const a=t.transitions[s].target,o=new qr({state:a,alt:s+1,context:r},null);this.closure(e,o,n,!1,!1,!1)}return n}closure(e,t,r,n,s,a){let o=null;if(Ft.debug&&console.log("closure("+t.toString(this.recog,!0)+")"),t.state instanceof Cr){if(Ft.debug&&(this.recog!==null?console.log(`closure at %s rule stop %s
`,this.recog.ruleNames[t.state.ruleIndex],t):console.log(`closure at rule stop %s
`,t)),t.context===null||t.context.hasEmptyPath()){if(t.context===null||t.context.isEmpty())return r.add(t),!0;r.add(new qr({state:t.state,context:We.EMPTY},t)),n=!0}if(t.context!==null&&!t.context.isEmpty()){for(let u=0;u<t.context.length;u++)if(t.context.getReturnState(u)!==We.EMPTY_RETURN_STATE){const l=t.context.getParent(u),h=this.atn.states[t.context.getReturnState(u)];o=new qr({state:h,context:l},t),n=this.closure(e,o,r,n,s,a)}}return n}t.state.epsilonOnlyTransitions||n&&t.passedThroughNonGreedyDecision||r.add(t);for(let u=0;u<t.state.transitions.length;u++){const l=t.state.transitions[u];o=this.getEpsilonTarget(e,t,l,r,s,a),o!==null&&(n=this.closure(e,o,r,n,s,a))}return n}getEpsilonTarget(e,t,r,n,s,a){let o=null;if(r.serializationType===_e.RULE){const u=Nr.create(t.context,r.followState.stateNumber);o=new qr({state:r.target,context:u},t)}else{if(r.serializationType===_e.PRECEDENCE)throw"Precedence predicates are not supported in lexers.";if(r.serializationType===_e.PREDICATE)Ft.debug&&console.log("EVAL rule "+r.ruleIndex+":"+r.predIndex),n.hasSemanticContext=!0,this.evaluatePredicate(e,r.ruleIndex,r.predIndex,s)&&(o=new qr({state:r.target},t));else if(r.serializationType===_e.ACTION)if(t.context===null||t.context.hasEmptyPath()){const u=Ma.append(t.lexerActionExecutor,this.atn.lexerActions[r.actionIndex]);o=new qr({state:r.target,lexerActionExecutor:u},t)}else o=new qr({state:r.target},t);else r.serializationType===_e.EPSILON?o=new qr({state:r.target},t):r.serializationType!==_e.ATOM&&r.serializationType!==_e.RANGE&&r.serializationType!==_e.SET||a&&r.matches(Ee.EOF,0,kt.MAX_CHAR_VALUE)&&(o=new qr({state:r.target},t))}return o}evaluatePredicate(e,t,r,n){if(this.recog===null)return!0;if(!n)return this.recog.sempred(null,t,r);const s=this.column,a=this.line,o=e.index,u=e.mark();try{return this.consume(e),this.recog.sempred(null,t,r)}finally{this.column=s,this.line=a,e.seek(o),e.release(u)}}captureSimState(e,t,r){e.index=t.index,e.line=this.line,e.column=this.column,e.dfaState=r}addDFAEdge(e,t,r,n){if(r===void 0&&(r=null),n===void 0&&(n=null),r===null&&n!==null){const s=n.hasSemanticContext;if(n.hasSemanticContext=!1,r=this.addDFAState(n),s)return r}return t<Ft.MIN_DFA_EDGE||t>Ft.MAX_DFA_EDGE||(Ft.debug&&console.log("EDGE "+e+" -> "+r+" upon "+t),e.edges===null&&(e.edges=[]),e.edges[t-Ft.MIN_DFA_EDGE]=r),r}addDFAState(e){const t=new Sn(null,e);let r=null;for(let o=0;o<e.items.length;o++){const u=e.items[o];if(u.state instanceof Cr){r=u;break}}r!==null&&(t.isAcceptState=!0,t.lexerActionExecutor=r.lexerActionExecutor,t.prediction=this.atn.ruleToTokenType[r.state.ruleIndex]);const n=this.decisionToDFA[this.mode],s=n.states.get(t);if(s!==null)return s;const a=t;return a.stateNumber=n.states.length,e.setReadonly(!0),a.configs=e,n.states.add(a),a}getDFA(e){return this.decisionToDFA[e]}getText(e){return e.getText(this.startIndex,e.index-1)}consume(e){e.LA(1)===10?(this.line+=1,this.column=0):this.column+=1,e.consume()}getTokenName(e){return e===-1?"EOF":"'"+String.fromCharCode(e)+"'"}}Ft.debug=!1,Ft.dfa_debug=!1,Ft.MIN_DFA_EDGE=0,Ft.MAX_DFA_EDGE=127;class dv{constructor(e,t){this.alt=t,this.pred=e}toString(){return"("+this.pred+", "+this.alt+")"}}class LI{constructor(){this.data={}}get(e){return this.data["k-"+e]||null}set(e,t){this.data["k-"+e]=t}values(){return Object.keys(this.data).filter(e=>e.startsWith("k-")).map(e=>this.data[e],this)}}const Xi={SLL:0,LL:1,LL_EXACT_AMBIG_DETECTION:2,hasSLLConflictTerminatingPrediction:function(i,e){if(Xi.allConfigsInRuleStopStates(e))return!0;if(i===Xi.SLL&&e.hasSemanticContext){const r=new _r;for(let n=0;n<e.items.length;n++){let s=e.items[n];s=new Kt({semanticContext:pt.NONE},s),r.add(s)}e=r}const t=Xi.getConflictingAltSubsets(e);return Xi.hasConflictingAltSet(t)&&!Xi.hasStateAssociatedWithOneAlt(e)},hasConfigInRuleStopState:function(i){for(let e=0;e<i.items.length;e++)if(i.items[e].state instanceof Cr)return!0;return!1},allConfigsInRuleStopStates:function(i){for(let e=0;e<i.items.length;e++)if(!(i.items[e].state instanceof Cr))return!1;return!0},resolvesToJustOneViableAlt:function(i){return Xi.getSingleViableAlt(i)},allSubsetsConflict:function(i){return!Xi.hasNonConflictingAltSet(i)},hasNonConflictingAltSet:function(i){for(let e=0;e<i.length;e++)if(i[e].length===1)return!0;return!1},hasConflictingAltSet:function(i){for(let e=0;e<i.length;e++)if(i[e].length>1)return!0;return!1},allSubsetsEqual:function(i){let e=null;for(let t=0;t<i.length;t++){const r=i[t];if(e===null)e=r;else if(r!==e)return!1}return!0},getUniqueAlt:function(i){const e=Xi.getAlts(i);return e.length===1?e.minValue():Mt.INVALID_ALT_NUMBER},getAlts:function(i){const e=new Lr;return i.map(function(t){e.or(t)}),e},getConflictingAltSubsets:function(i){const e=new qo;return e.hashFunction=function(t){zr.hashStuff(t.state.stateNumber,t.context)},e.equalsFunction=function(t,r){return t.state.stateNumber===r.state.stateNumber&&t.context.equals(r.context)},i.items.map(function(t){let r=e.get(t);r===null&&(r=new Lr,e.set(t,r)),r.set(t.alt)}),e.getValues()},getStateToAltMap:function(i){const e=new LI;return i.items.map(function(t){let r=e.get(t.state);r===null&&(r=new Lr,e.set(t.state,r)),r.set(t.alt)}),e},hasStateAssociatedWithOneAlt:function(i){const e=Xi.getStateToAltMap(i).values();for(let t=0;t<e.length;t++)if(e[t].length===1)return!0;return!1},getSingleViableAlt:function(i){let e=null;for(let t=0;t<i.length;t++){const r=i[t].minValue();if(e===null)e=r;else if(e!==r)return Mt.INVALID_ALT_NUMBER}return e}},Zt=Xi;let fu=class extends xn{constructor(e,t,r,n,s,a){a=a||e._ctx,n=n||e.getCurrentToken(),r=r||e.getCurrentToken(),t=t||e.getInputStream(),super({message:"",recognizer:e,input:t,ctx:a}),this.deadEndConfigs=s,this.startToken=r,this.offendingToken=n}},_I=class{constructor(e){this.defaultMapCtor=e||qo,this.cacheMap=new this.defaultMapCtor}get(e,t){const r=this.cacheMap.get(e)||null;return r===null?null:r.get(t)||null}set(e,t,r){let n=this.cacheMap.get(e)||null;n===null&&(n=new this.defaultMapCtor,this.cacheMap.set(e,n)),n.set(t,r)}};class fv extends Yi{constructor(e,t,r,n){super(t,n),this.parser=e,this.decisionToDFA=r,this.predictionMode=Zt.LL,this._input=null,this._startIndex=0,this._outerContext=null,this._dfa=null,this.mergeCache=null,this.debug=!1,this.debug_closure=!1,this.debug_add=!1,this.trace_atn_sim=!1,this.dfa_debug=!1,this.retry_debug=!1}reset(){}adaptivePredict(e,t,r){(this.debug||this.trace_atn_sim)&&console.log("adaptivePredict decision "+t+" exec LA(1)=="+this.getLookaheadName(e)+" line "+e.LT(1).line+":"+e.LT(1).column),this._input=e,this._startIndex=e.index,this._outerContext=r;const n=this.decisionToDFA[t];this._dfa=n;const s=e.mark(),a=e.index;try{let o;if(o=n.precedenceDfa?n.getPrecedenceStartState(this.parser.getPrecedence()):n.s0,o===null){r===null&&(r=Us.EMPTY),this.debug&&console.log("predictATN decision "+n.decision+" exec LA(1)=="+this.getLookaheadName(e)+", outerContext="+r.toString(this.parser.ruleNames));let h=this.computeStartState(n.atnStartState,Us.EMPTY,!1);n.precedenceDfa?(n.s0.configs=h,h=this.applyPrecedenceFilter(h),o=this.addDFAState(n,new Sn(null,h)),n.setPrecedenceStartState(this.parser.getPrecedence(),o)):(o=this.addDFAState(n,new Sn(null,h)),n.s0=o)}const u=this.execATN(n,o,e,a,r);return this.debug&&console.log("DFA after predictATN: "+n.toString(this.parser.literalNames,this.parser.symbolicNames)),u}finally{this._dfa=null,this.mergeCache=null,e.seek(a),e.release(s)}}execATN(e,t,r,n,s){let a;(this.debug||this.trace_atn_sim)&&console.log("execATN decision "+e.decision+", DFA state "+t+", LA(1)=="+this.getLookaheadName(r)+" line "+r.LT(1).line+":"+r.LT(1).column);let o=t;this.debug&&console.log("s0 = "+t);let u=r.LA(1);for(;;){let l=this.getExistingTargetState(o,u);if(l===null&&(l=this.computeTargetState(e,o,u)),l===Yi.ERROR){const h=this.noViableAlt(r,s,o.configs,n);if(r.seek(n),a=this.getSynValidOrSemInvalidAltThatFinishedDecisionEntryRule(o.configs,s),a!==Mt.INVALID_ALT_NUMBER)return a;throw h}if(l.requiresFullContext&&this.predictionMode!==Zt.SLL){let h=null;if(l.predicates!==null){this.debug&&console.log("DFA state has preds in DFA sim LL failover");const g=r.index;if(g!==n&&r.seek(n),h=this.evalSemanticContext(l.predicates,s,!0),h.length===1)return this.debug&&console.log("Full LL avoided"),h.minValue();g!==n&&r.seek(g)}this.dfa_debug&&console.log("ctx sensitive state "+s+" in "+l);const d=!0,p=this.computeStartState(e.atnStartState,s,d);return this.reportAttemptingFullContext(e,h,l.configs,n,r.index),a=this.execATNWithFullContext(e,l,p,r,n,s),a}if(l.isAcceptState){if(l.predicates===null)return l.prediction;const h=r.index;r.seek(n);const d=this.evalSemanticContext(l.predicates,s,!0);if(d.length===0)throw this.noViableAlt(r,s,l.configs,n);return d.length===1||this.reportAmbiguity(e,l,n,h,!1,d,l.configs),d.minValue()}o=l,u!==Ee.EOF&&(r.consume(),u=r.LA(1))}}getExistingTargetState(e,t){const r=e.edges;return r===null?null:r[t+1]||null}computeTargetState(e,t,r){const n=this.computeReachSet(t.configs,r,!1);if(n===null)return this.addDFAEdge(e,t,r,Yi.ERROR),Yi.ERROR;let s=new Sn(null,n);const a=this.getUniqueAlt(n);if(this.debug){const o=Zt.getConflictingAltSubsets(n);console.log("SLL altSubSets="+yn(o)+", configs="+n+", predict="+a+", allSubsetsConflict="+Zt.allSubsetsConflict(o)+", conflictingAlts="+this.getConflictingAlts(n))}return a!==Mt.INVALID_ALT_NUMBER?(s.isAcceptState=!0,s.configs.uniqueAlt=a,s.prediction=a):Zt.hasSLLConflictTerminatingPrediction(this.predictionMode,n)&&(s.configs.conflictingAlts=this.getConflictingAlts(n),s.requiresFullContext=!0,s.isAcceptState=!0,s.prediction=s.configs.conflictingAlts.minValue()),s.isAcceptState&&s.configs.hasSemanticContext&&(this.predicateDFAState(s,this.atn.getDecisionState(e.decision)),s.predicates!==null&&(s.prediction=Mt.INVALID_ALT_NUMBER)),s=this.addDFAEdge(e,t,r,s),s}predicateDFAState(e,t){const r=t.transitions.length,n=this.getConflictingAltsOrUniqueAlt(e.configs),s=this.getPredsForAmbigAlts(n,e.configs,r);s!==null?(e.predicates=this.getPredicatePredictions(n,s),e.prediction=Mt.INVALID_ALT_NUMBER):e.prediction=n.minValue()}execATNWithFullContext(e,t,r,n,s,a){(this.debug||this.trace_atn_sim)&&console.log("execATNWithFullContext "+r);let o,u=!1,l=r;n.seek(s);let h=n.LA(1),d=-1;for(;;){if(o=this.computeReachSet(l,h,!0),o===null){const g=this.noViableAlt(n,a,l,s);n.seek(s);const m=this.getSynValidOrSemInvalidAltThatFinishedDecisionEntryRule(l,a);if(m!==Mt.INVALID_ALT_NUMBER)return m;throw g}const p=Zt.getConflictingAltSubsets(o);if(this.debug&&console.log("LL altSubSets="+p+", predict="+Zt.getUniqueAlt(p)+", resolvesToJustOneViableAlt="+Zt.resolvesToJustOneViableAlt(p)),o.uniqueAlt=this.getUniqueAlt(o),o.uniqueAlt!==Mt.INVALID_ALT_NUMBER){d=o.uniqueAlt;break}if(this.predictionMode!==Zt.LL_EXACT_AMBIG_DETECTION){if(d=Zt.resolvesToJustOneViableAlt(p),d!==Mt.INVALID_ALT_NUMBER)break}else if(Zt.allSubsetsConflict(p)&&Zt.allSubsetsEqual(p)){u=!0,d=Zt.getSingleViableAlt(p);break}l=o,h!==Ee.EOF&&(n.consume(),h=n.LA(1))}return o.uniqueAlt!==Mt.INVALID_ALT_NUMBER?(this.reportContextSensitivity(e,d,o,s,n.index),d):(this.reportAmbiguity(e,t,s,n.index,u,null,o),d)}computeReachSet(e,t,r){this.debug&&console.log("in computeReachSet, starting closure: "+e),this.mergeCache===null&&(this.mergeCache=new _I);const n=new _r(r);let s=null;for(let o=0;o<e.items.length;o++){const u=e.items[o];if(this.debug&&console.log("testing "+this.getTokenName(t)+" at "+u),u.state instanceof Cr)(r||t===Ee.EOF)&&(s===null&&(s=[]),s.push(u),this.debug_add&&console.log("added "+u+" to skippedStopStates"));else for(let l=0;l<u.state.transitions.length;l++){const h=u.state.transitions[l],d=this.getReachableTarget(h,t);if(d!==null){const p=new Kt({state:d},u);n.add(p,this.mergeCache),this.debug_add&&console.log("added "+p+" to intermediate")}}}let a=null;if(s===null&&t!==Ee.EOF&&(n.items.length===1||this.getUniqueAlt(n)!==Mt.INVALID_ALT_NUMBER)&&(a=n),a===null){a=new _r(r);const o=new jr,u=t===Ee.EOF;for(let l=0;l<n.items.length;l++)this.closure(n.items[l],a,o,!1,r,u)}if(t===Ee.EOF&&(a=this.removeAllConfigsNotInRuleStopState(a,a===n)),!(s===null||r&&Zt.hasConfigInRuleStopState(a)))for(let o=0;o<s.length;o++)a.add(s[o],this.mergeCache);return this.trace_atn_sim&&console.log("computeReachSet "+e+" -> "+a),a.items.length===0?null:a}removeAllConfigsNotInRuleStopState(e,t){if(Zt.allConfigsInRuleStopStates(e))return e;const r=new _r(e.fullCtx);for(let n=0;n<e.items.length;n++){const s=e.items[n];if(s.state instanceof Cr)r.add(s,this.mergeCache);else if(t&&s.state.epsilonOnlyTransitions&&this.atn.nextTokens(s.state).contains(Ee.EPSILON)){const a=this.atn.ruleToStopState[s.state.ruleIndex];r.add(new Kt({state:a},s),this.mergeCache)}}return r}computeStartState(e,t,r){const n=ld(this.atn,t),s=new _r(r);this.trace_atn_sim&&console.log("computeStartState from ATN state "+e+" initialContext="+n.toString(this.parser));for(let a=0;a<e.transitions.length;a++){const o=e.transitions[a].target,u=new Kt({state:o,alt:a+1,context:n},null),l=new jr;this.closure(u,s,l,!0,r,!1)}return s}applyPrecedenceFilter(e){let t;const r=[],n=new _r(e.fullCtx);for(let s=0;s<e.items.length;s++){if(t=e.items[s],t.alt!==1)continue;const a=t.semanticContext.evalPrecedence(this.parser,this._outerContext);a!==null&&(r[t.state.stateNumber]=t.context,a!==t.semanticContext?n.add(new Kt({semanticContext:a},t),this.mergeCache):n.add(t,this.mergeCache))}for(let s=0;s<e.items.length;s++)if(t=e.items[s],t.alt!==1){if(!t.precedenceFilterSuppressed){const a=r[t.state.stateNumber]||null;if(a!==null&&a.equals(t.context))continue}n.add(t,this.mergeCache)}return n}getReachableTarget(e,t){return e.matches(t,0,this.atn.maxTokenType)?e.target:null}getPredsForAmbigAlts(e,t,r){let n=[];for(let a=0;a<t.items.length;a++){const o=t.items[a];e.get(o.alt)&&(n[o.alt]=pt.orContext(n[o.alt]||null,o.semanticContext))}let s=0;for(let a=1;a<r+1;a++){const o=n[a]||null;o===null?n[a]=pt.NONE:o!==pt.NONE&&(s+=1)}return s===0&&(n=null),this.debug&&console.log("getPredsForAmbigAlts result "+yn(n)),n}getPredicatePredictions(e,t){const r=[];let n=!1;for(let s=1;s<t.length;s++){const a=t[s];e!==null&&e.get(s)&&r.push(new dv(a,s)),a!==pt.NONE&&(n=!0)}return n?r:null}getSynValidOrSemInvalidAltThatFinishedDecisionEntryRule(e,t){const r=this.splitAccordingToSemanticValidity(e,t),n=r[0],s=r[1];let a=this.getAltThatFinishedDecisionEntryRule(n);return a!==Mt.INVALID_ALT_NUMBER||s.items.length>0&&(a=this.getAltThatFinishedDecisionEntryRule(s),a!==Mt.INVALID_ALT_NUMBER)?a:Mt.INVALID_ALT_NUMBER}getAltThatFinishedDecisionEntryRule(e){const t=[];for(let r=0;r<e.items.length;r++){const n=e.items[r];(n.reachesIntoOuterContext>0||n.state instanceof Cr&&n.context.hasEmptyPath())&&t.indexOf(n.alt)<0&&t.push(n.alt)}return t.length===0?Mt.INVALID_ALT_NUMBER:Math.min.apply(null,t)}splitAccordingToSemanticValidity(e,t){const r=new _r(e.fullCtx),n=new _r(e.fullCtx);for(let s=0;s<e.items.length;s++){const a=e.items[s];a.semanticContext!==pt.NONE?a.semanticContext.evaluate(this.parser,t)?r.add(a):n.add(a):r.add(a)}return[r,n]}evalSemanticContext(e,t,r){const n=new Lr;for(let s=0;s<e.length;s++){const a=e[s];if(a.pred===pt.NONE){if(n.set(a.alt),!r)break;continue}const o=a.pred.evaluate(this.parser,t);if((this.debug||this.dfa_debug)&&console.log("eval pred "+a+"="+o),o&&((this.debug||this.dfa_debug)&&console.log("PREDICT "+a.alt),n.set(a.alt),!r))break}return n}closure(e,t,r,n,s,a){this.closureCheckingStopState(e,t,r,n,s,0,a)}closureCheckingStopState(e,t,r,n,s,a,o){if((this.trace_atn_sim||this.debug_closure)&&console.log("closure("+e.toString(this.parser,!0)+")"),e.state instanceof Cr){if(!e.context.isEmpty()){for(let u=0;u<e.context.length;u++){if(e.context.getReturnState(u)===We.EMPTY_RETURN_STATE){if(s){t.add(new Kt({state:e.state,context:We.EMPTY},e),this.mergeCache);continue}this.debug&&console.log("FALLING off rule "+this.getRuleName(e.state.ruleIndex)),this.closure_(e,t,r,n,s,a,o);continue}const l=this.atn.states[e.context.getReturnState(u)],h=e.context.getParent(u),d={state:l,alt:e.alt,context:h,semanticContext:e.semanticContext},p=new Kt(d,null);p.reachesIntoOuterContext=e.reachesIntoOuterContext,this.closureCheckingStopState(p,t,r,n,s,a-1,o)}return}if(s)return void t.add(e,this.mergeCache);this.debug&&console.log("FALLING off rule "+this.getRuleName(e.state.ruleIndex))}this.closure_(e,t,r,n,s,a,o)}closure_(e,t,r,n,s,a,o){const u=e.state;u.epsilonOnlyTransitions||t.add(e,this.mergeCache);for(let l=0;l<u.transitions.length;l++){if(l===0&&this.canDropLoopEntryEdgeInLeftRecursiveRule(e))continue;const h=u.transitions[l],d=n&&!(h instanceof lv),p=this.getEpsilonTarget(e,h,d,a===0,s,o);if(p!==null){let g=a;if(e.state instanceof Cr){if(this._dfa!==null&&this._dfa.precedenceDfa&&h.outermostPrecedenceReturn===this._dfa.atnStartState.ruleIndex&&(p.precedenceFilterSuppressed=!0),p.reachesIntoOuterContext+=1,r.getOrAdd(p)!==p)continue;t.dipsIntoOuterContext=!0,g-=1,this.debug&&console.log("dips into outer ctx: "+p)}else{if(!h.isEpsilon&&r.getOrAdd(p)!==p)continue;h instanceof au&&g>=0&&(g+=1)}this.closureCheckingStopState(p,t,r,d,s,g,o)}}}canDropLoopEntryEdgeInLeftRecursiveRule(e){const t=e.state;if(t.stateType!==Pe.STAR_LOOP_ENTRY||t.stateType!==Pe.STAR_LOOP_ENTRY||!t.isPrecedenceDecision||e.context.isEmpty()||e.context.hasEmptyPath())return!1;const r=e.context.length;for(let a=0;a<r;a++)if(this.atn.states[e.context.getReturnState(a)].ruleIndex!==t.ruleIndex)return!1;const n=t.transitions[0].target.endState.stateNumber,s=this.atn.states[n];for(let a=0;a<r;a++){const o=e.context.getReturnState(a),u=this.atn.states[o];if(u.transitions.length!==1||!u.transitions[0].isEpsilon)return!1;const l=u.transitions[0].target;if(!(u.stateType===Pe.BLOCK_END&&l===t||u===s||l===s||l.stateType===Pe.BLOCK_END&&l.transitions.length===1&&l.transitions[0].isEpsilon&&l.transitions[0].target===t))return!1}return!0}getRuleName(e){return this.parser!==null&&e>=0?this.parser.ruleNames[e]:"<rule "+e+">"}getEpsilonTarget(e,t,r,n,s,a){switch(t.serializationType){case _e.RULE:return this.ruleTransition(e,t);case _e.PRECEDENCE:return this.precedenceTransition(e,t,r,n,s);case _e.PREDICATE:return this.predTransition(e,t,r,n,s);case _e.ACTION:return this.actionTransition(e,t);case _e.EPSILON:return new Kt({state:t.target},e);case _e.ATOM:case _e.RANGE:case _e.SET:return a&&t.matches(Ee.EOF,0,1)?new Kt({state:t.target},e):null;default:return null}}actionTransition(e,t){if(this.debug){const r=t.actionIndex===-1?65535:t.actionIndex;console.log("ACTION edge "+t.ruleIndex+":"+r)}return new Kt({state:t.target},e)}precedenceTransition(e,t,r,n,s){this.debug&&(console.log("PRED (collectPredicates="+r+") "+t.precedence+">=_p, ctx dependent=true"),this.parser!==null&&console.log("context surrounding pred is "+yn(this.parser.getRuleInvocationStack())));let a=null;if(r&&n)if(s){const o=this._input.index;this._input.seek(this._startIndex);const u=t.getPredicate().evaluate(this.parser,this._outerContext);this._input.seek(o),u&&(a=new Kt({state:t.target},e))}else{const o=pt.andContext(e.semanticContext,t.getPredicate());a=new Kt({state:t.target,semanticContext:o},e)}else a=new Kt({state:t.target},e);return this.debug&&console.log("config from pred transition="+a),a}predTransition(e,t,r,n,s){this.debug&&(console.log("PRED (collectPredicates="+r+") "+t.ruleIndex+":"+t.predIndex+", ctx dependent="+t.isCtxDependent),this.parser!==null&&console.log("context surrounding pred is "+yn(this.parser.getRuleInvocationStack())));let a=null;if(r&&(t.isCtxDependent&&n||!t.isCtxDependent))if(s){const o=this._input.index;this._input.seek(this._startIndex);const u=t.getPredicate().evaluate(this.parser,this._outerContext);this._input.seek(o),u&&(a=new Kt({state:t.target},e))}else{const o=pt.andContext(e.semanticContext,t.getPredicate());a=new Kt({state:t.target,semanticContext:o},e)}else a=new Kt({state:t.target},e);return this.debug&&console.log("config from pred transition="+a),a}ruleTransition(e,t){this.debug&&console.log("CALL rule "+this.getRuleName(t.target.ruleIndex)+", ctx="+e.context);const r=t.followState,n=Nr.create(e.context,r.stateNumber);return new Kt({state:t.target,context:n},e)}getConflictingAlts(e){const t=Zt.getConflictingAltSubsets(e);return Zt.getAlts(t)}getConflictingAltsOrUniqueAlt(e){let t=null;return e.uniqueAlt!==Mt.INVALID_ALT_NUMBER?(t=new Lr,t.set(e.uniqueAlt)):t=e.conflictingAlts,t}getTokenName(e){if(e===Ee.EOF)return"EOF";if(this.parser!==null&&this.parser.literalNames!==null){if(!(e>=this.parser.literalNames.length&&e>=this.parser.symbolicNames.length))return(this.parser.literalNames[e]||this.parser.symbolicNames[e])+"<"+e+">";console.log(e+" ttype out of range: "+this.parser.literalNames),console.log(""+this.parser.getInputStream().getTokens())}return""+e}getLookaheadName(e){return this.getTokenName(e.LA(1))}dumpDeadEndConfigs(e){console.log("dead end configs: ");const t=e.getDeadEndConfigs();for(let r=0;r<t.length;r++){const n=t[r];let s="no edges";if(n.state.transitions.length>0){const a=n.state.transitions[0];a instanceof gd?s="Atom "+this.getTokenName(a.label):a instanceof nd&&(s=(a instanceof sd?"~":"")+"Set "+a.set)}console.error(n.toString(this.parser,!0)+":"+s)}}noViableAlt(e,t,r,n){return new fu(this.parser,e,e.get(n),e.LT(1),r,t)}getUniqueAlt(e){let t=Mt.INVALID_ALT_NUMBER;for(let r=0;r<e.items.length;r++){const n=e.items[r];if(t===Mt.INVALID_ALT_NUMBER)t=n.alt;else if(n.alt!==t)return Mt.INVALID_ALT_NUMBER}return t}addDFAEdge(e,t,r,n){if(this.debug&&console.log("EDGE "+t+" -> "+n+" upon "+this.getTokenName(r)),n===null)return null;if(n=this.addDFAState(e,n),t===null||r<-1||r>this.atn.maxTokenType)return n;if(t.edges===null&&(t.edges=[]),t.edges[r+1]=n,this.debug){const s=this.parser===null?null:this.parser.literalNames,a=this.parser===null?null:this.parser.symbolicNames;console.log(`DFA=
`+e.toString(s,a))}return n}addDFAState(e,t){if(t===Yi.ERROR)return t;const r=e.states.get(t);return r!==null?(this.trace_atn_sim&&console.log("addDFAState "+t+" exists"),r):(t.stateNumber=e.states.length,t.configs.readOnly||(t.configs.optimizeConfigs(this),t.configs.setReadonly(!0)),this.trace_atn_sim&&console.log("addDFAState new "+t),e.states.add(t),this.debug&&console.log("adding new DFA state: "+t),t)}reportAttemptingFullContext(e,t,r,n,s){if(this.debug||this.retry_debug){const a=new dt(n,s+1);console.log("reportAttemptingFullContext decision="+e.decision+":"+r+", input="+this.parser.getTokenStream().getText(a))}this.parser!==null&&this.parser.getErrorListener().reportAttemptingFullContext(this.parser,e,n,s,t,r)}reportContextSensitivity(e,t,r,n,s){if(this.debug||this.retry_debug){const a=new dt(n,s+1);console.log("reportContextSensitivity decision="+e.decision+":"+r+", input="+this.parser.getTokenStream().getText(a))}this.parser!==null&&this.parser.getErrorListener().reportContextSensitivity(this.parser,e,n,s,t,r)}reportAmbiguity(e,t,r,n,s,a,o){if(this.debug||this.retry_debug){const u=new dt(r,n+1);console.log("reportAmbiguity "+a+":"+o+", input="+this.parser.getTokenStream().getText(u))}this.parser!==null&&this.parser.getErrorListener().reportAmbiguity(this.parser,e,r,n,s,a,o)}}class gv{constructor(){this.cache=new qo}add(e){if(e===We.EMPTY)return We.EMPTY;const t=this.cache.get(e)||null;return t!==null?t:(this.cache.set(e,e),e)}get(e){return this.cache.get(e)||null}get length(){return this.cache.length}}const MI={ATN:Mt,ATNDeserializer:bd,LexerATNSimulator:Ft,ParserATNSimulator:fv,PredictionMode:Zt,PredictionContextCache:gv};class Id{constructor(e,t,r){this.dfa=e,this.literalNames=t||[],this.symbolicNames=r||[]}toString(){if(this.dfa.s0===null)return null;let e="";const t=this.dfa.sortedStates();for(let r=0;r<t.length;r++){const n=t[r];if(n.edges!==null){const s=n.edges.length;for(let a=0;a<s;a++){const o=n.edges[a]||null;o!==null&&o.stateNumber!==2147483647&&(e=e.concat(this.getStateString(n)),e=e.concat("-"),e=e.concat(this.getEdgeLabel(a)),e=e.concat("->"),e=e.concat(this.getStateString(o)),e=e.concat(`
`))}}}return e.length===0?null:e}getEdgeLabel(e){return e===0?"EOF":this.literalNames!==null||this.symbolicNames!==null?this.literalNames[e-1]||this.symbolicNames[e-1]:String.fromCharCode(e-1)}getStateString(e){const t=(e.isAcceptState?":":"")+"s"+e.stateNumber+(e.requiresFullContext?"^":"");return e.isAcceptState?e.predicates!==null?t+"=>"+yn(e.predicates):t+"=>"+e.prediction.toString():t}}let pv=class extends Id{constructor(e){super(e,null)}getEdgeLabel(e){return"'"+String.fromCharCode(e)+"'"}};class mv{constructor(e,t){if(t===void 0&&(t=0),this.atnStartState=e,this.decision=t,this._states=new jr,this.s0=null,this.precedenceDfa=!1,e instanceof $s&&e.isPrecedenceDecision){this.precedenceDfa=!0;const r=new Sn(null,new _r);r.edges=[],r.isAcceptState=!1,r.requiresFullContext=!1,this.s0=r}}getPrecedenceStartState(e){if(!this.precedenceDfa)throw"Only precedence DFAs may contain a precedence start state.";return e<0||e>=this.s0.edges.length?null:this.s0.edges[e]||null}setPrecedenceStartState(e,t){if(!this.precedenceDfa)throw"Only precedence DFAs may contain a precedence start state.";e<0||(this.s0.edges[e]=t)}setPrecedenceDfa(e){if(this.precedenceDfa!==e){if(this._states=new jr,e){const t=new Sn(null,new _r);t.edges=[],t.isAcceptState=!1,t.requiresFullContext=!1,this.s0=t}else this.s0=null;this.precedenceDfa=e}}sortedStates(){return this._states.values().sort(function(e,t){return e.stateNumber-t.stateNumber})}toString(e,t){return e=e||null,t=t||null,this.s0===null?"":new Id(this,e,t).toString()}toLexerString(){return this.s0===null?"":new pv(this).toString()}get states(){return this._states}}const OI={DFA:mv,DFASerializer:Id,LexerDFASerializer:pv,PredPrediction:dv},PI={PredictionContext:We},kI={Interval:dt,IntervalSet:ui};class wd{visitTerminal(e){}visitErrorNode(e){}enterEveryRule(e){}exitEveryRule(e){}}class yv{visit(e){return Array.isArray(e)?e.map(function(t){return t.accept(this)},this):e.accept(this)}visitChildren(e){return e.children?this.visit(e.children):null}visitTerminal(e){}visitErrorNode(e){}}class gu{walk(e,t){if(t instanceof ou||t.isErrorNode!==void 0&&t.isErrorNode())e.visitErrorNode(t);else if(t instanceof Ki)e.visitTerminal(t);else{this.enterRule(e,t);for(let r=0;r<t.getChildCount();r++){const n=t.getChild(r);this.walk(e,n)}this.exitRule(e,t)}}enterRule(e,t){const r=t.ruleContext;e.enterEveryRule(r),r.enterRule(e)}exitRule(e,t){const r=t.ruleContext;r.exitRule(e),e.exitEveryRule(r)}}gu.DEFAULT=new gu;const FI={Trees:rv,RuleNode:Go,ErrorNode:ou,TerminalNode:Ki,ParseTreeListener:wd,ParseTreeVisitor:yv,ParseTreeWalker:gu};class Oa extends xn{constructor(e){super({message:"",recognizer:e,input:e.getInputStream(),ctx:e._ctx}),this.offendingToken=e.getCurrentToken()}}class Cd extends xn{constructor(e,t,r){super({message:BI(t,r||null),recognizer:e,input:e.getInputStream(),ctx:e._ctx});const n=e._interp.atn.states[e.state].transitions[0];n instanceof uv?(this.ruleIndex=n.ruleIndex,this.predicateIndex=n.predIndex):(this.ruleIndex=0,this.predicateIndex=0),this.predicate=t,this.offendingToken=e.getCurrentToken()}}function BI(i,e){return e!==null?e:"failed predicate: {"+i+"}?"}class vv extends Ko{constructor(e){super(),e=e||!0,this.exactOnly=e}reportAmbiguity(e,t,r,n,s,a,o){if(this.exactOnly&&!s)return;const u="reportAmbiguity d="+this.getDecisionDescription(e,t)+": ambigAlts="+this.getConflictingAlts(a,o)+", input='"+e.getTokenStream().getText(new dt(r,n))+"'";e.notifyErrorListeners(u)}reportAttemptingFullContext(e,t,r,n,s,a){const o="reportAttemptingFullContext d="+this.getDecisionDescription(e,t)+", input='"+e.getTokenStream().getText(new dt(r,n))+"'";e.notifyErrorListeners(o)}reportContextSensitivity(e,t,r,n,s,a){const o="reportContextSensitivity d="+this.getDecisionDescription(e,t)+", input='"+e.getTokenStream().getText(new dt(r,n))+"'";e.notifyErrorListeners(o)}getDecisionDescription(e,t){const r=t.decision,n=t.atnStartState.ruleIndex,s=e.ruleNames;if(n<0||n>=s.length)return""+r;const a=s[n]||null;return a===null||a.length===0?""+r:`${r} (${a})`}getConflictingAlts(e,t){if(e!==null)return e;const r=new Lr;for(let n=0;n<t.items.length;n++)r.set(t.items[n].alt);return`{${r.values().join(", ")}}`}}class Nd extends Error{constructor(){super(),Error.captureStackTrace(this,Nd)}}class UI{reset(e){}recoverInline(e){}recover(e,t){}sync(e){}inErrorRecoveryMode(e){}reportError(e){}}class pu extends UI{constructor(){super(),this.errorRecoveryMode=!1,this.lastErrorIndex=-1,this.lastErrorStates=null,this.nextTokensContext=null,this.nextTokenState=0}reset(e){this.endErrorCondition(e)}beginErrorCondition(e){this.errorRecoveryMode=!0}inErrorRecoveryMode(e){return this.errorRecoveryMode}endErrorCondition(e){this.errorRecoveryMode=!1,this.lastErrorStates=null,this.lastErrorIndex=-1}reportMatch(e){this.endErrorCondition(e)}reportError(e,t){this.inErrorRecoveryMode(e)||(this.beginErrorCondition(e),t instanceof fu?this.reportNoViableAlternative(e,t):t instanceof Oa?this.reportInputMismatch(e,t):t instanceof Cd?this.reportFailedPredicate(e,t):(console.log("unknown recognition error type: "+t.constructor.name),console.log(t.stack),e.notifyErrorListeners(t.getOffendingToken(),t.getMessage(),t)))}recover(e,t){this.lastErrorIndex===e.getInputStream().index&&this.lastErrorStates!==null&&this.lastErrorStates.indexOf(e.state)>=0&&e.consume(),this.lastErrorIndex=e._input.index,this.lastErrorStates===null&&(this.lastErrorStates=[]),this.lastErrorStates.push(e.state);const r=this.getErrorRecoverySet(e);this.consumeUntil(e,r)}sync(e){if(this.inErrorRecoveryMode(e))return;const t=e._interp.atn.states[e.state],r=e.getTokenStream().LA(1),n=e.atn.nextTokens(t);if(n.contains(r))return this.nextTokensContext=null,void(this.nextTokenState=Pe.INVALID_STATE_NUMBER);if(n.contains(Ee.EPSILON))this.nextTokensContext===null&&(this.nextTokensContext=e._ctx,this.nextTokensState=e._stateNumber);else switch(t.stateType){case Pe.BLOCK_START:case Pe.STAR_BLOCK_START:case Pe.PLUS_BLOCK_START:case Pe.STAR_LOOP_ENTRY:if(this.singleTokenDeletion(e)!==null)return;throw new Oa(e);case Pe.PLUS_LOOP_BACK:case Pe.STAR_LOOP_BACK:{this.reportUnwantedToken(e);const s=new ui;s.addSet(e.getExpectedTokens());const a=s.addSet(this.getErrorRecoverySet(e));this.consumeUntil(e,a)}}}reportNoViableAlternative(e,t){const r=e.getTokenStream();let n;n=r!==null?t.startToken.type===Ee.EOF?"<EOF>":r.getText(new dt(t.startToken.tokenIndex,t.offendingToken.tokenIndex)):"<unknown input>";const s="no viable alternative at input "+this.escapeWSAndQuote(n);e.notifyErrorListeners(s,t.offendingToken,t)}reportInputMismatch(e,t){const r="mismatched input "+this.getTokenErrorDisplay(t.offendingToken)+" expecting "+t.getExpectedTokens().toString(e.literalNames,e.symbolicNames);e.notifyErrorListeners(r,t.offendingToken,t)}reportFailedPredicate(e,t){const r="rule "+e.ruleNames[e._ctx.ruleIndex]+" "+t.message;e.notifyErrorListeners(r,t.offendingToken,t)}reportUnwantedToken(e){if(this.inErrorRecoveryMode(e))return;this.beginErrorCondition(e);const t=e.getCurrentToken(),r="extraneous input "+this.getTokenErrorDisplay(t)+" expecting "+this.getExpectedTokens(e).toString(e.literalNames,e.symbolicNames);e.notifyErrorListeners(r,t,null)}reportMissingToken(e){if(this.inErrorRecoveryMode(e))return;this.beginErrorCondition(e);const t=e.getCurrentToken(),r="missing "+this.getExpectedTokens(e).toString(e.literalNames,e.symbolicNames)+" at "+this.getTokenErrorDisplay(t);e.notifyErrorListeners(r,t,null)}recoverInline(e){const t=this.singleTokenDeletion(e);if(t!==null)return e.consume(),t;if(this.singleTokenInsertion(e))return this.getMissingSymbol(e);throw new Oa(e)}singleTokenInsertion(e){const t=e.getTokenStream().LA(1),r=e._interp.atn,n=r.states[e.state].transitions[0].target;return!!r.nextTokens(n,e._ctx).contains(t)&&(this.reportMissingToken(e),!0)}singleTokenDeletion(e){const t=e.getTokenStream().LA(2);if(this.getExpectedTokens(e).contains(t)){this.reportUnwantedToken(e),e.consume();const r=e.getCurrentToken();return this.reportMatch(e),r}return null}getMissingSymbol(e){const t=e.getCurrentToken(),r=this.getExpectedTokens(e).first();let n;n=r===Ee.EOF?"<missing EOF>":"<missing "+e.literalNames[r]+">";let s=t;const a=e.getTokenStream().LT(-1);return s.type===Ee.EOF&&a!==null&&(s=a),e.getTokenFactory().create(s.source,r,n,Ee.DEFAULT_CHANNEL,-1,-1,s.line,s.column)}getExpectedTokens(e){return e.getExpectedTokens()}getTokenErrorDisplay(e){if(e===null)return"<no token>";let t=e.text;return t===null&&(t=e.type===Ee.EOF?"<EOF>":"<"+e.type+">"),this.escapeWSAndQuote(t)}escapeWSAndQuote(e){return"'"+(e=(e=(e=e.replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/\t/g,"\\t"))+"'"}getErrorRecoverySet(e){const t=e._interp.atn;let r=e._ctx;const n=new ui;for(;r!==null&&r.invokingState>=0;){const s=t.states[r.invokingState].transitions[0],a=t.nextTokens(s.followState);n.addSet(a),r=r.parentCtx}return n.removeOne(Ee.EPSILON),n}consumeUntil(e,t){let r=e.getTokenStream().LA(1);for(;r!==Ee.EOF&&!t.contains(r);)e.consume(),r=e.getTokenStream().LA(1)}}class Ev extends pu{constructor(){super()}recover(e,t){let r=e._ctx;for(;r!==null;)r.exception=t,r=r.parentCtx;throw new Nd(t)}recoverInline(e){this.recover(e,new Oa(e))}sync(e){}}const $I={RecognitionException:xn,NoViableAltException:fu,LexerNoViableAltException:Rd,InputMismatchException:Oa,FailedPredicateException:Cd,DiagnosticErrorListener:vv,BailErrorStrategy:Ev,DefaultErrorStrategy:pu,ErrorListener:Ko};class Gs{constructor(e,t){if(this.name="<empty>",this.strdata=e,this.decodeToUnicodeCodePoints=t||!1,this._index=0,this.data=[],this.decodeToUnicodeCodePoints)for(let r=0;r<this.strdata.length;){const n=this.strdata.codePointAt(r);this.data.push(n),r+=n<=65535?1:2}else{this.data=new Array(this.strdata.length);for(let r=0;r<this.strdata.length;r++)this.data[r]=this.strdata.charCodeAt(r)}this._size=this.data.length}reset(){this._index=0}consume(){if(this._index>=this._size)throw"cannot consume EOF";this._index+=1}LA(e){if(e===0)return 0;e<0&&(e+=1);const t=this._index+e-1;return t<0||t>=this._size?Ee.EOF:this.data[t]}LT(e){return this.LA(e)}mark(){return-1}release(e){}seek(e){e<=this._index?this._index=e:this._index=Math.min(e,this._size)}getText(e,t){if(t>=this._size&&(t=this._size-1),e>=this._size)return"";if(this.decodeToUnicodeCodePoints){let r="";for(let n=e;n<=t;n++)r+=String.fromCodePoint(this.data[n]);return r}return this.strdata.slice(e,t+1)}toString(){return this.strdata}get index(){return this._index}get size(){return this._size}}class Ld extends Gs{constructor(e,t){super(e,t)}}var Av=Bs(763);const xv=typeof process<"u"&&process.versions!=null&&process.versions.node!=null;class Sv extends Ld{static fromPath(e,t,r){if(!xv)throw new Error("FileStream is only available when running in Node!");Av.readFile(e,t,function(n,s){let a=null;s!==null&&(a=new Gs(s,!0)),r(n,a)})}constructor(e,t,r){if(!xv)throw new Error("FileStream is only available when running in Node!");super(Av.readFileSync(e,t||"utf-8"),r),this.fileName=e}}const bv={fromString:function(i){return new Gs(i,!0)},fromBlob:function(i,e,t,r){const n=new window.FileReader;n.onload=function(s){const a=new Gs(s.target.result,!0);t(a)},n.onerror=r,n.readAsText(i,e)},fromBuffer:function(i,e){return new Gs(i.toString(e),!0)},fromPath:function(i,e,t){Sv.fromPath(i,e,t)},fromPathSync:function(i,e){return new Sv(i,e)}},GI={arrayToString:yn,stringToCharArray:function(i){let e=new Uint16Array(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}};class qI{}class Tv extends qI{constructor(e){super(),this.tokenSource=e,this.tokens=[],this.index=-1,this.fetchedEOF=!1}mark(){return 0}release(e){}reset(){this.seek(0)}seek(e){this.lazyInit(),this.index=this.adjustSeekIndex(e)}get size(){return this.tokens.length}get(e){return this.lazyInit(),this.tokens[e]}consume(){let e=!1;if(e=this.index>=0&&(this.fetchedEOF?this.index<this.tokens.length-1:this.index<this.tokens.length),!e&&this.LA(1)===Ee.EOF)throw"cannot consume EOF";this.sync(this.index+1)&&(this.index=this.adjustSeekIndex(this.index+1))}sync(e){const t=e-this.tokens.length+1;return!(t>0)||this.fetch(t)>=t}fetch(e){if(this.fetchedEOF)return 0;for(let t=0;t<e;t++){const r=this.tokenSource.nextToken();if(r.tokenIndex=this.tokens.length,this.tokens.push(r),r.type===Ee.EOF)return this.fetchedEOF=!0,t+1}return e}getTokens(e,t,r){if(r===void 0&&(r=null),e<0||t<0)return null;this.lazyInit();const n=[];t>=this.tokens.length&&(t=this.tokens.length-1);for(let s=e;s<t;s++){const a=this.tokens[s];if(a.type===Ee.EOF)break;(r===null||r.contains(a.type))&&n.push(a)}return n}LA(e){return this.LT(e).type}LB(e){return this.index-e<0?null:this.tokens[this.index-e]}LT(e){if(this.lazyInit(),e===0)return null;if(e<0)return this.LB(-e);const t=this.index+e-1;return this.sync(t),t>=this.tokens.length?this.tokens[this.tokens.length-1]:this.tokens[t]}adjustSeekIndex(e){return e}lazyInit(){this.index===-1&&this.setup()}setup(){this.sync(0),this.index=this.adjustSeekIndex(0)}setTokenSource(e){this.tokenSource=e,this.tokens=[],this.index=-1,this.fetchedEOF=!1}nextTokenOnChannel(e,t){if(this.sync(e),e>=this.tokens.length)return-1;let r=this.tokens[e];for(;r.channel!==t;){if(r.type===Ee.EOF)return-1;e+=1,this.sync(e),r=this.tokens[e]}return e}previousTokenOnChannel(e,t){for(;e>=0&&this.tokens[e].channel!==t;)e-=1;return e}getHiddenTokensToRight(e,t){if(t===void 0&&(t=-1),this.lazyInit(),e<0||e>=this.tokens.length)throw e+" not in 0.."+this.tokens.length-1;const r=this.nextTokenOnChannel(e+1,kt.DEFAULT_TOKEN_CHANNEL),n=e+1,s=r===-1?this.tokens.length-1:r;return this.filterForChannel(n,s,t)}getHiddenTokensToLeft(e,t){if(t===void 0&&(t=-1),this.lazyInit(),e<0||e>=this.tokens.length)throw e+" not in 0.."+this.tokens.length-1;const r=this.previousTokenOnChannel(e-1,kt.DEFAULT_TOKEN_CHANNEL);if(r===e-1)return null;const n=r+1,s=e-1;return this.filterForChannel(n,s,t)}filterForChannel(e,t,r){const n=[];for(let s=e;s<t+1;s++){const a=this.tokens[s];r===-1?a.channel!==kt.DEFAULT_TOKEN_CHANNEL&&n.push(a):a.channel===r&&n.push(a)}return n.length===0?null:n}getSourceName(){return this.tokenSource.getSourceName()}getText(e){this.lazyInit(),this.fill(),e||(e=new dt(0,this.tokens.length-1));let t=e.start;t instanceof Ee&&(t=t.tokenIndex);let r=e.stop;if(r instanceof Ee&&(r=r.tokenIndex),t===null||r===null||t<0||r<0)return"";r>=this.tokens.length&&(r=this.tokens.length-1);let n="";for(let s=t;s<r+1;s++){const a=this.tokens[s];if(a.type===Ee.EOF)break;n+=a.text}return n}fill(){for(this.lazyInit();this.fetch(1e3)===1e3;);}}Object.defineProperty(Tv,"size",{get:function(){return this.tokens.length}});class Dv extends Tv{constructor(e,t){super(e),this.channel=t===void 0?Ee.DEFAULT_CHANNEL:t}adjustSeekIndex(e){return this.nextTokenOnChannel(e,this.channel)}LB(e){if(e===0||this.index-e<0)return null;let t=this.index,r=1;for(;r<=e;)t=this.previousTokenOnChannel(t-1,this.channel),r+=1;return t<0?null:this.tokens[t]}LT(e){if(this.lazyInit(),e===0)return null;if(e<0)return this.LB(-e);let t=this.index,r=1;for(;r<e;)this.sync(t+1)&&(t=this.nextTokenOnChannel(t+1,this.channel)),r+=1;return this.tokens[t]}getNumberOfOnChannelTokens(){let e=0;this.fill();for(let t=0;t<this.tokens.length;t++){const r=this.tokens[t];if(r.channel===this.channel&&(e+=1),r.type===Ee.EOF)break}return e}}class HI extends wd{constructor(e){super(),this.parser=e}enterEveryRule(e){console.log("enter   "+this.parser.ruleNames[e.ruleIndex]+", LT(1)="+this.parser._input.LT(1).text)}visitTerminal(e){console.log("consume "+e.symbol+" rule "+this.parser.ruleNames[this.parser._ctx.ruleIndex])}exitEveryRule(e){console.log("exit    "+this.parser.ruleNames[e.ruleIndex]+", LT(1)="+this.parser._input.LT(1).text)}}class _d extends du{constructor(e){super(),this._input=null,this._errHandler=new pu,this._precedenceStack=[],this._precedenceStack.push(0),this._ctx=null,this.buildParseTrees=!0,this._tracer=null,this._parseListeners=null,this._syntaxErrors=0,this.setInputStream(e)}reset(){this._input!==null&&this._input.seek(0),this._errHandler.reset(this),this._ctx=null,this._syntaxErrors=0,this.setTrace(!1),this._precedenceStack=[],this._precedenceStack.push(0),this._interp!==null&&this._interp.reset()}match(e){let t=this.getCurrentToken();return t.type===e?(this._errHandler.reportMatch(this),this.consume()):(t=this._errHandler.recoverInline(this),this.buildParseTrees&&t.tokenIndex===-1&&this._ctx.addErrorNode(t)),t}matchWildcard(){let e=this.getCurrentToken();return e.type>0?(this._errHandler.reportMatch(this),this.consume()):(e=this._errHandler.recoverInline(this),this.buildParseTrees&&e.tokenIndex===-1&&this._ctx.addErrorNode(e)),e}getParseListeners(){return this._parseListeners||[]}addParseListener(e){if(e===null)throw"listener";this._parseListeners===null&&(this._parseListeners=[]),this._parseListeners.push(e)}removeParseListener(e){if(this._parseListeners!==null){const t=this._parseListeners.indexOf(e);t>=0&&this._parseListeners.splice(t,1),this._parseListeners.length===0&&(this._parseListeners=null)}}removeParseListeners(){this._parseListeners=null}triggerEnterRuleEvent(){if(this._parseListeners!==null){const e=this._ctx;this._parseListeners.forEach(function(t){t.enterEveryRule(e),e.enterRule(t)})}}triggerExitRuleEvent(){if(this._parseListeners!==null){const e=this._ctx;this._parseListeners.slice(0).reverse().forEach(function(t){e.exitRule(t),t.exitEveryRule(e)})}}getTokenFactory(){return this._input.tokenSource._factory}setTokenFactory(e){this._input.tokenSource._factory=e}getATNWithBypassAlts(){const e=this.getSerializedATN();if(e===null)throw"The current parser does not support an ATN with bypass alternatives.";let t=this.bypassAltsAtnCache[e];if(t===null){const r=new Vo;r.generateRuleBypassTransitions=!0,t=new bd(r).deserialize(e),this.bypassAltsAtnCache[e]=t}return t}getInputStream(){return this.getTokenStream()}setInputStream(e){this.setTokenStream(e)}getTokenStream(){return this._input}setTokenStream(e){this._input=null,this.reset(),this._input=e}get syntaxErrorsCount(){return this._syntaxErrors}getCurrentToken(){return this._input.LT(1)}notifyErrorListeners(e,t,r){r=r||null,(t=t||null)===null&&(t=this.getCurrentToken()),this._syntaxErrors+=1;const n=t.line,s=t.column;this.getErrorListener().syntaxError(this,t,n,s,e,r)}consume(){const e=this.getCurrentToken();e.type!==Ee.EOF&&this.getInputStream().consume();const t=this._parseListeners!==null&&this._parseListeners.length>0;if(this.buildParseTrees||t){let r;r=this._errHandler.inErrorRecoveryMode(this)?this._ctx.addErrorNode(e):this._ctx.addTokenNode(e),r.invokingState=this.state,t&&this._parseListeners.forEach(function(n){r instanceof ou||r.isErrorNode!==void 0&&r.isErrorNode()?n.visitErrorNode(r):r instanceof Ki&&n.visitTerminal(r)})}return e}addContextToParseTree(){this._ctx.parentCtx!==null&&this._ctx.parentCtx.addChild(this._ctx)}enterRule(e,t,r){this.state=t,this._ctx=e,this._ctx.start=this._input.LT(1),this.buildParseTrees&&this.addContextToParseTree(),this.triggerEnterRuleEvent()}exitRule(){this._ctx.stop=this._input.LT(-1),this.triggerExitRuleEvent(),this.state=this._ctx.invokingState,this._ctx=this._ctx.parentCtx}enterOuterAlt(e,t){e.setAltNumber(t),this.buildParseTrees&&this._ctx!==e&&this._ctx.parentCtx!==null&&(this._ctx.parentCtx.removeLastChild(),this._ctx.parentCtx.addChild(e)),this._ctx=e}getPrecedence(){return this._precedenceStack.length===0?-1:this._precedenceStack[this._precedenceStack.length-1]}enterRecursionRule(e,t,r,n){this.state=t,this._precedenceStack.push(n),this._ctx=e,this._ctx.start=this._input.LT(1),this.triggerEnterRuleEvent()}pushNewRecursionContext(e,t,r){const n=this._ctx;n.parentCtx=e,n.invokingState=t,n.stop=this._input.LT(-1),this._ctx=e,this._ctx.start=n.start,this.buildParseTrees&&this._ctx.addChild(n),this.triggerEnterRuleEvent()}unrollRecursionContexts(e){this._precedenceStack.pop(),this._ctx.stop=this._input.LT(-1);const t=this._ctx,r=this.getParseListeners();if(r!==null&&r.length>0)for(;this._ctx!==e;)this.triggerExitRuleEvent(),this._ctx=this._ctx.parentCtx;else this._ctx=e;t.parentCtx=e,this.buildParseTrees&&e!==null&&e.addChild(t)}getInvokingContext(e){let t=this._ctx;for(;t!==null;){if(t.ruleIndex===e)return t;t=t.parentCtx}return null}precpred(e,t){return t>=this._precedenceStack[this._precedenceStack.length-1]}inContext(e){return!1}isExpectedToken(e){const t=this._interp.atn;let r=this._ctx;const n=t.states[this.state];let s=t.nextTokens(n);if(s.contains(e))return!0;if(!s.contains(Ee.EPSILON))return!1;for(;r!==null&&r.invokingState>=0&&s.contains(Ee.EPSILON);){const a=t.states[r.invokingState].transitions[0];if(s=t.nextTokens(a.followState),s.contains(e))return!0;r=r.parentCtx}return!(!s.contains(Ee.EPSILON)||e!==Ee.EOF)}getExpectedTokens(){return this._interp.atn.getExpectedTokens(this.state,this._ctx)}getExpectedTokensWithinCurrentRule(){const e=this._interp.atn,t=e.states[this.state];return e.nextTokens(t)}getRuleIndex(e){const t=this.getRuleIndexMap()[e];return t!==null?t:-1}getRuleInvocationStack(e){(e=e||null)===null&&(e=this._ctx);const t=[];for(;e!==null;){const r=e.ruleIndex;r<0?t.push("n/a"):t.push(this.ruleNames[r]),e=e.parentCtx}return t}getDFAStrings(){return this._interp.decisionToDFA.toString()}dumpDFA(){let e=!1;for(let t=0;t<this._interp.decisionToDFA.length;t++){const r=this._interp.decisionToDFA[t];r.states.length>0&&(e&&console.log(),this.printer.println("Decision "+r.decision+":"),this.printer.print(r.toString(this.literalNames,this.symbolicNames)),e=!0)}}getSourceName(){return this._input.getSourceName()}setTrace(e){e?(this._tracer!==null&&this.removeParseListener(this._tracer),this._tracer=new HI(this),this.addParseListener(this._tracer)):(this.removeParseListener(this._tracer),this._tracer=null)}}_d.bypassAltsAtnCache={};class Rv extends Ki{constructor(e){super(),this.parentCtx=null,this.symbol=e}getChild(e){return null}getSymbol(){return this.symbol}getParent(){return this.parentCtx}getPayload(){return this.symbol}getSourceInterval(){if(this.symbol===null)return dt.INVALID_INTERVAL;const e=this.symbol.tokenIndex;return new dt(e,e)}getChildCount(){return 0}accept(e){return e.visitTerminal(this)}getText(){return this.symbol.text}toString(){return this.symbol.type===Ee.EOF?"<EOF>":this.symbol.text}}class Iv extends Rv{constructor(e){super(e)}isErrorNode(){return!0}accept(e){return e.visitErrorNode(this)}}class Md extends Us{constructor(e,t){super(e,t),this.children=null,this.start=null,this.stop=null,this.exception=null}copyFrom(e){this.parentCtx=e.parentCtx,this.invokingState=e.invokingState,this.children=null,this.start=e.start,this.stop=e.stop,e.children&&(this.children=[],e.children.map(function(t){t instanceof Iv&&(this.children.push(t),t.parentCtx=this)},this))}enterRule(e){}exitRule(e){}addChild(e){return this.children===null&&(this.children=[]),this.children.push(e),e}removeLastChild(){this.children!==null&&this.children.pop()}addTokenNode(e){const t=new Rv(e);return this.addChild(t),t.parentCtx=this,t}addErrorNode(e){const t=new Iv(e);return this.addChild(t),t.parentCtx=this,t}getChild(e,t){if(t=t||null,this.children===null||e<0||e>=this.children.length)return null;if(t===null)return this.children[e];for(let r=0;r<this.children.length;r++){const n=this.children[r];if(n instanceof t){if(e===0)return n;e-=1}}return null}getToken(e,t){if(this.children===null||t<0||t>=this.children.length)return null;for(let r=0;r<this.children.length;r++){const n=this.children[r];if(n instanceof Ki&&n.symbol.type===e){if(t===0)return n;t-=1}}return null}getTokens(e){if(this.children===null)return[];{const t=[];for(let r=0;r<this.children.length;r++){const n=this.children[r];n instanceof Ki&&n.symbol.type===e&&t.push(n)}return t}}getTypedRuleContext(e,t){return this.getChild(t,e)}getTypedRuleContexts(e){if(this.children===null)return[];{const t=[];for(let r=0;r<this.children.length;r++){const n=this.children[r];n instanceof e&&t.push(n)}return t}}getChildCount(){return this.children===null?0:this.children.length}getSourceInterval(){return this.start===null||this.stop===null?dt.INVALID_INTERVAL:new dt(this.start.tokenIndex,this.stop.tokenIndex)}}Us.EMPTY=new Md;const Pn=class Pn{constructor(e){this.tokens=e,this.programs=new Map}getTokenStream(){return this.tokens}insertAfter(e,t){let r,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Pn.DEFAULT_PROGRAM_NAME;r=typeof e=="number"?e:e.tokenIndex;let s=this.getProgram(n),a=new Cv(this.tokens,r,s.length,t);s.push(a)}insertBefore(e,t){let r,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Pn.DEFAULT_PROGRAM_NAME;r=typeof e=="number"?e:e.tokenIndex;const s=this.getProgram(n),a=new Pa(this.tokens,r,s.length,t);s.push(a)}replaceSingle(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Pn.DEFAULT_PROGRAM_NAME;this.replace(e,e,t,r)}replace(e,t,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Pn.DEFAULT_PROGRAM_NAME;if(typeof e!="number"&&(e=e.tokenIndex),typeof t!="number"&&(t=t.tokenIndex),e>t||e<0||t<0||t>=this.tokens.size)throw new RangeError(`replace: range invalid: ${e}..${t}(size=${this.tokens.size})`);let s=this.getProgram(n),a=new yu(this.tokens,e,t,s.length,r);s.push(a)}delete(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Pn.DEFAULT_PROGRAM_NAME;t===void 0&&(t=e),this.replace(e,t,null,r)}getProgram(e){let t=this.programs.get(e);return t==null&&(t=this.initializeProgram(e)),t}initializeProgram(e){const t=[];return this.programs.set(e,t),t}getText(e){let t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Pn.DEFAULT_PROGRAM_NAME;t=e instanceof dt?e:new dt(0,this.tokens.size-1),typeof e=="string"&&(r=e);const n=this.programs.get(r);let s=t.start,a=t.stop;if(a>this.tokens.size-1&&(a=this.tokens.size-1),s<0&&(s=0),n==null||n.length===0)return this.tokens.getText(new dt(s,a));let o=[],u=this.reduceToSingleOperationPerIndex(n),l=s;for(;l<=a&&l<this.tokens.size;){let h=u.get(l);u.delete(l);let d=this.tokens.get(l);h==null?(d.type!==Ee.EOF&&o.push(String(d.text)),l++):l=h.execute(o)}if(a===this.tokens.size-1)for(const h of u.values())h.index>=this.tokens.size-1&&o.push(h.text.toString());return o.join("")}reduceToSingleOperationPerIndex(e){for(let r=0;r<e.length;r++){let n=e[r];if(n==null||!(n instanceof yu))continue;let s=n,a=this.getKindOfOps(e,Pa,r);for(let u of a)u.index===s.index?(e[u.instructionIndex]=void 0,s.text=u.text.toString()+(s.text!=null?s.text.toString():"")):u.index>s.index&&u.index<=s.lastIndex&&(e[u.instructionIndex]=void 0);let o=this.getKindOfOps(e,yu,r);for(let u of o){if(u.index>=s.index&&u.lastIndex<=s.lastIndex){e[u.instructionIndex]=void 0;continue}let l=u.lastIndex<s.index||u.index>s.lastIndex;if(u.text!=null||s.text!=null||l){if(!l)throw new Error(`replace op boundaries of ${s} overlap with previous ${u}`)}else e[u.instructionIndex]=void 0,s.index=Math.min(u.index,s.index),s.lastIndex=Math.max(u.lastIndex,s.lastIndex)}}for(let r=0;r<e.length;r++){let n=e[r];if(n==null||!(n instanceof Pa))continue;let s=n,a=this.getKindOfOps(e,Pa,r);for(let u of a)u.index===s.index&&(u instanceof Cv?(s.text=this.catOpText(u.text,s.text),e[u.instructionIndex]=void 0):u instanceof Pa&&(s.text=this.catOpText(s.text,u.text),e[u.instructionIndex]=void 0));let o=this.getKindOfOps(e,yu,r);for(let u of o)if(s.index!==u.index){if(s.index>=u.index&&s.index<=u.lastIndex)throw new Error(`insert op ${s} within boundaries of previous ${u}`)}else u.text=this.catOpText(s.text,u.text),e[r]=void 0}let t=new Map;for(let r of e)if(r!=null){if(t.get(r.index)!=null)throw new Error("should only be one op per index");t.set(r.index,r)}return t}catOpText(e,t){let r="",n="";return e!=null&&(r=e.toString()),t!=null&&(n=t.toString()),r+n}getKindOfOps(e,t,r){return e.slice(0,r).filter(n=>n&&n instanceof t)}};fe(Pn,"DEFAULT_PROGRAM_NAME","default");let mu=Pn;class wv{constructor(e,t,r,n){this.tokens=e,this.instructionIndex=r,this.index=t,this.text=n===void 0?"":n}toString(){let e=this.constructor.name;const t=e.indexOf("$");return e=e.substring(t+1,e.length),"<"+e+"@"+this.tokens.get(this.index)+':"'+this.text+'">'}}class Pa extends wv{constructor(e,t,r,n){super(e,t,r,n)}execute(e){return this.text&&e.push(this.text.toString()),this.tokens.get(this.index).type!==Ee.EOF&&e.push(String(this.tokens.get(this.index).text)),this.index+1}}class Cv extends Pa{constructor(e,t,r,n){super(e,t+1,r,n)}}class yu extends wv{constructor(e,t,r,n,s){super(e,t,n,s),this.lastIndex=r}execute(e){return this.text&&e.push(this.text.toString()),this.lastIndex+1}toString(){return this.text==null?"<DeleteOp@"+this.tokens.get(this.index)+".."+this.tokens.get(this.lastIndex)+">":"<ReplaceOp@"+this.tokens.get(this.index)+".."+this.tokens.get(this.lastIndex)+':"'+this.text+'">'}}const VI={atn:MI,dfa:OI,context:PI,misc:kI,tree:FI,error:$I,Token:Ee,CommonToken:An,CharStreams:bv,CharStream:Gs,InputStream:Ld,CommonTokenStream:Dv,Lexer:kt,Parser:_d,ParserRuleContext:Md,Interval:dt,IntervalSet:ui,LL1Analyzer:lu,Utils:GI,TokenStreamRewriter:mu};lt.MG,lt.fr,lt.sR,lt.Zo,lt.iH,lt.rt,lt.jB,lt.M8,lt.$t,lt.aq,lt.pG,lt.eP,lt.KU,lt.zW,lt.IX,lt.mY,lt.a7,lt.JG,lt.ay,lt.X2,lt.WU,lt.Uw,lt.gw,lt.iX,lt.re,lt.Pg,lt.tD,lt.R$,lt.Dj,lt.m7,lt.NZ,lt.xo,lt.ou,lt.qC,lt.mD;var KI=lt.Ay,WI={63:i=>{i.exports=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,s,a;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(s=n;s--!=0;)if(!e(t[s],r[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(a=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(s=n;s--!=0;)if(!Object.prototype.hasOwnProperty.call(r,a[s]))return!1;for(s=n;s--!=0;){var o=a[s];if(!e(t[o],r[o]))return!1}return!0}return t!=t&&r!=r}}},Nv={};function is(i){var e=Nv[i];if(e!==void 0)return e.exports;var t=Nv[i]={exports:{}};return WI[i](t,t.exports,is),t.exports}is.d=(i,e)=>{for(var t in e)is.o(e,t)&&!is.o(i,t)&&Object.defineProperty(i,t,{enumerable:!0,get:e[t]})},is.o=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);var ka={};(()=>{is.d(ka,{yS:()=>r,Qc:()=>V,Hb:()=>B,IO:()=>xe,Pz:()=>Me});const i=(e={default:()=>KI},t={},is.d(t,e),t);var e,t;class r extends Error{constructor(D,S,P){super(P),this.line=D,this.charPositionInLine=S,this.msg=P}}const n=new i.default.atn.ATNDeserializer().deserialize([4,0,45,356,6,-1,2,0,7,0,2,1,7,1,2,2,7,2,2,3,7,3,2,4,7,4,2,5,7,5,2,6,7,6,2,7,7,7,2,8,7,8,2,9,7,9,2,10,7,10,2,11,7,11,2,12,7,12,2,13,7,13,2,14,7,14,2,15,7,15,2,16,7,16,2,17,7,17,2,18,7,18,2,19,7,19,2,20,7,20,2,21,7,21,2,22,7,22,2,23,7,23,2,24,7,24,2,25,7,25,2,26,7,26,2,27,7,27,2,28,7,28,2,29,7,29,2,30,7,30,2,31,7,31,2,32,7,32,2,33,7,33,2,34,7,34,2,35,7,35,2,36,7,36,2,37,7,37,2,38,7,38,2,39,7,39,2,40,7,40,2,41,7,41,2,42,7,42,2,43,7,43,2,44,7,44,2,45,7,45,2,46,7,46,2,47,7,47,2,48,7,48,2,49,7,49,2,50,7,50,2,51,7,51,2,52,7,52,1,0,1,0,1,1,1,1,1,1,1,2,1,2,1,3,1,3,1,4,1,4,1,5,1,5,1,5,1,6,1,6,1,6,1,7,1,7,1,7,1,8,1,8,1,9,1,9,1,9,1,10,1,10,1,11,1,11,1,11,1,12,1,12,1,12,1,13,1,13,1,13,1,13,1,13,1,14,1,14,1,14,1,14,1,14,1,14,1,15,1,15,1,15,1,15,1,15,1,15,1,15,1,15,1,15,1,15,1,15,1,16,1,16,1,16,1,16,1,16,1,16,1,16,1,16,1,17,1,17,1,17,1,17,1,17,1,17,1,17,1,17,1,17,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,20,1,20,1,20,1,20,1,20,1,20,1,20,1,21,1,21,1,22,1,22,1,22,1,23,1,23,1,23,1,23,1,23,1,24,1,24,1,24,1,24,1,24,1,24,1,25,1,25,1,25,1,25,1,25,1,26,1,26,1,27,1,27,1,28,1,28,1,29,1,29,1,30,1,30,1,31,1,31,1,32,1,32,1,33,1,33,1,34,1,34,1,35,1,35,1,35,1,36,1,36,1,37,1,37,1,38,5,38,250,8,38,10,38,12,38,253,9,38,1,39,1,39,5,39,257,8,39,10,39,12,39,260,9,39,1,39,1,39,1,40,5,40,265,8,40,10,40,12,40,268,9,40,1,40,1,40,5,40,272,8,40,10,40,12,40,275,9,40,1,41,4,41,278,8,41,11,41,12,41,279,1,42,4,42,283,8,42,11,42,12,42,284,1,42,1,42,1,43,3,43,290,8,43,1,43,1,43,1,43,4,43,295,8,43,11,43,12,43,296,3,43,299,8,43,1,43,3,43,302,8,43,1,44,1,44,1,44,5,44,307,8,44,10,44,12,44,310,9,44,1,44,1,44,1,44,1,44,5,44,316,8,44,10,44,12,44,319,9,44,1,44,3,44,322,8,44,1,45,1,45,1,45,3,45,327,8,45,1,46,1,46,1,46,3,46,332,8,46,1,47,1,47,1,47,1,47,1,47,1,47,1,48,1,48,1,49,1,49,1,50,1,50,1,51,4,51,347,8,51,11,51,12,51,348,1,52,1,52,3,52,353,8,52,1,52,1,52,1,258,0,53,1,1,3,2,5,3,7,4,9,5,11,6,13,7,15,8,17,9,19,10,21,11,23,12,25,13,27,14,29,15,31,16,33,17,35,18,37,19,39,20,41,21,43,22,45,23,47,24,49,25,51,26,53,27,55,28,57,29,59,30,61,31,63,32,65,33,67,34,69,35,71,36,73,37,75,38,77,39,79,40,81,41,83,42,85,43,87,44,89,45,91,0,93,0,95,0,97,0,99,0,101,0,103,0,105,0,1,0,14,6,0,103,103,105,105,109,109,115,115,117,117,121,121,4,0,45,45,65,90,95,95,97,122,3,0,65,90,95,95,97,122,4,0,48,57,65,90,95,95,97,122,2,0,95,95,128,65535,3,0,9,10,13,13,32,32,1,0,48,57,8,0,39,39,47,47,92,92,98,98,102,102,110,110,114,114,116,116,8,0,34,34,47,47,92,92,98,98,102,102,110,110,114,114,116,116,3,0,48,57,65,70,97,102,3,0,0,31,39,39,92,92,3,0,0,31,34,34,92,92,2,0,69,69,101,101,2,0,43,43,45,45,366,0,1,1,0,0,0,0,3,1,0,0,0,0,5,1,0,0,0,0,7,1,0,0,0,0,9,1,0,0,0,0,11,1,0,0,0,0,13,1,0,0,0,0,15,1,0,0,0,0,17,1,0,0,0,0,19,1,0,0,0,0,21,1,0,0,0,0,23,1,0,0,0,0,25,1,0,0,0,0,27,1,0,0,0,0,29,1,0,0,0,0,31,1,0,0,0,0,33,1,0,0,0,0,35,1,0,0,0,0,37,1,0,0,0,0,39,1,0,0,0,0,41,1,0,0,0,0,43,1,0,0,0,0,45,1,0,0,0,0,47,1,0,0,0,0,49,1,0,0,0,0,51,1,0,0,0,0,53,1,0,0,0,0,55,1,0,0,0,0,57,1,0,0,0,0,59,1,0,0,0,0,61,1,0,0,0,0,63,1,0,0,0,0,65,1,0,0,0,0,67,1,0,0,0,0,69,1,0,0,0,0,71,1,0,0,0,0,73,1,0,0,0,0,75,1,0,0,0,0,77,1,0,0,0,0,79,1,0,0,0,0,81,1,0,0,0,0,83,1,0,0,0,0,85,1,0,0,0,0,87,1,0,0,0,0,89,1,0,0,0,1,107,1,0,0,0,3,109,1,0,0,0,5,112,1,0,0,0,7,114,1,0,0,0,9,116,1,0,0,0,11,118,1,0,0,0,13,121,1,0,0,0,15,124,1,0,0,0,17,127,1,0,0,0,19,129,1,0,0,0,21,132,1,0,0,0,23,134,1,0,0,0,25,137,1,0,0,0,27,140,1,0,0,0,29,145,1,0,0,0,31,151,1,0,0,0,33,162,1,0,0,0,35,170,1,0,0,0,37,179,1,0,0,0,39,188,1,0,0,0,41,195,1,0,0,0,43,202,1,0,0,0,45,204,1,0,0,0,47,207,1,0,0,0,49,212,1,0,0,0,51,218,1,0,0,0,53,223,1,0,0,0,55,225,1,0,0,0,57,227,1,0,0,0,59,229,1,0,0,0,61,231,1,0,0,0,63,233,1,0,0,0,65,235,1,0,0,0,67,237,1,0,0,0,69,239,1,0,0,0,71,241,1,0,0,0,73,244,1,0,0,0,75,246,1,0,0,0,77,251,1,0,0,0,79,254,1,0,0,0,81,266,1,0,0,0,83,277,1,0,0,0,85,282,1,0,0,0,87,289,1,0,0,0,89,321,1,0,0,0,91,323,1,0,0,0,93,328,1,0,0,0,95,333,1,0,0,0,97,339,1,0,0,0,99,341,1,0,0,0,101,343,1,0,0,0,103,346,1,0,0,0,105,350,1,0,0,0,107,108,5,64,0,0,108,2,1,0,0,0,109,110,5,46,0,0,110,111,5,46,0,0,111,4,1,0,0,0,112,113,5,36,0,0,113,6,1,0,0,0,114,115,5,46,0,0,115,8,1,0,0,0,116,117,5,42,0,0,117,10,1,0,0,0,118,119,5,38,0,0,119,120,5,38,0,0,120,12,1,0,0,0,121,122,5,61,0,0,122,123,5,61,0,0,123,14,1,0,0,0,124,125,5,62,0,0,125,126,5,61,0,0,126,16,1,0,0,0,127,128,5,62,0,0,128,18,1,0,0,0,129,130,5,60,0,0,130,131,5,61,0,0,131,20,1,0,0,0,132,133,5,60,0,0,133,22,1,0,0,0,134,135,5,33,0,0,135,136,5,61,0,0,136,24,1,0,0,0,137,138,5,61,0,0,138,139,5,126,0,0,139,26,1,0,0,0,140,141,5,32,0,0,141,142,5,105,0,0,142,143,5,110,0,0,143,144,5,32,0,0,144,28,1,0,0,0,145,146,5,32,0,0,146,147,5,110,0,0,147,148,5,105,0,0,148,149,5,110,0,0,149,150,5,32,0,0,150,30,1,0,0,0,151,152,5,32,0,0,152,153,5,115,0,0,153,154,5,117,0,0,154,155,5,98,0,0,155,156,5,115,0,0,156,157,5,101,0,0,157,158,5,116,0,0,158,159,5,111,0,0,159,160,5,102,0,0,160,161,5,32,0,0,161,32,1,0,0,0,162,163,5,32,0,0,163,164,5,97,0,0,164,165,5,110,0,0,165,166,5,121,0,0,166,167,5,111,0,0,167,168,5,102,0,0,168,169,5,32,0,0,169,34,1,0,0,0,170,171,5,32,0,0,171,172,5,110,0,0,172,173,5,111,0,0,173,174,5,110,0,0,174,175,5,101,0,0,175,176,5,111,0,0,176,177,5,102,0,0,177,178,5,32,0,0,178,36,1,0,0,0,179,180,5,32,0,0,180,181,5,115,0,0,181,182,5,105,0,0,182,183,5,122,0,0,183,184,5,101,0,0,184,185,5,111,0,0,185,186,5,102,0,0,186,187,5,32,0,0,187,38,1,0,0,0,188,189,5,32,0,0,189,190,5,115,0,0,190,191,5,105,0,0,191,192,5,122,0,0,192,193,5,101,0,0,193,194,5,32,0,0,194,40,1,0,0,0,195,196,5,32,0,0,196,197,5,101,0,0,197,198,5,109,0,0,198,199,5,112,0,0,199,200,5,116,0,0,200,201,5,121,0,0,201,42,1,0,0,0,202,203,5,33,0,0,203,44,1,0,0,0,204,205,5,124,0,0,205,206,5,124,0,0,206,46,1,0,0,0,207,208,5,116,0,0,208,209,5,114,0,0,209,210,5,117,0,0,210,211,5,101,0,0,211,48,1,0,0,0,212,213,5,102,0,0,213,214,5,97,0,0,214,215,5,108,0,0,215,216,5,115,0,0,216,217,5,101,0,0,217,50,1,0,0,0,218,219,5,110,0,0,219,220,5,117,0,0,220,221,5,108,0,0,221,222,5,108,0,0,222,52,1,0,0,0,223,224,5,123,0,0,224,54,1,0,0,0,225,226,5,125,0,0,226,56,1,0,0,0,227,228,5,91,0,0,228,58,1,0,0,0,229,230,5,93,0,0,230,60,1,0,0,0,231,232,5,58,0,0,232,62,1,0,0,0,233,234,5,44,0,0,234,64,1,0,0,0,235,236,5,40,0,0,236,66,1,0,0,0,237,238,5,41,0,0,238,68,1,0,0,0,239,240,5,63,0,0,240,70,1,0,0,0,241,242,5,45,0,0,242,243,5,32,0,0,243,72,1,0,0,0,244,245,5,43,0,0,245,74,1,0,0,0,246,247,5,47,0,0,247,76,1,0,0,0,248,250,7,0,0,0,249,248,1,0,0,0,250,253,1,0,0,0,251,249,1,0,0,0,251,252,1,0,0,0,252,78,1,0,0,0,253,251,1,0,0,0,254,258,5,47,0,0,255,257,9,0,0,0,256,255,1,0,0,0,257,260,1,0,0,0,258,259,1,0,0,0,258,256,1,0,0,0,259,261,1,0,0,0,260,258,1,0,0,0,261,262,5,47,0,0,262,80,1,0,0,0,263,265,7,1,0,0,264,263,1,0,0,0,265,268,1,0,0,0,266,264,1,0,0,0,266,267,1,0,0,0,267,269,1,0,0,0,268,266,1,0,0,0,269,273,7,2,0,0,270,272,7,3,0,0,271,270,1,0,0,0,272,275,1,0,0,0,273,271,1,0,0,0,273,274,1,0,0,0,274,82,1,0,0,0,275,273,1,0,0,0,276,278,7,4,0,0,277,276,1,0,0,0,278,279,1,0,0,0,279,277,1,0,0,0,279,280,1,0,0,0,280,84,1,0,0,0,281,283,7,5,0,0,282,281,1,0,0,0,283,284,1,0,0,0,284,282,1,0,0,0,284,285,1,0,0,0,285,286,1,0,0,0,286,287,6,42,0,0,287,86,1,0,0,0,288,290,5,45,0,0,289,288,1,0,0,0,289,290,1,0,0,0,290,291,1,0,0,0,291,298,3,103,51,0,292,294,5,46,0,0,293,295,7,6,0,0,294,293,1,0,0,0,295,296,1,0,0,0,296,294,1,0,0,0,296,297,1,0,0,0,297,299,1,0,0,0,298,292,1,0,0,0,298,299,1,0,0,0,299,301,1,0,0,0,300,302,3,105,52,0,301,300,1,0,0,0,301,302,1,0,0,0,302,88,1,0,0,0,303,308,5,34,0,0,304,307,3,93,46,0,305,307,3,101,50,0,306,304,1,0,0,0,306,305,1,0,0,0,307,310,1,0,0,0,308,306,1,0,0,0,308,309,1,0,0,0,309,311,1,0,0,0,310,308,1,0,0,0,311,322,5,34,0,0,312,317,5,39,0,0,313,316,3,91,45,0,314,316,3,99,49,0,315,313,1,0,0,0,315,314,1,0,0,0,316,319,1,0,0,0,317,315,1,0,0,0,317,318,1,0,0,0,318,320,1,0,0,0,319,317,1,0,0,0,320,322,5,39,0,0,321,303,1,0,0,0,321,312,1,0,0,0,322,90,1,0,0,0,323,326,5,92,0,0,324,327,7,7,0,0,325,327,3,95,47,0,326,324,1,0,0,0,326,325,1,0,0,0,327,92,1,0,0,0,328,331,5,92,0,0,329,332,7,8,0,0,330,332,3,95,47,0,331,329,1,0,0,0,331,330,1,0,0,0,332,94,1,0,0,0,333,334,5,117,0,0,334,335,3,97,48,0,335,336,3,97,48,0,336,337,3,97,48,0,337,338,3,97,48,0,338,96,1,0,0,0,339,340,7,9,0,0,340,98,1,0,0,0,341,342,8,10,0,0,342,100,1,0,0,0,343,344,8,11,0,0,344,102,1,0,0,0,345,347,7,6,0,0,346,345,1,0,0,0,347,348,1,0,0,0,348,346,1,0,0,0,348,349,1,0,0,0,349,104,1,0,0,0,350,352,7,12,0,0,351,353,7,13,0,0,352,351,1,0,0,0,352,353,1,0,0,0,353,354,1,0,0,0,354,355,3,103,51,0,355,106,1,0,0,0,20,0,251,258,266,273,279,284,289,296,298,301,306,308,315,317,321,326,331,348,352,1,6,0,0]),s=n.decisionToState.map((K,D)=>new i.default.dfa.DFA(K,D));class a extends i.default.Lexer{constructor(D){super(D),this._interp=new i.default.atn.LexerATNSimulator(this,n,s,new i.default.atn.PredictionContextCache)}}fe(a,"grammarFileName","JSONPath.g4"),fe(a,"channelNames",["DEFAULT_TOKEN_CHANNEL","HIDDEN"]),fe(a,"modeNames",["DEFAULT_MODE"]),fe(a,"literalNames",[null,"'@'","'..'","'$'","'.'","'*'","'&&'","'=='","'>='","'>'","'<='","'<'","'!='","'=~'","' in '","' nin '","' subsetof '","' anyof '","' noneof '","' sizeof '","' size '","' empty'","'!'","'||'","'true'","'false'","'null'","'{'","'}'","'['","']'","':'","','","'('","')'","'?'","'- '","'+'","'/'"]),fe(a,"symbolicNames",[null,"CURRENT_VALUE","DOTDOT","ROOT_VALUE","DOT","STAR","AND","EQ","GE","GT","LE","LT","NE","REG","IN","NIN","SUB","ANY","NON","SIZO","SIZ","EMPT","NOT","OR","TRUE","FALSE","NULL","BRACE_LEFT","BRACE_RIGHT","BRACKET_LEFT","BRACKET_RIGHT","COLON","COMMA","PAREN_LEFT","PAREN_RIGHT","QUESTION","MINUS_SP","PLUS","DIV","REGEX_OPT","REGEX_EXPR","KEY","SPECIAL_KEY","WS","NUMBER","STRING"]),fe(a,"ruleNames",["CURRENT_VALUE","DOTDOT","ROOT_VALUE","DOT","STAR","AND","EQ","GE","GT","LE","LT","NE","REG","IN","NIN","SUB","ANY","NON","SIZO","SIZ","EMPT","NOT","OR","TRUE","FALSE","NULL","BRACE_LEFT","BRACE_RIGHT","BRACKET_LEFT","BRACKET_RIGHT","COLON","COMMA","PAREN_LEFT","PAREN_RIGHT","QUESTION","MINUS_SP","PLUS","DIV","REGEX_OPT","REGEX_EXPR","KEY","SPECIAL_KEY","WS","NUMBER","STRING","ESC_SINGLE","ESC_DOUBLE","UNICODE","HEX","SAFECODEPOINT_SINGLE","SAFECODEPOINT_DOUBLE","INT","EXP"]),a.EOF=i.default.Token.EOF,a.CURRENT_VALUE=1,a.DOTDOT=2,a.ROOT_VALUE=3,a.DOT=4,a.STAR=5,a.AND=6,a.EQ=7,a.GE=8,a.GT=9,a.LE=10,a.LT=11,a.NE=12,a.REG=13,a.IN=14,a.NIN=15,a.SUB=16,a.ANY=17,a.NON=18,a.SIZO=19,a.SIZ=20,a.EMPT=21,a.NOT=22,a.OR=23,a.TRUE=24,a.FALSE=25,a.NULL=26,a.BRACE_LEFT=27,a.BRACE_RIGHT=28,a.BRACKET_LEFT=29,a.BRACKET_RIGHT=30,a.COLON=31,a.COMMA=32,a.PAREN_LEFT=33,a.PAREN_RIGHT=34,a.QUESTION=35,a.MINUS_SP=36,a.PLUS=37,a.DIV=38,a.REGEX_OPT=39,a.REGEX_EXPR=40,a.KEY=41,a.SPECIAL_KEY=42,a.WS=43,a.NUMBER=44,a.STRING=45;class o extends i.default.tree.ParseTreeListener{enterJsonpath(D){}exitJsonpath(D){}enterFilterarg(D){}exitFilterarg(D){}enterSubscript(D){}exitSubscript(D){}enterDotdotContent(D){}exitDotdotContent(D){}enterDotContent(D){}exitDotContent(D){}enterBracket(D){}exitBracket(D){}enterBracketContent(D){}exitBracketContent(D){}enterFilterExpression(D){}exitFilterExpression(D){}enterIndexes(D){}exitIndexes(D){}enterUnions(D){}exitUnions(D){}enterSlices(D){}exitSlices(D){}enterRegex(D){}exitRegex(D){}enterExpression(D){}exitExpression(D){}enterFilterpath(D){}exitFilterpath(D){}enterIdentifier(D){}exitIdentifier(D){}enterObj(D){}exitObj(D){}enterPair(D){}exitPair(D){}enterArray(D){}exitArray(D){}enterValue(D){}exitValue(D){}}const u=new i.default.atn.ATNDeserializer().deserialize([4,1,45,236,2,0,7,0,2,1,7,1,2,2,7,2,2,3,7,3,2,4,7,4,2,5,7,5,2,6,7,6,2,7,7,7,2,8,7,8,2,9,7,9,2,10,7,10,2,11,7,11,2,12,7,12,2,13,7,13,2,14,7,14,2,15,7,15,2,16,7,16,2,17,7,17,2,18,7,18,1,0,1,0,3,0,41,8,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,52,8,1,1,1,1,1,1,1,1,1,1,1,3,1,59,8,1,1,1,5,1,62,8,1,10,1,12,1,65,9,1,1,2,1,2,1,2,3,2,70,8,2,1,2,1,2,1,2,3,2,75,8,2,1,2,1,2,3,2,79,8,2,3,2,81,8,2,1,3,1,3,1,3,3,3,86,8,3,1,4,1,4,1,4,3,4,91,8,4,1,5,1,5,1,5,1,5,1,6,1,6,1,6,1,6,1,6,1,6,1,6,1,6,3,6,105,8,6,1,7,1,7,1,7,1,7,1,7,1,8,1,8,1,8,4,8,115,8,8,11,8,12,8,116,1,9,1,9,1,9,4,9,122,8,9,11,9,12,9,123,1,9,1,9,1,9,4,9,129,8,9,11,9,12,9,130,3,9,133,8,9,1,10,3,10,136,8,10,1,10,1,10,3,10,140,8,10,1,10,1,10,3,10,144,8,10,3,10,146,8,10,1,11,1,11,3,11,150,8,11,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,3,12,177,8,12,1,12,1,12,1,12,5,12,182,8,12,10,12,12,12,185,9,12,1,13,1,13,3,13,189,8,13,1,14,1,14,1,15,1,15,1,15,1,15,5,15,197,8,15,10,15,12,15,200,9,15,1,15,1,15,1,15,1,15,3,15,206,8,15,1,16,1,16,1,16,1,16,1,17,1,17,1,17,1,17,5,17,216,8,17,10,17,12,17,219,9,17,1,17,1,17,1,17,1,17,3,17,225,8,17,1,18,1,18,1,18,1,18,1,18,1,18,1,18,3,18,234,8,18,1,18,0,2,2,24,19,0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,0,6,2,0,5,5,38,38,1,0,36,37,2,0,7,12,14,20,2,0,6,6,23,23,2,0,1,1,3,3,2,0,24,26,41,42,267,0,38,1,0,0,0,2,51,1,0,0,0,4,80,1,0,0,0,6,85,1,0,0,0,8,90,1,0,0,0,10,92,1,0,0,0,12,104,1,0,0,0,14,106,1,0,0,0,16,111,1,0,0,0,18,132,1,0,0,0,20,135,1,0,0,0,22,147,1,0,0,0,24,176,1,0,0,0,26,186,1,0,0,0,28,190,1,0,0,0,30,205,1,0,0,0,32,207,1,0,0,0,34,224,1,0,0,0,36,233,1,0,0,0,38,40,5,3,0,0,39,41,3,4,2,0,40,39,1,0,0,0,40,41,1,0,0,0,41,42,1,0,0,0,42,43,5,0,0,1,43,1,1,0,0,0,44,45,6,1,-1,0,45,46,5,33,0,0,46,47,3,2,1,0,47,48,5,34,0,0,48,52,1,0,0,0,49,52,3,36,18,0,50,52,3,26,13,0,51,44,1,0,0,0,51,49,1,0,0,0,51,50,1,0,0,0,52,63,1,0,0,0,53,54,10,4,0,0,54,55,7,0,0,0,55,62,3,2,1,5,56,58,10,3,0,0,57,59,7,1,0,0,58,57,1,0,0,0,58,59,1,0,0,0,59,60,1,0,0,0,60,62,3,2,1,4,61,53,1,0,0,0,61,56,1,0,0,0,62,65,1,0,0,0,63,61,1,0,0,0,63,64,1,0,0,0,64,3,1,0,0,0,65,63,1,0,0,0,66,67,5,2,0,0,67,69,3,6,3,0,68,70,3,4,2,0,69,68,1,0,0,0,69,70,1,0,0,0,70,81,1,0,0,0,71,72,5,4,0,0,72,74,3,8,4,0,73,75,3,4,2,0,74,73,1,0,0,0,74,75,1,0,0,0,75,81,1,0,0,0,76,78,3,10,5,0,77,79,3,4,2,0,78,77,1,0,0,0,78,79,1,0,0,0,79,81,1,0,0,0,80,66,1,0,0,0,80,71,1,0,0,0,80,76,1,0,0,0,81,5,1,0,0,0,82,86,5,5,0,0,83,86,3,28,14,0,84,86,3,10,5,0,85,82,1,0,0,0,85,83,1,0,0,0,85,84,1,0,0,0,86,7,1,0,0,0,87,91,5,5,0,0,88,91,5,44,0,0,89,91,3,28,14,0,90,87,1,0,0,0,90,88,1,0,0,0,90,89,1,0,0,0,91,9,1,0,0,0,92,93,5,29,0,0,93,94,3,12,6,0,94,95,5,30,0,0,95,11,1,0,0,0,96,105,3,18,9,0,97,105,3,16,8,0,98,105,3,20,10,0,99,105,5,5,0,0,100,105,5,44,0,0,101,105,5,45,0,0,102,105,3,28,14,0,103,105,3,14,7,0,104,96,1,0,0,0,104,97,1,0,0,0,104,98,1,0,0,0,104,99,1,0,0,0,104,100,1,0,0,0,104,101,1,0,0,0,104,102,1,0,0,0,104,103,1,0,0,0,105,13,1,0,0,0,106,107,5,35,0,0,107,108,5,33,0,0,108,109,3,24,12,0,109,110,5,34,0,0,110,15,1,0,0,0,111,114,5,44,0,0,112,113,5,32,0,0,113,115,5,44,0,0,114,112,1,0,0,0,115,116,1,0,0,0,116,114,1,0,0,0,116,117,1,0,0,0,117,17,1,0,0,0,118,121,5,45,0,0,119,120,5,32,0,0,120,122,5,45,0,0,121,119,1,0,0,0,122,123,1,0,0,0,123,121,1,0,0,0,123,124,1,0,0,0,124,133,1,0,0,0,125,128,3,28,14,0,126,127,5,32,0,0,127,129,3,28,14,0,128,126,1,0,0,0,129,130,1,0,0,0,130,128,1,0,0,0,130,131,1,0,0,0,131,133,1,0,0,0,132,118,1,0,0,0,132,125,1,0,0,0,133,19,1,0,0,0,134,136,5,44,0,0,135,134,1,0,0,0,135,136,1,0,0,0,136,137,1,0,0,0,137,139,5,31,0,0,138,140,5,44,0,0,139,138,1,0,0,0,139,140,1,0,0,0,140,145,1,0,0,0,141,143,5,31,0,0,142,144,5,44,0,0,143,142,1,0,0,0,143,144,1,0,0,0,144,146,1,0,0,0,145,141,1,0,0,0,145,146,1,0,0,0,146,21,1,0,0,0,147,149,5,40,0,0,148,150,5,39,0,0,149,148,1,0,0,0,149,150,1,0,0,0,150,23,1,0,0,0,151,152,6,12,-1,0,152,153,5,22,0,0,153,154,5,33,0,0,154,155,3,24,12,0,155,156,5,34,0,0,156,177,1,0,0,0,157,158,5,33,0,0,158,159,3,24,12,0,159,160,5,34,0,0,160,177,1,0,0,0,161,162,3,2,1,0,162,163,7,2,0,0,163,164,3,2,1,0,164,177,1,0,0,0,165,166,3,2,1,0,166,167,5,13,0,0,167,168,3,22,11,0,168,177,1,0,0,0,169,170,3,2,1,0,170,171,5,21,0,0,171,177,1,0,0,0,172,177,3,26,13,0,173,177,5,24,0,0,174,177,5,25,0,0,175,177,5,26,0,0,176,151,1,0,0,0,176,157,1,0,0,0,176,161,1,0,0,0,176,165,1,0,0,0,176,169,1,0,0,0,176,172,1,0,0,0,176,173,1,0,0,0,176,174,1,0,0,0,176,175,1,0,0,0,177,183,1,0,0,0,178,179,10,8,0,0,179,180,7,3,0,0,180,182,3,24,12,9,181,178,1,0,0,0,182,185,1,0,0,0,183,181,1,0,0,0,183,184,1,0,0,0,184,25,1,0,0,0,185,183,1,0,0,0,186,188,7,4,0,0,187,189,3,4,2,0,188,187,1,0,0,0,188,189,1,0,0,0,189,27,1,0,0,0,190,191,7,5,0,0,191,29,1,0,0,0,192,193,5,27,0,0,193,198,3,32,16,0,194,195,5,32,0,0,195,197,3,32,16,0,196,194,1,0,0,0,197,200,1,0,0,0,198,196,1,0,0,0,198,199,1,0,0,0,199,201,1,0,0,0,200,198,1,0,0,0,201,202,5,28,0,0,202,206,1,0,0,0,203,204,5,27,0,0,204,206,5,28,0,0,205,192,1,0,0,0,205,203,1,0,0,0,206,31,1,0,0,0,207,208,5,45,0,0,208,209,5,31,0,0,209,210,3,36,18,0,210,33,1,0,0,0,211,212,5,29,0,0,212,217,3,36,18,0,213,214,5,32,0,0,214,216,3,36,18,0,215,213,1,0,0,0,216,219,1,0,0,0,217,215,1,0,0,0,217,218,1,0,0,0,218,220,1,0,0,0,219,217,1,0,0,0,220,221,5,30,0,0,221,225,1,0,0,0,222,223,5,29,0,0,223,225,5,30,0,0,224,211,1,0,0,0,224,222,1,0,0,0,225,35,1,0,0,0,226,234,5,45,0,0,227,234,5,44,0,0,228,234,3,30,15,0,229,234,3,34,17,0,230,234,5,24,0,0,231,234,5,25,0,0,232,234,5,26,0,0,233,226,1,0,0,0,233,227,1,0,0,0,233,228,1,0,0,0,233,229,1,0,0,0,233,230,1,0,0,0,233,231,1,0,0,0,233,232,1,0,0,0,234,37,1,0,0,0,29,40,51,58,61,63,69,74,78,80,85,90,104,116,123,130,132,135,139,143,145,149,176,183,188,198,205,217,224,233]),l=u.decisionToState.map((K,D)=>new i.default.dfa.DFA(K,D)),h=new i.default.atn.PredictionContextCache,le=class le extends i.default.Parser{constructor(D){super(D),this._interp=new i.default.atn.ParserATNSimulator(this,u,l,h),this.ruleNames=le.ruleNames,this.literalNames=le.literalNames,this.symbolicNames=le.symbolicNames}sempred(D,S,P){switch(S){case 1:return this.filterarg_sempred(D,P);case 12:return this.expression_sempred(D,P);default:throw"No predicate with index:"+S}}filterarg_sempred(D,S){switch(S){case 0:return this.precpred(this._ctx,4);case 1:return this.precpred(this._ctx,3);default:throw"No predicate with index:"+S}}expression_sempred(D,S){if(S===2)return this.precpred(this._ctx,8);throw"No predicate with index:"+S}jsonpath(){let D=new p(this,this._ctx,this.state);this.enterRule(D,0,le.RULE_jsonpath);var S=0;try{this.enterOuterAlt(D,1),this.state=38,this.match(le.ROOT_VALUE),this.state=40,this._errHandler.sync(this),(-32&(S=this._input.LA(1)))==0&&(1<<S&536870932)!=0&&(this.state=39,this.subscript()),this.state=42,this.match(le.EOF)}catch(P){if(!(P instanceof i.default.error.RecognitionException))throw P;D.exception=P,this._errHandler.reportError(this,P),this._errHandler.recover(this,P)}finally{this.exitRule()}return D}filterarg(D){D===void 0&&(D=0);const S=this._ctx,P=this.state;let z=new g(this,this._ctx,P),Te=z;this.enterRecursionRule(z,2,le.RULE_filterarg,D);var me=0;try{switch(this.enterOuterAlt(z,1),this.state=51,this._errHandler.sync(this),this._input.LA(1)){case 33:this.state=45,this.match(le.PAREN_LEFT),this.state=46,this.filterarg(0),this.state=47,this.match(le.PAREN_RIGHT);break;case 24:case 25:case 26:case 27:case 29:case 44:case 45:this.state=49,this.value();break;case 1:case 3:this.state=50,this.filterpath();break;default:throw new i.default.error.NoViableAltException(this)}this._ctx.stop=this._input.LT(-1),this.state=63,this._errHandler.sync(this);for(var ye=this._interp.adaptivePredict(this._input,4,this._ctx);ye!=2&&ye!=i.default.atn.ATN.INVALID_ALT_NUMBER;){if(ye===1)switch(this._parseListeners!==null&&this.triggerExitRuleEvent(),Te=z,this.state=61,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,3,this._ctx)){case 1:if(z=new g(this,S,P),this.pushNewRecursionContext(z,2,le.RULE_filterarg),this.state=53,!this.precpred(this._ctx,4))throw new i.default.error.FailedPredicateException(this,"this.precpred(this._ctx, 4)");this.state=54,(me=this._input.LA(1))!==5&&me!==38?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume()),this.state=55,this.filterarg(5);break;case 2:if(z=new g(this,S,P),this.pushNewRecursionContext(z,2,le.RULE_filterarg),this.state=56,!this.precpred(this._ctx,3))throw new i.default.error.FailedPredicateException(this,"this.precpred(this._ctx, 3)");this.state=58,this._errHandler.sync(this),(me=this._input.LA(1))!==36&&me!==37||(this.state=57,(me=this._input.LA(1))!==36&&me!==37?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume())),this.state=60,this.filterarg(4)}this.state=65,this._errHandler.sync(this),ye=this._interp.adaptivePredict(this._input,4,this._ctx)}}catch(st){if(!(st instanceof i.default.error.RecognitionException))throw st;z.exception=st,this._errHandler.reportError(this,st),this._errHandler.recover(this,st)}finally{this.unrollRecursionContexts(S)}return z}subscript(){let D=new m(this,this._ctx,this.state);this.enterRule(D,4,le.RULE_subscript);try{switch(this.state=80,this._errHandler.sync(this),this._input.LA(1)){case 2:this.enterOuterAlt(D,1),this.state=66,this.match(le.DOTDOT),this.state=67,this.dotdotContent(),this.state=69,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,5,this._ctx)===1&&(this.state=68,this.subscript());break;case 4:this.enterOuterAlt(D,2),this.state=71,this.match(le.DOT),this.state=72,this.dotContent(),this.state=74,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,6,this._ctx)===1&&(this.state=73,this.subscript());break;case 29:this.enterOuterAlt(D,3),this.state=76,this.bracket(),this.state=78,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,7,this._ctx)===1&&(this.state=77,this.subscript());break;default:throw new i.default.error.NoViableAltException(this)}}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}dotdotContent(){let D=new v(this,this._ctx,this.state);this.enterRule(D,6,le.RULE_dotdotContent);try{switch(this.state=85,this._errHandler.sync(this),this._input.LA(1)){case 5:this.enterOuterAlt(D,1),this.state=82,this.match(le.STAR);break;case 24:case 25:case 26:case 41:case 42:this.enterOuterAlt(D,2),this.state=83,this.identifier();break;case 29:this.enterOuterAlt(D,3),this.state=84,this.bracket();break;default:throw new i.default.error.NoViableAltException(this)}}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}dotContent(){let D=new E(this,this._ctx,this.state);this.enterRule(D,8,le.RULE_dotContent);try{switch(this.state=90,this._errHandler.sync(this),this._input.LA(1)){case 5:this.enterOuterAlt(D,1),this.state=87,this.match(le.STAR);break;case 44:this.enterOuterAlt(D,2),this.state=88,this.match(le.NUMBER);break;case 24:case 25:case 26:case 41:case 42:this.enterOuterAlt(D,3),this.state=89,this.identifier();break;default:throw new i.default.error.NoViableAltException(this)}}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}bracket(){let D=new x(this,this._ctx,this.state);this.enterRule(D,10,le.RULE_bracket);try{this.enterOuterAlt(D,1),this.state=92,this.match(le.BRACKET_LEFT),this.state=93,this.bracketContent(),this.state=94,this.match(le.BRACKET_RIGHT)}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}bracketContent(){let D=new T(this,this._ctx,this.state);this.enterRule(D,12,le.RULE_bracketContent);try{switch(this.state=104,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,11,this._ctx)){case 1:this.enterOuterAlt(D,1),this.state=96,this.unions();break;case 2:this.enterOuterAlt(D,2),this.state=97,this.indexes();break;case 3:this.enterOuterAlt(D,3),this.state=98,this.slices();break;case 4:this.enterOuterAlt(D,4),this.state=99,this.match(le.STAR);break;case 5:this.enterOuterAlt(D,5),this.state=100,this.match(le.NUMBER);break;case 6:this.enterOuterAlt(D,6),this.state=101,this.match(le.STRING);break;case 7:this.enterOuterAlt(D,7),this.state=102,this.identifier();break;case 8:this.enterOuterAlt(D,8),this.state=103,this.filterExpression()}}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}filterExpression(){let D=new R(this,this._ctx,this.state);this.enterRule(D,14,le.RULE_filterExpression);try{this.enterOuterAlt(D,1),this.state=106,this.match(le.QUESTION),this.state=107,this.match(le.PAREN_LEFT),this.state=108,this.expression(0),this.state=109,this.match(le.PAREN_RIGHT)}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}indexes(){let D=new _(this,this._ctx,this.state);this.enterRule(D,16,le.RULE_indexes);var S=0;try{this.enterOuterAlt(D,1),this.state=111,this.match(le.NUMBER),this.state=114,this._errHandler.sync(this),S=this._input.LA(1);do this.state=112,this.match(le.COMMA),this.state=113,this.match(le.NUMBER),this.state=116,this._errHandler.sync(this),S=this._input.LA(1);while(S===32)}catch(P){if(!(P instanceof i.default.error.RecognitionException))throw P;D.exception=P,this._errHandler.reportError(this,P),this._errHandler.recover(this,P)}finally{this.exitRule()}return D}unions(){let D=new F(this,this._ctx,this.state);this.enterRule(D,18,le.RULE_unions);var S=0;try{switch(this.state=132,this._errHandler.sync(this),this._input.LA(1)){case 45:this.enterOuterAlt(D,1),this.state=118,this.match(le.STRING),this.state=121,this._errHandler.sync(this),S=this._input.LA(1);do this.state=119,this.match(le.COMMA),this.state=120,this.match(le.STRING),this.state=123,this._errHandler.sync(this),S=this._input.LA(1);while(S===32);break;case 24:case 25:case 26:case 41:case 42:this.enterOuterAlt(D,2),this.state=125,this.identifier(),this.state=128,this._errHandler.sync(this),S=this._input.LA(1);do this.state=126,this.match(le.COMMA),this.state=127,this.identifier(),this.state=130,this._errHandler.sync(this),S=this._input.LA(1);while(S===32);break;default:throw new i.default.error.NoViableAltException(this)}}catch(P){if(!(P instanceof i.default.error.RecognitionException))throw P;D.exception=P,this._errHandler.reportError(this,P),this._errHandler.recover(this,P)}finally{this.exitRule()}return D}slices(){let D=new N(this,this._ctx,this.state);this.enterRule(D,20,le.RULE_slices);try{this.enterOuterAlt(D,1),this.state=135,this._errHandler.sync(this),this._input.LA(1)===44&&(this.state=134,this.match(le.NUMBER)),this.state=137,this.match(le.COLON),this.state=139,this._errHandler.sync(this),this._input.LA(1)===44&&(this.state=138,this.match(le.NUMBER)),this.state=145,this._errHandler.sync(this),this._input.LA(1)===31&&(this.state=141,this.match(le.COLON),this.state=143,this._errHandler.sync(this),this._input.LA(1)===44&&(this.state=142,this.match(le.NUMBER)))}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}regex(){let D=new C(this,this._ctx,this.state);this.enterRule(D,22,le.RULE_regex);try{this.enterOuterAlt(D,1),this.state=147,this.match(le.REGEX_EXPR),this.state=149,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,20,this._ctx)===1&&(this.state=148,this.match(le.REGEX_OPT))}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}expression(D){D===void 0&&(D=0);const S=this._ctx,P=this.state;let z=new M(this,this._ctx,P),Te=z;this.enterRecursionRule(z,24,le.RULE_expression,D);var me=0;try{switch(this.enterOuterAlt(z,1),this.state=176,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,21,this._ctx)){case 1:this.state=152,this.match(le.NOT),this.state=153,this.match(le.PAREN_LEFT),this.state=154,this.expression(0),this.state=155,this.match(le.PAREN_RIGHT);break;case 2:this.state=157,this.match(le.PAREN_LEFT),this.state=158,this.expression(0),this.state=159,this.match(le.PAREN_RIGHT);break;case 3:this.state=161,this.filterarg(0),this.state=162,(-32&(me=this._input.LA(1)))!=0||(1<<me&2088832)==0?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume()),this.state=163,this.filterarg(0);break;case 4:this.state=165,this.filterarg(0),this.state=166,this.match(le.REG),this.state=167,this.regex();break;case 5:this.state=169,this.filterarg(0),this.state=170,this.match(le.EMPT);break;case 6:this.state=172,this.filterpath();break;case 7:this.state=173,this.match(le.TRUE);break;case 8:this.state=174,this.match(le.FALSE);break;case 9:this.state=175,this.match(le.NULL)}this._ctx.stop=this._input.LT(-1),this.state=183,this._errHandler.sync(this);for(var ye=this._interp.adaptivePredict(this._input,22,this._ctx);ye!=2&&ye!=i.default.atn.ATN.INVALID_ALT_NUMBER;){if(ye===1){if(this._parseListeners!==null&&this.triggerExitRuleEvent(),Te=z,z=new M(this,S,P),this.pushNewRecursionContext(z,24,le.RULE_expression),this.state=178,!this.precpred(this._ctx,8))throw new i.default.error.FailedPredicateException(this,"this.precpred(this._ctx, 8)");this.state=179,(me=this._input.LA(1))!==6&&me!==23?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume()),this.state=180,this.expression(9)}this.state=185,this._errHandler.sync(this),ye=this._interp.adaptivePredict(this._input,22,this._ctx)}}catch(st){if(!(st instanceof i.default.error.RecognitionException))throw st;z.exception=st,this._errHandler.reportError(this,st),this._errHandler.recover(this,st)}finally{this.unrollRecursionContexts(S)}return z}filterpath(){let D=new L(this,this._ctx,this.state);this.enterRule(D,26,le.RULE_filterpath);var S=0;try{this.enterOuterAlt(D,1),this.state=186,(S=this._input.LA(1))!==1&&S!==3?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume()),this.state=188,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,23,this._ctx)===1&&(this.state=187,this.subscript())}catch(P){if(!(P instanceof i.default.error.RecognitionException))throw P;D.exception=P,this._errHandler.reportError(this,P),this._errHandler.recover(this,P)}finally{this.exitRule()}return D}identifier(){let D=new I(this,this._ctx,this.state);this.enterRule(D,28,le.RULE_identifier);var S=0;try{this.enterOuterAlt(D,1),this.state=190,((S=this._input.LA(1))-24&-32)!=0||(1<<S-24&393223)==0?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume())}catch(P){if(!(P instanceof i.default.error.RecognitionException))throw P;D.exception=P,this._errHandler.reportError(this,P),this._errHandler.recover(this,P)}finally{this.exitRule()}return D}obj(){let D=new U(this,this._ctx,this.state);this.enterRule(D,30,le.RULE_obj);var S=0;try{switch(this.state=205,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,25,this._ctx)){case 1:for(this.enterOuterAlt(D,1),this.state=192,this.match(le.BRACE_LEFT),this.state=193,this.pair(),this.state=198,this._errHandler.sync(this),S=this._input.LA(1);S===32;)this.state=194,this.match(le.COMMA),this.state=195,this.pair(),this.state=200,this._errHandler.sync(this),S=this._input.LA(1);this.state=201,this.match(le.BRACE_RIGHT);break;case 2:this.enterOuterAlt(D,2),this.state=203,this.match(le.BRACE_LEFT),this.state=204,this.match(le.BRACE_RIGHT)}}catch(P){if(!(P instanceof i.default.error.RecognitionException))throw P;D.exception=P,this._errHandler.reportError(this,P),this._errHandler.recover(this,P)}finally{this.exitRule()}return D}pair(){let D=new q(this,this._ctx,this.state);this.enterRule(D,32,le.RULE_pair);try{this.enterOuterAlt(D,1),this.state=207,this.match(le.STRING),this.state=208,this.match(le.COLON),this.state=209,this.value()}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}array(){let D=new $(this,this._ctx,this.state);this.enterRule(D,34,le.RULE_array);var S=0;try{switch(this.state=224,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,27,this._ctx)){case 1:for(this.enterOuterAlt(D,1),this.state=211,this.match(le.BRACKET_LEFT),this.state=212,this.value(),this.state=217,this._errHandler.sync(this),S=this._input.LA(1);S===32;)this.state=213,this.match(le.COMMA),this.state=214,this.value(),this.state=219,this._errHandler.sync(this),S=this._input.LA(1);this.state=220,this.match(le.BRACKET_RIGHT);break;case 2:this.enterOuterAlt(D,2),this.state=222,this.match(le.BRACKET_LEFT),this.state=223,this.match(le.BRACKET_RIGHT)}}catch(P){if(!(P instanceof i.default.error.RecognitionException))throw P;D.exception=P,this._errHandler.reportError(this,P),this._errHandler.recover(this,P)}finally{this.exitRule()}return D}value(){let D=new X(this,this._ctx,this.state);this.enterRule(D,36,le.RULE_value);try{switch(this.state=233,this._errHandler.sync(this),this._input.LA(1)){case 45:this.enterOuterAlt(D,1),this.state=226,this.match(le.STRING);break;case 44:this.enterOuterAlt(D,2),this.state=227,this.match(le.NUMBER);break;case 27:this.enterOuterAlt(D,3),this.state=228,this.obj();break;case 29:this.enterOuterAlt(D,4),this.state=229,this.array();break;case 24:this.enterOuterAlt(D,5),this.state=230,this.match(le.TRUE);break;case 25:this.enterOuterAlt(D,6),this.state=231,this.match(le.FALSE);break;case 26:this.enterOuterAlt(D,7),this.state=232,this.match(le.NULL);break;default:throw new i.default.error.NoViableAltException(this)}}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}};fe(le,"grammarFileName","JSONPath.g4"),fe(le,"literalNames",[null,"'@'","'..'","'$'","'.'","'*'","'&&'","'=='","'>='","'>'","'<='","'<'","'!='","'=~'","' in '","' nin '","' subsetof '","' anyof '","' noneof '","' sizeof '","' size '","' empty'","'!'","'||'","'true'","'false'","'null'","'{'","'}'","'['","']'","':'","','","'('","')'","'?'","'- '","'+'","'/'"]),fe(le,"symbolicNames",[null,"CURRENT_VALUE","DOTDOT","ROOT_VALUE","DOT","STAR","AND","EQ","GE","GT","LE","LT","NE","REG","IN","NIN","SUB","ANY","NON","SIZO","SIZ","EMPT","NOT","OR","TRUE","FALSE","NULL","BRACE_LEFT","BRACE_RIGHT","BRACKET_LEFT","BRACKET_RIGHT","COLON","COMMA","PAREN_LEFT","PAREN_RIGHT","QUESTION","MINUS_SP","PLUS","DIV","REGEX_OPT","REGEX_EXPR","KEY","SPECIAL_KEY","WS","NUMBER","STRING"]),fe(le,"ruleNames",["jsonpath","filterarg","subscript","dotdotContent","dotContent","bracket","bracketContent","filterExpression","indexes","unions","slices","regex","expression","filterpath","identifier","obj","pair","array","value"]);let d=le;d.EOF=i.default.Token.EOF,d.CURRENT_VALUE=1,d.DOTDOT=2,d.ROOT_VALUE=3,d.DOT=4,d.STAR=5,d.AND=6,d.EQ=7,d.GE=8,d.GT=9,d.LE=10,d.LT=11,d.NE=12,d.REG=13,d.IN=14,d.NIN=15,d.SUB=16,d.ANY=17,d.NON=18,d.SIZO=19,d.SIZ=20,d.EMPT=21,d.NOT=22,d.OR=23,d.TRUE=24,d.FALSE=25,d.NULL=26,d.BRACE_LEFT=27,d.BRACE_RIGHT=28,d.BRACKET_LEFT=29,d.BRACKET_RIGHT=30,d.COLON=31,d.COMMA=32,d.PAREN_LEFT=33,d.PAREN_RIGHT=34,d.QUESTION=35,d.MINUS_SP=36,d.PLUS=37,d.DIV=38,d.REGEX_OPT=39,d.REGEX_EXPR=40,d.KEY=41,d.SPECIAL_KEY=42,d.WS=43,d.NUMBER=44,d.STRING=45,d.RULE_jsonpath=0,d.RULE_filterarg=1,d.RULE_subscript=2,d.RULE_dotdotContent=3,d.RULE_dotContent=4,d.RULE_bracket=5,d.RULE_bracketContent=6,d.RULE_filterExpression=7,d.RULE_indexes=8,d.RULE_unions=9,d.RULE_slices=10,d.RULE_regex=11,d.RULE_expression=12,d.RULE_filterpath=13,d.RULE_identifier=14,d.RULE_obj=15,d.RULE_pair=16,d.RULE_array=17,d.RULE_value=18;class p extends i.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_jsonpath}ROOT_VALUE(){return this.getToken(d.ROOT_VALUE,0)}EOF(){return this.getToken(d.EOF,0)}subscript(){return this.getTypedRuleContext(m,0)}enterRule(D){D instanceof o&&D.enterJsonpath(this)}exitRule(D){D instanceof o&&D.exitJsonpath(this)}}class g extends i.default.ParserRuleContext{constructor(S,P,z){P===void 0&&(P=null),z==null&&(z=-1);super(P,z);fe(this,"filterarg",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(g):this.getTypedRuleContext(g,S)});this.parser=S,this.ruleIndex=d.RULE_filterarg}PAREN_LEFT(){return this.getToken(d.PAREN_LEFT,0)}PAREN_RIGHT(){return this.getToken(d.PAREN_RIGHT,0)}value(){return this.getTypedRuleContext(X,0)}filterpath(){return this.getTypedRuleContext(L,0)}STAR(){return this.getToken(d.STAR,0)}DIV(){return this.getToken(d.DIV,0)}PLUS(){return this.getToken(d.PLUS,0)}MINUS_SP(){return this.getToken(d.MINUS_SP,0)}enterRule(S){S instanceof o&&S.enterFilterarg(this)}exitRule(S){S instanceof o&&S.exitFilterarg(this)}}class m extends i.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_subscript}DOTDOT(){return this.getToken(d.DOTDOT,0)}dotdotContent(){return this.getTypedRuleContext(v,0)}subscript(){return this.getTypedRuleContext(m,0)}DOT(){return this.getToken(d.DOT,0)}dotContent(){return this.getTypedRuleContext(E,0)}bracket(){return this.getTypedRuleContext(x,0)}enterRule(D){D instanceof o&&D.enterSubscript(this)}exitRule(D){D instanceof o&&D.exitSubscript(this)}}class v extends i.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_dotdotContent}STAR(){return this.getToken(d.STAR,0)}identifier(){return this.getTypedRuleContext(I,0)}bracket(){return this.getTypedRuleContext(x,0)}enterRule(D){D instanceof o&&D.enterDotdotContent(this)}exitRule(D){D instanceof o&&D.exitDotdotContent(this)}}class E extends i.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_dotContent}STAR(){return this.getToken(d.STAR,0)}NUMBER(){return this.getToken(d.NUMBER,0)}identifier(){return this.getTypedRuleContext(I,0)}enterRule(D){D instanceof o&&D.enterDotContent(this)}exitRule(D){D instanceof o&&D.exitDotContent(this)}}class x extends i.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_bracket}BRACKET_LEFT(){return this.getToken(d.BRACKET_LEFT,0)}bracketContent(){return this.getTypedRuleContext(T,0)}BRACKET_RIGHT(){return this.getToken(d.BRACKET_RIGHT,0)}enterRule(D){D instanceof o&&D.enterBracket(this)}exitRule(D){D instanceof o&&D.exitBracket(this)}}class T extends i.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_bracketContent}unions(){return this.getTypedRuleContext(F,0)}indexes(){return this.getTypedRuleContext(_,0)}slices(){return this.getTypedRuleContext(N,0)}STAR(){return this.getToken(d.STAR,0)}NUMBER(){return this.getToken(d.NUMBER,0)}STRING(){return this.getToken(d.STRING,0)}identifier(){return this.getTypedRuleContext(I,0)}filterExpression(){return this.getTypedRuleContext(R,0)}enterRule(D){D instanceof o&&D.enterBracketContent(this)}exitRule(D){D instanceof o&&D.exitBracketContent(this)}}class R extends i.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_filterExpression}QUESTION(){return this.getToken(d.QUESTION,0)}PAREN_LEFT(){return this.getToken(d.PAREN_LEFT,0)}expression(){return this.getTypedRuleContext(M,0)}PAREN_RIGHT(){return this.getToken(d.PAREN_RIGHT,0)}enterRule(D){D instanceof o&&D.enterFilterExpression(this)}exitRule(D){D instanceof o&&D.exitFilterExpression(this)}}class _ extends i.default.ParserRuleContext{constructor(S,P,z){P===void 0&&(P=null),z==null&&(z=-1);super(P,z);fe(this,"NUMBER",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.NUMBER):this.getToken(d.NUMBER,S)});fe(this,"COMMA",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.COMMA):this.getToken(d.COMMA,S)});this.parser=S,this.ruleIndex=d.RULE_indexes}enterRule(S){S instanceof o&&S.enterIndexes(this)}exitRule(S){S instanceof o&&S.exitIndexes(this)}}class F extends i.default.ParserRuleContext{constructor(S,P,z){P===void 0&&(P=null),z==null&&(z=-1);super(P,z);fe(this,"STRING",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.STRING):this.getToken(d.STRING,S)});fe(this,"COMMA",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.COMMA):this.getToken(d.COMMA,S)});fe(this,"identifier",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(I):this.getTypedRuleContext(I,S)});this.parser=S,this.ruleIndex=d.RULE_unions}enterRule(S){S instanceof o&&S.enterUnions(this)}exitRule(S){S instanceof o&&S.exitUnions(this)}}class N extends i.default.ParserRuleContext{constructor(S,P,z){P===void 0&&(P=null),z==null&&(z=-1);super(P,z);fe(this,"COLON",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.COLON):this.getToken(d.COLON,S)});fe(this,"NUMBER",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.NUMBER):this.getToken(d.NUMBER,S)});this.parser=S,this.ruleIndex=d.RULE_slices}enterRule(S){S instanceof o&&S.enterSlices(this)}exitRule(S){S instanceof o&&S.exitSlices(this)}}class C extends i.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_regex}REGEX_EXPR(){return this.getToken(d.REGEX_EXPR,0)}REGEX_OPT(){return this.getToken(d.REGEX_OPT,0)}enterRule(D){D instanceof o&&D.enterRegex(this)}exitRule(D){D instanceof o&&D.exitRegex(this)}}class M extends i.default.ParserRuleContext{constructor(S,P,z){P===void 0&&(P=null),z==null&&(z=-1);super(P,z);fe(this,"expression",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(M):this.getTypedRuleContext(M,S)});fe(this,"filterarg",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(g):this.getTypedRuleContext(g,S)});this.parser=S,this.ruleIndex=d.RULE_expression}NOT(){return this.getToken(d.NOT,0)}PAREN_LEFT(){return this.getToken(d.PAREN_LEFT,0)}PAREN_RIGHT(){return this.getToken(d.PAREN_RIGHT,0)}EQ(){return this.getToken(d.EQ,0)}NE(){return this.getToken(d.NE,0)}LT(){return this.getToken(d.LT,0)}LE(){return this.getToken(d.LE,0)}GT(){return this.getToken(d.GT,0)}GE(){return this.getToken(d.GE,0)}IN(){return this.getToken(d.IN,0)}NIN(){return this.getToken(d.NIN,0)}SUB(){return this.getToken(d.SUB,0)}ANY(){return this.getToken(d.ANY,0)}SIZO(){return this.getToken(d.SIZO,0)}NON(){return this.getToken(d.NON,0)}SIZ(){return this.getToken(d.SIZ,0)}REG(){return this.getToken(d.REG,0)}regex(){return this.getTypedRuleContext(C,0)}EMPT(){return this.getToken(d.EMPT,0)}filterpath(){return this.getTypedRuleContext(L,0)}TRUE(){return this.getToken(d.TRUE,0)}FALSE(){return this.getToken(d.FALSE,0)}NULL(){return this.getToken(d.NULL,0)}AND(){return this.getToken(d.AND,0)}OR(){return this.getToken(d.OR,0)}enterRule(S){S instanceof o&&S.enterExpression(this)}exitRule(S){S instanceof o&&S.exitExpression(this)}}class L extends i.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_filterpath}ROOT_VALUE(){return this.getToken(d.ROOT_VALUE,0)}CURRENT_VALUE(){return this.getToken(d.CURRENT_VALUE,0)}subscript(){return this.getTypedRuleContext(m,0)}enterRule(D){D instanceof o&&D.enterFilterpath(this)}exitRule(D){D instanceof o&&D.exitFilterpath(this)}}class I extends i.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_identifier}KEY(){return this.getToken(d.KEY,0)}SPECIAL_KEY(){return this.getToken(d.SPECIAL_KEY,0)}TRUE(){return this.getToken(d.TRUE,0)}FALSE(){return this.getToken(d.FALSE,0)}NULL(){return this.getToken(d.NULL,0)}enterRule(D){D instanceof o&&D.enterIdentifier(this)}exitRule(D){D instanceof o&&D.exitIdentifier(this)}}class U extends i.default.ParserRuleContext{constructor(S,P,z){P===void 0&&(P=null),z==null&&(z=-1);super(P,z);fe(this,"pair",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(q):this.getTypedRuleContext(q,S)});fe(this,"COMMA",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.COMMA):this.getToken(d.COMMA,S)});this.parser=S,this.ruleIndex=d.RULE_obj}BRACE_LEFT(){return this.getToken(d.BRACE_LEFT,0)}BRACE_RIGHT(){return this.getToken(d.BRACE_RIGHT,0)}enterRule(S){S instanceof o&&S.enterObj(this)}exitRule(S){S instanceof o&&S.exitObj(this)}}class q extends i.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_pair}STRING(){return this.getToken(d.STRING,0)}COLON(){return this.getToken(d.COLON,0)}value(){return this.getTypedRuleContext(X,0)}enterRule(D){D instanceof o&&D.enterPair(this)}exitRule(D){D instanceof o&&D.exitPair(this)}}class $ extends i.default.ParserRuleContext{constructor(S,P,z){P===void 0&&(P=null),z==null&&(z=-1);super(P,z);fe(this,"value",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(X):this.getTypedRuleContext(X,S)});fe(this,"COMMA",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.COMMA):this.getToken(d.COMMA,S)});this.parser=S,this.ruleIndex=d.RULE_array}BRACKET_LEFT(){return this.getToken(d.BRACKET_LEFT,0)}BRACKET_RIGHT(){return this.getToken(d.BRACKET_RIGHT,0)}enterRule(S){S instanceof o&&S.enterArray(this)}exitRule(S){S instanceof o&&S.exitArray(this)}}class X extends i.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_value}STRING(){return this.getToken(d.STRING,0)}NUMBER(){return this.getToken(d.NUMBER,0)}obj(){return this.getTypedRuleContext(U,0)}array(){return this.getTypedRuleContext($,0)}TRUE(){return this.getToken(d.TRUE,0)}FALSE(){return this.getToken(d.FALSE,0)}NULL(){return this.getToken(d.NULL,0)}enterRule(D){D instanceof o&&D.enterValue(this)}exitRule(D){D instanceof o&&D.exitValue(this)}}d.JsonpathContext=p,d.FilterargContext=g,d.SubscriptContext=m,d.DotdotContentContext=v,d.DotContentContext=E,d.BracketContext=x,d.BracketContentContext=T,d.FilterExpressionContext=R,d.IndexesContext=_,d.UnionsContext=F,d.SlicesContext=N,d.RegexContext=C,d.ExpressionContext=M,d.FilterpathContext=L,d.IdentifierContext=I,d.ObjContext=U,d.PairContext=q,d.ArrayContext=$,d.ValueContext=X;const ie={root:K=>"type"in K&&K.type==="root",value:K=>"type"in K&&K.type==="value",regex:K=>"type"in K&&K.type==="value"&&K.subtype==="regex",operationContent:K=>"type"in K&&typeof K.type=="string"&&["value","current","root","groupOperation","operation"].includes(K.type),subscript:K=>"type"in K&&K.type==="subscript",bracket:K=>"type"in K&&["bracketMember","bracketExpression"].includes(K.type),unions:K=>"type"in K&&K.type==="unions",indexes:K=>"type"in K&&K.type==="indexes",slices:K=>"type"in K&&K.type==="slices",filterExpression:K=>"type"in K&&K.type==="filterExpression",dotContent:K=>"type"in K&&["identifier","numericLiteral","wildcard"].includes(K.type),dotdotContent:K=>"type"in K&&["identifier","wildcard","bracketMember","bracketExpression"].includes(K.type),bracketContent:K=>"type"in K&&["identifier","wildcard","numericLiteral","stringLiteral","filterExpression","slices","unions","indexes"].includes(K.type),expressionContent:K=>"type"in K&&["value","comparator","groupExpression","logicalExpression","notExpression","current","root"].includes(K.type)};class ne extends o{constructor(){super(...arguments),this._stack=[]}getTree(){return this.popWithCheck("root",null)}popWithCheck(D,S){const P=this._stack.pop();if(P!==void 0&&ie[D](P))return P;throw new Error(`bad type (${JSON.stringify(P)}) returned for ${D} with token: ${S==null?void 0:S.getText()}`)}push(D){this._stack.push(D)}exitJsonpath(D){if(D.ROOT_VALUE()){const S=D.subscript()?this.popWithCheck("subscript",D):null;this.push({type:"root",next:S})}}exitBracketContent(D){switch(!0){case!!D.identifier():{const S=D.identifier().getText();this.push({type:"identifier",value:S});break}case!!D.STAR():this.push({type:"wildcard"});break;case!!D.unions():{const S=this.popWithCheck("unions",D);this.push(S);break}case!!D.indexes():{const S=this.popWithCheck("indexes",D);this.push(S);break}case!!D.slices():{const S=this.popWithCheck("slices",D);this.push(S);break}case!!D.STRING():{const S=D.STRING().getText().slice(1,-1);this.push({type:"stringLiteral",value:S});break}case!!D.NUMBER():{const S=Number.parseInt(D.NUMBER().getText());this.push({type:"numericLiteral",value:S});break}case!!D.filterExpression():{const S=this.popWithCheck("filterExpression",D);this.push(S);break}}}exitBracket(D){const S=this.popWithCheck("bracketContent",D);["identifier","numericLiteral","stringLiteral"].includes(S.type)?this.push({type:"bracketMember",value:S}):this.push({type:"bracketExpression",value:S})}exitDotdotContent(D){switch(!0){case!!D.STAR():this.push({type:"wildcard"});break;case!!D.identifier():{const S=D.identifier().getText();this.push({type:"identifier",value:S});break}case!!D.bracket():{const S=this.popWithCheck("bracket",D);this.push(S);break}}}exitDotContent(D){switch(!0){case!!D.STAR():this.push({type:"wildcard"});break;case!!D.identifier():{const S=D.identifier().getText();this.push({type:"identifier",value:S});break}case!!D.NUMBER():{const S=Number.parseInt(D.NUMBER().getText());this.push({type:"numericLiteral",value:S});break}}}exitSubscript(D){switch(!0){case!!D.DOT():{const S=D.subscript()?this.popWithCheck("subscript",D):null,P=this.popWithCheck("dotContent",D);this.push({type:"subscript",value:{type:"dot",value:P},next:S});break}case!!D.DOTDOT():{const S=D.subscript()?this.popWithCheck("subscript",D):null,P=this.popWithCheck("dotdotContent",D);this.push({type:"subscript",value:{type:"dotdot",value:P},next:S});break}case!!D.bracket():{const S=D.subscript()?this.popWithCheck("subscript",D):null,P=this.popWithCheck("bracket",D);this.push({type:"subscript",next:S,value:P});break}}}exitFilterpath(D){switch(!0){case!!D.ROOT_VALUE():{const S=D.subscript()?this.popWithCheck("subscript",D):null;this.push({type:"root",next:S});break}case!!D.CURRENT_VALUE():{const S=D.subscript()?this.popWithCheck("subscript",D):null;this.push({type:"current",next:S});break}}}exitUnions(D){const S=[];for(let P=0;P<D.identifier().length;P+=1){const z=D.identifier(P).getText();S.push({type:"identifier",value:z})}for(let P=0;P<D.STRING().length;P+=1){const z=D.STRING(P).getText().slice(1,-1);S.push({type:"stringLiteral",value:z})}this.push({type:"unions",values:S})}exitIndexes(D){const S=[];for(let P=0;P<D.NUMBER().length;P+=1){const z=Number.parseInt(D.NUMBER(P).getText());S.push({type:"numericLiteral",value:z})}this.push({type:"indexes",values:S})}exitSlices(D){const S=[0,1,2].map(ye=>D.getToken(d.NUMBER,ye)),P=[0,1].map(ye=>D.getToken(d.COLON,ye));let z=null,Te=null,me=null;P[0]&&S[0]&&S[0].getSourceInterval().start<P[0].getSourceInterval().start&&(z=Number.parseInt(S[0].getText())),!P[1]&&P[0]&&S[1]&&S[1].getSourceInterval().start>P[0].getSourceInterval().start||P[1]&&S[1]&&S[1].getSourceInterval().start<P[1].getSourceInterval().start?Te=Number.parseInt(S[1].getText()):P[0]&&S[0]&&S[0].getSourceInterval().start>P[0].getSourceInterval().start&&(!P[1]||S[0].getSourceInterval().start<P[1].getSourceInterval().start)&&(Te=Number.parseInt(S[0].getText())),P[1]&&S[2]?me=Number.parseInt(S[2].getText()):P[1]&&S[1]&&S[1].getSourceInterval().start>P[1].getSourceInterval().start?me=Number.parseInt(S[1].getText()):P[1]&&S[0]&&S[0].getSourceInterval().start>P[1].getSourceInterval().start&&(me=Number.parseInt(S[0].getText())),this.push({type:"slices",start:z,end:Te,step:me})}exitFilterExpression(D){const S=this.popWithCheck("expressionContent",D);this.push({type:"filterExpression",value:S})}exitRegex(D){var S;const P=D.REGEX_EXPR().getText(),z=((S=D.REGEX_OPT())===null||S===void 0?void 0:S.getText())||"";this.push({type:"value",subtype:"regex",value:P,opts:z})}exitExpression(D){switch(!0){case!!D.NOT():{const S=this.popWithCheck("expressionContent",D);this.push({type:"notExpression",value:S});break}case!!D.NULL():this.push({type:"value",value:null,subtype:"null"});break;case!!D.FALSE():this.push({type:"value",value:!1,subtype:"boolean"});break;case!!D.TRUE():this.push({type:"value",value:!0,subtype:"boolean"});break;case!!D.AND():{const S=this.popWithCheck("expressionContent",D),P=this.popWithCheck("expressionContent",D);this.push({type:"logicalExpression",operator:"and",left:P,right:S});break}case!!D.OR():{const S=this.popWithCheck("expressionContent",D),P=this.popWithCheck("expressionContent",D);this.push({type:"logicalExpression",operator:"or",left:P,right:S});break}case!!D.PAREN_LEFT():{const S=this.popWithCheck("expressionContent",D);this.push({type:"groupExpression",value:S});break}case!!D.regex():{const S=this.popWithCheck("regex",D),P=this.popWithCheck("operationContent",D);this.push({type:"comparator",operator:"reg",left:P,right:S});break}case!!D.EMPT():{const S=this.popWithCheck("operationContent",D);this.push({type:"comparator",operator:"empty",left:S,right:null});break}case!!D.getTypedRuleContext(d.FilterargContext,1):{const S=this.popWithCheck("operationContent",D),P=this.popWithCheck("operationContent",D);switch(!0){case!!D.EQ():this.push({type:"comparator",operator:"eq",left:P,right:S});break;case!!D.NE():this.push({type:"comparator",operator:"ne",left:P,right:S});break;case!!D.LT():this.push({type:"comparator",operator:"lt",left:P,right:S});break;case!!D.LE():this.push({type:"comparator",operator:"le",left:P,right:S});break;case!!D.GT():this.push({type:"comparator",operator:"gt",left:P,right:S});break;case!!D.GE():this.push({type:"comparator",operator:"ge",left:P,right:S});break;case!!D.IN():this.push({type:"comparator",operator:"in",left:P,right:S});break;case!!D.NIN():this.push({type:"comparator",operator:"nin",left:P,right:S});break;case!!D.SUB():this.push({type:"comparator",operator:"subsetof",left:P,right:S});break;case!!D.ANY():this.push({type:"comparator",operator:"anyof",left:P,right:S});break;case!!D.NON():this.push({type:"comparator",operator:"noneof",left:P,right:S});break;case!!D.SIZ():this.push({type:"comparator",operator:"size",left:P,right:S});break;case!!D.SIZO():this.push({type:"comparator",operator:"sizeof",left:P,right:S})}break}}}exitObj(D){const S={};for(const P of D.pair()){const z=this.popWithCheck("value",D);S[P.STRING().getText().slice(1,-1)]=z.value}this.push({type:"value",subtype:"object",value:S})}exitArray(D){const S=[];for(let P=0;P<D.value().length;P+=1){const z=this.popWithCheck("value",D);S.unshift(z.value)}this.push({type:"value",subtype:"array",value:S})}exitFilterarg(D){switch(!0){case!!D.getTypedRuleContext(d.FilterargContext,1):switch(!0){case!!D.STAR():{const S=this.popWithCheck("operationContent",D),P=this.popWithCheck("operationContent",D);this.push({type:"operation",operator:"multi",left:P,right:S});break}case!!D.DIV():{const S=this.popWithCheck("operationContent",D),P=this.popWithCheck("operationContent",D);this.push({type:"operation",operator:"div",left:P,right:S});break}case!!D.PLUS():{const S=this.popWithCheck("operationContent",D),P=this.popWithCheck("operationContent",D);this.push({type:"operation",operator:"plus",left:P,right:S});break}case!!D.MINUS_SP():{const S=this.popWithCheck("operationContent",D),P=this.popWithCheck("operationContent",D);this.push({type:"operation",operator:"minus",left:P,right:S});break}default:{const S=this.popWithCheck("operationContent",D),P=this.popWithCheck("operationContent",D);this.push({type:"operation",operator:"",left:P,right:S});break}}break;case!!D.PAREN_LEFT():{const S=this.popWithCheck("operationContent",D);this.push({type:"groupOperation",value:S});break}case!!D.value():{const S=this.popWithCheck("operationContent",D);this.push(S);break}case!!D.filterpath():{const S=this.popWithCheck("operationContent",D);this.push(S);break}}}exitValue(D){switch(!0){case!!D.STRING():{const P=D.STRING().getText().slice(1,-1);this.push({type:"value",subtype:"string",value:P});break}case!!D.NUMBER():{const P=D.NUMBER().getText();P!==`${Number.parseInt(P)}`?this.push({type:"value",subtype:"number",value:Number.parseFloat(P)}):this.push({type:"value",subtype:"number",value:Number.parseInt(P)});break}case!!D.array():const S=this.popWithCheck("value",D);this.push(S);break;case!!D.obj():{const P=this.popWithCheck("value",D);this.push(P);break}case!!D.TRUE():this.push({type:"value",value:!0,subtype:"boolean"});break;case!!D.FALSE():this.push({type:"value",value:!1,subtype:"boolean"});break;case!!D.NULL():this.push({type:"value",value:null,subtype:"null"})}}}const ue={syntaxError:(K,D,S,P,z,Te)=>{throw new r(S,P,z)},reportAmbiguity:function(K,D,S,P,z,Te,me){},reportAttemptingFullContext:function(K,D,S,P,z,Te){},reportContextSensitivity:function(K,D,S,P,z,Te){}};function re(K){const D=new i.default.InputStream(K),S=new a(D),P=new i.default.CommonTokenStream(S),z=new d(P);z.removeErrorListeners(),z.addErrorListener(ue);const Te=new ne;z.buildParseTrees=!0;const me=z.jsonpath();return i.default.tree.ParseTreeWalker.DEFAULT.walk(Te,me),Te.getTree()}function V(K,D={}){try{return re(K)}catch(S){if(!D.hideExceptions)throw S;return null}}var J=is(63);const ve=(K,D)=>J(K,D),de=K=>Array.isArray(K),De=K=>{if(typeof K!="object"||K===null)return!1;let D=K;for(;Object.getPrototypeOf(D)!==null;)D=Object.getPrototypeOf(D);return Object.getPrototypeOf(K)===D},Ie=K=>typeof K=="number",Ne=K=>typeof K=="string",Be=K=>K===void 0,$e=K=>K!==void 0,et=(K,D)=>K<0?D+K:K,rt=(K,D)=>K.concat(`["${D}"]`),Ge=(K,D)=>K.concat(`[${D}]`);class nt{constructor(D){this.handleIdentifier=(S,P)=>{if(De(S.value)&&P.value in S.value)return{value:S.value[P.value],paths:rt(S.paths,P.value)}},this.handleWildcard=({value:S,paths:P})=>De(S)||de(S)?de(S)?S.map((z,Te)=>({value:z,paths:Ge(P,Te)})):Object.keys(S).map(z=>({value:S[z],paths:rt(P,z)})):[],this.handleOperationContent=(S,P)=>{var z,Te;switch(P.type){case"root":return this.handleSubscript(this.rootPayload,P.next);case"current":return this.handleSubscript(S,P.next);case"value":return{value:P.value,paths:S.paths};case"groupOperation":return this.handleOperationContent(S,P.value);case"operation":{const me=(z=this.handleOperationContent(S,P.left))===null||z===void 0?void 0:z.value,ye=(Te=this.handleOperationContent(S,P.right))===null||Te===void 0?void 0:Te.value;if(!Ie(me)||!Ie(ye))return;switch(P.operator){case"plus":return{value:me+ye,paths:S.paths};case"minus":return{value:me-ye,paths:S.paths};case"div":return ye===0?void 0:{value:me/ye,paths:S.paths};case"multi":return{value:me*ye,paths:S.paths};case"":if(ye>0)throw new r(0,0,"Missing operator in operation");return{value:me+ye,paths:S.paths}}}}},this.handleComparator=(S,P)=>{var z,Te;const me=(z=this.handleOperationContent(S,P.left))===null||z===void 0?void 0:z.value;if(P.operator==="empty")return!(!de(me)&&!Ne(me))&&me.length===0;const ye=(Te=this.handleOperationContent(S,P.right))===null||Te===void 0?void 0:Te.value;switch(P.operator){case"subsetof":{if(!de(me)||!de(ye))return!1;const st=new Set(ye);return me.every(qt=>st.has(qt))}case"anyof":{if(!de(me)||!de(ye))return!1;const st=new Set(ye);return me.some(qt=>st.has(qt))}case"noneof":{if(!de(me)||!de(ye))return!1;const st=new Set(ye);return!me.some(qt=>st.has(qt))}case"sizeof":return!(!de(me)&&!Ne(me)||!de(ye)&&!Ne(ye))&&me.length===ye.length;case"size":return!(!de(me)&&!Ne(me)||!Ie(ye))&&me.length===ye;case"eq":return ve(me,ye);case"ne":return!ve(me,ye);case"lt":return(Ie(me)&&Ie(ye)||!(!Ne(me)||!Ne(ye)))&&me<ye;case"le":return(Ie(me)&&Ie(ye)||!(!Ne(me)||!Ne(ye)))&&me<=ye;case"gt":return(Ie(me)&&Ie(ye)||!(!Ne(me)||!Ne(ye)))&&me>ye;case"ge":return(Ie(me)&&Ie(ye)||!(!Ne(me)||!Ne(ye)))&&me>=ye;case"in":return!!de(ye)&&ye.includes(me);case"nin":return!!de(ye)&&!ye.includes(me);case"reg":{if(!Ne(me)||!Ne(ye))return!1;const st=ye.slice(1,-1);return!!me.match(new RegExp(st,P.right.opts))}}},this.handleLogicalExpression=(S,P)=>{const z=this.handleFilterExpressionContent(S,P.left),Te=this.handleFilterExpressionContent(S,P.right);switch(P.operator){case"and":return z&&Te;case"or":return z||Te}},this.handleFilterExpressionContent=(S,P)=>{switch(P.type){case"logicalExpression":return this.handleLogicalExpression(S,P);case"comparator":return this.handleComparator(S,P);case"groupExpression":return this.handleFilterExpressionContent(S,P.value);case"notExpression":return!this.handleFilterExpressionContent(S,P.value);case"root":return $e(this.handleSubscript(this.rootPayload,P.next));case"current":return $e(this.handleSubscript(S,P.next));case"value":return!!P.value}},this.handleNumericLiteral=({value:S,paths:P},z)=>{if(!de(S)&&!De(S))return;if(De(S))return this.handleStringLiteral({value:S,paths:P},{type:"stringLiteral",value:`${z.value}`});const Te=et(z.value,S.length);return Te<S.length&&Te>=0?{value:S[Te],paths:Ge(P,Te)}:void 0},this.handleSlices=({value:S,paths:P},z)=>{const Te=[];if(!de(S))return[];const me=z.start!==null?et(z.start,S.length):0,ye=z.end!==null?et(z.end,S.length):S.length,st=z.step===null||z.step<=0?1:z.step;let qt=0;return S.forEach((pi,br)=>{br>=me&&br<ye&&(qt%st==0&&Te.push({value:pi,paths:Ge(P,br)}),qt+=1)}),Te},this.handleStringLiteral=({value:S,paths:P},z)=>{if(De(S)&&z.value in S)return{value:S[z.value],paths:rt(P,z.value)}},this.handleUnions=(S,P)=>De(S.value)?P.values.map(z=>{switch(z.type){case"identifier":return this.handleIdentifier(S,z);case"stringLiteral":return this.handleStringLiteral(S,z)}}).filter($e):[],this.handleIndexes=({value:S,paths:P},z)=>de(S)?z.values.map(Te=>this.handleNumericLiteral({value:S,paths:P},Te)).filter($e):[],this.handleDotdot=(S,P)=>{const z=P.value,Te=S.value;let me=[];switch(z.type){case"bracketMember":{const ye=this.handleBracketMemberContent(S,z.value);$e(ye)&&(me=me.concat(ye));break}case"bracketExpression":if(De(Te)||de(Te)&&z.value.type==="wildcard"){const ye=this.handleBracketExpressionContent(S,z.value);me=me.concat(ye)}break;case"wildcard":{const ye=this.handleWildcard(S);me=me.concat(ye);break}case"identifier":{const ye=this.handleIdentifier(S,z);$e(ye)&&(me=me.concat(ye));break}}return De(Te)?Object.keys(Te).forEach(ye=>{const st=this.handleDotdot({value:Te[ye],paths:rt(S.paths,ye)},P);me=me.concat(st)}):de(Te)&&Te.forEach((ye,st)=>{const qt=this.handleDotdot({value:ye,paths:Ge(S.paths,st)},P);me=me.concat(qt)}),me},this.handleBracketMemberContent=(S,P)=>{switch(P.type){case"identifier":return this.handleIdentifier(S,P);case"numericLiteral":return this.handleNumericLiteral(S,P);case"stringLiteral":return this.handleStringLiteral(S,P)}},this.handleBracketExpressionContent=(S,P)=>{const z=S.value;switch(P.type){case"filterExpression":{let Te=[];return de(z)?z.forEach((me,ye)=>{const st={value:me,paths:Ge(S.paths,ye)};this.handleFilterExpressionContent(st,P.value)&&(Te=Te.concat(st))}):De(z)&&this.handleFilterExpressionContent(S,P.value)&&(Te=Te.concat(S)),Te}case"indexes":return this.handleIndexes(S,P);case"unions":return this.handleUnions(S,P);case"wildcard":return this.handleWildcard(S);case"slices":return this.handleSlices(S,P)}},this.concatIndefiniteValuePaths=(S,P)=>{if(!P)return S.reduce((me,ye)=>({isIndefinite:!0,value:[...me.value,ye.value],paths:[...me.paths,ye.paths]}),{value:[],paths:[],isIndefinite:!0});let z=[],Te=[];return S.forEach(me=>{const ye=this.handleSubscript(me,P);Be(ye)||(z=ye.isIndefinite?z.concat(ye.value):[...z,ye.value],Te=Te.concat(ye.paths))}),{value:z,paths:Te,isIndefinite:!0}},this.handleSubscript=(S,P)=>{if(P===null)return S;const z=P.value;switch(z.type){case"bracketExpression":{const Te=this.handleBracketExpressionContent(S,z.value);return this.concatIndefiniteValuePaths(Te,P.next)}case"bracketMember":{const Te=this.handleBracketMemberContent(S,z.value);return Be(Te)?void 0:this.handleSubscript(Te,P.next)}case"dot":switch(z.value.type){case"identifier":{const Te=this.handleIdentifier(S,z.value);return Be(Te)?void 0:this.handleSubscript(Te,P.next)}case"numericLiteral":{const Te=this.handleNumericLiteral(S,z.value);return Be(Te)?void 0:this.handleSubscript(Te,P.next)}case"wildcard":{const Te=this.handleWildcard(S);return this.concatIndefiniteValuePaths(Te,P.next)}}case"dotdot":{const Te=this.handleDotdot(S,z);return this.concatIndefiniteValuePaths(Te,P.next)}}},this.handleRoot=S=>this.handleSubscript(this.rootPayload,S.next),this.rootPayload={value:D,paths:"$"}}}const B=(K,D,S={})=>{try{const P=re(D),z=new nt(K).handleRoot(P);return Be(z)?[]:de(z.paths)?z.paths:[z.paths]}catch(P){if(!S.hideExceptions)throw P;return[]}},se=(K,D,S)=>{const P=re(D),z=new nt(K).handleRoot(P);return!(z!=null&&z.isIndefinite)&&S.returnArray?Be(z)?[]:[z.value]:z==null?void 0:z.value},xe=(K,D,S={})=>{try{return de(D)?((P,z,Te)=>{const me=[];for(const ye of z){const st=se(P,ye,Te);$e(st)&&me.push(st)}return me})(K,D,S):se(K,D,S)}catch(P){if(!S.hideExceptions)throw P;return S.returnArray?[]:void 0}},Ae={eq:"==",ne:"!=",lt:"<",le:"<=",gt:">",ge:">=",in:"in",reg:"=~",nin:"nin",subsetof:"subsetof",anyof:"anyof",noneof:"noneof",empty:"empty",sizeof:"sizeof",size:"size"},ge={plus:"+",minus:"-",multi:"*",div:"/","":""},we={and:"&&",or:"||"};function Me(K){if(K===null)return"";switch(K.type){case"root":return"$"+Me(K.next);case"current":return"@"+Me(K.next);case"dot":return"."+Me(K.value);case"dotdot":return".."+Me(K.value);case"bracketExpression":case"bracketMember":return"["+Me(K.value)+"]";case"subscript":return Me(K.value)+Me(K.next);case"identifier":return K.value;case"wildcard":return"*";case"indexes":case"unions":return K.values.map(Me).join(", ");case"stringLiteral":return`"${K.value}"`;case"numericLiteral":return`${K.value}`;case"notExpression":return"!("+Me(K.value)+")";case"value":return K.subtype==="regex"?`${K.value}${K.opts}`:JSON.stringify(K.value);case"filterExpression":return"?("+Me(K.value)+")";case"groupOperation":case"groupExpression":return"("+Me(K.value)+")";case"operation":return Me(K.left)+" "+ge[K.operator]+" "+Me(K.right);case"comparator":return Me(K.left)+` ${Ae[K.operator]} `+Me(K.right);case"logicalExpression":return Me(K.left)+` ${we[K.operator]} `+Me(K.right);case"slices":return`${K.start!==null?K.start:""}:${K.end!==null?K.end:""}${K.step!==null?":"+K.step:""}`}}})(),ka.yS,ka.Qc,ka.Hb;var wi=ka.IO;ka.Pz;var Ci=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fa(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function YI(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var e=i.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(i).forEach(function(r){var n=Object.getOwnPropertyDescriptor(i,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return i[r]}})}),t}var Yo={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var XI=Yo.exports,Lv;function zI(){return Lv||(Lv=1,function(i,e){(function(){var t,r="4.17.20",n=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",o="__lodash_hash_undefined__",u=500,l="__lodash_placeholder__",h=1,d=2,p=4,g=1,m=2,v=1,E=2,x=4,T=8,R=16,_=32,F=64,N=128,C=256,M=512,L=30,I="...",U=800,q=16,$=1,X=2,ie=3,ne=1/0,ue=9007199254740991,re=17976931348623157e292,V=NaN,J=4294967295,ve=J-1,de=J>>>1,De=[["ary",N],["bind",v],["bindKey",E],["curry",T],["curryRight",R],["flip",M],["partial",_],["partialRight",F],["rearg",C]],Ie="[object Arguments]",Ne="[object Array]",Be="[object AsyncFunction]",$e="[object Boolean]",et="[object Date]",rt="[object DOMException]",Ge="[object Error]",nt="[object Function]",B="[object GeneratorFunction]",se="[object Map]",xe="[object Number]",Ae="[object Null]",ge="[object Object]",we="[object Promise]",Me="[object Proxy]",le="[object RegExp]",K="[object Set]",D="[object String]",S="[object Symbol]",P="[object Undefined]",z="[object WeakMap]",Te="[object WeakSet]",me="[object ArrayBuffer]",ye="[object DataView]",st="[object Float32Array]",qt="[object Float64Array]",pi="[object Int8Array]",br="[object Int16Array]",Sl="[object Int32Array]",bl="[object Uint8Array]",ea="[object Uint8ClampedArray]",ys="[object Uint16Array]",Z="[object Uint32Array]",ee=/\b__p \+= '';/g,gt=/\b(__p \+=) '' \+/g,Rt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,It=/&(?:amp|lt|gt|quot|#39);/g,Ze=/[&<>"']/g,un=RegExp(It.source),kn=RegExp(Ze.source),kr=/<%-([\s\S]+?)%>/g,cn=/<%([\s\S]+?)%>/g,fo=/<%=([\s\S]+?)%>/g,vs=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ti=/^\w*$/,Dc=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,go=/[\\^$.*+?()[\]{}|]/g,Rc=RegExp(go.source),Es=/^\s+|\s+$/g,po=/^\s+/,mo=/\s+$/,Tl=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Dl=/\{\n\/\* \[wrapped with (.+)\] \*/,Ic=/,? & /,wc=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Rl=/\\(\\)?/g,Cc=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,yo=/\w*$/,Nc=/^[-+]0x[0-9a-f]+$/i,Up=/^0b[01]+$/i,Il=/^\[object .+?Constructor\]$/,As=/^0o[0-7]+$/i,vo=/^(?:0|[1-9]\d*)$/,$p=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ta=/($^)/,YF=/['\n\r\u2028\u2029\\]/g,Lc="\\ud800-\\udfff",XF="\\u0300-\\u036f",zF="\\ufe20-\\ufe2f",jF="\\u20d0-\\u20ff",mS=XF+zF+jF,yS="\\u2700-\\u27bf",vS="a-z\\xdf-\\xf6\\xf8-\\xff",JF="\\xac\\xb1\\xd7\\xf7",QF="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ZF="\\u2000-\\u206f",eB=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ES="A-Z\\xc0-\\xd6\\xd8-\\xde",AS="\\ufe0e\\ufe0f",xS=JF+QF+ZF+eB,Gp="['’]",tB="["+Lc+"]",SS="["+xS+"]",_c="["+mS+"]",bS="\\d+",rB="["+yS+"]",TS="["+vS+"]",DS="[^"+Lc+xS+bS+yS+vS+ES+"]",qp="\\ud83c[\\udffb-\\udfff]",iB="(?:"+_c+"|"+qp+")",RS="[^"+Lc+"]",Hp="(?:\\ud83c[\\udde6-\\uddff]){2}",Vp="[\\ud800-\\udbff][\\udc00-\\udfff]",Eo="["+ES+"]",IS="\\u200d",wS="(?:"+TS+"|"+DS+")",nB="(?:"+Eo+"|"+DS+")",CS="(?:"+Gp+"(?:d|ll|m|re|s|t|ve))?",NS="(?:"+Gp+"(?:D|LL|M|RE|S|T|VE))?",LS=iB+"?",_S="["+AS+"]?",sB="(?:"+IS+"(?:"+[RS,Hp,Vp].join("|")+")"+_S+LS+")*",aB="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",oB="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",MS=_S+LS+sB,lB="(?:"+[rB,Hp,Vp].join("|")+")"+MS,uB="(?:"+[RS+_c+"?",_c,Hp,Vp,tB].join("|")+")",cB=RegExp(Gp,"g"),hB=RegExp(_c,"g"),Kp=RegExp(qp+"(?="+qp+")|"+uB+MS,"g"),dB=RegExp([Eo+"?"+TS+"+"+CS+"(?="+[SS,Eo,"$"].join("|")+")",nB+"+"+NS+"(?="+[SS,Eo+wS,"$"].join("|")+")",Eo+"?"+wS+"+"+CS,Eo+"+"+NS,oB,aB,bS,lB].join("|"),"g"),fB=RegExp("["+IS+Lc+mS+AS+"]"),gB=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,pB=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],mB=-1,Ot={};Ot[st]=Ot[qt]=Ot[pi]=Ot[br]=Ot[Sl]=Ot[bl]=Ot[ea]=Ot[ys]=Ot[Z]=!0,Ot[Ie]=Ot[Ne]=Ot[me]=Ot[$e]=Ot[ye]=Ot[et]=Ot[Ge]=Ot[nt]=Ot[se]=Ot[xe]=Ot[ge]=Ot[le]=Ot[K]=Ot[D]=Ot[z]=!1;var Lt={};Lt[Ie]=Lt[Ne]=Lt[me]=Lt[ye]=Lt[$e]=Lt[et]=Lt[st]=Lt[qt]=Lt[pi]=Lt[br]=Lt[Sl]=Lt[se]=Lt[xe]=Lt[ge]=Lt[le]=Lt[K]=Lt[D]=Lt[S]=Lt[bl]=Lt[ea]=Lt[ys]=Lt[Z]=!0,Lt[Ge]=Lt[nt]=Lt[z]=!1;var yB={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},vB={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},EB={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},AB={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},xB=parseFloat,SB=parseInt,OS=typeof Ci=="object"&&Ci&&Ci.Object===Object&&Ci,bB=typeof self=="object"&&self&&self.Object===Object&&self,yr=OS||bB||Function("return this")(),Wp=e&&!e.nodeType&&e,ra=Wp&&!0&&i&&!i.nodeType&&i,PS=ra&&ra.exports===Wp,Yp=PS&&OS.process,mi=function(){try{var Y=ra&&ra.require&&ra.require("util").types;return Y||Yp&&Yp.binding&&Yp.binding("util")}catch{}}(),kS=mi&&mi.isArrayBuffer,FS=mi&&mi.isDate,BS=mi&&mi.isMap,US=mi&&mi.isRegExp,$S=mi&&mi.isSet,GS=mi&&mi.isTypedArray;function ri(Y,ae,te){switch(te.length){case 0:return Y.call(ae);case 1:return Y.call(ae,te[0]);case 2:return Y.call(ae,te[0],te[1]);case 3:return Y.call(ae,te[0],te[1],te[2])}return Y.apply(ae,te)}function TB(Y,ae,te,Le){for(var ze=-1,Et=Y==null?0:Y.length;++ze<Et;){var rr=Y[ze];ae(Le,rr,te(rr),Y)}return Le}function yi(Y,ae){for(var te=-1,Le=Y==null?0:Y.length;++te<Le&&ae(Y[te],te,Y)!==!1;);return Y}function DB(Y,ae){for(var te=Y==null?0:Y.length;te--&&ae(Y[te],te,Y)!==!1;);return Y}function qS(Y,ae){for(var te=-1,Le=Y==null?0:Y.length;++te<Le;)if(!ae(Y[te],te,Y))return!1;return!0}function xs(Y,ae){for(var te=-1,Le=Y==null?0:Y.length,ze=0,Et=[];++te<Le;){var rr=Y[te];ae(rr,te,Y)&&(Et[ze++]=rr)}return Et}function Mc(Y,ae){var te=Y==null?0:Y.length;return!!te&&Ao(Y,ae,0)>-1}function Xp(Y,ae,te){for(var Le=-1,ze=Y==null?0:Y.length;++Le<ze;)if(te(ae,Y[Le]))return!0;return!1}function $t(Y,ae){for(var te=-1,Le=Y==null?0:Y.length,ze=Array(Le);++te<Le;)ze[te]=ae(Y[te],te,Y);return ze}function Ss(Y,ae){for(var te=-1,Le=ae.length,ze=Y.length;++te<Le;)Y[ze+te]=ae[te];return Y}function zp(Y,ae,te,Le){var ze=-1,Et=Y==null?0:Y.length;for(Le&&Et&&(te=Y[++ze]);++ze<Et;)te=ae(te,Y[ze],ze,Y);return te}function RB(Y,ae,te,Le){var ze=Y==null?0:Y.length;for(Le&&ze&&(te=Y[--ze]);ze--;)te=ae(te,Y[ze],ze,Y);return te}function jp(Y,ae){for(var te=-1,Le=Y==null?0:Y.length;++te<Le;)if(ae(Y[te],te,Y))return!0;return!1}var IB=Jp("length");function wB(Y){return Y.split("")}function CB(Y){return Y.match(wc)||[]}function HS(Y,ae,te){var Le;return te(Y,function(ze,Et,rr){if(ae(ze,Et,rr))return Le=Et,!1}),Le}function Oc(Y,ae,te,Le){for(var ze=Y.length,Et=te+(Le?1:-1);Le?Et--:++Et<ze;)if(ae(Y[Et],Et,Y))return Et;return-1}function Ao(Y,ae,te){return ae===ae?GB(Y,ae,te):Oc(Y,VS,te)}function NB(Y,ae,te,Le){for(var ze=te-1,Et=Y.length;++ze<Et;)if(Le(Y[ze],ae))return ze;return-1}function VS(Y){return Y!==Y}function KS(Y,ae){var te=Y==null?0:Y.length;return te?Zp(Y,ae)/te:V}function Jp(Y){return function(ae){return ae==null?t:ae[Y]}}function Qp(Y){return function(ae){return Y==null?t:Y[ae]}}function WS(Y,ae,te,Le,ze){return ze(Y,function(Et,rr,Ct){te=Le?(Le=!1,Et):ae(te,Et,rr,Ct)}),te}function LB(Y,ae){var te=Y.length;for(Y.sort(ae);te--;)Y[te]=Y[te].value;return Y}function Zp(Y,ae){for(var te,Le=-1,ze=Y.length;++Le<ze;){var Et=ae(Y[Le]);Et!==t&&(te=te===t?Et:te+Et)}return te}function e0(Y,ae){for(var te=-1,Le=Array(Y);++te<Y;)Le[te]=ae(te);return Le}function _B(Y,ae){return $t(ae,function(te){return[te,Y[te]]})}function ii(Y){return function(ae){return Y(ae)}}function t0(Y,ae){return $t(ae,function(te){return Y[te]})}function wl(Y,ae){return Y.has(ae)}function YS(Y,ae){for(var te=-1,Le=Y.length;++te<Le&&Ao(ae,Y[te],0)>-1;);return te}function XS(Y,ae){for(var te=Y.length;te--&&Ao(ae,Y[te],0)>-1;);return te}function MB(Y,ae){for(var te=Y.length,Le=0;te--;)Y[te]===ae&&++Le;return Le}var OB=Qp(yB),PB=Qp(vB);function kB(Y){return"\\"+AB[Y]}function FB(Y,ae){return Y==null?t:Y[ae]}function xo(Y){return fB.test(Y)}function BB(Y){return gB.test(Y)}function UB(Y){for(var ae,te=[];!(ae=Y.next()).done;)te.push(ae.value);return te}function r0(Y){var ae=-1,te=Array(Y.size);return Y.forEach(function(Le,ze){te[++ae]=[ze,Le]}),te}function zS(Y,ae){return function(te){return Y(ae(te))}}function bs(Y,ae){for(var te=-1,Le=Y.length,ze=0,Et=[];++te<Le;){var rr=Y[te];(rr===ae||rr===l)&&(Y[te]=l,Et[ze++]=te)}return Et}function Pc(Y){var ae=-1,te=Array(Y.size);return Y.forEach(function(Le){te[++ae]=Le}),te}function $B(Y){var ae=-1,te=Array(Y.size);return Y.forEach(function(Le){te[++ae]=[Le,Le]}),te}function GB(Y,ae,te){for(var Le=te-1,ze=Y.length;++Le<ze;)if(Y[Le]===ae)return Le;return-1}function qB(Y,ae,te){for(var Le=te+1;Le--;)if(Y[Le]===ae)return Le;return Le}function So(Y){return xo(Y)?VB(Y):IB(Y)}function Mi(Y){return xo(Y)?KB(Y):wB(Y)}var HB=Qp(EB);function VB(Y){for(var ae=Kp.lastIndex=0;Kp.test(Y);)++ae;return ae}function KB(Y){return Y.match(Kp)||[]}function WB(Y){return Y.match(dB)||[]}var YB=function Y(ae){ae=ae==null?yr:bo.defaults(yr.Object(),ae,bo.pick(yr,pB));var te=ae.Array,Le=ae.Date,ze=ae.Error,Et=ae.Function,rr=ae.Math,Ct=ae.Object,i0=ae.RegExp,XB=ae.String,vi=ae.TypeError,kc=te.prototype,zB=Et.prototype,To=Ct.prototype,Fc=ae["__core-js_shared__"],Bc=zB.toString,Dt=To.hasOwnProperty,jB=0,jS=function(){var c=/[^.]+$/.exec(Fc&&Fc.keys&&Fc.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),Uc=To.toString,JB=Bc.call(Ct),QB=yr._,ZB=i0("^"+Bc.call(Dt).replace(go,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),$c=PS?ae.Buffer:t,Ts=ae.Symbol,Gc=ae.Uint8Array,JS=$c?$c.allocUnsafe:t,qc=zS(Ct.getPrototypeOf,Ct),QS=Ct.create,ZS=To.propertyIsEnumerable,Hc=kc.splice,eb=Ts?Ts.isConcatSpreadable:t,Cl=Ts?Ts.iterator:t,ia=Ts?Ts.toStringTag:t,Vc=function(){try{var c=la(Ct,"defineProperty");return c({},"",{}),c}catch{}}(),e5=ae.clearTimeout!==yr.clearTimeout&&ae.clearTimeout,t5=Le&&Le.now!==yr.Date.now&&Le.now,r5=ae.setTimeout!==yr.setTimeout&&ae.setTimeout,Kc=rr.ceil,Wc=rr.floor,n0=Ct.getOwnPropertySymbols,i5=$c?$c.isBuffer:t,tb=ae.isFinite,n5=kc.join,s5=zS(Ct.keys,Ct),ir=rr.max,Tr=rr.min,a5=Le.now,o5=ae.parseInt,rb=rr.random,l5=kc.reverse,s0=la(ae,"DataView"),Nl=la(ae,"Map"),a0=la(ae,"Promise"),Do=la(ae,"Set"),Ll=la(ae,"WeakMap"),_l=la(Ct,"create"),Yc=Ll&&new Ll,Ro={},u5=ua(s0),c5=ua(Nl),h5=ua(a0),d5=ua(Do),f5=ua(Ll),Xc=Ts?Ts.prototype:t,Ml=Xc?Xc.valueOf:t,ib=Xc?Xc.toString:t;function O(c){if(Yt(c)&&!je(c)&&!(c instanceof ht)){if(c instanceof Ei)return c;if(Dt.call(c,"__wrapped__"))return nT(c)}return new Ei(c)}var Io=function(){function c(){}return function(f){if(!Ht(f))return{};if(QS)return QS(f);c.prototype=f;var y=new c;return c.prototype=t,y}}();function zc(){}function Ei(c,f){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=t}O.templateSettings={escape:kr,evaluate:cn,interpolate:fo,variable:"",imports:{_:O}},O.prototype=zc.prototype,O.prototype.constructor=O,Ei.prototype=Io(zc.prototype),Ei.prototype.constructor=Ei;function ht(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=J,this.__views__=[]}function g5(){var c=new ht(this.__wrapped__);return c.__actions__=Kr(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=Kr(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=Kr(this.__views__),c}function p5(){if(this.__filtered__){var c=new ht(this);c.__dir__=-1,c.__filtered__=!0}else c=this.clone(),c.__dir__*=-1;return c}function m5(){var c=this.__wrapped__.value(),f=this.__dir__,y=je(c),A=f<0,w=y?c.length:0,k=wU(0,w,this.__views__),G=k.start,H=k.end,W=H-G,ce=A?H:G-1,he=this.__iteratees__,pe=he.length,Re=0,Fe=Tr(W,this.__takeCount__);if(!y||!A&&w==W&&Fe==W)return Ib(c,this.__actions__);var Ke=[];e:for(;W--&&Re<Fe;){ce+=f;for(var it=-1,Ve=c[ce];++it<pe;){var ut=he[it],ft=ut.iteratee,ai=ut.type,Ur=ft(Ve);if(ai==X)Ve=Ur;else if(!Ur){if(ai==$)continue e;break e}}Ke[Re++]=Ve}return Ke}ht.prototype=Io(zc.prototype),ht.prototype.constructor=ht;function na(c){var f=-1,y=c==null?0:c.length;for(this.clear();++f<y;){var A=c[f];this.set(A[0],A[1])}}function y5(){this.__data__=_l?_l(null):{},this.size=0}function v5(c){var f=this.has(c)&&delete this.__data__[c];return this.size-=f?1:0,f}function E5(c){var f=this.__data__;if(_l){var y=f[c];return y===o?t:y}return Dt.call(f,c)?f[c]:t}function A5(c){var f=this.__data__;return _l?f[c]!==t:Dt.call(f,c)}function x5(c,f){var y=this.__data__;return this.size+=this.has(c)?0:1,y[c]=_l&&f===t?o:f,this}na.prototype.clear=y5,na.prototype.delete=v5,na.prototype.get=E5,na.prototype.has=A5,na.prototype.set=x5;function Fn(c){var f=-1,y=c==null?0:c.length;for(this.clear();++f<y;){var A=c[f];this.set(A[0],A[1])}}function S5(){this.__data__=[],this.size=0}function b5(c){var f=this.__data__,y=jc(f,c);if(y<0)return!1;var A=f.length-1;return y==A?f.pop():Hc.call(f,y,1),--this.size,!0}function T5(c){var f=this.__data__,y=jc(f,c);return y<0?t:f[y][1]}function D5(c){return jc(this.__data__,c)>-1}function R5(c,f){var y=this.__data__,A=jc(y,c);return A<0?(++this.size,y.push([c,f])):y[A][1]=f,this}Fn.prototype.clear=S5,Fn.prototype.delete=b5,Fn.prototype.get=T5,Fn.prototype.has=D5,Fn.prototype.set=R5;function Bn(c){var f=-1,y=c==null?0:c.length;for(this.clear();++f<y;){var A=c[f];this.set(A[0],A[1])}}function I5(){this.size=0,this.__data__={hash:new na,map:new(Nl||Fn),string:new na}}function w5(c){var f=lh(this,c).delete(c);return this.size-=f?1:0,f}function C5(c){return lh(this,c).get(c)}function N5(c){return lh(this,c).has(c)}function L5(c,f){var y=lh(this,c),A=y.size;return y.set(c,f),this.size+=y.size==A?0:1,this}Bn.prototype.clear=I5,Bn.prototype.delete=w5,Bn.prototype.get=C5,Bn.prototype.has=N5,Bn.prototype.set=L5;function sa(c){var f=-1,y=c==null?0:c.length;for(this.__data__=new Bn;++f<y;)this.add(c[f])}function _5(c){return this.__data__.set(c,o),this}function M5(c){return this.__data__.has(c)}sa.prototype.add=sa.prototype.push=_5,sa.prototype.has=M5;function Oi(c){var f=this.__data__=new Fn(c);this.size=f.size}function O5(){this.__data__=new Fn,this.size=0}function P5(c){var f=this.__data__,y=f.delete(c);return this.size=f.size,y}function k5(c){return this.__data__.get(c)}function F5(c){return this.__data__.has(c)}function B5(c,f){var y=this.__data__;if(y instanceof Fn){var A=y.__data__;if(!Nl||A.length<n-1)return A.push([c,f]),this.size=++y.size,this;y=this.__data__=new Bn(A)}return y.set(c,f),this.size=y.size,this}Oi.prototype.clear=O5,Oi.prototype.delete=P5,Oi.prototype.get=k5,Oi.prototype.has=F5,Oi.prototype.set=B5;function nb(c,f){var y=je(c),A=!y&&ca(c),w=!y&&!A&&Cs(c),k=!y&&!A&&!w&&Lo(c),G=y||A||w||k,H=G?e0(c.length,XB):[],W=H.length;for(var ce in c)(f||Dt.call(c,ce))&&!(G&&(ce=="length"||w&&(ce=="offset"||ce=="parent")||k&&(ce=="buffer"||ce=="byteLength"||ce=="byteOffset")||qn(ce,W)))&&H.push(ce);return H}function sb(c){var f=c.length;return f?c[y0(0,f-1)]:t}function U5(c,f){return uh(Kr(c),aa(f,0,c.length))}function $5(c){return uh(Kr(c))}function o0(c,f,y){(y!==t&&!Pi(c[f],y)||y===t&&!(f in c))&&Un(c,f,y)}function Ol(c,f,y){var A=c[f];(!(Dt.call(c,f)&&Pi(A,y))||y===t&&!(f in c))&&Un(c,f,y)}function jc(c,f){for(var y=c.length;y--;)if(Pi(c[y][0],f))return y;return-1}function G5(c,f,y,A){return Ds(c,function(w,k,G){f(A,w,y(w),G)}),A}function ab(c,f){return c&&dn(f,hr(f),c)}function q5(c,f){return c&&dn(f,Yr(f),c)}function Un(c,f,y){f=="__proto__"&&Vc?Vc(c,f,{configurable:!0,enumerable:!0,value:y,writable:!0}):c[f]=y}function l0(c,f){for(var y=-1,A=f.length,w=te(A),k=c==null;++y<A;)w[y]=k?t:q0(c,f[y]);return w}function aa(c,f,y){return c===c&&(y!==t&&(c=c<=y?c:y),f!==t&&(c=c>=f?c:f)),c}function Ai(c,f,y,A,w,k){var G,H=f&h,W=f&d,ce=f&p;if(y&&(G=w?y(c,A,w,k):y(c)),G!==t)return G;if(!Ht(c))return c;var he=je(c);if(he){if(G=NU(c),!H)return Kr(c,G)}else{var pe=Dr(c),Re=pe==nt||pe==B;if(Cs(c))return Nb(c,H);if(pe==ge||pe==Ie||Re&&!w){if(G=W||Re?{}:zb(c),!H)return W?EU(c,q5(G,c)):vU(c,ab(G,c))}else{if(!Lt[pe])return w?c:{};G=LU(c,pe,H)}}k||(k=new Oi);var Fe=k.get(c);if(Fe)return Fe;k.set(c,G),TT(c)?c.forEach(function(Ve){G.add(Ai(Ve,f,y,Ve,c,k))}):ST(c)&&c.forEach(function(Ve,ut){G.set(ut,Ai(Ve,f,y,ut,c,k))});var Ke=ce?W?w0:I0:W?Yr:hr,it=he?t:Ke(c);return yi(it||c,function(Ve,ut){it&&(ut=Ve,Ve=c[ut]),Ol(G,ut,Ai(Ve,f,y,ut,c,k))}),G}function H5(c){var f=hr(c);return function(y){return ob(y,c,f)}}function ob(c,f,y){var A=y.length;if(c==null)return!A;for(c=Ct(c);A--;){var w=y[A],k=f[w],G=c[w];if(G===t&&!(w in c)||!k(G))return!1}return!0}function lb(c,f,y){if(typeof c!="function")throw new vi(a);return Gl(function(){c.apply(t,y)},f)}function Pl(c,f,y,A){var w=-1,k=Mc,G=!0,H=c.length,W=[],ce=f.length;if(!H)return W;y&&(f=$t(f,ii(y))),A?(k=Xp,G=!1):f.length>=n&&(k=wl,G=!1,f=new sa(f));e:for(;++w<H;){var he=c[w],pe=y==null?he:y(he);if(he=A||he!==0?he:0,G&&pe===pe){for(var Re=ce;Re--;)if(f[Re]===pe)continue e;W.push(he)}else k(f,pe,A)||W.push(he)}return W}var Ds=Pb(hn),ub=Pb(c0,!0);function V5(c,f){var y=!0;return Ds(c,function(A,w,k){return y=!!f(A,w,k),y}),y}function Jc(c,f,y){for(var A=-1,w=c.length;++A<w;){var k=c[A],G=f(k);if(G!=null&&(H===t?G===G&&!si(G):y(G,H)))var H=G,W=k}return W}function K5(c,f,y,A){var w=c.length;for(y=tt(y),y<0&&(y=-y>w?0:w+y),A=A===t||A>w?w:tt(A),A<0&&(A+=w),A=y>A?0:RT(A);y<A;)c[y++]=f;return c}function cb(c,f){var y=[];return Ds(c,function(A,w,k){f(A,w,k)&&y.push(A)}),y}function vr(c,f,y,A,w){var k=-1,G=c.length;for(y||(y=MU),w||(w=[]);++k<G;){var H=c[k];f>0&&y(H)?f>1?vr(H,f-1,y,A,w):Ss(w,H):A||(w[w.length]=H)}return w}var u0=kb(),hb=kb(!0);function hn(c,f){return c&&u0(c,f,hr)}function c0(c,f){return c&&hb(c,f,hr)}function Qc(c,f){return xs(f,function(y){return Hn(c[y])})}function oa(c,f){f=Is(f,c);for(var y=0,A=f.length;c!=null&&y<A;)c=c[fn(f[y++])];return y&&y==A?c:t}function db(c,f,y){var A=f(c);return je(c)?A:Ss(A,y(c))}function Fr(c){return c==null?c===t?P:Ae:ia&&ia in Ct(c)?IU(c):$U(c)}function h0(c,f){return c>f}function W5(c,f){return c!=null&&Dt.call(c,f)}function Y5(c,f){return c!=null&&f in Ct(c)}function X5(c,f,y){return c>=Tr(f,y)&&c<ir(f,y)}function d0(c,f,y){for(var A=y?Xp:Mc,w=c[0].length,k=c.length,G=k,H=te(k),W=1/0,ce=[];G--;){var he=c[G];G&&f&&(he=$t(he,ii(f))),W=Tr(he.length,W),H[G]=!y&&(f||w>=120&&he.length>=120)?new sa(G&&he):t}he=c[0];var pe=-1,Re=H[0];e:for(;++pe<w&&ce.length<W;){var Fe=he[pe],Ke=f?f(Fe):Fe;if(Fe=y||Fe!==0?Fe:0,!(Re?wl(Re,Ke):A(ce,Ke,y))){for(G=k;--G;){var it=H[G];if(!(it?wl(it,Ke):A(c[G],Ke,y)))continue e}Re&&Re.push(Ke),ce.push(Fe)}}return ce}function z5(c,f,y,A){return hn(c,function(w,k,G){f(A,y(w),k,G)}),A}function kl(c,f,y){f=Is(f,c),c=Zb(c,f);var A=c==null?c:c[fn(Si(f))];return A==null?t:ri(A,c,y)}function fb(c){return Yt(c)&&Fr(c)==Ie}function j5(c){return Yt(c)&&Fr(c)==me}function J5(c){return Yt(c)&&Fr(c)==et}function Fl(c,f,y,A,w){return c===f?!0:c==null||f==null||!Yt(c)&&!Yt(f)?c!==c&&f!==f:Q5(c,f,y,A,Fl,w)}function Q5(c,f,y,A,w,k){var G=je(c),H=je(f),W=G?Ne:Dr(c),ce=H?Ne:Dr(f);W=W==Ie?ge:W,ce=ce==Ie?ge:ce;var he=W==ge,pe=ce==ge,Re=W==ce;if(Re&&Cs(c)){if(!Cs(f))return!1;G=!0,he=!1}if(Re&&!he)return k||(k=new Oi),G||Lo(c)?Wb(c,f,y,A,w,k):DU(c,f,W,y,A,w,k);if(!(y&g)){var Fe=he&&Dt.call(c,"__wrapped__"),Ke=pe&&Dt.call(f,"__wrapped__");if(Fe||Ke){var it=Fe?c.value():c,Ve=Ke?f.value():f;return k||(k=new Oi),w(it,Ve,y,A,k)}}return Re?(k||(k=new Oi),RU(c,f,y,A,w,k)):!1}function Z5(c){return Yt(c)&&Dr(c)==se}function f0(c,f,y,A){var w=y.length,k=w,G=!A;if(c==null)return!k;for(c=Ct(c);w--;){var H=y[w];if(G&&H[2]?H[1]!==c[H[0]]:!(H[0]in c))return!1}for(;++w<k;){H=y[w];var W=H[0],ce=c[W],he=H[1];if(G&&H[2]){if(ce===t&&!(W in c))return!1}else{var pe=new Oi;if(A)var Re=A(ce,he,W,c,f,pe);if(!(Re===t?Fl(he,ce,g|m,A,pe):Re))return!1}}return!0}function gb(c){if(!Ht(c)||PU(c))return!1;var f=Hn(c)?ZB:Il;return f.test(ua(c))}function eU(c){return Yt(c)&&Fr(c)==le}function tU(c){return Yt(c)&&Dr(c)==K}function rU(c){return Yt(c)&&ph(c.length)&&!!Ot[Fr(c)]}function pb(c){return typeof c=="function"?c:c==null?Xr:typeof c=="object"?je(c)?vb(c[0],c[1]):yb(c):FT(c)}function g0(c){if(!$l(c))return s5(c);var f=[];for(var y in Ct(c))Dt.call(c,y)&&y!="constructor"&&f.push(y);return f}function iU(c){if(!Ht(c))return UU(c);var f=$l(c),y=[];for(var A in c)A=="constructor"&&(f||!Dt.call(c,A))||y.push(A);return y}function p0(c,f){return c<f}function mb(c,f){var y=-1,A=Wr(c)?te(c.length):[];return Ds(c,function(w,k,G){A[++y]=f(w,k,G)}),A}function yb(c){var f=N0(c);return f.length==1&&f[0][2]?Jb(f[0][0],f[0][1]):function(y){return y===c||f0(y,c,f)}}function vb(c,f){return _0(c)&&jb(f)?Jb(fn(c),f):function(y){var A=q0(y,c);return A===t&&A===f?H0(y,c):Fl(f,A,g|m)}}function Zc(c,f,y,A,w){c!==f&&u0(f,function(k,G){if(w||(w=new Oi),Ht(k))nU(c,f,G,y,Zc,A,w);else{var H=A?A(O0(c,G),k,G+"",c,f,w):t;H===t&&(H=k),o0(c,G,H)}},Yr)}function nU(c,f,y,A,w,k,G){var H=O0(c,y),W=O0(f,y),ce=G.get(W);if(ce){o0(c,y,ce);return}var he=k?k(H,W,y+"",c,f,G):t,pe=he===t;if(pe){var Re=je(W),Fe=!Re&&Cs(W),Ke=!Re&&!Fe&&Lo(W);he=W,Re||Fe||Ke?je(H)?he=H:zt(H)?he=Kr(H):Fe?(pe=!1,he=Nb(W,!0)):Ke?(pe=!1,he=Lb(W,!0)):he=[]:ql(W)||ca(W)?(he=H,ca(H)?he=IT(H):(!Ht(H)||Hn(H))&&(he=zb(W))):pe=!1}pe&&(G.set(W,he),w(he,W,A,k,G),G.delete(W)),o0(c,y,he)}function Eb(c,f){var y=c.length;if(y)return f+=f<0?y:0,qn(f,y)?c[f]:t}function Ab(c,f,y){f.length?f=$t(f,function(k){return je(k)?function(G){return oa(G,k.length===1?k[0]:k)}:k}):f=[Xr];var A=-1;f=$t(f,ii(qe()));var w=mb(c,function(k,G,H){var W=$t(f,function(ce){return ce(k)});return{criteria:W,index:++A,value:k}});return LB(w,function(k,G){return yU(k,G,y)})}function sU(c,f){return xb(c,f,function(y,A){return H0(c,A)})}function xb(c,f,y){for(var A=-1,w=f.length,k={};++A<w;){var G=f[A],H=oa(c,G);y(H,G)&&Bl(k,Is(G,c),H)}return k}function aU(c){return function(f){return oa(f,c)}}function m0(c,f,y,A){var w=A?NB:Ao,k=-1,G=f.length,H=c;for(c===f&&(f=Kr(f)),y&&(H=$t(c,ii(y)));++k<G;)for(var W=0,ce=f[k],he=y?y(ce):ce;(W=w(H,he,W,A))>-1;)H!==c&&Hc.call(H,W,1),Hc.call(c,W,1);return c}function Sb(c,f){for(var y=c?f.length:0,A=y-1;y--;){var w=f[y];if(y==A||w!==k){var k=w;qn(w)?Hc.call(c,w,1):A0(c,w)}}return c}function y0(c,f){return c+Wc(rb()*(f-c+1))}function oU(c,f,y,A){for(var w=-1,k=ir(Kc((f-c)/(y||1)),0),G=te(k);k--;)G[A?k:++w]=c,c+=y;return G}function v0(c,f){var y="";if(!c||f<1||f>ue)return y;do f%2&&(y+=c),f=Wc(f/2),f&&(c+=c);while(f);return y}function at(c,f){return P0(Qb(c,f,Xr),c+"")}function lU(c){return sb(_o(c))}function uU(c,f){var y=_o(c);return uh(y,aa(f,0,y.length))}function Bl(c,f,y,A){if(!Ht(c))return c;f=Is(f,c);for(var w=-1,k=f.length,G=k-1,H=c;H!=null&&++w<k;){var W=fn(f[w]),ce=y;if(W==="__proto__"||W==="constructor"||W==="prototype")return c;if(w!=G){var he=H[W];ce=A?A(he,W,H):t,ce===t&&(ce=Ht(he)?he:qn(f[w+1])?[]:{})}Ol(H,W,ce),H=H[W]}return c}var bb=Yc?function(c,f){return Yc.set(c,f),c}:Xr,cU=Vc?function(c,f){return Vc(c,"toString",{configurable:!0,enumerable:!1,value:K0(f),writable:!0})}:Xr;function hU(c){return uh(_o(c))}function xi(c,f,y){var A=-1,w=c.length;f<0&&(f=-f>w?0:w+f),y=y>w?w:y,y<0&&(y+=w),w=f>y?0:y-f>>>0,f>>>=0;for(var k=te(w);++A<w;)k[A]=c[A+f];return k}function dU(c,f){var y;return Ds(c,function(A,w,k){return y=f(A,w,k),!y}),!!y}function eh(c,f,y){var A=0,w=c==null?A:c.length;if(typeof f=="number"&&f===f&&w<=de){for(;A<w;){var k=A+w>>>1,G=c[k];G!==null&&!si(G)&&(y?G<=f:G<f)?A=k+1:w=k}return w}return E0(c,f,Xr,y)}function E0(c,f,y,A){var w=0,k=c==null?0:c.length;if(k===0)return 0;f=y(f);for(var G=f!==f,H=f===null,W=si(f),ce=f===t;w<k;){var he=Wc((w+k)/2),pe=y(c[he]),Re=pe!==t,Fe=pe===null,Ke=pe===pe,it=si(pe);if(G)var Ve=A||Ke;else ce?Ve=Ke&&(A||Re):H?Ve=Ke&&Re&&(A||!Fe):W?Ve=Ke&&Re&&!Fe&&(A||!it):Fe||it?Ve=!1:Ve=A?pe<=f:pe<f;Ve?w=he+1:k=he}return Tr(k,ve)}function Tb(c,f){for(var y=-1,A=c.length,w=0,k=[];++y<A;){var G=c[y],H=f?f(G):G;if(!y||!Pi(H,W)){var W=H;k[w++]=G===0?0:G}}return k}function Db(c){return typeof c=="number"?c:si(c)?V:+c}function ni(c){if(typeof c=="string")return c;if(je(c))return $t(c,ni)+"";if(si(c))return ib?ib.call(c):"";var f=c+"";return f=="0"&&1/c==-ne?"-0":f}function Rs(c,f,y){var A=-1,w=Mc,k=c.length,G=!0,H=[],W=H;if(y)G=!1,w=Xp;else if(k>=n){var ce=f?null:bU(c);if(ce)return Pc(ce);G=!1,w=wl,W=new sa}else W=f?[]:H;e:for(;++A<k;){var he=c[A],pe=f?f(he):he;if(he=y||he!==0?he:0,G&&pe===pe){for(var Re=W.length;Re--;)if(W[Re]===pe)continue e;f&&W.push(pe),H.push(he)}else w(W,pe,y)||(W!==H&&W.push(pe),H.push(he))}return H}function A0(c,f){return f=Is(f,c),c=Zb(c,f),c==null||delete c[fn(Si(f))]}function Rb(c,f,y,A){return Bl(c,f,y(oa(c,f)),A)}function th(c,f,y,A){for(var w=c.length,k=A?w:-1;(A?k--:++k<w)&&f(c[k],k,c););return y?xi(c,A?0:k,A?k+1:w):xi(c,A?k+1:0,A?w:k)}function Ib(c,f){var y=c;return y instanceof ht&&(y=y.value()),zp(f,function(A,w){return w.func.apply(w.thisArg,Ss([A],w.args))},y)}function x0(c,f,y){var A=c.length;if(A<2)return A?Rs(c[0]):[];for(var w=-1,k=te(A);++w<A;)for(var G=c[w],H=-1;++H<A;)H!=w&&(k[w]=Pl(k[w]||G,c[H],f,y));return Rs(vr(k,1),f,y)}function wb(c,f,y){for(var A=-1,w=c.length,k=f.length,G={};++A<w;){var H=A<k?f[A]:t;y(G,c[A],H)}return G}function S0(c){return zt(c)?c:[]}function b0(c){return typeof c=="function"?c:Xr}function Is(c,f){return je(c)?c:_0(c,f)?[c]:iT(St(c))}var fU=at;function ws(c,f,y){var A=c.length;return y=y===t?A:y,!f&&y>=A?c:xi(c,f,y)}var Cb=e5||function(c){return yr.clearTimeout(c)};function Nb(c,f){if(f)return c.slice();var y=c.length,A=JS?JS(y):new c.constructor(y);return c.copy(A),A}function T0(c){var f=new c.constructor(c.byteLength);return new Gc(f).set(new Gc(c)),f}function gU(c,f){var y=f?T0(c.buffer):c.buffer;return new c.constructor(y,c.byteOffset,c.byteLength)}function pU(c){var f=new c.constructor(c.source,yo.exec(c));return f.lastIndex=c.lastIndex,f}function mU(c){return Ml?Ct(Ml.call(c)):{}}function Lb(c,f){var y=f?T0(c.buffer):c.buffer;return new c.constructor(y,c.byteOffset,c.length)}function _b(c,f){if(c!==f){var y=c!==t,A=c===null,w=c===c,k=si(c),G=f!==t,H=f===null,W=f===f,ce=si(f);if(!H&&!ce&&!k&&c>f||k&&G&&W&&!H&&!ce||A&&G&&W||!y&&W||!w)return 1;if(!A&&!k&&!ce&&c<f||ce&&y&&w&&!A&&!k||H&&y&&w||!G&&w||!W)return-1}return 0}function yU(c,f,y){for(var A=-1,w=c.criteria,k=f.criteria,G=w.length,H=y.length;++A<G;){var W=_b(w[A],k[A]);if(W){if(A>=H)return W;var ce=y[A];return W*(ce=="desc"?-1:1)}}return c.index-f.index}function Mb(c,f,y,A){for(var w=-1,k=c.length,G=y.length,H=-1,W=f.length,ce=ir(k-G,0),he=te(W+ce),pe=!A;++H<W;)he[H]=f[H];for(;++w<G;)(pe||w<k)&&(he[y[w]]=c[w]);for(;ce--;)he[H++]=c[w++];return he}function Ob(c,f,y,A){for(var w=-1,k=c.length,G=-1,H=y.length,W=-1,ce=f.length,he=ir(k-H,0),pe=te(he+ce),Re=!A;++w<he;)pe[w]=c[w];for(var Fe=w;++W<ce;)pe[Fe+W]=f[W];for(;++G<H;)(Re||w<k)&&(pe[Fe+y[G]]=c[w++]);return pe}function Kr(c,f){var y=-1,A=c.length;for(f||(f=te(A));++y<A;)f[y]=c[y];return f}function dn(c,f,y,A){var w=!y;y||(y={});for(var k=-1,G=f.length;++k<G;){var H=f[k],W=A?A(y[H],c[H],H,y,c):t;W===t&&(W=c[H]),w?Un(y,H,W):Ol(y,H,W)}return y}function vU(c,f){return dn(c,L0(c),f)}function EU(c,f){return dn(c,Yb(c),f)}function rh(c,f){return function(y,A){var w=je(y)?TB:G5,k=f?f():{};return w(y,c,qe(A,2),k)}}function wo(c){return at(function(f,y){var A=-1,w=y.length,k=w>1?y[w-1]:t,G=w>2?y[2]:t;for(k=c.length>3&&typeof k=="function"?(w--,k):t,G&&Br(y[0],y[1],G)&&(k=w<3?t:k,w=1),f=Ct(f);++A<w;){var H=y[A];H&&c(f,H,A,k)}return f})}function Pb(c,f){return function(y,A){if(y==null)return y;if(!Wr(y))return c(y,A);for(var w=y.length,k=f?w:-1,G=Ct(y);(f?k--:++k<w)&&A(G[k],k,G)!==!1;);return y}}function kb(c){return function(f,y,A){for(var w=-1,k=Ct(f),G=A(f),H=G.length;H--;){var W=G[c?H:++w];if(y(k[W],W,k)===!1)break}return f}}function AU(c,f,y){var A=f&v,w=Ul(c);function k(){var G=this&&this!==yr&&this instanceof k?w:c;return G.apply(A?y:this,arguments)}return k}function Fb(c){return function(f){f=St(f);var y=xo(f)?Mi(f):t,A=y?y[0]:f.charAt(0),w=y?ws(y,1).join(""):f.slice(1);return A[c]()+w}}function Co(c){return function(f){return zp(PT(OT(f).replace(cB,"")),c,"")}}function Ul(c){return function(){var f=arguments;switch(f.length){case 0:return new c;case 1:return new c(f[0]);case 2:return new c(f[0],f[1]);case 3:return new c(f[0],f[1],f[2]);case 4:return new c(f[0],f[1],f[2],f[3]);case 5:return new c(f[0],f[1],f[2],f[3],f[4]);case 6:return new c(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new c(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var y=Io(c.prototype),A=c.apply(y,f);return Ht(A)?A:y}}function xU(c,f,y){var A=Ul(c);function w(){for(var k=arguments.length,G=te(k),H=k,W=No(w);H--;)G[H]=arguments[H];var ce=k<3&&G[0]!==W&&G[k-1]!==W?[]:bs(G,W);if(k-=ce.length,k<y)return qb(c,f,ih,w.placeholder,t,G,ce,t,t,y-k);var he=this&&this!==yr&&this instanceof w?A:c;return ri(he,this,G)}return w}function Bb(c){return function(f,y,A){var w=Ct(f);if(!Wr(f)){var k=qe(y,3);f=hr(f),y=function(H){return k(w[H],H,w)}}var G=c(f,y,A);return G>-1?w[k?f[G]:G]:t}}function Ub(c){return Gn(function(f){var y=f.length,A=y,w=Ei.prototype.thru;for(c&&f.reverse();A--;){var k=f[A];if(typeof k!="function")throw new vi(a);if(w&&!G&&oh(k)=="wrapper")var G=new Ei([],!0)}for(A=G?A:y;++A<y;){k=f[A];var H=oh(k),W=H=="wrapper"?C0(k):t;W&&M0(W[0])&&W[1]==(N|T|_|C)&&!W[4].length&&W[9]==1?G=G[oh(W[0])].apply(G,W[3]):G=k.length==1&&M0(k)?G[H]():G.thru(k)}return function(){var ce=arguments,he=ce[0];if(G&&ce.length==1&&je(he))return G.plant(he).value();for(var pe=0,Re=y?f[pe].apply(this,ce):he;++pe<y;)Re=f[pe].call(this,Re);return Re}})}function ih(c,f,y,A,w,k,G,H,W,ce){var he=f&N,pe=f&v,Re=f&E,Fe=f&(T|R),Ke=f&M,it=Re?t:Ul(c);function Ve(){for(var ut=arguments.length,ft=te(ut),ai=ut;ai--;)ft[ai]=arguments[ai];if(Fe)var Ur=No(Ve),oi=MB(ft,Ur);if(A&&(ft=Mb(ft,A,w,Fe)),k&&(ft=Ob(ft,k,G,Fe)),ut-=oi,Fe&&ut<ce){var jt=bs(ft,Ur);return qb(c,f,ih,Ve.placeholder,y,ft,jt,H,W,ce-ut)}var ki=pe?y:this,Kn=Re?ki[c]:c;return ut=ft.length,H?ft=GU(ft,H):Ke&&ut>1&&ft.reverse(),he&&W<ut&&(ft.length=W),this&&this!==yr&&this instanceof Ve&&(Kn=it||Ul(Kn)),Kn.apply(ki,ft)}return Ve}function $b(c,f){return function(y,A){return z5(y,c,f(A),{})}}function nh(c,f){return function(y,A){var w;if(y===t&&A===t)return f;if(y!==t&&(w=y),A!==t){if(w===t)return A;typeof y=="string"||typeof A=="string"?(y=ni(y),A=ni(A)):(y=Db(y),A=Db(A)),w=c(y,A)}return w}}function D0(c){return Gn(function(f){return f=$t(f,ii(qe())),at(function(y){var A=this;return c(f,function(w){return ri(w,A,y)})})})}function sh(c,f){f=f===t?" ":ni(f);var y=f.length;if(y<2)return y?v0(f,c):f;var A=v0(f,Kc(c/So(f)));return xo(f)?ws(Mi(A),0,c).join(""):A.slice(0,c)}function SU(c,f,y,A){var w=f&v,k=Ul(c);function G(){for(var H=-1,W=arguments.length,ce=-1,he=A.length,pe=te(he+W),Re=this&&this!==yr&&this instanceof G?k:c;++ce<he;)pe[ce]=A[ce];for(;W--;)pe[ce++]=arguments[++H];return ri(Re,w?y:this,pe)}return G}function Gb(c){return function(f,y,A){return A&&typeof A!="number"&&Br(f,y,A)&&(y=A=t),f=Vn(f),y===t?(y=f,f=0):y=Vn(y),A=A===t?f<y?1:-1:Vn(A),oU(f,y,A,c)}}function ah(c){return function(f,y){return typeof f=="string"&&typeof y=="string"||(f=bi(f),y=bi(y)),c(f,y)}}function qb(c,f,y,A,w,k,G,H,W,ce){var he=f&T,pe=he?G:t,Re=he?t:G,Fe=he?k:t,Ke=he?t:k;f|=he?_:F,f&=~(he?F:_),f&x||(f&=-4);var it=[c,f,w,Fe,pe,Ke,Re,H,W,ce],Ve=y.apply(t,it);return M0(c)&&eT(Ve,it),Ve.placeholder=A,tT(Ve,c,f)}function R0(c){var f=rr[c];return function(y,A){if(y=bi(y),A=A==null?0:Tr(tt(A),292),A&&tb(y)){var w=(St(y)+"e").split("e"),k=f(w[0]+"e"+(+w[1]+A));return w=(St(k)+"e").split("e"),+(w[0]+"e"+(+w[1]-A))}return f(y)}}var bU=Do&&1/Pc(new Do([,-0]))[1]==ne?function(c){return new Do(c)}:X0;function Hb(c){return function(f){var y=Dr(f);return y==se?r0(f):y==K?$B(f):_B(f,c(f))}}function $n(c,f,y,A,w,k,G,H){var W=f&E;if(!W&&typeof c!="function")throw new vi(a);var ce=A?A.length:0;if(ce||(f&=-97,A=w=t),G=G===t?G:ir(tt(G),0),H=H===t?H:tt(H),ce-=w?w.length:0,f&F){var he=A,pe=w;A=w=t}var Re=W?t:C0(c),Fe=[c,f,y,A,w,he,pe,k,G,H];if(Re&&BU(Fe,Re),c=Fe[0],f=Fe[1],y=Fe[2],A=Fe[3],w=Fe[4],H=Fe[9]=Fe[9]===t?W?0:c.length:ir(Fe[9]-ce,0),!H&&f&(T|R)&&(f&=-25),!f||f==v)var Ke=AU(c,f,y);else f==T||f==R?Ke=xU(c,f,H):(f==_||f==(v|_))&&!w.length?Ke=SU(c,f,y,A):Ke=ih.apply(t,Fe);var it=Re?bb:eT;return tT(it(Ke,Fe),c,f)}function Vb(c,f,y,A){return c===t||Pi(c,To[y])&&!Dt.call(A,y)?f:c}function Kb(c,f,y,A,w,k){return Ht(c)&&Ht(f)&&(k.set(f,c),Zc(c,f,t,Kb,k),k.delete(f)),c}function TU(c){return ql(c)?t:c}function Wb(c,f,y,A,w,k){var G=y&g,H=c.length,W=f.length;if(H!=W&&!(G&&W>H))return!1;var ce=k.get(c),he=k.get(f);if(ce&&he)return ce==f&&he==c;var pe=-1,Re=!0,Fe=y&m?new sa:t;for(k.set(c,f),k.set(f,c);++pe<H;){var Ke=c[pe],it=f[pe];if(A)var Ve=G?A(it,Ke,pe,f,c,k):A(Ke,it,pe,c,f,k);if(Ve!==t){if(Ve)continue;Re=!1;break}if(Fe){if(!jp(f,function(ut,ft){if(!wl(Fe,ft)&&(Ke===ut||w(Ke,ut,y,A,k)))return Fe.push(ft)})){Re=!1;break}}else if(!(Ke===it||w(Ke,it,y,A,k))){Re=!1;break}}return k.delete(c),k.delete(f),Re}function DU(c,f,y,A,w,k,G){switch(y){case ye:if(c.byteLength!=f.byteLength||c.byteOffset!=f.byteOffset)return!1;c=c.buffer,f=f.buffer;case me:return!(c.byteLength!=f.byteLength||!k(new Gc(c),new Gc(f)));case $e:case et:case xe:return Pi(+c,+f);case Ge:return c.name==f.name&&c.message==f.message;case le:case D:return c==f+"";case se:var H=r0;case K:var W=A&g;if(H||(H=Pc),c.size!=f.size&&!W)return!1;var ce=G.get(c);if(ce)return ce==f;A|=m,G.set(c,f);var he=Wb(H(c),H(f),A,w,k,G);return G.delete(c),he;case S:if(Ml)return Ml.call(c)==Ml.call(f)}return!1}function RU(c,f,y,A,w,k){var G=y&g,H=I0(c),W=H.length,ce=I0(f),he=ce.length;if(W!=he&&!G)return!1;for(var pe=W;pe--;){var Re=H[pe];if(!(G?Re in f:Dt.call(f,Re)))return!1}var Fe=k.get(c),Ke=k.get(f);if(Fe&&Ke)return Fe==f&&Ke==c;var it=!0;k.set(c,f),k.set(f,c);for(var Ve=G;++pe<W;){Re=H[pe];var ut=c[Re],ft=f[Re];if(A)var ai=G?A(ft,ut,Re,f,c,k):A(ut,ft,Re,c,f,k);if(!(ai===t?ut===ft||w(ut,ft,y,A,k):ai)){it=!1;break}Ve||(Ve=Re=="constructor")}if(it&&!Ve){var Ur=c.constructor,oi=f.constructor;Ur!=oi&&"constructor"in c&&"constructor"in f&&!(typeof Ur=="function"&&Ur instanceof Ur&&typeof oi=="function"&&oi instanceof oi)&&(it=!1)}return k.delete(c),k.delete(f),it}function Gn(c){return P0(Qb(c,t,oT),c+"")}function I0(c){return db(c,hr,L0)}function w0(c){return db(c,Yr,Yb)}var C0=Yc?function(c){return Yc.get(c)}:X0;function oh(c){for(var f=c.name+"",y=Ro[f],A=Dt.call(Ro,f)?y.length:0;A--;){var w=y[A],k=w.func;if(k==null||k==c)return w.name}return f}function No(c){var f=Dt.call(O,"placeholder")?O:c;return f.placeholder}function qe(){var c=O.iteratee||W0;return c=c===W0?pb:c,arguments.length?c(arguments[0],arguments[1]):c}function lh(c,f){var y=c.__data__;return OU(f)?y[typeof f=="string"?"string":"hash"]:y.map}function N0(c){for(var f=hr(c),y=f.length;y--;){var A=f[y],w=c[A];f[y]=[A,w,jb(w)]}return f}function la(c,f){var y=FB(c,f);return gb(y)?y:t}function IU(c){var f=Dt.call(c,ia),y=c[ia];try{c[ia]=t;var A=!0}catch{}var w=Uc.call(c);return A&&(f?c[ia]=y:delete c[ia]),w}var L0=n0?function(c){return c==null?[]:(c=Ct(c),xs(n0(c),function(f){return ZS.call(c,f)}))}:z0,Yb=n0?function(c){for(var f=[];c;)Ss(f,L0(c)),c=qc(c);return f}:z0,Dr=Fr;(s0&&Dr(new s0(new ArrayBuffer(1)))!=ye||Nl&&Dr(new Nl)!=se||a0&&Dr(a0.resolve())!=we||Do&&Dr(new Do)!=K||Ll&&Dr(new Ll)!=z)&&(Dr=function(c){var f=Fr(c),y=f==ge?c.constructor:t,A=y?ua(y):"";if(A)switch(A){case u5:return ye;case c5:return se;case h5:return we;case d5:return K;case f5:return z}return f});function wU(c,f,y){for(var A=-1,w=y.length;++A<w;){var k=y[A],G=k.size;switch(k.type){case"drop":c+=G;break;case"dropRight":f-=G;break;case"take":f=Tr(f,c+G);break;case"takeRight":c=ir(c,f-G);break}}return{start:c,end:f}}function CU(c){var f=c.match(Dl);return f?f[1].split(Ic):[]}function Xb(c,f,y){f=Is(f,c);for(var A=-1,w=f.length,k=!1;++A<w;){var G=fn(f[A]);if(!(k=c!=null&&y(c,G)))break;c=c[G]}return k||++A!=w?k:(w=c==null?0:c.length,!!w&&ph(w)&&qn(G,w)&&(je(c)||ca(c)))}function NU(c){var f=c.length,y=new c.constructor(f);return f&&typeof c[0]=="string"&&Dt.call(c,"index")&&(y.index=c.index,y.input=c.input),y}function zb(c){return typeof c.constructor=="function"&&!$l(c)?Io(qc(c)):{}}function LU(c,f,y){var A=c.constructor;switch(f){case me:return T0(c);case $e:case et:return new A(+c);case ye:return gU(c,y);case st:case qt:case pi:case br:case Sl:case bl:case ea:case ys:case Z:return Lb(c,y);case se:return new A;case xe:case D:return new A(c);case le:return pU(c);case K:return new A;case S:return mU(c)}}function _U(c,f){var y=f.length;if(!y)return c;var A=y-1;return f[A]=(y>1?"& ":"")+f[A],f=f.join(y>2?", ":" "),c.replace(Tl,`{
/* [wrapped with `+f+`] */
`)}function MU(c){return je(c)||ca(c)||!!(eb&&c&&c[eb])}function qn(c,f){var y=typeof c;return f=f??ue,!!f&&(y=="number"||y!="symbol"&&vo.test(c))&&c>-1&&c%1==0&&c<f}function Br(c,f,y){if(!Ht(y))return!1;var A=typeof f;return(A=="number"?Wr(y)&&qn(f,y.length):A=="string"&&f in y)?Pi(y[f],c):!1}function _0(c,f){if(je(c))return!1;var y=typeof c;return y=="number"||y=="symbol"||y=="boolean"||c==null||si(c)?!0:ti.test(c)||!vs.test(c)||f!=null&&c in Ct(f)}function OU(c){var f=typeof c;return f=="string"||f=="number"||f=="symbol"||f=="boolean"?c!=="__proto__":c===null}function M0(c){var f=oh(c),y=O[f];if(typeof y!="function"||!(f in ht.prototype))return!1;if(c===y)return!0;var A=C0(y);return!!A&&c===A[0]}function PU(c){return!!jS&&jS in c}var kU=Fc?Hn:j0;function $l(c){var f=c&&c.constructor,y=typeof f=="function"&&f.prototype||To;return c===y}function jb(c){return c===c&&!Ht(c)}function Jb(c,f){return function(y){return y==null?!1:y[c]===f&&(f!==t||c in Ct(y))}}function FU(c){var f=fh(c,function(A){return y.size===u&&y.clear(),A}),y=f.cache;return f}function BU(c,f){var y=c[1],A=f[1],w=y|A,k=w<(v|E|N),G=A==N&&y==T||A==N&&y==C&&c[7].length<=f[8]||A==(N|C)&&f[7].length<=f[8]&&y==T;if(!(k||G))return c;A&v&&(c[2]=f[2],w|=y&v?0:x);var H=f[3];if(H){var W=c[3];c[3]=W?Mb(W,H,f[4]):H,c[4]=W?bs(c[3],l):f[4]}return H=f[5],H&&(W=c[5],c[5]=W?Ob(W,H,f[6]):H,c[6]=W?bs(c[5],l):f[6]),H=f[7],H&&(c[7]=H),A&N&&(c[8]=c[8]==null?f[8]:Tr(c[8],f[8])),c[9]==null&&(c[9]=f[9]),c[0]=f[0],c[1]=w,c}function UU(c){var f=[];if(c!=null)for(var y in Ct(c))f.push(y);return f}function $U(c){return Uc.call(c)}function Qb(c,f,y){return f=ir(f===t?c.length-1:f,0),function(){for(var A=arguments,w=-1,k=ir(A.length-f,0),G=te(k);++w<k;)G[w]=A[f+w];w=-1;for(var H=te(f+1);++w<f;)H[w]=A[w];return H[f]=y(G),ri(c,this,H)}}function Zb(c,f){return f.length<2?c:oa(c,xi(f,0,-1))}function GU(c,f){for(var y=c.length,A=Tr(f.length,y),w=Kr(c);A--;){var k=f[A];c[A]=qn(k,y)?w[k]:t}return c}function O0(c,f){if(!(f==="constructor"&&typeof c[f]=="function")&&f!="__proto__")return c[f]}var eT=rT(bb),Gl=r5||function(c,f){return yr.setTimeout(c,f)},P0=rT(cU);function tT(c,f,y){var A=f+"";return P0(c,_U(A,qU(CU(A),y)))}function rT(c){var f=0,y=0;return function(){var A=a5(),w=q-(A-y);if(y=A,w>0){if(++f>=U)return arguments[0]}else f=0;return c.apply(t,arguments)}}function uh(c,f){var y=-1,A=c.length,w=A-1;for(f=f===t?A:f;++y<f;){var k=y0(y,w),G=c[k];c[k]=c[y],c[y]=G}return c.length=f,c}var iT=FU(function(c){var f=[];return c.charCodeAt(0)===46&&f.push(""),c.replace(Dc,function(y,A,w,k){f.push(w?k.replace(Rl,"$1"):A||y)}),f});function fn(c){if(typeof c=="string"||si(c))return c;var f=c+"";return f=="0"&&1/c==-ne?"-0":f}function ua(c){if(c!=null){try{return Bc.call(c)}catch{}try{return c+""}catch{}}return""}function qU(c,f){return yi(De,function(y){var A="_."+y[0];f&y[1]&&!Mc(c,A)&&c.push(A)}),c.sort()}function nT(c){if(c instanceof ht)return c.clone();var f=new Ei(c.__wrapped__,c.__chain__);return f.__actions__=Kr(c.__actions__),f.__index__=c.__index__,f.__values__=c.__values__,f}function HU(c,f,y){(y?Br(c,f,y):f===t)?f=1:f=ir(tt(f),0);var A=c==null?0:c.length;if(!A||f<1)return[];for(var w=0,k=0,G=te(Kc(A/f));w<A;)G[k++]=xi(c,w,w+=f);return G}function VU(c){for(var f=-1,y=c==null?0:c.length,A=0,w=[];++f<y;){var k=c[f];k&&(w[A++]=k)}return w}function KU(){var c=arguments.length;if(!c)return[];for(var f=te(c-1),y=arguments[0],A=c;A--;)f[A-1]=arguments[A];return Ss(je(y)?Kr(y):[y],vr(f,1))}var WU=at(function(c,f){return zt(c)?Pl(c,vr(f,1,zt,!0)):[]}),YU=at(function(c,f){var y=Si(f);return zt(y)&&(y=t),zt(c)?Pl(c,vr(f,1,zt,!0),qe(y,2)):[]}),XU=at(function(c,f){var y=Si(f);return zt(y)&&(y=t),zt(c)?Pl(c,vr(f,1,zt,!0),t,y):[]});function zU(c,f,y){var A=c==null?0:c.length;return A?(f=y||f===t?1:tt(f),xi(c,f<0?0:f,A)):[]}function jU(c,f,y){var A=c==null?0:c.length;return A?(f=y||f===t?1:tt(f),f=A-f,xi(c,0,f<0?0:f)):[]}function JU(c,f){return c&&c.length?th(c,qe(f,3),!0,!0):[]}function QU(c,f){return c&&c.length?th(c,qe(f,3),!0):[]}function ZU(c,f,y,A){var w=c==null?0:c.length;return w?(y&&typeof y!="number"&&Br(c,f,y)&&(y=0,A=w),K5(c,f,y,A)):[]}function sT(c,f,y){var A=c==null?0:c.length;if(!A)return-1;var w=y==null?0:tt(y);return w<0&&(w=ir(A+w,0)),Oc(c,qe(f,3),w)}function aT(c,f,y){var A=c==null?0:c.length;if(!A)return-1;var w=A-1;return y!==t&&(w=tt(y),w=y<0?ir(A+w,0):Tr(w,A-1)),Oc(c,qe(f,3),w,!0)}function oT(c){var f=c==null?0:c.length;return f?vr(c,1):[]}function e4(c){var f=c==null?0:c.length;return f?vr(c,ne):[]}function t4(c,f){var y=c==null?0:c.length;return y?(f=f===t?1:tt(f),vr(c,f)):[]}function r4(c){for(var f=-1,y=c==null?0:c.length,A={};++f<y;){var w=c[f];A[w[0]]=w[1]}return A}function lT(c){return c&&c.length?c[0]:t}function i4(c,f,y){var A=c==null?0:c.length;if(!A)return-1;var w=y==null?0:tt(y);return w<0&&(w=ir(A+w,0)),Ao(c,f,w)}function n4(c){var f=c==null?0:c.length;return f?xi(c,0,-1):[]}var s4=at(function(c){var f=$t(c,S0);return f.length&&f[0]===c[0]?d0(f):[]}),a4=at(function(c){var f=Si(c),y=$t(c,S0);return f===Si(y)?f=t:y.pop(),y.length&&y[0]===c[0]?d0(y,qe(f,2)):[]}),o4=at(function(c){var f=Si(c),y=$t(c,S0);return f=typeof f=="function"?f:t,f&&y.pop(),y.length&&y[0]===c[0]?d0(y,t,f):[]});function l4(c,f){return c==null?"":n5.call(c,f)}function Si(c){var f=c==null?0:c.length;return f?c[f-1]:t}function u4(c,f,y){var A=c==null?0:c.length;if(!A)return-1;var w=A;return y!==t&&(w=tt(y),w=w<0?ir(A+w,0):Tr(w,A-1)),f===f?qB(c,f,w):Oc(c,VS,w,!0)}function c4(c,f){return c&&c.length?Eb(c,tt(f)):t}var h4=at(uT);function uT(c,f){return c&&c.length&&f&&f.length?m0(c,f):c}function d4(c,f,y){return c&&c.length&&f&&f.length?m0(c,f,qe(y,2)):c}function f4(c,f,y){return c&&c.length&&f&&f.length?m0(c,f,t,y):c}var g4=Gn(function(c,f){var y=c==null?0:c.length,A=l0(c,f);return Sb(c,$t(f,function(w){return qn(w,y)?+w:w}).sort(_b)),A});function p4(c,f){var y=[];if(!(c&&c.length))return y;var A=-1,w=[],k=c.length;for(f=qe(f,3);++A<k;){var G=c[A];f(G,A,c)&&(y.push(G),w.push(A))}return Sb(c,w),y}function k0(c){return c==null?c:l5.call(c)}function m4(c,f,y){var A=c==null?0:c.length;return A?(y&&typeof y!="number"&&Br(c,f,y)?(f=0,y=A):(f=f==null?0:tt(f),y=y===t?A:tt(y)),xi(c,f,y)):[]}function y4(c,f){return eh(c,f)}function v4(c,f,y){return E0(c,f,qe(y,2))}function E4(c,f){var y=c==null?0:c.length;if(y){var A=eh(c,f);if(A<y&&Pi(c[A],f))return A}return-1}function A4(c,f){return eh(c,f,!0)}function x4(c,f,y){return E0(c,f,qe(y,2),!0)}function S4(c,f){var y=c==null?0:c.length;if(y){var A=eh(c,f,!0)-1;if(Pi(c[A],f))return A}return-1}function b4(c){return c&&c.length?Tb(c):[]}function T4(c,f){return c&&c.length?Tb(c,qe(f,2)):[]}function D4(c){var f=c==null?0:c.length;return f?xi(c,1,f):[]}function R4(c,f,y){return c&&c.length?(f=y||f===t?1:tt(f),xi(c,0,f<0?0:f)):[]}function I4(c,f,y){var A=c==null?0:c.length;return A?(f=y||f===t?1:tt(f),f=A-f,xi(c,f<0?0:f,A)):[]}function w4(c,f){return c&&c.length?th(c,qe(f,3),!1,!0):[]}function C4(c,f){return c&&c.length?th(c,qe(f,3)):[]}var N4=at(function(c){return Rs(vr(c,1,zt,!0))}),L4=at(function(c){var f=Si(c);return zt(f)&&(f=t),Rs(vr(c,1,zt,!0),qe(f,2))}),_4=at(function(c){var f=Si(c);return f=typeof f=="function"?f:t,Rs(vr(c,1,zt,!0),t,f)});function M4(c){return c&&c.length?Rs(c):[]}function O4(c,f){return c&&c.length?Rs(c,qe(f,2)):[]}function P4(c,f){return f=typeof f=="function"?f:t,c&&c.length?Rs(c,t,f):[]}function F0(c){if(!(c&&c.length))return[];var f=0;return c=xs(c,function(y){if(zt(y))return f=ir(y.length,f),!0}),e0(f,function(y){return $t(c,Jp(y))})}function cT(c,f){if(!(c&&c.length))return[];var y=F0(c);return f==null?y:$t(y,function(A){return ri(f,t,A)})}var k4=at(function(c,f){return zt(c)?Pl(c,f):[]}),F4=at(function(c){return x0(xs(c,zt))}),B4=at(function(c){var f=Si(c);return zt(f)&&(f=t),x0(xs(c,zt),qe(f,2))}),U4=at(function(c){var f=Si(c);return f=typeof f=="function"?f:t,x0(xs(c,zt),t,f)}),$4=at(F0);function G4(c,f){return wb(c||[],f||[],Ol)}function q4(c,f){return wb(c||[],f||[],Bl)}var H4=at(function(c){var f=c.length,y=f>1?c[f-1]:t;return y=typeof y=="function"?(c.pop(),y):t,cT(c,y)});function hT(c){var f=O(c);return f.__chain__=!0,f}function V4(c,f){return f(c),c}function ch(c,f){return f(c)}var K4=Gn(function(c){var f=c.length,y=f?c[0]:0,A=this.__wrapped__,w=function(k){return l0(k,c)};return f>1||this.__actions__.length||!(A instanceof ht)||!qn(y)?this.thru(w):(A=A.slice(y,+y+(f?1:0)),A.__actions__.push({func:ch,args:[w],thisArg:t}),new Ei(A,this.__chain__).thru(function(k){return f&&!k.length&&k.push(t),k}))});function W4(){return hT(this)}function Y4(){return new Ei(this.value(),this.__chain__)}function X4(){this.__values__===t&&(this.__values__=DT(this.value()));var c=this.__index__>=this.__values__.length,f=c?t:this.__values__[this.__index__++];return{done:c,value:f}}function z4(){return this}function j4(c){for(var f,y=this;y instanceof zc;){var A=nT(y);A.__index__=0,A.__values__=t,f?w.__wrapped__=A:f=A;var w=A;y=y.__wrapped__}return w.__wrapped__=c,f}function J4(){var c=this.__wrapped__;if(c instanceof ht){var f=c;return this.__actions__.length&&(f=new ht(this)),f=f.reverse(),f.__actions__.push({func:ch,args:[k0],thisArg:t}),new Ei(f,this.__chain__)}return this.thru(k0)}function Q4(){return Ib(this.__wrapped__,this.__actions__)}var Z4=rh(function(c,f,y){Dt.call(c,y)?++c[y]:Un(c,y,1)});function e8(c,f,y){var A=je(c)?qS:V5;return y&&Br(c,f,y)&&(f=t),A(c,qe(f,3))}function t8(c,f){var y=je(c)?xs:cb;return y(c,qe(f,3))}var r8=Bb(sT),i8=Bb(aT);function n8(c,f){return vr(hh(c,f),1)}function s8(c,f){return vr(hh(c,f),ne)}function a8(c,f,y){return y=y===t?1:tt(y),vr(hh(c,f),y)}function dT(c,f){var y=je(c)?yi:Ds;return y(c,qe(f,3))}function fT(c,f){var y=je(c)?DB:ub;return y(c,qe(f,3))}var o8=rh(function(c,f,y){Dt.call(c,y)?c[y].push(f):Un(c,y,[f])});function l8(c,f,y,A){c=Wr(c)?c:_o(c),y=y&&!A?tt(y):0;var w=c.length;return y<0&&(y=ir(w+y,0)),mh(c)?y<=w&&c.indexOf(f,y)>-1:!!w&&Ao(c,f,y)>-1}var u8=at(function(c,f,y){var A=-1,w=typeof f=="function",k=Wr(c)?te(c.length):[];return Ds(c,function(G){k[++A]=w?ri(f,G,y):kl(G,f,y)}),k}),c8=rh(function(c,f,y){Un(c,y,f)});function hh(c,f){var y=je(c)?$t:mb;return y(c,qe(f,3))}function h8(c,f,y,A){return c==null?[]:(je(f)||(f=f==null?[]:[f]),y=A?t:y,je(y)||(y=y==null?[]:[y]),Ab(c,f,y))}var d8=rh(function(c,f,y){c[y?0:1].push(f)},function(){return[[],[]]});function f8(c,f,y){var A=je(c)?zp:WS,w=arguments.length<3;return A(c,qe(f,4),y,w,Ds)}function g8(c,f,y){var A=je(c)?RB:WS,w=arguments.length<3;return A(c,qe(f,4),y,w,ub)}function p8(c,f){var y=je(c)?xs:cb;return y(c,gh(qe(f,3)))}function m8(c){var f=je(c)?sb:lU;return f(c)}function y8(c,f,y){(y?Br(c,f,y):f===t)?f=1:f=tt(f);var A=je(c)?U5:uU;return A(c,f)}function v8(c){var f=je(c)?$5:hU;return f(c)}function E8(c){if(c==null)return 0;if(Wr(c))return mh(c)?So(c):c.length;var f=Dr(c);return f==se||f==K?c.size:g0(c).length}function A8(c,f,y){var A=je(c)?jp:dU;return y&&Br(c,f,y)&&(f=t),A(c,qe(f,3))}var x8=at(function(c,f){if(c==null)return[];var y=f.length;return y>1&&Br(c,f[0],f[1])?f=[]:y>2&&Br(f[0],f[1],f[2])&&(f=[f[0]]),Ab(c,vr(f,1),[])}),dh=t5||function(){return yr.Date.now()};function S8(c,f){if(typeof f!="function")throw new vi(a);return c=tt(c),function(){if(--c<1)return f.apply(this,arguments)}}function gT(c,f,y){return f=y?t:f,f=c&&f==null?c.length:f,$n(c,N,t,t,t,t,f)}function pT(c,f){var y;if(typeof f!="function")throw new vi(a);return c=tt(c),function(){return--c>0&&(y=f.apply(this,arguments)),c<=1&&(f=t),y}}var B0=at(function(c,f,y){var A=v;if(y.length){var w=bs(y,No(B0));A|=_}return $n(c,A,f,y,w)}),mT=at(function(c,f,y){var A=v|E;if(y.length){var w=bs(y,No(mT));A|=_}return $n(f,A,c,y,w)});function yT(c,f,y){f=y?t:f;var A=$n(c,T,t,t,t,t,t,f);return A.placeholder=yT.placeholder,A}function vT(c,f,y){f=y?t:f;var A=$n(c,R,t,t,t,t,t,f);return A.placeholder=vT.placeholder,A}function ET(c,f,y){var A,w,k,G,H,W,ce=0,he=!1,pe=!1,Re=!0;if(typeof c!="function")throw new vi(a);f=bi(f)||0,Ht(y)&&(he=!!y.leading,pe="maxWait"in y,k=pe?ir(bi(y.maxWait)||0,f):k,Re="trailing"in y?!!y.trailing:Re);function Fe(jt){var ki=A,Kn=w;return A=w=t,ce=jt,G=c.apply(Kn,ki),G}function Ke(jt){return ce=jt,H=Gl(ut,f),he?Fe(jt):G}function it(jt){var ki=jt-W,Kn=jt-ce,BT=f-ki;return pe?Tr(BT,k-Kn):BT}function Ve(jt){var ki=jt-W,Kn=jt-ce;return W===t||ki>=f||ki<0||pe&&Kn>=k}function ut(){var jt=dh();if(Ve(jt))return ft(jt);H=Gl(ut,it(jt))}function ft(jt){return H=t,Re&&A?Fe(jt):(A=w=t,G)}function ai(){H!==t&&Cb(H),ce=0,A=W=w=H=t}function Ur(){return H===t?G:ft(dh())}function oi(){var jt=dh(),ki=Ve(jt);if(A=arguments,w=this,W=jt,ki){if(H===t)return Ke(W);if(pe)return Cb(H),H=Gl(ut,f),Fe(W)}return H===t&&(H=Gl(ut,f)),G}return oi.cancel=ai,oi.flush=Ur,oi}var b8=at(function(c,f){return lb(c,1,f)}),T8=at(function(c,f,y){return lb(c,bi(f)||0,y)});function D8(c){return $n(c,M)}function fh(c,f){if(typeof c!="function"||f!=null&&typeof f!="function")throw new vi(a);var y=function(){var A=arguments,w=f?f.apply(this,A):A[0],k=y.cache;if(k.has(w))return k.get(w);var G=c.apply(this,A);return y.cache=k.set(w,G)||k,G};return y.cache=new(fh.Cache||Bn),y}fh.Cache=Bn;function gh(c){if(typeof c!="function")throw new vi(a);return function(){var f=arguments;switch(f.length){case 0:return!c.call(this);case 1:return!c.call(this,f[0]);case 2:return!c.call(this,f[0],f[1]);case 3:return!c.call(this,f[0],f[1],f[2])}return!c.apply(this,f)}}function R8(c){return pT(2,c)}var I8=fU(function(c,f){f=f.length==1&&je(f[0])?$t(f[0],ii(qe())):$t(vr(f,1),ii(qe()));var y=f.length;return at(function(A){for(var w=-1,k=Tr(A.length,y);++w<k;)A[w]=f[w].call(this,A[w]);return ri(c,this,A)})}),U0=at(function(c,f){var y=bs(f,No(U0));return $n(c,_,t,f,y)}),AT=at(function(c,f){var y=bs(f,No(AT));return $n(c,F,t,f,y)}),w8=Gn(function(c,f){return $n(c,C,t,t,t,f)});function C8(c,f){if(typeof c!="function")throw new vi(a);return f=f===t?f:tt(f),at(c,f)}function N8(c,f){if(typeof c!="function")throw new vi(a);return f=f==null?0:ir(tt(f),0),at(function(y){var A=y[f],w=ws(y,0,f);return A&&Ss(w,A),ri(c,this,w)})}function L8(c,f,y){var A=!0,w=!0;if(typeof c!="function")throw new vi(a);return Ht(y)&&(A="leading"in y?!!y.leading:A,w="trailing"in y?!!y.trailing:w),ET(c,f,{leading:A,maxWait:f,trailing:w})}function _8(c){return gT(c,1)}function M8(c,f){return U0(b0(f),c)}function O8(){if(!arguments.length)return[];var c=arguments[0];return je(c)?c:[c]}function P8(c){return Ai(c,p)}function k8(c,f){return f=typeof f=="function"?f:t,Ai(c,p,f)}function F8(c){return Ai(c,h|p)}function B8(c,f){return f=typeof f=="function"?f:t,Ai(c,h|p,f)}function U8(c,f){return f==null||ob(c,f,hr(f))}function Pi(c,f){return c===f||c!==c&&f!==f}var $8=ah(h0),G8=ah(function(c,f){return c>=f}),ca=fb(function(){return arguments}())?fb:function(c){return Yt(c)&&Dt.call(c,"callee")&&!ZS.call(c,"callee")},je=te.isArray,q8=kS?ii(kS):j5;function Wr(c){return c!=null&&ph(c.length)&&!Hn(c)}function zt(c){return Yt(c)&&Wr(c)}function H8(c){return c===!0||c===!1||Yt(c)&&Fr(c)==$e}var Cs=i5||j0,V8=FS?ii(FS):J5;function K8(c){return Yt(c)&&c.nodeType===1&&!ql(c)}function W8(c){if(c==null)return!0;if(Wr(c)&&(je(c)||typeof c=="string"||typeof c.splice=="function"||Cs(c)||Lo(c)||ca(c)))return!c.length;var f=Dr(c);if(f==se||f==K)return!c.size;if($l(c))return!g0(c).length;for(var y in c)if(Dt.call(c,y))return!1;return!0}function Y8(c,f){return Fl(c,f)}function X8(c,f,y){y=typeof y=="function"?y:t;var A=y?y(c,f):t;return A===t?Fl(c,f,t,y):!!A}function $0(c){if(!Yt(c))return!1;var f=Fr(c);return f==Ge||f==rt||typeof c.message=="string"&&typeof c.name=="string"&&!ql(c)}function z8(c){return typeof c=="number"&&tb(c)}function Hn(c){if(!Ht(c))return!1;var f=Fr(c);return f==nt||f==B||f==Be||f==Me}function xT(c){return typeof c=="number"&&c==tt(c)}function ph(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=ue}function Ht(c){var f=typeof c;return c!=null&&(f=="object"||f=="function")}function Yt(c){return c!=null&&typeof c=="object"}var ST=BS?ii(BS):Z5;function j8(c,f){return c===f||f0(c,f,N0(f))}function J8(c,f,y){return y=typeof y=="function"?y:t,f0(c,f,N0(f),y)}function Q8(c){return bT(c)&&c!=+c}function Z8(c){if(kU(c))throw new ze(s);return gb(c)}function e6(c){return c===null}function t6(c){return c==null}function bT(c){return typeof c=="number"||Yt(c)&&Fr(c)==xe}function ql(c){if(!Yt(c)||Fr(c)!=ge)return!1;var f=qc(c);if(f===null)return!0;var y=Dt.call(f,"constructor")&&f.constructor;return typeof y=="function"&&y instanceof y&&Bc.call(y)==JB}var G0=US?ii(US):eU;function r6(c){return xT(c)&&c>=-ue&&c<=ue}var TT=$S?ii($S):tU;function mh(c){return typeof c=="string"||!je(c)&&Yt(c)&&Fr(c)==D}function si(c){return typeof c=="symbol"||Yt(c)&&Fr(c)==S}var Lo=GS?ii(GS):rU;function i6(c){return c===t}function n6(c){return Yt(c)&&Dr(c)==z}function s6(c){return Yt(c)&&Fr(c)==Te}var a6=ah(p0),o6=ah(function(c,f){return c<=f});function DT(c){if(!c)return[];if(Wr(c))return mh(c)?Mi(c):Kr(c);if(Cl&&c[Cl])return UB(c[Cl]());var f=Dr(c),y=f==se?r0:f==K?Pc:_o;return y(c)}function Vn(c){if(!c)return c===0?c:0;if(c=bi(c),c===ne||c===-ne){var f=c<0?-1:1;return f*re}return c===c?c:0}function tt(c){var f=Vn(c),y=f%1;return f===f?y?f-y:f:0}function RT(c){return c?aa(tt(c),0,J):0}function bi(c){if(typeof c=="number")return c;if(si(c))return V;if(Ht(c)){var f=typeof c.valueOf=="function"?c.valueOf():c;c=Ht(f)?f+"":f}if(typeof c!="string")return c===0?c:+c;c=c.replace(Es,"");var y=Up.test(c);return y||As.test(c)?SB(c.slice(2),y?2:8):Nc.test(c)?V:+c}function IT(c){return dn(c,Yr(c))}function l6(c){return c?aa(tt(c),-ue,ue):c===0?c:0}function St(c){return c==null?"":ni(c)}var u6=wo(function(c,f){if($l(f)||Wr(f)){dn(f,hr(f),c);return}for(var y in f)Dt.call(f,y)&&Ol(c,y,f[y])}),wT=wo(function(c,f){dn(f,Yr(f),c)}),yh=wo(function(c,f,y,A){dn(f,Yr(f),c,A)}),c6=wo(function(c,f,y,A){dn(f,hr(f),c,A)}),h6=Gn(l0);function d6(c,f){var y=Io(c);return f==null?y:ab(y,f)}var f6=at(function(c,f){c=Ct(c);var y=-1,A=f.length,w=A>2?f[2]:t;for(w&&Br(f[0],f[1],w)&&(A=1);++y<A;)for(var k=f[y],G=Yr(k),H=-1,W=G.length;++H<W;){var ce=G[H],he=c[ce];(he===t||Pi(he,To[ce])&&!Dt.call(c,ce))&&(c[ce]=k[ce])}return c}),g6=at(function(c){return c.push(t,Kb),ri(CT,t,c)});function p6(c,f){return HS(c,qe(f,3),hn)}function m6(c,f){return HS(c,qe(f,3),c0)}function y6(c,f){return c==null?c:u0(c,qe(f,3),Yr)}function v6(c,f){return c==null?c:hb(c,qe(f,3),Yr)}function E6(c,f){return c&&hn(c,qe(f,3))}function A6(c,f){return c&&c0(c,qe(f,3))}function x6(c){return c==null?[]:Qc(c,hr(c))}function S6(c){return c==null?[]:Qc(c,Yr(c))}function q0(c,f,y){var A=c==null?t:oa(c,f);return A===t?y:A}function b6(c,f){return c!=null&&Xb(c,f,W5)}function H0(c,f){return c!=null&&Xb(c,f,Y5)}var T6=$b(function(c,f,y){f!=null&&typeof f.toString!="function"&&(f=Uc.call(f)),c[f]=y},K0(Xr)),D6=$b(function(c,f,y){f!=null&&typeof f.toString!="function"&&(f=Uc.call(f)),Dt.call(c,f)?c[f].push(y):c[f]=[y]},qe),R6=at(kl);function hr(c){return Wr(c)?nb(c):g0(c)}function Yr(c){return Wr(c)?nb(c,!0):iU(c)}function I6(c,f){var y={};return f=qe(f,3),hn(c,function(A,w,k){Un(y,f(A,w,k),A)}),y}function w6(c,f){var y={};return f=qe(f,3),hn(c,function(A,w,k){Un(y,w,f(A,w,k))}),y}var C6=wo(function(c,f,y){Zc(c,f,y)}),CT=wo(function(c,f,y,A){Zc(c,f,y,A)}),N6=Gn(function(c,f){var y={};if(c==null)return y;var A=!1;f=$t(f,function(k){return k=Is(k,c),A||(A=k.length>1),k}),dn(c,w0(c),y),A&&(y=Ai(y,h|d|p,TU));for(var w=f.length;w--;)A0(y,f[w]);return y});function L6(c,f){return NT(c,gh(qe(f)))}var _6=Gn(function(c,f){return c==null?{}:sU(c,f)});function NT(c,f){if(c==null)return{};var y=$t(w0(c),function(A){return[A]});return f=qe(f),xb(c,y,function(A,w){return f(A,w[0])})}function M6(c,f,y){f=Is(f,c);var A=-1,w=f.length;for(w||(w=1,c=t);++A<w;){var k=c==null?t:c[fn(f[A])];k===t&&(A=w,k=y),c=Hn(k)?k.call(c):k}return c}function O6(c,f,y){return c==null?c:Bl(c,f,y)}function P6(c,f,y,A){return A=typeof A=="function"?A:t,c==null?c:Bl(c,f,y,A)}var LT=Hb(hr),_T=Hb(Yr);function k6(c,f,y){var A=je(c),w=A||Cs(c)||Lo(c);if(f=qe(f,4),y==null){var k=c&&c.constructor;w?y=A?new k:[]:Ht(c)?y=Hn(k)?Io(qc(c)):{}:y={}}return(w?yi:hn)(c,function(G,H,W){return f(y,G,H,W)}),y}function F6(c,f){return c==null?!0:A0(c,f)}function B6(c,f,y){return c==null?c:Rb(c,f,b0(y))}function U6(c,f,y,A){return A=typeof A=="function"?A:t,c==null?c:Rb(c,f,b0(y),A)}function _o(c){return c==null?[]:t0(c,hr(c))}function $6(c){return c==null?[]:t0(c,Yr(c))}function G6(c,f,y){return y===t&&(y=f,f=t),y!==t&&(y=bi(y),y=y===y?y:0),f!==t&&(f=bi(f),f=f===f?f:0),aa(bi(c),f,y)}function q6(c,f,y){return f=Vn(f),y===t?(y=f,f=0):y=Vn(y),c=bi(c),X5(c,f,y)}function H6(c,f,y){if(y&&typeof y!="boolean"&&Br(c,f,y)&&(f=y=t),y===t&&(typeof f=="boolean"?(y=f,f=t):typeof c=="boolean"&&(y=c,c=t)),c===t&&f===t?(c=0,f=1):(c=Vn(c),f===t?(f=c,c=0):f=Vn(f)),c>f){var A=c;c=f,f=A}if(y||c%1||f%1){var w=rb();return Tr(c+w*(f-c+xB("1e-"+((w+"").length-1))),f)}return y0(c,f)}var V6=Co(function(c,f,y){return f=f.toLowerCase(),c+(y?MT(f):f)});function MT(c){return V0(St(c).toLowerCase())}function OT(c){return c=St(c),c&&c.replace($p,OB).replace(hB,"")}function K6(c,f,y){c=St(c),f=ni(f);var A=c.length;y=y===t?A:aa(tt(y),0,A);var w=y;return y-=f.length,y>=0&&c.slice(y,w)==f}function W6(c){return c=St(c),c&&kn.test(c)?c.replace(Ze,PB):c}function Y6(c){return c=St(c),c&&Rc.test(c)?c.replace(go,"\\$&"):c}var X6=Co(function(c,f,y){return c+(y?"-":"")+f.toLowerCase()}),z6=Co(function(c,f,y){return c+(y?" ":"")+f.toLowerCase()}),j6=Fb("toLowerCase");function J6(c,f,y){c=St(c),f=tt(f);var A=f?So(c):0;if(!f||A>=f)return c;var w=(f-A)/2;return sh(Wc(w),y)+c+sh(Kc(w),y)}function Q6(c,f,y){c=St(c),f=tt(f);var A=f?So(c):0;return f&&A<f?c+sh(f-A,y):c}function Z6(c,f,y){c=St(c),f=tt(f);var A=f?So(c):0;return f&&A<f?sh(f-A,y)+c:c}function e9(c,f,y){return y||f==null?f=0:f&&(f=+f),o5(St(c).replace(po,""),f||0)}function t9(c,f,y){return(y?Br(c,f,y):f===t)?f=1:f=tt(f),v0(St(c),f)}function r9(){var c=arguments,f=St(c[0]);return c.length<3?f:f.replace(c[1],c[2])}var i9=Co(function(c,f,y){return c+(y?"_":"")+f.toLowerCase()});function n9(c,f,y){return y&&typeof y!="number"&&Br(c,f,y)&&(f=y=t),y=y===t?J:y>>>0,y?(c=St(c),c&&(typeof f=="string"||f!=null&&!G0(f))&&(f=ni(f),!f&&xo(c))?ws(Mi(c),0,y):c.split(f,y)):[]}var s9=Co(function(c,f,y){return c+(y?" ":"")+V0(f)});function a9(c,f,y){return c=St(c),y=y==null?0:aa(tt(y),0,c.length),f=ni(f),c.slice(y,y+f.length)==f}function o9(c,f,y){var A=O.templateSettings;y&&Br(c,f,y)&&(f=t),c=St(c),f=yh({},f,A,Vb);var w=yh({},f.imports,A.imports,Vb),k=hr(w),G=t0(w,k),H,W,ce=0,he=f.interpolate||ta,pe="__p += '",Re=i0((f.escape||ta).source+"|"+he.source+"|"+(he===fo?Cc:ta).source+"|"+(f.evaluate||ta).source+"|$","g"),Fe="//# sourceURL="+(Dt.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++mB+"]")+`
`;c.replace(Re,function(Ve,ut,ft,ai,Ur,oi){return ft||(ft=ai),pe+=c.slice(ce,oi).replace(YF,kB),ut&&(H=!0,pe+=`' +
__e(`+ut+`) +
'`),Ur&&(W=!0,pe+=`';
`+Ur+`;
__p += '`),ft&&(pe+=`' +
((__t = (`+ft+`)) == null ? '' : __t) +
'`),ce=oi+Ve.length,Ve}),pe+=`';
`;var Ke=Dt.call(f,"variable")&&f.variable;Ke||(pe=`with (obj) {
`+pe+`
}
`),pe=(W?pe.replace(ee,""):pe).replace(gt,"$1").replace(Rt,"$1;"),pe="function("+(Ke||"obj")+`) {
`+(Ke?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(H?", __e = _.escape":"")+(W?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+pe+`return __p
}`;var it=kT(function(){return Et(k,Fe+"return "+pe).apply(t,G)});if(it.source=pe,$0(it))throw it;return it}function l9(c){return St(c).toLowerCase()}function u9(c){return St(c).toUpperCase()}function c9(c,f,y){if(c=St(c),c&&(y||f===t))return c.replace(Es,"");if(!c||!(f=ni(f)))return c;var A=Mi(c),w=Mi(f),k=YS(A,w),G=XS(A,w)+1;return ws(A,k,G).join("")}function h9(c,f,y){if(c=St(c),c&&(y||f===t))return c.replace(mo,"");if(!c||!(f=ni(f)))return c;var A=Mi(c),w=XS(A,Mi(f))+1;return ws(A,0,w).join("")}function d9(c,f,y){if(c=St(c),c&&(y||f===t))return c.replace(po,"");if(!c||!(f=ni(f)))return c;var A=Mi(c),w=YS(A,Mi(f));return ws(A,w).join("")}function f9(c,f){var y=L,A=I;if(Ht(f)){var w="separator"in f?f.separator:w;y="length"in f?tt(f.length):y,A="omission"in f?ni(f.omission):A}c=St(c);var k=c.length;if(xo(c)){var G=Mi(c);k=G.length}if(y>=k)return c;var H=y-So(A);if(H<1)return A;var W=G?ws(G,0,H).join(""):c.slice(0,H);if(w===t)return W+A;if(G&&(H+=W.length-H),G0(w)){if(c.slice(H).search(w)){var ce,he=W;for(w.global||(w=i0(w.source,St(yo.exec(w))+"g")),w.lastIndex=0;ce=w.exec(he);)var pe=ce.index;W=W.slice(0,pe===t?H:pe)}}else if(c.indexOf(ni(w),H)!=H){var Re=W.lastIndexOf(w);Re>-1&&(W=W.slice(0,Re))}return W+A}function g9(c){return c=St(c),c&&un.test(c)?c.replace(It,HB):c}var p9=Co(function(c,f,y){return c+(y?" ":"")+f.toUpperCase()}),V0=Fb("toUpperCase");function PT(c,f,y){return c=St(c),f=y?t:f,f===t?BB(c)?WB(c):CB(c):c.match(f)||[]}var kT=at(function(c,f){try{return ri(c,t,f)}catch(y){return $0(y)?y:new ze(y)}}),m9=Gn(function(c,f){return yi(f,function(y){y=fn(y),Un(c,y,B0(c[y],c))}),c});function y9(c){var f=c==null?0:c.length,y=qe();return c=f?$t(c,function(A){if(typeof A[1]!="function")throw new vi(a);return[y(A[0]),A[1]]}):[],at(function(A){for(var w=-1;++w<f;){var k=c[w];if(ri(k[0],this,A))return ri(k[1],this,A)}})}function v9(c){return H5(Ai(c,h))}function K0(c){return function(){return c}}function E9(c,f){return c==null||c!==c?f:c}var A9=Ub(),x9=Ub(!0);function Xr(c){return c}function W0(c){return pb(typeof c=="function"?c:Ai(c,h))}function S9(c){return yb(Ai(c,h))}function b9(c,f){return vb(c,Ai(f,h))}var T9=at(function(c,f){return function(y){return kl(y,c,f)}}),D9=at(function(c,f){return function(y){return kl(c,y,f)}});function Y0(c,f,y){var A=hr(f),w=Qc(f,A);y==null&&!(Ht(f)&&(w.length||!A.length))&&(y=f,f=c,c=this,w=Qc(f,hr(f)));var k=!(Ht(y)&&"chain"in y)||!!y.chain,G=Hn(c);return yi(w,function(H){var W=f[H];c[H]=W,G&&(c.prototype[H]=function(){var ce=this.__chain__;if(k||ce){var he=c(this.__wrapped__),pe=he.__actions__=Kr(this.__actions__);return pe.push({func:W,args:arguments,thisArg:c}),he.__chain__=ce,he}return W.apply(c,Ss([this.value()],arguments))})}),c}function R9(){return yr._===this&&(yr._=QB),this}function X0(){}function I9(c){return c=tt(c),at(function(f){return Eb(f,c)})}var w9=D0($t),C9=D0(qS),N9=D0(jp);function FT(c){return _0(c)?Jp(fn(c)):aU(c)}function L9(c){return function(f){return c==null?t:oa(c,f)}}var _9=Gb(),M9=Gb(!0);function z0(){return[]}function j0(){return!1}function O9(){return{}}function P9(){return""}function k9(){return!0}function F9(c,f){if(c=tt(c),c<1||c>ue)return[];var y=J,A=Tr(c,J);f=qe(f),c-=J;for(var w=e0(A,f);++y<c;)f(y);return w}function B9(c){return je(c)?$t(c,fn):si(c)?[c]:Kr(iT(St(c)))}function U9(c){var f=++jB;return St(c)+f}var $9=nh(function(c,f){return c+f},0),G9=R0("ceil"),q9=nh(function(c,f){return c/f},1),H9=R0("floor");function V9(c){return c&&c.length?Jc(c,Xr,h0):t}function K9(c,f){return c&&c.length?Jc(c,qe(f,2),h0):t}function W9(c){return KS(c,Xr)}function Y9(c,f){return KS(c,qe(f,2))}function X9(c){return c&&c.length?Jc(c,Xr,p0):t}function z9(c,f){return c&&c.length?Jc(c,qe(f,2),p0):t}var j9=nh(function(c,f){return c*f},1),J9=R0("round"),Q9=nh(function(c,f){return c-f},0);function Z9(c){return c&&c.length?Zp(c,Xr):0}function e$(c,f){return c&&c.length?Zp(c,qe(f,2)):0}return O.after=S8,O.ary=gT,O.assign=u6,O.assignIn=wT,O.assignInWith=yh,O.assignWith=c6,O.at=h6,O.before=pT,O.bind=B0,O.bindAll=m9,O.bindKey=mT,O.castArray=O8,O.chain=hT,O.chunk=HU,O.compact=VU,O.concat=KU,O.cond=y9,O.conforms=v9,O.constant=K0,O.countBy=Z4,O.create=d6,O.curry=yT,O.curryRight=vT,O.debounce=ET,O.defaults=f6,O.defaultsDeep=g6,O.defer=b8,O.delay=T8,O.difference=WU,O.differenceBy=YU,O.differenceWith=XU,O.drop=zU,O.dropRight=jU,O.dropRightWhile=JU,O.dropWhile=QU,O.fill=ZU,O.filter=t8,O.flatMap=n8,O.flatMapDeep=s8,O.flatMapDepth=a8,O.flatten=oT,O.flattenDeep=e4,O.flattenDepth=t4,O.flip=D8,O.flow=A9,O.flowRight=x9,O.fromPairs=r4,O.functions=x6,O.functionsIn=S6,O.groupBy=o8,O.initial=n4,O.intersection=s4,O.intersectionBy=a4,O.intersectionWith=o4,O.invert=T6,O.invertBy=D6,O.invokeMap=u8,O.iteratee=W0,O.keyBy=c8,O.keys=hr,O.keysIn=Yr,O.map=hh,O.mapKeys=I6,O.mapValues=w6,O.matches=S9,O.matchesProperty=b9,O.memoize=fh,O.merge=C6,O.mergeWith=CT,O.method=T9,O.methodOf=D9,O.mixin=Y0,O.negate=gh,O.nthArg=I9,O.omit=N6,O.omitBy=L6,O.once=R8,O.orderBy=h8,O.over=w9,O.overArgs=I8,O.overEvery=C9,O.overSome=N9,O.partial=U0,O.partialRight=AT,O.partition=d8,O.pick=_6,O.pickBy=NT,O.property=FT,O.propertyOf=L9,O.pull=h4,O.pullAll=uT,O.pullAllBy=d4,O.pullAllWith=f4,O.pullAt=g4,O.range=_9,O.rangeRight=M9,O.rearg=w8,O.reject=p8,O.remove=p4,O.rest=C8,O.reverse=k0,O.sampleSize=y8,O.set=O6,O.setWith=P6,O.shuffle=v8,O.slice=m4,O.sortBy=x8,O.sortedUniq=b4,O.sortedUniqBy=T4,O.split=n9,O.spread=N8,O.tail=D4,O.take=R4,O.takeRight=I4,O.takeRightWhile=w4,O.takeWhile=C4,O.tap=V4,O.throttle=L8,O.thru=ch,O.toArray=DT,O.toPairs=LT,O.toPairsIn=_T,O.toPath=B9,O.toPlainObject=IT,O.transform=k6,O.unary=_8,O.union=N4,O.unionBy=L4,O.unionWith=_4,O.uniq=M4,O.uniqBy=O4,O.uniqWith=P4,O.unset=F6,O.unzip=F0,O.unzipWith=cT,O.update=B6,O.updateWith=U6,O.values=_o,O.valuesIn=$6,O.without=k4,O.words=PT,O.wrap=M8,O.xor=F4,O.xorBy=B4,O.xorWith=U4,O.zip=$4,O.zipObject=G4,O.zipObjectDeep=q4,O.zipWith=H4,O.entries=LT,O.entriesIn=_T,O.extend=wT,O.extendWith=yh,Y0(O,O),O.add=$9,O.attempt=kT,O.camelCase=V6,O.capitalize=MT,O.ceil=G9,O.clamp=G6,O.clone=P8,O.cloneDeep=F8,O.cloneDeepWith=B8,O.cloneWith=k8,O.conformsTo=U8,O.deburr=OT,O.defaultTo=E9,O.divide=q9,O.endsWith=K6,O.eq=Pi,O.escape=W6,O.escapeRegExp=Y6,O.every=e8,O.find=r8,O.findIndex=sT,O.findKey=p6,O.findLast=i8,O.findLastIndex=aT,O.findLastKey=m6,O.floor=H9,O.forEach=dT,O.forEachRight=fT,O.forIn=y6,O.forInRight=v6,O.forOwn=E6,O.forOwnRight=A6,O.get=q0,O.gt=$8,O.gte=G8,O.has=b6,O.hasIn=H0,O.head=lT,O.identity=Xr,O.includes=l8,O.indexOf=i4,O.inRange=q6,O.invoke=R6,O.isArguments=ca,O.isArray=je,O.isArrayBuffer=q8,O.isArrayLike=Wr,O.isArrayLikeObject=zt,O.isBoolean=H8,O.isBuffer=Cs,O.isDate=V8,O.isElement=K8,O.isEmpty=W8,O.isEqual=Y8,O.isEqualWith=X8,O.isError=$0,O.isFinite=z8,O.isFunction=Hn,O.isInteger=xT,O.isLength=ph,O.isMap=ST,O.isMatch=j8,O.isMatchWith=J8,O.isNaN=Q8,O.isNative=Z8,O.isNil=t6,O.isNull=e6,O.isNumber=bT,O.isObject=Ht,O.isObjectLike=Yt,O.isPlainObject=ql,O.isRegExp=G0,O.isSafeInteger=r6,O.isSet=TT,O.isString=mh,O.isSymbol=si,O.isTypedArray=Lo,O.isUndefined=i6,O.isWeakMap=n6,O.isWeakSet=s6,O.join=l4,O.kebabCase=X6,O.last=Si,O.lastIndexOf=u4,O.lowerCase=z6,O.lowerFirst=j6,O.lt=a6,O.lte=o6,O.max=V9,O.maxBy=K9,O.mean=W9,O.meanBy=Y9,O.min=X9,O.minBy=z9,O.stubArray=z0,O.stubFalse=j0,O.stubObject=O9,O.stubString=P9,O.stubTrue=k9,O.multiply=j9,O.nth=c4,O.noConflict=R9,O.noop=X0,O.now=dh,O.pad=J6,O.padEnd=Q6,O.padStart=Z6,O.parseInt=e9,O.random=H6,O.reduce=f8,O.reduceRight=g8,O.repeat=t9,O.replace=r9,O.result=M6,O.round=J9,O.runInContext=Y,O.sample=m8,O.size=E8,O.snakeCase=i9,O.some=A8,O.sortedIndex=y4,O.sortedIndexBy=v4,O.sortedIndexOf=E4,O.sortedLastIndex=A4,O.sortedLastIndexBy=x4,O.sortedLastIndexOf=S4,O.startCase=s9,O.startsWith=a9,O.subtract=Q9,O.sum=Z9,O.sumBy=e$,O.template=o9,O.times=F9,O.toFinite=Vn,O.toInteger=tt,O.toLength=RT,O.toLower=l9,O.toNumber=bi,O.toSafeInteger=l6,O.toString=St,O.toUpper=u9,O.trim=c9,O.trimEnd=h9,O.trimStart=d9,O.truncate=f9,O.unescape=g9,O.uniqueId=U9,O.upperCase=p9,O.upperFirst=V0,O.each=dT,O.eachRight=fT,O.first=lT,Y0(O,function(){var c={};return hn(O,function(f,y){Dt.call(O.prototype,y)||(c[y]=f)}),c}(),{chain:!1}),O.VERSION=r,yi(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){O[c].placeholder=O}),yi(["drop","take"],function(c,f){ht.prototype[c]=function(y){y=y===t?1:ir(tt(y),0);var A=this.__filtered__&&!f?new ht(this):this.clone();return A.__filtered__?A.__takeCount__=Tr(y,A.__takeCount__):A.__views__.push({size:Tr(y,J),type:c+(A.__dir__<0?"Right":"")}),A},ht.prototype[c+"Right"]=function(y){return this.reverse()[c](y).reverse()}}),yi(["filter","map","takeWhile"],function(c,f){var y=f+1,A=y==$||y==ie;ht.prototype[c]=function(w){var k=this.clone();return k.__iteratees__.push({iteratee:qe(w,3),type:y}),k.__filtered__=k.__filtered__||A,k}}),yi(["head","last"],function(c,f){var y="take"+(f?"Right":"");ht.prototype[c]=function(){return this[y](1).value()[0]}}),yi(["initial","tail"],function(c,f){var y="drop"+(f?"":"Right");ht.prototype[c]=function(){return this.__filtered__?new ht(this):this[y](1)}}),ht.prototype.compact=function(){return this.filter(Xr)},ht.prototype.find=function(c){return this.filter(c).head()},ht.prototype.findLast=function(c){return this.reverse().find(c)},ht.prototype.invokeMap=at(function(c,f){return typeof c=="function"?new ht(this):this.map(function(y){return kl(y,c,f)})}),ht.prototype.reject=function(c){return this.filter(gh(qe(c)))},ht.prototype.slice=function(c,f){c=tt(c);var y=this;return y.__filtered__&&(c>0||f<0)?new ht(y):(c<0?y=y.takeRight(-c):c&&(y=y.drop(c)),f!==t&&(f=tt(f),y=f<0?y.dropRight(-f):y.take(f-c)),y)},ht.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},ht.prototype.toArray=function(){return this.take(J)},hn(ht.prototype,function(c,f){var y=/^(?:filter|find|map|reject)|While$/.test(f),A=/^(?:head|last)$/.test(f),w=O[A?"take"+(f=="last"?"Right":""):f],k=A||/^find/.test(f);w&&(O.prototype[f]=function(){var G=this.__wrapped__,H=A?[1]:arguments,W=G instanceof ht,ce=H[0],he=W||je(G),pe=function(ut){var ft=w.apply(O,Ss([ut],H));return A&&Re?ft[0]:ft};he&&y&&typeof ce=="function"&&ce.length!=1&&(W=he=!1);var Re=this.__chain__,Fe=!!this.__actions__.length,Ke=k&&!Re,it=W&&!Fe;if(!k&&he){G=it?G:new ht(this);var Ve=c.apply(G,H);return Ve.__actions__.push({func:ch,args:[pe],thisArg:t}),new Ei(Ve,Re)}return Ke&&it?c.apply(this,H):(Ve=this.thru(pe),Ke?A?Ve.value()[0]:Ve.value():Ve)})}),yi(["pop","push","shift","sort","splice","unshift"],function(c){var f=kc[c],y=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",A=/^(?:pop|shift)$/.test(c);O.prototype[c]=function(){var w=arguments;if(A&&!this.__chain__){var k=this.value();return f.apply(je(k)?k:[],w)}return this[y](function(G){return f.apply(je(G)?G:[],w)})}}),hn(ht.prototype,function(c,f){var y=O[f];if(y){var A=y.name+"";Dt.call(Ro,A)||(Ro[A]=[]),Ro[A].push({name:f,func:y})}}),Ro[ih(t,E).name]=[{name:"wrapper",func:t}],ht.prototype.clone=g5,ht.prototype.reverse=p5,ht.prototype.value=m5,O.prototype.at=K4,O.prototype.chain=W4,O.prototype.commit=Y4,O.prototype.next=X4,O.prototype.plant=j4,O.prototype.reverse=J4,O.prototype.toJSON=O.prototype.valueOf=O.prototype.value=Q4,O.prototype.first=O.prototype.head,Cl&&(O.prototype[Cl]=z4),O},bo=YB();ra?((ra.exports=bo)._=bo,Wp._=bo):yr._=bo}).call(XI)}(Yo,Yo.exports)),Yo.exports}var jI=zI();const mt=Fa(jI);var Od,_v;function Ba(){return _v||(_v=1,Od=TypeError),Od}const Pd=YI(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var kd,Mv;function vu(){if(Mv)return kd;Mv=1;var i=typeof Map=="function"&&Map.prototype,e=Object.getOwnPropertyDescriptor&&i?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,t=i&&e&&typeof e.get=="function"?e.get:null,r=i&&Map.prototype.forEach,n=typeof Set=="function"&&Set.prototype,s=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,a=n&&s&&typeof s.get=="function"?s.get:null,o=n&&Set.prototype.forEach,u=typeof WeakMap=="function"&&WeakMap.prototype,l=u?WeakMap.prototype.has:null,h=typeof WeakSet=="function"&&WeakSet.prototype,d=h?WeakSet.prototype.has:null,p=typeof WeakRef=="function"&&WeakRef.prototype,g=p?WeakRef.prototype.deref:null,m=Boolean.prototype.valueOf,v=Object.prototype.toString,E=Function.prototype.toString,x=String.prototype.match,T=String.prototype.slice,R=String.prototype.replace,_=String.prototype.toUpperCase,F=String.prototype.toLowerCase,N=RegExp.prototype.test,C=Array.prototype.concat,M=Array.prototype.join,L=Array.prototype.slice,I=Math.floor,U=typeof BigInt=="function"?BigInt.prototype.valueOf:null,q=Object.getOwnPropertySymbols,$=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,X=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ie=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===X||!0)?Symbol.toStringTag:null,ne=Object.prototype.propertyIsEnumerable,ue=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(Z){return Z.__proto__}:null);function re(Z,ee){if(Z===1/0||Z===-1/0||Z!==Z||Z&&Z>-1e3&&Z<1e3||N.call(/e/,ee))return ee;var gt=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof Z=="number"){var Rt=Z<0?-I(-Z):I(Z);if(Rt!==Z){var It=String(Rt),Ze=T.call(ee,It.length+1);return R.call(It,gt,"$&_")+"."+R.call(R.call(Ze,/([0-9]{3})/g,"$&_"),/_$/,"")}}return R.call(ee,gt,"$&_")}var V=Pd,J=V.custom,ve=xe(J)?J:null,de={__proto__:null,double:'"',single:"'"},De={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};kd=function Z(ee,gt,Rt,It){var Ze=gt||{};if(we(Ze,"quoteStyle")&&!we(de,Ze.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(we(Ze,"maxStringLength")&&(typeof Ze.maxStringLength=="number"?Ze.maxStringLength<0&&Ze.maxStringLength!==1/0:Ze.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var un=we(Ze,"customInspect")?Ze.customInspect:!0;if(typeof un!="boolean"&&un!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(we(Ze,"indent")&&Ze.indent!==null&&Ze.indent!=="	"&&!(parseInt(Ze.indent,10)===Ze.indent&&Ze.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(we(Ze,"numericSeparator")&&typeof Ze.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var kn=Ze.numericSeparator;if(typeof ee>"u")return"undefined";if(ee===null)return"null";if(typeof ee=="boolean")return ee?"true":"false";if(typeof ee=="string")return ye(ee,Ze);if(typeof ee=="number"){if(ee===0)return 1/0/ee>0?"0":"-0";var kr=String(ee);return kn?re(ee,kr):kr}if(typeof ee=="bigint"){var cn=String(ee)+"n";return kn?re(ee,cn):cn}var fo=typeof Ze.depth>"u"?5:Ze.depth;if(typeof Rt>"u"&&(Rt=0),Rt>=fo&&fo>0&&typeof ee=="object")return $e(ee)?"[Array]":"[Object]";var vs=bl(Ze,Rt);if(typeof It>"u")It=[];else if(K(It,ee)>=0)return"[Circular]";function ti(As,vo,$p){if(vo&&(It=L.call(It),It.push(vo)),$p){var ta={depth:Ze.depth};return we(Ze,"quoteStyle")&&(ta.quoteStyle=Ze.quoteStyle),Z(As,ta,Rt+1,It)}return Z(As,Ze,Rt+1,It)}if(typeof ee=="function"&&!rt(ee)){var Dc=le(ee),go=ys(ee,ti);return"[Function"+(Dc?": "+Dc:" (anonymous)")+"]"+(go.length>0?" { "+M.call(go,", ")+" }":"")}if(xe(ee)){var Rc=X?R.call(String(ee),/^(Symbol\(.*\))_[^)]*$/,"$1"):$.call(ee);return typeof ee=="object"&&!X?qt(Rc):Rc}if(me(ee)){for(var Es="<"+F.call(String(ee.nodeName)),po=ee.attributes||[],mo=0;mo<po.length;mo++)Es+=" "+po[mo].name+"="+Ie(Ne(po[mo].value),"double",Ze);return Es+=">",ee.childNodes&&ee.childNodes.length&&(Es+="..."),Es+="</"+F.call(String(ee.nodeName))+">",Es}if($e(ee)){if(ee.length===0)return"[]";var Tl=ys(ee,ti);return vs&&!Sl(Tl)?"["+ea(Tl,vs)+"]":"[ "+M.call(Tl,", ")+" ]"}if(Ge(ee)){var Dl=ys(ee,ti);return!("cause"in Error.prototype)&&"cause"in ee&&!ne.call(ee,"cause")?"{ ["+String(ee)+"] "+M.call(C.call("[cause]: "+ti(ee.cause),Dl),", ")+" }":Dl.length===0?"["+String(ee)+"]":"{ ["+String(ee)+"] "+M.call(Dl,", ")+" }"}if(typeof ee=="object"&&un){if(ve&&typeof ee[ve]=="function"&&V)return V(ee,{depth:fo-Rt});if(un!=="symbol"&&typeof ee.inspect=="function")return ee.inspect()}if(D(ee)){var Ic=[];return r&&r.call(ee,function(As,vo){Ic.push(ti(vo,ee,!0)+" => "+ti(As,ee))}),br("Map",t.call(ee),Ic,vs)}if(z(ee)){var wc=[];return o&&o.call(ee,function(As){wc.push(ti(As,ee))}),br("Set",a.call(ee),wc,vs)}if(S(ee))return pi("WeakMap");if(Te(ee))return pi("WeakSet");if(P(ee))return pi("WeakRef");if(B(ee))return qt(ti(Number(ee)));if(Ae(ee))return qt(ti(U.call(ee)));if(se(ee))return qt(m.call(ee));if(nt(ee))return qt(ti(String(ee)));if(typeof window<"u"&&ee===window)return"{ [object Window] }";if(typeof globalThis<"u"&&ee===globalThis||typeof Ci<"u"&&ee===Ci)return"{ [object globalThis] }";if(!et(ee)&&!rt(ee)){var Rl=ys(ee,ti),Cc=ue?ue(ee)===Object.prototype:ee instanceof Object||ee.constructor===Object,yo=ee instanceof Object?"":"null prototype",Nc=!Cc&&ie&&Object(ee)===ee&&ie in ee?T.call(Me(ee),8,-1):yo?"Object":"",Up=Cc||typeof ee.constructor!="function"?"":ee.constructor.name?ee.constructor.name+" ":"",Il=Up+(Nc||yo?"["+M.call(C.call([],Nc||[],yo||[]),": ")+"] ":"");return Rl.length===0?Il+"{}":vs?Il+"{"+ea(Rl,vs)+"}":Il+"{ "+M.call(Rl,", ")+" }"}return String(ee)};function Ie(Z,ee,gt){var Rt=gt.quoteStyle||ee,It=de[Rt];return It+Z+It}function Ne(Z){return R.call(String(Z),/"/g,"&quot;")}function Be(Z){return!ie||!(typeof Z=="object"&&(ie in Z||typeof Z[ie]<"u"))}function $e(Z){return Me(Z)==="[object Array]"&&Be(Z)}function et(Z){return Me(Z)==="[object Date]"&&Be(Z)}function rt(Z){return Me(Z)==="[object RegExp]"&&Be(Z)}function Ge(Z){return Me(Z)==="[object Error]"&&Be(Z)}function nt(Z){return Me(Z)==="[object String]"&&Be(Z)}function B(Z){return Me(Z)==="[object Number]"&&Be(Z)}function se(Z){return Me(Z)==="[object Boolean]"&&Be(Z)}function xe(Z){if(X)return Z&&typeof Z=="object"&&Z instanceof Symbol;if(typeof Z=="symbol")return!0;if(!Z||typeof Z!="object"||!$)return!1;try{return $.call(Z),!0}catch{}return!1}function Ae(Z){if(!Z||typeof Z!="object"||!U)return!1;try{return U.call(Z),!0}catch{}return!1}var ge=Object.prototype.hasOwnProperty||function(Z){return Z in this};function we(Z,ee){return ge.call(Z,ee)}function Me(Z){return v.call(Z)}function le(Z){if(Z.name)return Z.name;var ee=x.call(E.call(Z),/^function\s*([\w$]+)/);return ee?ee[1]:null}function K(Z,ee){if(Z.indexOf)return Z.indexOf(ee);for(var gt=0,Rt=Z.length;gt<Rt;gt++)if(Z[gt]===ee)return gt;return-1}function D(Z){if(!t||!Z||typeof Z!="object")return!1;try{t.call(Z);try{a.call(Z)}catch{return!0}return Z instanceof Map}catch{}return!1}function S(Z){if(!l||!Z||typeof Z!="object")return!1;try{l.call(Z,l);try{d.call(Z,d)}catch{return!0}return Z instanceof WeakMap}catch{}return!1}function P(Z){if(!g||!Z||typeof Z!="object")return!1;try{return g.call(Z),!0}catch{}return!1}function z(Z){if(!a||!Z||typeof Z!="object")return!1;try{a.call(Z);try{t.call(Z)}catch{return!0}return Z instanceof Set}catch{}return!1}function Te(Z){if(!d||!Z||typeof Z!="object")return!1;try{d.call(Z,d);try{l.call(Z,l)}catch{return!0}return Z instanceof WeakSet}catch{}return!1}function me(Z){return!Z||typeof Z!="object"?!1:typeof HTMLElement<"u"&&Z instanceof HTMLElement?!0:typeof Z.nodeName=="string"&&typeof Z.getAttribute=="function"}function ye(Z,ee){if(Z.length>ee.maxStringLength){var gt=Z.length-ee.maxStringLength,Rt="... "+gt+" more character"+(gt>1?"s":"");return ye(T.call(Z,0,ee.maxStringLength),ee)+Rt}var It=De[ee.quoteStyle||"single"];It.lastIndex=0;var Ze=R.call(R.call(Z,It,"\\$1"),/[\x00-\x1f]/g,st);return Ie(Ze,"single",ee)}function st(Z){var ee=Z.charCodeAt(0),gt={8:"b",9:"t",10:"n",12:"f",13:"r"}[ee];return gt?"\\"+gt:"\\x"+(ee<16?"0":"")+_.call(ee.toString(16))}function qt(Z){return"Object("+Z+")"}function pi(Z){return Z+" { ? }"}function br(Z,ee,gt,Rt){var It=Rt?ea(gt,Rt):M.call(gt,", ");return Z+" ("+ee+") {"+It+"}"}function Sl(Z){for(var ee=0;ee<Z.length;ee++)if(K(Z[ee],`
`)>=0)return!1;return!0}function bl(Z,ee){var gt;if(Z.indent==="	")gt="	";else if(typeof Z.indent=="number"&&Z.indent>0)gt=M.call(Array(Z.indent+1)," ");else return null;return{base:gt,prev:M.call(Array(ee+1),gt)}}function ea(Z,ee){if(Z.length===0)return"";var gt=`
`+ee.prev+ee.base;return gt+M.call(Z,","+gt)+`
`+ee.prev}function ys(Z,ee){var gt=$e(Z),Rt=[];if(gt){Rt.length=Z.length;for(var It=0;It<Z.length;It++)Rt[It]=we(Z,It)?ee(Z[It],Z):""}var Ze=typeof q=="function"?q(Z):[],un;if(X){un={};for(var kn=0;kn<Ze.length;kn++)un["$"+Ze[kn]]=Ze[kn]}for(var kr in Z)we(Z,kr)&&(gt&&String(Number(kr))===kr&&kr<Z.length||X&&un["$"+kr]instanceof Symbol||(N.call(/[^\w$]/,kr)?Rt.push(ee(kr,Z)+": "+ee(Z[kr],Z)):Rt.push(kr+": "+ee(Z[kr],Z))));if(typeof q=="function")for(var cn=0;cn<Ze.length;cn++)ne.call(Z,Ze[cn])&&Rt.push("["+ee(Ze[cn])+"]: "+ee(Z[Ze[cn]],Z));return Rt}return kd}var Fd,Ov;function JI(){if(Ov)return Fd;Ov=1;var i=vu(),e=Ba(),t=function(o,u,l){for(var h=o,d;(d=h.next)!=null;h=d)if(d.key===u)return h.next=d.next,l||(d.next=o.next,o.next=d),d},r=function(o,u){if(o){var l=t(o,u);return l&&l.value}},n=function(o,u,l){var h=t(o,u);h?h.value=l:o.next={key:u,next:o.next,value:l}},s=function(o,u){return o?!!t(o,u):!1},a=function(o,u){if(o)return t(o,u,!0)};return Fd=function(){var u,l={assert:function(h){if(!l.has(h))throw new e("Side channel does not contain "+i(h))},delete:function(h){var d=u&&u.next,p=a(u,h);return p&&d&&d===p&&(u=void 0),!!p},get:function(h){return r(u,h)},has:function(h){return s(u,h)},set:function(h,d){u||(u={next:void 0}),n(u,h,d)}};return l},Fd}var Bd,Pv;function kv(){return Pv||(Pv=1,Bd=Object),Bd}var Ud,Fv;function QI(){return Fv||(Fv=1,Ud=Error),Ud}var $d,Bv;function ZI(){return Bv||(Bv=1,$d=EvalError),$d}var Gd,Uv;function ew(){return Uv||(Uv=1,Gd=RangeError),Gd}var qd,$v;function tw(){return $v||($v=1,qd=ReferenceError),qd}var Hd,Gv;function rw(){return Gv||(Gv=1,Hd=SyntaxError),Hd}var Vd,qv;function iw(){return qv||(qv=1,Vd=URIError),Vd}var Kd,Hv;function nw(){return Hv||(Hv=1,Kd=Math.abs),Kd}var Wd,Vv;function sw(){return Vv||(Vv=1,Wd=Math.floor),Wd}var Yd,Kv;function aw(){return Kv||(Kv=1,Yd=Math.max),Yd}var Xd,Wv;function ow(){return Wv||(Wv=1,Xd=Math.min),Xd}var zd,Yv;function lw(){return Yv||(Yv=1,zd=Math.pow),zd}var jd,Xv;function uw(){return Xv||(Xv=1,jd=Math.round),jd}var Jd,zv;function cw(){return zv||(zv=1,Jd=Number.isNaN||function(e){return e!==e}),Jd}var Qd,jv;function hw(){if(jv)return Qd;jv=1;var i=cw();return Qd=function(t){return i(t)||t===0?t:t<0?-1:1},Qd}var Zd,Jv;function dw(){return Jv||(Jv=1,Zd=Object.getOwnPropertyDescriptor),Zd}var ef,Qv;function Zv(){if(Qv)return ef;Qv=1;var i=dw();if(i)try{i([],"length")}catch{i=null}return ef=i,ef}var tf,e1;function fw(){if(e1)return tf;e1=1;var i=Object.defineProperty||!1;if(i)try{i({},"a",{value:1})}catch{i=!1}return tf=i,tf}var rf,t1;function gw(){return t1||(t1=1,rf=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),r=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var n=42;e[t]=n;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var a=Object.getOwnPropertySymbols(e);if(a.length!==1||a[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==n||o.enumerable!==!0)return!1}return!0}),rf}var nf,r1;function pw(){if(r1)return nf;r1=1;var i=typeof Symbol<"u"&&Symbol,e=gw();return nf=function(){return typeof i!="function"||typeof Symbol!="function"||typeof i("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},nf}var sf,i1;function n1(){return i1||(i1=1,sf=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),sf}var af,s1;function a1(){if(s1)return af;s1=1;var i=kv();return af=i.getPrototypeOf||null,af}var of,o1;function mw(){if(o1)return of;o1=1;var i="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,r="[object Function]",n=function(u,l){for(var h=[],d=0;d<u.length;d+=1)h[d]=u[d];for(var p=0;p<l.length;p+=1)h[p+u.length]=l[p];return h},s=function(u,l){for(var h=[],d=l,p=0;d<u.length;d+=1,p+=1)h[p]=u[d];return h},a=function(o,u){for(var l="",h=0;h<o.length;h+=1)l+=o[h],h+1<o.length&&(l+=u);return l};return of=function(u){var l=this;if(typeof l!="function"||e.apply(l)!==r)throw new TypeError(i+l);for(var h=s(arguments,1),d,p=function(){if(this instanceof d){var x=l.apply(this,n(h,arguments));return Object(x)===x?x:this}return l.apply(u,n(h,arguments))},g=t(0,l.length-h.length),m=[],v=0;v<g;v++)m[v]="$"+v;if(d=Function("binder","return function ("+a(m,",")+"){ return binder.apply(this,arguments); }")(p),l.prototype){var E=function(){};E.prototype=l.prototype,d.prototype=new E,E.prototype=null}return d},of}var lf,l1;function Eu(){if(l1)return lf;l1=1;var i=mw();return lf=Function.prototype.bind||i,lf}var uf,u1;function cf(){return u1||(u1=1,uf=Function.prototype.call),uf}var hf,c1;function h1(){return c1||(c1=1,hf=Function.prototype.apply),hf}var df,d1;function yw(){return d1||(d1=1,df=typeof Reflect<"u"&&Reflect&&Reflect.apply),df}var ff,f1;function vw(){if(f1)return ff;f1=1;var i=Eu(),e=h1(),t=cf(),r=yw();return ff=r||i.call(t,e),ff}var gf,g1;function p1(){if(g1)return gf;g1=1;var i=Eu(),e=Ba(),t=cf(),r=vw();return gf=function(s){if(s.length<1||typeof s[0]!="function")throw new e("a function is required");return r(i,t,s)},gf}var pf,m1;function Ew(){if(m1)return pf;m1=1;var i=p1(),e=Zv(),t;try{t=[].__proto__===Array.prototype}catch(a){if(!a||typeof a!="object"||!("code"in a)||a.code!=="ERR_PROTO_ACCESS")throw a}var r=!!t&&e&&e(Object.prototype,"__proto__"),n=Object,s=n.getPrototypeOf;return pf=r&&typeof r.get=="function"?i([r.get]):typeof s=="function"?function(o){return s(o==null?o:n(o))}:!1,pf}var mf,y1;function Aw(){if(y1)return mf;y1=1;var i=n1(),e=a1(),t=Ew();return mf=i?function(n){return i(n)}:e?function(n){if(!n||typeof n!="object"&&typeof n!="function")throw new TypeError("getProto: not an object");return e(n)}:t?function(n){return t(n)}:null,mf}var yf,v1;function xw(){if(v1)return yf;v1=1;var i=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=Eu();return yf=t.call(i,e),yf}var vf,E1;function Ef(){if(E1)return vf;E1=1;var i,e=kv(),t=QI(),r=ZI(),n=ew(),s=tw(),a=rw(),o=Ba(),u=iw(),l=nw(),h=sw(),d=aw(),p=ow(),g=lw(),m=uw(),v=hw(),E=Function,x=function(rt){try{return E('"use strict"; return ('+rt+").constructor;")()}catch{}},T=Zv(),R=fw(),_=function(){throw new o},F=T?function(){try{return arguments.callee,_}catch{try{return T(arguments,"callee").get}catch{return _}}}():_,N=pw()(),C=Aw(),M=a1(),L=n1(),I=h1(),U=cf(),q={},$=typeof Uint8Array>"u"||!C?i:C(Uint8Array),X={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?i:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?i:ArrayBuffer,"%ArrayIteratorPrototype%":N&&C?C([][Symbol.iterator]()):i,"%AsyncFromSyncIteratorPrototype%":i,"%AsyncFunction%":q,"%AsyncGenerator%":q,"%AsyncGeneratorFunction%":q,"%AsyncIteratorPrototype%":q,"%Atomics%":typeof Atomics>"u"?i:Atomics,"%BigInt%":typeof BigInt>"u"?i:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?i:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?i:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?i:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":r,"%Float16Array%":typeof Float16Array>"u"?i:Float16Array,"%Float32Array%":typeof Float32Array>"u"?i:Float32Array,"%Float64Array%":typeof Float64Array>"u"?i:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?i:FinalizationRegistry,"%Function%":E,"%GeneratorFunction%":q,"%Int8Array%":typeof Int8Array>"u"?i:Int8Array,"%Int16Array%":typeof Int16Array>"u"?i:Int16Array,"%Int32Array%":typeof Int32Array>"u"?i:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":N&&C?C(C([][Symbol.iterator]())):i,"%JSON%":typeof JSON=="object"?JSON:i,"%Map%":typeof Map>"u"?i:Map,"%MapIteratorPrototype%":typeof Map>"u"||!N||!C?i:C(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":T,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?i:Promise,"%Proxy%":typeof Proxy>"u"?i:Proxy,"%RangeError%":n,"%ReferenceError%":s,"%Reflect%":typeof Reflect>"u"?i:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?i:Set,"%SetIteratorPrototype%":typeof Set>"u"||!N||!C?i:C(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?i:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":N&&C?C(""[Symbol.iterator]()):i,"%Symbol%":N?Symbol:i,"%SyntaxError%":a,"%ThrowTypeError%":F,"%TypedArray%":$,"%TypeError%":o,"%Uint8Array%":typeof Uint8Array>"u"?i:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?i:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?i:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?i:Uint32Array,"%URIError%":u,"%WeakMap%":typeof WeakMap>"u"?i:WeakMap,"%WeakRef%":typeof WeakRef>"u"?i:WeakRef,"%WeakSet%":typeof WeakSet>"u"?i:WeakSet,"%Function.prototype.call%":U,"%Function.prototype.apply%":I,"%Object.defineProperty%":R,"%Object.getPrototypeOf%":M,"%Math.abs%":l,"%Math.floor%":h,"%Math.max%":d,"%Math.min%":p,"%Math.pow%":g,"%Math.round%":m,"%Math.sign%":v,"%Reflect.getPrototypeOf%":L};if(C)try{null.error}catch(rt){var ie=C(C(rt));X["%Error.prototype%"]=ie}var ne=function rt(Ge){var nt;if(Ge==="%AsyncFunction%")nt=x("async function () {}");else if(Ge==="%GeneratorFunction%")nt=x("function* () {}");else if(Ge==="%AsyncGeneratorFunction%")nt=x("async function* () {}");else if(Ge==="%AsyncGenerator%"){var B=rt("%AsyncGeneratorFunction%");B&&(nt=B.prototype)}else if(Ge==="%AsyncIteratorPrototype%"){var se=rt("%AsyncGenerator%");se&&C&&(nt=C(se.prototype))}return X[Ge]=nt,nt},ue={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},re=Eu(),V=xw(),J=re.call(U,Array.prototype.concat),ve=re.call(I,Array.prototype.splice),de=re.call(U,String.prototype.replace),De=re.call(U,String.prototype.slice),Ie=re.call(U,RegExp.prototype.exec),Ne=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Be=/\\(\\)?/g,$e=function(Ge){var nt=De(Ge,0,1),B=De(Ge,-1);if(nt==="%"&&B!=="%")throw new a("invalid intrinsic syntax, expected closing `%`");if(B==="%"&&nt!=="%")throw new a("invalid intrinsic syntax, expected opening `%`");var se=[];return de(Ge,Ne,function(xe,Ae,ge,we){se[se.length]=ge?de(we,Be,"$1"):Ae||xe}),se},et=function(Ge,nt){var B=Ge,se;if(V(ue,B)&&(se=ue[B],B="%"+se[0]+"%"),V(X,B)){var xe=X[B];if(xe===q&&(xe=ne(B)),typeof xe>"u"&&!nt)throw new o("intrinsic "+Ge+" exists, but is not available. Please file an issue!");return{alias:se,name:B,value:xe}}throw new a("intrinsic "+Ge+" does not exist!")};return vf=function(Ge,nt){if(typeof Ge!="string"||Ge.length===0)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof nt!="boolean")throw new o('"allowMissing" argument must be a boolean');if(Ie(/^%?[^%]*%?$/,Ge)===null)throw new a("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var B=$e(Ge),se=B.length>0?B[0]:"",xe=et("%"+se+"%",nt),Ae=xe.name,ge=xe.value,we=!1,Me=xe.alias;Me&&(se=Me[0],ve(B,J([0,1],Me)));for(var le=1,K=!0;le<B.length;le+=1){var D=B[le],S=De(D,0,1),P=De(D,-1);if((S==='"'||S==="'"||S==="`"||P==='"'||P==="'"||P==="`")&&S!==P)throw new a("property names with quotes must have matching quotes");if((D==="constructor"||!K)&&(we=!0),se+="."+D,Ae="%"+se+"%",V(X,Ae))ge=X[Ae];else if(ge!=null){if(!(D in ge)){if(!nt)throw new o("base intrinsic for "+Ge+" exists, but the property is not available.");return}if(T&&le+1>=B.length){var z=T(ge,D);K=!!z,K&&"get"in z&&!("originalValue"in z.get)?ge=z.get:ge=ge[D]}else K=V(ge,D),ge=ge[D];K&&!we&&(X[Ae]=ge)}}return ge},vf}var Af,A1;function x1(){if(A1)return Af;A1=1;var i=Ef(),e=p1(),t=e([i("%String.prototype.indexOf%")]);return Af=function(n,s){var a=i(n,!!s);return typeof a=="function"&&t(n,".prototype.")>-1?e([a]):a},Af}var xf,S1;function b1(){if(S1)return xf;S1=1;var i=Ef(),e=x1(),t=vu(),r=Ba(),n=i("%Map%",!0),s=e("Map.prototype.get",!0),a=e("Map.prototype.set",!0),o=e("Map.prototype.has",!0),u=e("Map.prototype.delete",!0),l=e("Map.prototype.size",!0);return xf=!!n&&function(){var d,p={assert:function(g){if(!p.has(g))throw new r("Side channel does not contain "+t(g))},delete:function(g){if(d){var m=u(d,g);return l(d)===0&&(d=void 0),m}return!1},get:function(g){if(d)return s(d,g)},has:function(g){return d?o(d,g):!1},set:function(g,m){d||(d=new n),a(d,g,m)}};return p},xf}var Sf,T1;function Sw(){if(T1)return Sf;T1=1;var i=Ef(),e=x1(),t=vu(),r=b1(),n=Ba(),s=i("%WeakMap%",!0),a=e("WeakMap.prototype.get",!0),o=e("WeakMap.prototype.set",!0),u=e("WeakMap.prototype.has",!0),l=e("WeakMap.prototype.delete",!0);return Sf=s?function(){var d,p,g={assert:function(m){if(!g.has(m))throw new n("Side channel does not contain "+t(m))},delete:function(m){if(s&&m&&(typeof m=="object"||typeof m=="function")){if(d)return l(d,m)}else if(r&&p)return p.delete(m);return!1},get:function(m){return s&&m&&(typeof m=="object"||typeof m=="function")&&d?a(d,m):p&&p.get(m)},has:function(m){return s&&m&&(typeof m=="object"||typeof m=="function")&&d?u(d,m):!!p&&p.has(m)},set:function(m,v){s&&m&&(typeof m=="object"||typeof m=="function")?(d||(d=new s),o(d,m,v)):r&&(p||(p=r()),p.set(m,v))}};return g}:r,Sf}var bf,D1;function bw(){if(D1)return bf;D1=1;var i=Ba(),e=vu(),t=JI(),r=b1(),n=Sw(),s=n||r||t;return bf=function(){var o,u={assert:function(l){if(!u.has(l))throw new i("Side channel does not contain "+e(l))},delete:function(l){return!!o&&o.delete(l)},get:function(l){return o&&o.get(l)},has:function(l){return!!o&&o.has(l)},set:function(l,h){o||(o=s()),o.set(l,h)}};return u},bf}var Tf,R1;function Df(){if(R1)return Tf;R1=1;var i=String.prototype.replace,e=/%20/g,t={RFC1738:"RFC1738",RFC3986:"RFC3986"};return Tf={default:t.RFC3986,formatters:{RFC1738:function(r){return i.call(r,e,"+")},RFC3986:function(r){return String(r)}},RFC1738:t.RFC1738,RFC3986:t.RFC3986},Tf}var Rf,I1;function w1(){if(I1)return Rf;I1=1;var i=Df(),e=Object.prototype.hasOwnProperty,t=Array.isArray,r=function(){for(var E=[],x=0;x<256;++x)E.push("%"+((x<16?"0":"")+x.toString(16)).toUpperCase());return E}(),n=function(x){for(;x.length>1;){var T=x.pop(),R=T.obj[T.prop];if(t(R)){for(var _=[],F=0;F<R.length;++F)typeof R[F]<"u"&&_.push(R[F]);T.obj[T.prop]=_}}},s=function(x,T){for(var R=T&&T.plainObjects?{__proto__:null}:{},_=0;_<x.length;++_)typeof x[_]<"u"&&(R[_]=x[_]);return R},a=function E(x,T,R){if(!T)return x;if(typeof T!="object"&&typeof T!="function"){if(t(x))x.push(T);else if(x&&typeof x=="object")(R&&(R.plainObjects||R.allowPrototypes)||!e.call(Object.prototype,T))&&(x[T]=!0);else return[x,T];return x}if(!x||typeof x!="object")return[x].concat(T);var _=x;return t(x)&&!t(T)&&(_=s(x,R)),t(x)&&t(T)?(T.forEach(function(F,N){if(e.call(x,N)){var C=x[N];C&&typeof C=="object"&&F&&typeof F=="object"?x[N]=E(C,F,R):x.push(F)}else x[N]=F}),x):Object.keys(T).reduce(function(F,N){var C=T[N];return e.call(F,N)?F[N]=E(F[N],C,R):F[N]=C,F},_)},o=function(x,T){return Object.keys(T).reduce(function(R,_){return R[_]=T[_],R},x)},u=function(E,x,T){var R=E.replace(/\+/g," ");if(T==="iso-8859-1")return R.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(R)}catch{return R}},l=1024,h=function(x,T,R,_,F){if(x.length===0)return x;var N=x;if(typeof x=="symbol"?N=Symbol.prototype.toString.call(x):typeof x!="string"&&(N=String(x)),R==="iso-8859-1")return escape(N).replace(/%u[0-9a-f]{4}/gi,function($){return"%26%23"+parseInt($.slice(2),16)+"%3B"});for(var C="",M=0;M<N.length;M+=l){for(var L=N.length>=l?N.slice(M,M+l):N,I=[],U=0;U<L.length;++U){var q=L.charCodeAt(U);if(q===45||q===46||q===95||q===126||q>=48&&q<=57||q>=65&&q<=90||q>=97&&q<=122||F===i.RFC1738&&(q===40||q===41)){I[I.length]=L.charAt(U);continue}if(q<128){I[I.length]=r[q];continue}if(q<2048){I[I.length]=r[192|q>>6]+r[128|q&63];continue}if(q<55296||q>=57344){I[I.length]=r[224|q>>12]+r[128|q>>6&63]+r[128|q&63];continue}U+=1,q=65536+((q&1023)<<10|L.charCodeAt(U)&1023),I[I.length]=r[240|q>>18]+r[128|q>>12&63]+r[128|q>>6&63]+r[128|q&63]}C+=I.join("")}return C},d=function(x){for(var T=[{obj:{o:x},prop:"o"}],R=[],_=0;_<T.length;++_)for(var F=T[_],N=F.obj[F.prop],C=Object.keys(N),M=0;M<C.length;++M){var L=C[M],I=N[L];typeof I=="object"&&I!==null&&R.indexOf(I)===-1&&(T.push({obj:N,prop:L}),R.push(I))}return n(T),x},p=function(x){return Object.prototype.toString.call(x)==="[object RegExp]"},g=function(x){return!x||typeof x!="object"?!1:!!(x.constructor&&x.constructor.isBuffer&&x.constructor.isBuffer(x))},m=function(x,T){return[].concat(x,T)},v=function(x,T){if(t(x)){for(var R=[],_=0;_<x.length;_+=1)R.push(T(x[_]));return R}return T(x)};return Rf={arrayToObject:s,assign:o,combine:m,compact:d,decode:u,encode:h,isBuffer:g,isRegExp:p,maybeMap:v,merge:a},Rf}var If,C1;function Tw(){if(C1)return If;C1=1;var i=bw(),e=w1(),t=Df(),r=Object.prototype.hasOwnProperty,n={brackets:function(E){return E+"[]"},comma:"comma",indices:function(E,x){return E+"["+x+"]"},repeat:function(E){return E}},s=Array.isArray,a=Array.prototype.push,o=function(v,E){a.apply(v,s(E)?E:[E])},u=Date.prototype.toISOString,l=t.default,h={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:e.encode,encodeValuesOnly:!1,filter:void 0,format:l,formatter:t.formatters[l],indices:!1,serializeDate:function(E){return u.call(E)},skipNulls:!1,strictNullHandling:!1},d=function(E){return typeof E=="string"||typeof E=="number"||typeof E=="boolean"||typeof E=="symbol"||typeof E=="bigint"},p={},g=function v(E,x,T,R,_,F,N,C,M,L,I,U,q,$,X,ie,ne,ue){for(var re=E,V=ue,J=0,ve=!1;(V=V.get(p))!==void 0&&!ve;){var de=V.get(E);if(J+=1,typeof de<"u"){if(de===J)throw new RangeError("Cyclic object value");ve=!0}typeof V.get(p)>"u"&&(J=0)}if(typeof L=="function"?re=L(x,re):re instanceof Date?re=q(re):T==="comma"&&s(re)&&(re=e.maybeMap(re,function(Ae){return Ae instanceof Date?q(Ae):Ae})),re===null){if(F)return M&&!ie?M(x,h.encoder,ne,"key",$):x;re=""}if(d(re)||e.isBuffer(re)){if(M){var De=ie?x:M(x,h.encoder,ne,"key",$);return[X(De)+"="+X(M(re,h.encoder,ne,"value",$))]}return[X(x)+"="+X(String(re))]}var Ie=[];if(typeof re>"u")return Ie;var Ne;if(T==="comma"&&s(re))ie&&M&&(re=e.maybeMap(re,M)),Ne=[{value:re.length>0?re.join(",")||null:void 0}];else if(s(L))Ne=L;else{var Be=Object.keys(re);Ne=I?Be.sort(I):Be}var $e=C?String(x).replace(/\./g,"%2E"):String(x),et=R&&s(re)&&re.length===1?$e+"[]":$e;if(_&&s(re)&&re.length===0)return et+"[]";for(var rt=0;rt<Ne.length;++rt){var Ge=Ne[rt],nt=typeof Ge=="object"&&Ge&&typeof Ge.value<"u"?Ge.value:re[Ge];if(!(N&&nt===null)){var B=U&&C?String(Ge).replace(/\./g,"%2E"):String(Ge),se=s(re)?typeof T=="function"?T(et,B):et:et+(U?"."+B:"["+B+"]");ue.set(E,J);var xe=i();xe.set(p,ue),o(Ie,v(nt,se,T,R,_,F,N,C,T==="comma"&&ie&&s(re)?null:M,L,I,U,q,$,X,ie,ne,xe))}}return Ie},m=function(E){if(!E)return h;if(typeof E.allowEmptyArrays<"u"&&typeof E.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof E.encodeDotInKeys<"u"&&typeof E.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(E.encoder!==null&&typeof E.encoder<"u"&&typeof E.encoder!="function")throw new TypeError("Encoder has to be a function.");var x=E.charset||h.charset;if(typeof E.charset<"u"&&E.charset!=="utf-8"&&E.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var T=t.default;if(typeof E.format<"u"){if(!r.call(t.formatters,E.format))throw new TypeError("Unknown format option provided.");T=E.format}var R=t.formatters[T],_=h.filter;(typeof E.filter=="function"||s(E.filter))&&(_=E.filter);var F;if(E.arrayFormat in n?F=E.arrayFormat:"indices"in E?F=E.indices?"indices":"repeat":F=h.arrayFormat,"commaRoundTrip"in E&&typeof E.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var N=typeof E.allowDots>"u"?E.encodeDotInKeys===!0?!0:h.allowDots:!!E.allowDots;return{addQueryPrefix:typeof E.addQueryPrefix=="boolean"?E.addQueryPrefix:h.addQueryPrefix,allowDots:N,allowEmptyArrays:typeof E.allowEmptyArrays=="boolean"?!!E.allowEmptyArrays:h.allowEmptyArrays,arrayFormat:F,charset:x,charsetSentinel:typeof E.charsetSentinel=="boolean"?E.charsetSentinel:h.charsetSentinel,commaRoundTrip:!!E.commaRoundTrip,delimiter:typeof E.delimiter>"u"?h.delimiter:E.delimiter,encode:typeof E.encode=="boolean"?E.encode:h.encode,encodeDotInKeys:typeof E.encodeDotInKeys=="boolean"?E.encodeDotInKeys:h.encodeDotInKeys,encoder:typeof E.encoder=="function"?E.encoder:h.encoder,encodeValuesOnly:typeof E.encodeValuesOnly=="boolean"?E.encodeValuesOnly:h.encodeValuesOnly,filter:_,format:T,formatter:R,serializeDate:typeof E.serializeDate=="function"?E.serializeDate:h.serializeDate,skipNulls:typeof E.skipNulls=="boolean"?E.skipNulls:h.skipNulls,sort:typeof E.sort=="function"?E.sort:null,strictNullHandling:typeof E.strictNullHandling=="boolean"?E.strictNullHandling:h.strictNullHandling}};return If=function(v,E){var x=v,T=m(E),R,_;typeof T.filter=="function"?(_=T.filter,x=_("",x)):s(T.filter)&&(_=T.filter,R=_);var F=[];if(typeof x!="object"||x===null)return"";var N=n[T.arrayFormat],C=N==="comma"&&T.commaRoundTrip;R||(R=Object.keys(x)),T.sort&&R.sort(T.sort);for(var M=i(),L=0;L<R.length;++L){var I=R[L],U=x[I];T.skipNulls&&U===null||o(F,g(U,I,N,C,T.allowEmptyArrays,T.strictNullHandling,T.skipNulls,T.encodeDotInKeys,T.encode?T.encoder:null,T.filter,T.sort,T.allowDots,T.serializeDate,T.format,T.formatter,T.encodeValuesOnly,T.charset,M))}var q=F.join(T.delimiter),$=T.addQueryPrefix===!0?"?":"";return T.charsetSentinel&&(T.charset==="iso-8859-1"?$+="utf8=%26%2310003%3B&":$+="utf8=%E2%9C%93&"),q.length>0?$+q:""},If}var wf,N1;function Dw(){if(N1)return wf;N1=1;var i=w1(),e=Object.prototype.hasOwnProperty,t=Array.isArray,r={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:i.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},n=function(p){return p.replace(/&#(\d+);/g,function(g,m){return String.fromCharCode(parseInt(m,10))})},s=function(p,g,m){if(p&&typeof p=="string"&&g.comma&&p.indexOf(",")>-1)return p.split(",");if(g.throwOnLimitExceeded&&m>=g.arrayLimit)throw new RangeError("Array limit exceeded. Only "+g.arrayLimit+" element"+(g.arrayLimit===1?"":"s")+" allowed in an array.");return p},a="utf8=%26%2310003%3B",o="utf8=%E2%9C%93",u=function(g,m){var v={__proto__:null},E=m.ignoreQueryPrefix?g.replace(/^\?/,""):g;E=E.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var x=m.parameterLimit===1/0?void 0:m.parameterLimit,T=E.split(m.delimiter,m.throwOnLimitExceeded?x+1:x);if(m.throwOnLimitExceeded&&T.length>x)throw new RangeError("Parameter limit exceeded. Only "+x+" parameter"+(x===1?"":"s")+" allowed.");var R=-1,_,F=m.charset;if(m.charsetSentinel)for(_=0;_<T.length;++_)T[_].indexOf("utf8=")===0&&(T[_]===o?F="utf-8":T[_]===a&&(F="iso-8859-1"),R=_,_=T.length);for(_=0;_<T.length;++_)if(_!==R){var N=T[_],C=N.indexOf("]="),M=C===-1?N.indexOf("="):C+1,L,I;M===-1?(L=m.decoder(N,r.decoder,F,"key"),I=m.strictNullHandling?null:""):(L=m.decoder(N.slice(0,M),r.decoder,F,"key"),I=i.maybeMap(s(N.slice(M+1),m,t(v[L])?v[L].length:0),function(q){return m.decoder(q,r.decoder,F,"value")})),I&&m.interpretNumericEntities&&F==="iso-8859-1"&&(I=n(String(I))),N.indexOf("[]=")>-1&&(I=t(I)?[I]:I);var U=e.call(v,L);U&&m.duplicates==="combine"?v[L]=i.combine(v[L],I):(!U||m.duplicates==="last")&&(v[L]=I)}return v},l=function(p,g,m,v){var E=0;if(p.length>0&&p[p.length-1]==="[]"){var x=p.slice(0,-1).join("");E=Array.isArray(g)&&g[x]?g[x].length:0}for(var T=v?g:s(g,m,E),R=p.length-1;R>=0;--R){var _,F=p[R];if(F==="[]"&&m.parseArrays)_=m.allowEmptyArrays&&(T===""||m.strictNullHandling&&T===null)?[]:i.combine([],T);else{_=m.plainObjects?{__proto__:null}:{};var N=F.charAt(0)==="["&&F.charAt(F.length-1)==="]"?F.slice(1,-1):F,C=m.decodeDotInKeys?N.replace(/%2E/g,"."):N,M=parseInt(C,10);!m.parseArrays&&C===""?_={0:T}:!isNaN(M)&&F!==C&&String(M)===C&&M>=0&&m.parseArrays&&M<=m.arrayLimit?(_=[],_[M]=T):C!=="__proto__"&&(_[C]=T)}T=_}return T},h=function(g,m,v,E){if(g){var x=v.allowDots?g.replace(/\.([^.[]+)/g,"[$1]"):g,T=/(\[[^[\]]*])/,R=/(\[[^[\]]*])/g,_=v.depth>0&&T.exec(x),F=_?x.slice(0,_.index):x,N=[];if(F){if(!v.plainObjects&&e.call(Object.prototype,F)&&!v.allowPrototypes)return;N.push(F)}for(var C=0;v.depth>0&&(_=R.exec(x))!==null&&C<v.depth;){if(C+=1,!v.plainObjects&&e.call(Object.prototype,_[1].slice(1,-1))&&!v.allowPrototypes)return;N.push(_[1])}if(_){if(v.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+v.depth+" and strictDepth is true");N.push("["+x.slice(_.index)+"]")}return l(N,m,v,E)}},d=function(g){if(!g)return r;if(typeof g.allowEmptyArrays<"u"&&typeof g.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof g.decodeDotInKeys<"u"&&typeof g.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(g.decoder!==null&&typeof g.decoder<"u"&&typeof g.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof g.charset<"u"&&g.charset!=="utf-8"&&g.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof g.throwOnLimitExceeded<"u"&&typeof g.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var m=typeof g.charset>"u"?r.charset:g.charset,v=typeof g.duplicates>"u"?r.duplicates:g.duplicates;if(v!=="combine"&&v!=="first"&&v!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var E=typeof g.allowDots>"u"?g.decodeDotInKeys===!0?!0:r.allowDots:!!g.allowDots;return{allowDots:E,allowEmptyArrays:typeof g.allowEmptyArrays=="boolean"?!!g.allowEmptyArrays:r.allowEmptyArrays,allowPrototypes:typeof g.allowPrototypes=="boolean"?g.allowPrototypes:r.allowPrototypes,allowSparse:typeof g.allowSparse=="boolean"?g.allowSparse:r.allowSparse,arrayLimit:typeof g.arrayLimit=="number"?g.arrayLimit:r.arrayLimit,charset:m,charsetSentinel:typeof g.charsetSentinel=="boolean"?g.charsetSentinel:r.charsetSentinel,comma:typeof g.comma=="boolean"?g.comma:r.comma,decodeDotInKeys:typeof g.decodeDotInKeys=="boolean"?g.decodeDotInKeys:r.decodeDotInKeys,decoder:typeof g.decoder=="function"?g.decoder:r.decoder,delimiter:typeof g.delimiter=="string"||i.isRegExp(g.delimiter)?g.delimiter:r.delimiter,depth:typeof g.depth=="number"||g.depth===!1?+g.depth:r.depth,duplicates:v,ignoreQueryPrefix:g.ignoreQueryPrefix===!0,interpretNumericEntities:typeof g.interpretNumericEntities=="boolean"?g.interpretNumericEntities:r.interpretNumericEntities,parameterLimit:typeof g.parameterLimit=="number"?g.parameterLimit:r.parameterLimit,parseArrays:g.parseArrays!==!1,plainObjects:typeof g.plainObjects=="boolean"?g.plainObjects:r.plainObjects,strictDepth:typeof g.strictDepth=="boolean"?!!g.strictDepth:r.strictDepth,strictNullHandling:typeof g.strictNullHandling=="boolean"?g.strictNullHandling:r.strictNullHandling,throwOnLimitExceeded:typeof g.throwOnLimitExceeded=="boolean"?g.throwOnLimitExceeded:!1}};return wf=function(p,g){var m=d(g);if(p===""||p===null||typeof p>"u")return m.plainObjects?{__proto__:null}:{};for(var v=typeof p=="string"?u(p,m):p,E=m.plainObjects?{__proto__:null}:{},x=Object.keys(v),T=0;T<x.length;++T){var R=x[T],_=h(R,v[R],m,typeof p=="string");E=i.merge(E,_,m)}return m.allowSparse===!0?E:i.compact(E)},wf}var Cf,L1;function Rw(){if(L1)return Cf;L1=1;var i=Tw(),e=Dw(),t=Df();return Cf={formats:t,parse:e,stringify:i},Cf}var Nf=Rw();const Iw=Fa(Nf);class Ua{buildVideoId(e,t){if(e.buildType==="join"){if(e.buildParams)return e.prefix!==void 0?e.prefix+t.join(e.buildParams[0]):t.join(e.buildParams[0]);throw console.log("ID extraction rule is configured with join method, but no separator is configured in buildParams",e),new Error("ID extraction rule is configured with join method, but no separator is configured in buildParams")}else return e.prefix!==void 0?e.prefix+t.join(""):t.join("")}}class ww extends Ua{getVideoId(e,t){if(mt.isEmpty(e.values))throw console.error("Video ID extraction rule missing values property",e),new Error("Video ID extraction rule missing values property");const r=t.computeParsedQsIfAbsent(()=>Nf.parse(new URL(window.location.href).search.substring(1))),n=Ii.of(e.values).map(s=>r[s]??e.defaultValue).toArray();return this.buildVideoId(e,n)}}var zi={},_1;function Cw(){if(_1)return zi;_1=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.TokenData=void 0,zi.parse=d,zi.compile=p,zi.match=v,zi.pathToRegexp=E,zi.stringify=_;const i="/",e=C=>C,t=/^[$_\p{ID_Start}]$/u,r=/^[$\u200c\u200d\p{ID_Continue}]$/u,n="https://git.new/pathToRegexpError",s={"{":"{","}":"}","(":"(",")":")","[":"[","]":"]","+":"+","?":"?","!":"!"};function a(C){return C.replace(/[{}()\[\]+?!:*]/g,"\\$&")}function o(C){return C.replace(/[.+*?^${}()[\]|/\\]/g,"\\$&")}function*u(C){const M=[...C];let L=0;function I(){let U="";if(t.test(M[++L]))for(U+=M[L];r.test(M[++L]);)U+=M[L];else if(M[L]==='"'){let q=L;for(;L<M.length;){if(M[++L]==='"'){L++,q=0;break}M[L]==="\\"?U+=M[++L]:U+=M[L]}if(q)throw new TypeError(`Unterminated quote at ${q}: ${n}`)}if(!U)throw new TypeError(`Missing parameter name at ${L}: ${n}`);return U}for(;L<M.length;){const U=M[L],q=s[U];if(q)yield{type:q,index:L++,value:U};else if(U==="\\")yield{type:"ESCAPED",index:L++,value:M[L++]};else if(U===":"){const $=I();yield{type:"PARAM",index:L,value:$}}else if(U==="*"){const $=I();yield{type:"WILDCARD",index:L,value:$}}else yield{type:"CHAR",index:L,value:M[L++]}}return{type:"END",index:L,value:""}}class l{constructor(M){this.tokens=M}peek(){if(!this._peek){const M=this.tokens.next();this._peek=M.value}return this._peek}tryConsume(M){const L=this.peek();if(L.type===M)return this._peek=void 0,L.value}consume(M){const L=this.tryConsume(M);if(L!==void 0)return L;const{type:I,index:U}=this.peek();throw new TypeError(`Unexpected ${I} at ${U}, expected ${M}: ${n}`)}text(){let M="",L;for(;L=this.tryConsume("CHAR")||this.tryConsume("ESCAPED");)M+=L;return M}}class h{constructor(M){this.tokens=M}}zi.TokenData=h;function d(C,M={}){const{encodePath:L=e}=M,I=new l(u(C));function U($){const X=[];for(;;){const ie=I.text();ie&&X.push({type:"text",value:L(ie)});const ne=I.tryConsume("PARAM");if(ne){X.push({type:"param",name:ne});continue}const ue=I.tryConsume("WILDCARD");if(ue){X.push({type:"wildcard",name:ue});continue}if(I.tryConsume("{")){X.push({type:"group",tokens:U("}")});continue}return I.consume($),X}}const q=U("END");return new h(q)}function p(C,M={}){const{encode:L=encodeURIComponent,delimiter:I=i}=M,U=C instanceof h?C:d(C,M),q=g(U.tokens,I,L);return function(X={}){const[ie,...ne]=q(X);if(ne.length)throw new TypeError(`Missing parameters: ${ne.join(", ")}`);return ie}}function g(C,M,L){const I=C.map(U=>m(U,M,L));return U=>{const q=[""];for(const $ of I){const[X,...ie]=$(U);q[0]+=X,q.push(...ie)}return q}}function m(C,M,L){if(C.type==="text")return()=>[C.value];if(C.type==="group"){const U=g(C.tokens,M,L);return q=>{const[$,...X]=U(q);return X.length?[""]:[$]}}const I=L||e;return C.type==="wildcard"&&L!==!1?U=>{const q=U[C.name];if(q==null)return["",C.name];if(!Array.isArray(q)||q.length===0)throw new TypeError(`Expected "${C.name}" to be a non-empty array`);return[q.map(($,X)=>{if(typeof $!="string")throw new TypeError(`Expected "${C.name}/${X}" to be a string`);return I($)}).join(M)]}:U=>{const q=U[C.name];if(q==null)return["",C.name];if(typeof q!="string")throw new TypeError(`Expected "${C.name}" to be a string`);return[I(q)]}}function v(C,M={}){const{decode:L=decodeURIComponent,delimiter:I=i}=M,{regexp:U,keys:q}=E(C,M),$=q.map(X=>L===!1?e:X.type==="param"?L:ie=>ie.split(I).map(L));return function(ie){const ne=U.exec(ie);if(!ne)return!1;const ue=ne[0],re=Object.create(null);for(let V=1;V<ne.length;V++){if(ne[V]===void 0)continue;const J=q[V-1],ve=$[V-1];re[J.name]=ve(ne[V])}return{path:ue,params:re}}}function E(C,M={}){const{delimiter:L=i,end:I=!0,sensitive:U=!1,trailing:q=!0}=M,$=[],X=[],ie=U?"":"i",ue=(Array.isArray(C)?C:[C]).map(J=>J instanceof h?J:d(J,M));for(const{tokens:J}of ue)for(const ve of x(J,0,[])){const de=T(ve,L,$);X.push(de)}let re=`^(?:${X.join("|")})`;return q&&(re+=`(?:${o(L)}$)?`),re+=I?"$":`(?=${o(L)}|$)`,{regexp:new RegExp(re,ie),keys:$}}function*x(C,M,L){if(M===C.length)return yield L;const I=C[M];if(I.type==="group"){const U=L.slice();for(const q of x(I.tokens,0,U))yield*x(C,M+1,q)}else L.push(I);yield*x(C,M+1,L)}function T(C,M,L){let I="",U="",q=!0;for(let $=0;$<C.length;$++){const X=C[$];if(X.type==="text"){I+=o(X.value),U+=X.value,q||(q=X.value.includes(M));continue}if(X.type==="param"||X.type==="wildcard"){if(!q&&!U)throw new TypeError(`Missing text after "${X.name}": ${n}`);X.type==="param"?I+=`(${R(M,q?"":U)}+)`:I+="([\\s\\S]+)",L.push(X),U="",q=!1;continue}}return I}function R(C,M){return M.length<2?C.length<2?`[^${o(C+M)}]`:`(?:(?!${o(C)})[^${o(M)}])`:C.length<2?`(?:(?!${o(M)})[^${o(C)}])`:`(?:(?!${o(M)}|${o(C)})[\\s\\S])`}function _(C){return C.tokens.map(function M(L,I,U){if(L.type==="text")return a(L.value);if(L.type==="group")return`{${L.tokens.map(M).join("")}}`;const $=F(L.name)&&N(U[I+1])?L.name:JSON.stringify(L.name);if(L.type==="param")return`:${$}`;if(L.type==="wildcard")return`*${$}`;throw new TypeError(`Unexpected token: ${L}`)}).join("")}function F(C){const[M,...L]=C;return t.test(M)?L.every(I=>r.test(I)):!1}function N(C){return(C==null?void 0:C.type)!=="text"?!0:!r.test(C.value[0])}return zi}var Lf=Cw();class Nw extends Ua{getVideoId(e,t){if(mt.isEmpty(e.values))throw console.error("Video ID extraction rule missing values property",e),new Error("Video ID extraction rule missing values property");const r=t.computeUrlMatchResultIfAbsent(()=>Lf.match(e.values[0])(new URL(window.location.href).pathname));if(!r)throw console.error("Video ID extraction rule configuration error for current URL:",e),new Error("Video ID extraction rule configuration error for current URL");return this.extractedVideoId(e,r)}extractedVideoId(e,t){const r=Ii.of(e.values).slice(1).map(n=>t.params[n]).toArray();return this.buildVideoId(e,r)}}class Lw extends Ua{getVideoId(e,t){if(t.data===void 0)throw console.error("Context vo object is missing, unable to extract video ID using JSONPath",t),new Error("Context vo object is missing, unable to extract video ID using JSONPath");if(mt.isEmpty(e.values))throw console.error("Video ID extraction rule missing JSONPath values property",e),new Error("Video ID extraction rule missing JSONPath values property");let r=Ii.of(e.values).map(n=>wi(t.data,n)).flatten().toArray();return this.buildVideoId(e,r)}}const M1={"en-IE":{0:["Emily"],1:["Connor"]},"ar-KW":{0:["Noura"],1:["Fahed"]},"sw-TZ":{0:["Rehema"],1:["Daudi"]},"ms-MY":{0:["Yasmin"],1:["Osman"]},"en-IN":{0:["Neerja"],1:["Prabhat"]},"es-BO":{0:["Sofia"],1:["Marcelo"]},"ar-SY":{0:["Amany"],1:["Laith"]},"en-ZA":{0:["Leah"],1:["Luke"]},"ta-IN":{0:["Pallavi"],1:["Valluvar"]},"el-GR":{0:["Athina"],1:["Nestoras"]},"nl-NL":{0:["Fenna","Colette"],1:["Maarten"]},"zu-ZA":{0:["Thando"],1:["Themba"]},"ar-LB":{0:["Layla"],1:["Rami"]},"en-AU":{0:["Natasha"],1:["William"]},"he-IL":{0:["Hila"],1:["Avri"]},"mk-MK":{0:["Marija"],1:["Aleksandar"]},"ar-TN":{0:["Reem"],1:["Hedi"]},"ar-LY":{0:["Iman"],1:["Omar"]},"hu-HU":{0:["Noemi"],1:["Tamas"]},"ml-IN":{0:["Sobhana"],1:["Midhun"]},"es-SV":{0:["Lorena"],1:["Rodrigo"]},"es-CR":{0:["Maria"],1:["Juan"]},"es-CL":{0:["Catalina"],1:["Lorenzo"]},"fr-CA":{0:["Sylvie"],1:["Antoine","Jean"]},"es-CO":{0:["Salome"],1:["Gonzalo"]},"jv-ID":{0:["Siti"],1:["Dimas"]},"pl-PL":{0:["Zofia"],1:["Marek"]},"pt-PT":{0:["Raquel"],1:["Duarte"]},"ar-EG":{0:["Salma"],1:["Shakir"]},"es-CU":{0:["Belkys"],1:["Manuel"]},"fr-BE":{0:["Charline"],1:["Gerard"]},"ga-IE":{0:["Orla"],1:["Colm"]},"cy-GB":{0:["Nia"],1:["Aled"]},"ar-DZ":{0:["Amina"],1:["Ismael"]},"en-SG":{0:["Luna"],1:["Wayne"]},"ar-MA":{0:["Mouna"],1:["Jamal"]},"fil-PH":{0:["Blessica"],1:["Angelo"]},"ta-SG":{0:["Venba"],1:["Anbu"]},"en-KE":{0:["Asilia"],1:["Chilemba"]},"es-HN":{0:["Karla"],1:["Carlos"]},"nb-NO":{0:["Pernille"],1:["Finn"]},"hr-HR":{0:["Gabrijela"],1:["Srecko"]},"es-PR":{0:["Karina"],1:["Victor"]},"af-ZA":{0:["Adri"],1:["Willem"]},"gl-ES":{0:["Sabela"],1:["Roi"]},"es-PY":{0:["Tania"],1:["Mario"]},"de-AT":{0:["Ingrid"],1:["Jonas"]},"ta-LK":{0:["Saranya"],1:["Kumar"]},"is-IS":{0:["Gudrun"],1:["Gunnar"]},"my-MM":{0:["Nilar"],1:["Thiha"]},"bg-BG":{0:["Kalina"],1:["Borislav"]},"cs-CZ":{0:["Vlasta"],1:["Antonin"]},"en-PH":{0:["Rosa"],1:["James"]},"uz-UZ":{0:["Madina"],1:["Sardor"]},"zh-TW":{0:["HsiaoYu","HsiaoChen"],1:["YunJhe"]},"en-HK":{0:["Yan"],1:["Sam"]},"ko-KR":{0:["SunHi"],1:["InJoon"]},"sk-SK":{0:["Viktoria"],1:["Lukas"]},"ps-AF":{0:["Latifa"],1:["GulNawaz"]},"ar-OM":{0:["Aysha"],1:["Abdullah"]},"ru-RU":{0:["Svetlana"],1:["Dmitry"]},"sq-AL":{0:["Anila"],1:["Ilir"]},"es-AR":{0:["Elena"],1:["Tomas"]},"sv-SE":{0:["Sofie"],1:["Mattias"]},"am-ET":{0:["Mekdes"],1:["Ameha"]},"mr-IN":{0:["Aarohi"],1:["Manohar"]},"da-DK":{0:["Christel"],1:["Jeppe"]},"mn-MN":{0:["Yesui"],1:["Bataa"]},"uk-UA":{0:["Polina"],1:["Ostap"]},"en-US":{0:["Michelle","Ana","Aria","Jenny"],1:["Roger","Christopher","Eric","Steffan","Guy"]},"ta-MY":{0:["Kani"],1:["Surya"]},"gu-IN":{0:["Dhwani"],1:["Niranjan"]},"lv-LV":{0:["Everita"],1:["Nils"]},"nl-BE":{0:["Dena"],1:["Arnaud"]},"zh-CN":{0:["Xiaoxiao","Xiaoyi"],1:["Yunyang","Yunxia","Yunxi","Yunjian"]},"ur-PK":{0:["Uzma"],1:["Asad"]},"te-IN":{0:["Shruti"],1:["Mohan"]},"hi-IN":{0:["Swara"],1:["Madhur"]},"en-NG":{0:["Ezinne"],1:["Abeo"]},"de-CH":{0:["Leni"],1:["Jan"]},"ja-JP":{0:["Nanami"],1:["Keita"]},"bs-BA":{0:["Vesna"],1:["Goran"]},"ar-YE":{0:["Maryam"],1:["Saleh"]},"ne-NP":{0:["Hemkala"],1:["Sagar"]},"ka-GE":{0:["Eka"],1:["Giorgi"]},"ar-QA":{0:["Amal"],1:["Moaz"]},"es-GT":{0:["Marta"],1:["Andres"]},"es-GQ":{0:["Teresa"],1:["Javier"]},"es-PE":{0:["Camila"],1:["Alex"]},"en-NZ":{0:["Molly"],1:["Mitchell"]},"fa-IR":{0:["Dilara"],1:["Farid"]},"es-PA":{0:["Margarita"],1:["Roberto"]},"ro-RO":{0:["Alina"],1:["Emil"]},"mt-MT":{0:["Grace"],1:["Joseph"]},"et-EE":{0:["Anu"],1:["Kert"]},"tr-TR":{0:["Emel"],1:["Ahmet"]},"fr-FR":{0:["Denise","Eloise"],1:["Henri"]},"vi-VN":{0:["HoaiMy"],1:["NamMinh"]},"en-GB":{0:["Maisie","Libby","Sonia"],1:["Thomas","Ryan"]},"km-KH":{0:["Sreymom"],1:["Piseth"]},"fi-FI":{0:["Noora"],1:["Harri"]},"az-AZ":{0:["Banu"],1:["Babek"]},"en-CA":{0:["Clara"],1:["Liam"]},"lt-LT":{0:["Ona"],1:["Leonas"]},"ar-AE":{0:["Fatima"],1:["Hamdan"]},"sl-SI":{0:["Petra"],1:["Rok"]},"es-DO":{0:["Ramona"],1:["Emilio"]},"ar-IQ":{0:["Rana"],1:["Bassel"]},"bn-IN":{0:["Tanishaa"],1:["Bashkar"]},"si-LK":{0:["Thilini"],1:["Sameera"]},"fr-CH":{0:["Ariane"],1:["Fabrice"]},"es-EC":{0:["Andrea"],1:["Luis"]},"es-US":{0:["Paloma"],1:["Alonso"]},"kn-IN":{0:["Sapna"],1:["Gagan"]},"lo-LA":{0:["Keomany"],1:["Chanthavong"]},"ar-SA":{0:["Zariyah"],1:["Hamed"]},"ca-ES":{0:["Joana"],1:["Enric"]},"de-DE":{0:["Katja","Amala"],1:["Conrad","Killian"]},"zh-HK":{0:["HiuGaai","HiuMaan"],1:["WanLung"]},"pt-BR":{0:["Francisca"],1:["Antonio"]},"sr-RS":{0:["Sophie"],1:["Nicholas"]},"es-UY":{0:["Valentina"],1:["Mateo"]},"sw-KE":{0:["Zuri"],1:["Rafiki"]},"ar-BH":{0:["Laila"],1:["Ali"]},"es-ES":{0:["Elvira"],1:["Alvaro"]},"kk-KZ":{0:["Aigul"],1:["Daulet"]},"ar-JO":{0:["Sana"],1:["Taim"]},"es-VE":{0:["Paola"],1:["Sebastian"]},"so-SO":{0:["Ubax"],1:["Muuse"]},"en-TZ":{0:["Imani"],1:["Elimu"]},"su-ID":{0:["Tuti"],1:["Jajang"]},"es-MX":{0:["Dalia"],1:["Jorge"]},"it-IT":{0:["Elsa","Isabella"],1:["Diego"]},"ur-IN":{0:["Gul"],1:["Salman"]},"bn-BD":{0:["Nabanita"],1:["Pradeep"]},"id-ID":{0:["Gadis"],1:["Ardi"]},"es-NI":{0:["Yolanda"],1:["Federico"]},"th-TH":{0:["Premwadee"],1:["Niwat"]}},Au={AvaMultilingual:{code:"en-US-AvaMultilingualNeural",language:"en-US",displayName:"Ava Multilingual",localName:"Ava Multilingual"},EmmaMultilingual:{code:"en-US-EmmaMultilingualNeural",language:"en-US",displayName:"Emma Multilingual",localName:"Emma Multilingual"},AndrewMultilingual:{code:"en-US-AndrewMultilingualNeural",language:"en-US",displayName:"Andrew Multilingual",localName:"Andrew Multilingual"},BrianMultilingual:{code:"en-US-BrianMultilingualNeural",language:"en-US",displayName:"Brian Multilingual",localName:"Brian Multilingual"},JennyMultilingual:{code:"en-US-JennyMultilingualNeural",language:"en-US",displayName:"Jenny Multilingual",localName:"Jenny Multilingual"},RyanMultilingual:{code:"en-US-RyanMultilingualNeural",language:"en-US",displayName:"Ryan Multilingual",localName:"Ryan Multilingual"},SeraphinaMultilingual:{code:"de-DE-SeraphinaMultilingualNeural",language:"de-DE",displayName:"Seraphina Multilingual",localName:"Seraphina Mehrsprachig"},FlorianMultilingual:{code:"de-DE-FlorianMultilingualNeural",language:"de-DE",displayName:"Florian Multilingual",localName:"Florian Mehrsprachig"},VivienneMultilingual:{code:"fr-FR-VivienneMultilingualNeural",language:"fr-FR",displayName:"Vivienne Multilingual",localName:"Vivienne Multilingue"},RemyMultilingual:{code:"fr-FR-RemyMultilingualNeural",language:"fr-FR",displayName:"Remy Multilingual",localName:"Rémy Multilingue"},MasaruMultilingual:{code:"ja-JP-MasaruMultilingualNeural",language:"ja-JP",displayName:"Masaru Multilingual",localName:"勝 多言語"},YunyiMultilingual:{code:"zh-CN-YunyiMultilingualNeural",language:"zh-CN",displayName:"Yunyi Multilingual",localName:"云逸 多语言"},XiaoxiaoMultilingual:{code:"zh-CN-XiaoxiaoMultilingualNeural",language:"zh-CN",displayName:"Xiaoxiao Multilingual",localName:"晓晓 多语言"},XiaochenMultilingual:{code:"zh-CN-XiaochenMultilingualNeural",language:"zh-CN",displayName:"Xiaochen Multilingual",localName:"晓辰 多语言"},XiaoyuMultilingual:{code:"zh-CN-XiaoyuMultilingualNeural",language:"zh-CN",displayName:"Xiaoyu Multilingual",localName:"晓雨 多语言"},"Xiaochen:DragonHDLatestNeural":{code:"zh-CN-Xiaochen:DragonHDLatestNeural",language:"zh-CN",displayName:"Xiaochen:DragonHDLatestNeural",localName:"晓辰(龙)"},"Seraphina:DragonHDLatestNeural":{code:"de-DE-Seraphina:DragonHDLatestNeural",language:"de-DE",displayName:"Seraphina:DragonHDLatest",localName:"Seraphina:DragonHD"},"Aria:DragonHDLatestNeural":{code:"en-US-Aria:DragonHDLatestNeural",language:"en-US",displayName:"Aria:DragonHDLatest",localName:"Aria:DragonHD"},"Ava:DragonHDLatestNeural":{code:"en-US-Ava:DragonHDLatestNeural",language:"en-US",displayName:"Ava:DragonHDLatest",localName:"Ava:DragonHD"},"Emma:DragonHDLatestNeural":{code:"en-US-Emma:DragonHDLatestNeural",language:"en-US",displayName:"Emma:DragonHDLatest",localName:"Emma:DragonHD"},"Emma2:DragonHDLatestNeural":{code:"en-US-Emma2:DragonHDLatestNeural",language:"en-US",displayName:"Emma2:DragonHDLatest",localName:"Emma2:DragonHD"},"Jenny:DragonHDLatestNeural":{code:"en-US-Jenny:DragonHDLatestNeural",language:"en-US",displayName:"Jenny:DragonHDLatest",localName:"Jenny:DragonHD"},"Andrew:DragonHDLatestNeural":{code:"en-US-Andrew:DragonHDLatestNeural",language:"en-US",displayName:"Andrew:DragonHDLatest",localName:"Andrew:DragonHD"},"Andrew2:DragonHDLatestNeural":{code:"en-US-Andrew2:DragonHDLatestNeural",language:"en-US",displayName:"Andrew2:DragonHDLatest",localName:"Andrew2:DragonHD"},"Davis:DragonHDLatestNeural":{code:"en-US-Davis:DragonHDLatestNeural",language:"en-US",displayName:"Davis:DragonHDLatest",localName:"Davis:DragonHD"},"Steffan:DragonHDLatestNeural":{code:"en-US-Steffan:DragonHDLatestNeural",language:"en-US",displayName:"Steffan:DragonHDLatest",localName:"Steffan:DragonHD"},"Masaru:DragonHDLatestNeural":{code:"ja-JP-Masaru:DragonHDLatestNeural",language:"ja-JP",displayName:"Masaru:DragonHDLatest",localName:"Masaru:DragonHD"},Alba:{code:"ca-ES-AlbaNeural",language:"ca-ES",displayName:"Alba",localName:"Alba"},Gisela:{code:"de-DE-GiselaNeural",language:"de-DE",displayName:"Gisela",localName:"Gisela"},Elke:{code:"de-DE-ElkeNeural",language:"de-DE",displayName:"Elke",localName:"Elke"},Klarissa:{code:"de-DE-KlarissaNeural",language:"de-DE",displayName:"Klarissa",localName:"Klarissa"},Louisa:{code:"de-DE-LouisaNeural",language:"de-DE",displayName:"Louisa",localName:"Louisa"},Maja:{code:"de-DE-MajaNeural",language:"de-DE",displayName:"Maja",localName:"Maja"},Tanja:{code:"de-DE-TanjaNeural",language:"de-DE",displayName:"Tanja",localName:"Tanja"},Bernd:{code:"de-DE-BerndNeural",language:"de-DE",displayName:"Bernd",localName:"Bernd"},Kasper:{code:"de-DE-KasperNeural",language:"de-DE",displayName:"Kasper",localName:"Kasper"},Christoph:{code:"de-DE-ChristophNeural",language:"de-DE",displayName:"Christoph",localName:"Christoph"},Klaus:{code:"de-DE-KlausNeural",language:"de-DE",displayName:"Klaus",localName:"Klaus"},Ralf:{code:"de-DE-RalfNeural",language:"de-DE",displayName:"Ralf",localName:"Ralf"},Annette:{code:"en-AU-AnnetteNeural",language:"en-AU",displayName:"Annette",localName:"Annette"},Carly:{code:"en-AU-CarlyNeural",language:"en-AU",displayName:"Carly",localName:"Carly"},Elsie:{code:"en-AU-ElsieNeural",language:"en-AU",displayName:"Elsie",localName:"Elsie"},Freya:{code:"en-AU-FreyaNeural",language:"en-AU",displayName:"Freya",localName:"Freya"},Joanne:{code:"en-AU-JoanneNeural",language:"en-AU",displayName:"Joanne",localName:"Joanne"},Kim:{code:"en-AU-KimNeural",language:"en-AU",displayName:"Kim",localName:"Kim"},Tina:{code:"en-AU-TinaNeural",language:"en-AU",displayName:"Tina",localName:"Tina"},Darren:{code:"en-AU-DarrenNeural",language:"en-AU",displayName:"Darren",localName:"Darren"},Duncan:{code:"en-AU-DuncanNeural",language:"en-AU",displayName:"Duncan",localName:"Duncan"},Ken:{code:"en-AU-KenNeural",language:"en-AU",displayName:"Ken",localName:"Ken"},Neil:{code:"en-AU-NeilNeural",language:"en-AU",displayName:"Neil",localName:"Neil"},Tim:{code:"en-AU-TimNeural",language:"en-AU",displayName:"Tim",localName:"Tim"},Abbi:{code:"en-GB-AbbiNeural",language:"en-GB",displayName:"Abbi",localName:"Abbi"},Bella:{code:"en-GB-BellaNeural",language:"en-GB",displayName:"Bella",localName:"Bella"},Hollie:{code:"en-GB-HollieNeural",language:"en-GB",displayName:"Hollie",localName:"Hollie"},Maisie:{code:"en-GB-MaisieNeural",language:"en-GB",displayName:"Maisie",localName:"Maisie"},Olivia:{code:"en-GB-OliviaNeural",language:"en-GB",displayName:"Olivia",localName:"Olivia"},Mia:{code:"en-GB-MiaNeural",language:"en-GB",displayName:"Mia",localName:"Mia"},Alfie:{code:"en-GB-AlfieNeural",language:"en-GB",displayName:"Alfie",localName:"Alfie"},Elliot:{code:"en-GB-ElliotNeural",language:"en-GB",displayName:"Elliot",localName:"Elliot"},Ethan:{code:"en-GB-EthanNeural",language:"en-GB",displayName:"Ethan",localName:"Ethan"},Noah:{code:"en-GB-NoahNeural",language:"en-GB",displayName:"Noah",localName:"Noah"},Oliver:{code:"en-GB-OliverNeural",language:"en-GB",displayName:"Oliver",localName:"Oliver"},Aashi:{code:"en-IN-AashiNeural",language:"en-IN",displayName:"Aashi",localName:"Aashi"},Ananya:{code:"en-IN-AnanyaNeural",language:"en-IN",displayName:"Ananya",localName:"Ananya"},Kavya:{code:"en-IN-KavyaNeural",language:"en-IN",displayName:"Kavya",localName:"Kavya"},Jane:{code:"en-US-JaneNeural",language:"en-US",displayName:"Jane",localName:"Jane"},Sara:{code:"en-US-SaraNeural",language:"en-US",displayName:"Sara",localName:"Sara"},Nancy:{code:"en-US-NancyNeural",language:"en-US",displayName:"Nancy",localName:"Nancy"},Amber:{code:"en-US-AmberNeural",language:"en-US",displayName:"Amber",localName:"Amber"},Ashley:{code:"en-US-AshleyNeural",language:"en-US",displayName:"Ashley",localName:"Ashley"},Cora:{code:"en-US-CoraNeural",language:"en-US",displayName:"Cora",localName:"Cora"},Elizabeth:{code:"en-US-ElizabethNeural",language:"en-US",displayName:"Elizabeth",localName:"Elizabeth"},Michelle:{code:"en-US-MichelleNeural",language:"en-US",displayName:"Michelle",localName:"Michelle"},Monica:{code:"en-US-MonicaNeural",language:"en-US",displayName:"Monica",localName:"Monica"},AIGenerate2:{code:"en-US-AIGenerate2Neural",language:"en-US",displayName:"AIGenerate2",localName:"AIGenerate2"},Blue:{code:"en-US-BlueNeural",language:"en-US",displayName:"Blue",localName:"Blue"},Davis:{code:"en-US-DavisNeural",language:"en-US",displayName:"Davis",localName:"Davis"},Jason:{code:"en-US-JasonNeural",language:"en-US",displayName:"Jason",localName:"Jason"},Tony:{code:"en-US-TonyNeural",language:"en-US",displayName:"Tony",localName:"Tony"},Brandon:{code:"en-US-BrandonNeural",language:"en-US",displayName:"Brandon",localName:"Brandon"},Jacob:{code:"en-US-JacobNeural",language:"en-US",displayName:"Jacob",localName:"Jacob"},AIGenerate1:{code:"en-US-AIGenerate1Neural",language:"en-US",displayName:"AIGenerate1",localName:"AIGenerate1"},Abril:{code:"es-ES-AbrilNeural",language:"es-ES",displayName:"Abril",localName:"Abril"},Estrella:{code:"es-ES-EstrellaNeural",language:"es-ES",displayName:"Estrella",localName:"Estrella"},Irene:{code:"es-ES-IreneNeural",language:"es-ES",displayName:"Irene",localName:"Irene"},Laia:{code:"es-ES-LaiaNeural",language:"es-ES",displayName:"Laia",localName:"Laia"},Lia:{code:"es-ES-LiaNeural",language:"es-ES",displayName:"Lia",localName:"Lia"},Triana:{code:"es-ES-TrianaNeural",language:"es-ES",displayName:"Triana",localName:"Triana"},Vera:{code:"es-ES-VeraNeural",language:"es-ES",displayName:"Vera",localName:"Vera"},Ximena:{code:"es-ES-XimenaNeural",language:"es-ES",displayName:"Ximena",localName:"Ximena"},Arnau:{code:"es-ES-ArnauNeural",language:"es-ES",displayName:"Arnau",localName:"Arnau"},Dario:{code:"es-ES-DarioNeural",language:"es-ES",displayName:"Dario",localName:"Dario"},Elias:{code:"es-ES-EliasNeural",language:"es-ES",displayName:"Elias",localName:"Elias"},Nil:{code:"es-ES-NilNeural",language:"es-ES",displayName:"Nil",localName:"Nil"},Saul:{code:"es-ES-SaulNeural",language:"es-ES",displayName:"Saul",localName:"Saul"},Teo:{code:"es-ES-TeoNeural",language:"es-ES",displayName:"Teo",localName:"Teo"},Beatriz:{code:"es-MX-BeatrizNeural",language:"es-MX",displayName:"Beatriz",localName:"Beatriz"},Candela:{code:"es-MX-CandelaNeural",language:"es-MX",displayName:"Candela",localName:"Candela"},Carlota:{code:"es-MX-CarlotaNeural",language:"es-MX",displayName:"Carlota",localName:"Carlota"},Larissa:{code:"es-MX-LarissaNeural",language:"es-MX",displayName:"Larissa",localName:"Larissa"},Marina:{code:"es-MX-MarinaNeural",language:"es-MX",displayName:"Marina",localName:"Marina"},Nuria:{code:"es-MX-NuriaNeural",language:"es-MX",displayName:"Nuria",localName:"Nuria"},Renata:{code:"es-MX-RenataNeural",language:"es-MX",displayName:"Renata",localName:"Renata"},Cecilio:{code:"es-MX-CecilioNeural",language:"es-MX",displayName:"Cecilio",localName:"Cecilio"},Gerardo:{code:"es-MX-GerardoNeural",language:"es-MX",displayName:"Gerardo",localName:"Gerardo"},Liberto:{code:"es-MX-LibertoNeural",language:"es-MX",displayName:"Liberto",localName:"Liberto"},Luciano:{code:"es-MX-LucianoNeural",language:"es-MX",displayName:"Luciano",localName:"Luciano"},Pelayo:{code:"es-MX-PelayoNeural",language:"es-MX",displayName:"Pelayo",localName:"Pelayo"},Yago:{code:"es-MX-YagoNeural",language:"es-MX",displayName:"Yago",localName:"Yago"},Selma:{code:"fi-FI-SelmaNeural",language:"fi-FI",displayName:"Selma",localName:"Selma"},Thierry:{code:"fr-CA-ThierryNeural",language:"fr-CA",displayName:"Thierry",localName:"Thierry"},Jacqueline:{code:"fr-FR-JacquelineNeural",language:"fr-FR",displayName:"Jacqueline",localName:"Jacqueline"},Josephine:{code:"fr-FR-JosephineNeural",language:"fr-FR",displayName:"Josephine",localName:"Josephine"},Brigitte:{code:"fr-FR-BrigitteNeural",language:"fr-FR",displayName:"Brigitte",localName:"Brigitte"},Coralie:{code:"fr-FR-CoralieNeural",language:"fr-FR",displayName:"Coralie",localName:"Coralie"},Celeste:{code:"fr-FR-CelesteNeural",language:"fr-FR",displayName:"Celeste",localName:"Celeste"},Yvette:{code:"fr-FR-YvetteNeural",language:"fr-FR",displayName:"Yvette",localName:"Yvette"},Claude:{code:"fr-FR-ClaudeNeural",language:"fr-FR",displayName:"Claude",localName:"Claude"},Alain:{code:"fr-FR-AlainNeural",language:"fr-FR",displayName:"Alain",localName:"Alain"},Jerome:{code:"fr-FR-JeromeNeural",language:"fr-FR",displayName:"Jerome",localName:"Jerome"},Maurice:{code:"fr-FR-MauriceNeural",language:"fr-FR",displayName:"Maurice",localName:"Maurice"},Yves:{code:"fr-FR-YvesNeural",language:"fr-FR",displayName:"Yves",localName:"Yves"},"Ananya-hi":{code:"hi-IN-AnanyaNeural",language:"hi-IN",displayName:"Ananya",localName:"अनन्या"},"Kavya-hi":{code:"hi-IN-KavyaNeural",language:"hi-IN",displayName:"Kavya",localName:"काव्या"},Fabiola:{code:"it-IT-FabiolaNeural",language:"it-IT",displayName:"Fabiola",localName:"Fabiola"},Fiamma:{code:"it-IT-FiammaNeural",language:"it-IT",displayName:"Fiamma",localName:"Fiamma"},Imelda:{code:"it-IT-ImeldaNeural",language:"it-IT",displayName:"Imelda",localName:"Imelda"},Irma:{code:"it-IT-IrmaNeural",language:"it-IT",displayName:"Irma",localName:"Irma"},Palmira:{code:"it-IT-PalmiraNeural",language:"it-IT",displayName:"Palmira",localName:"Palmira"},Pierina:{code:"it-IT-PierinaNeural",language:"it-IT",displayName:"Pierina",localName:"Pierina"},Benigno:{code:"it-IT-BenignoNeural",language:"it-IT",displayName:"Benigno",localName:"Benigno"},Calimero:{code:"it-IT-CalimeroNeural",language:"it-IT",displayName:"Calimero",localName:"Calimero"},Cataldo:{code:"it-IT-CataldoNeural",language:"it-IT",displayName:"Cataldo",localName:"Cataldo"},Gianni:{code:"it-IT-GianniNeural",language:"it-IT",displayName:"Gianni",localName:"Gianni"},Giuseppe:{code:"it-IT-GiuseppeNeural",language:"it-IT",displayName:"Giuseppe",localName:"Giuseppe"},Lisandro:{code:"it-IT-LisandroNeural",language:"it-IT",displayName:"Lisandro",localName:"Lisandro"},Rinaldo:{code:"it-IT-RinaldoNeural",language:"it-IT",displayName:"Rinaldo",localName:"Rinaldo"},Shiori:{code:"ja-JP-ShioriNeural",language:"ja-JP",displayName:"Shiori",localName:"志織"},Mayu:{code:"ja-JP-MayuNeural",language:"ja-JP",displayName:"Mayu",localName:"真夕"},Aoi:{code:"ja-JP-AoiNeural",language:"ja-JP",displayName:"Aoi",localName:"碧衣"},Naoki:{code:"ja-JP-NaokiNeural",language:"ja-JP",displayName:"Naoki",localName:"直紀"},Daichi:{code:"ja-JP-DaichiNeural",language:"ja-JP",displayName:"Daichi",localName:"大智"},JiMin:{code:"ko-KR-JiMinNeural",language:"ko-KR",displayName:"JiMin",localName:"지민"},SeoHyeon:{code:"ko-KR-SeoHyeonNeural",language:"ko-KR",displayName:"SeoHyeon",localName:"서현"},SoonBok:{code:"ko-KR-SoonBokNeural",language:"ko-KR",displayName:"SoonBok",localName:"순복"},YuJin:{code:"ko-KR-YuJinNeural",language:"ko-KR",displayName:"YuJin",localName:"유진"},BongJin:{code:"ko-KR-BongJinNeural",language:"ko-KR",displayName:"BongJin",localName:"봉진"},GookMin:{code:"ko-KR-GookMinNeural",language:"ko-KR",displayName:"GookMin",localName:"국민"},Hyunsu:{code:"ko-KR-HyunsuNeural",language:"ko-KR",displayName:"Hyunsu",localName:"현수"},Nilar:{code:"my-MM-NilarNeural",language:"my-MM",displayName:"Nilar",localName:"နီလာ"},Thiha:{code:"my-MM-ThihaNeural",language:"my-MM",displayName:"Thiha",localName:"သီဟ"},Iselin:{code:"nb-NO-IselinNeural",language:"nb-NO",displayName:"Iselin",localName:"Iselin"},Agnieszka:{code:"pl-PL-AgnieszkaNeural",language:"pl-PL",displayName:"Agnieszka",localName:"Agnieszka"},Giovanna:{code:"pt-BR-GiovannaNeural",language:"pt-BR",displayName:"Giovanna",localName:"Giovanna"},Leila:{code:"pt-BR-LeilaNeural",language:"pt-BR",displayName:"Leila",localName:"Leila"},Leticia:{code:"pt-BR-LeticiaNeural",language:"pt-BR",displayName:"Leticia",localName:"Leticia"},Yara:{code:"pt-BR-YaraNeural",language:"pt-BR",displayName:"Yara",localName:"Yara"},Manuela:{code:"pt-BR-ManuelaNeural",language:"pt-BR",displayName:"Manuela",localName:"Manuela"},Thalita:{code:"pt-BR-ThalitaNeural",language:"pt-BR",displayName:"Thalita",localName:"Thalita"},Elza:{code:"pt-BR-ElzaNeural",language:"pt-BR",displayName:"Elza",localName:"Elza"},Brenda:{code:"pt-BR-BrendaNeural",language:"pt-BR",displayName:"Brenda",localName:"Brenda"},Julio:{code:"pt-BR-JulioNeural",language:"pt-BR",displayName:"Julio",localName:"Julio"},Humberto:{code:"pt-BR-HumbertoNeural",language:"pt-BR",displayName:"Humberto",localName:"Humberto"},Nicolau:{code:"pt-BR-NicolauNeural",language:"pt-BR",displayName:"Nicolau",localName:"Nicolau"},Valerio:{code:"pt-BR-ValerioNeural",language:"pt-BR",displayName:"Valerio",localName:"Valerio"},Fabio:{code:"pt-BR-FabioNeural",language:"pt-BR",displayName:"Fabio",localName:"Fabio"},Donato:{code:"pt-BR-DonatoNeural",language:"pt-BR",displayName:"Donato",localName:"Donato"},Fernanda:{code:"pt-PT-FernandaNeural",language:"pt-PT",displayName:"Fernanda",localName:"Fernanda"},Dariya:{code:"ru-RU-DariyaNeural",language:"ru-RU",displayName:"Dariya",localName:"Дария"},Nicholas:{code:"sr-RS-NicholasNeural",language:"sr-RS",displayName:"Nicholas",localName:"Никола"},Sophie:{code:"sr-RS-SophieNeural",language:"sr-RS",displayName:"Sophie",localName:"Софија"},Hillevi:{code:"sv-SE-HilleviNeural",language:"sv-SE",displayName:"Hillevi",localName:"Hillevi"},Achara:{code:"th-TH-AcharaNeural",language:"th-TH",displayName:"Achara",localName:"อัจฉรา"},Xiaohan:{code:"zh-CN-XiaohanNeural",language:"zh-CN",displayName:"Xiaohan",localName:"晓涵"},Xiaomeng:{code:"zh-CN-XiaomengNeural",language:"zh-CN",displayName:"Xiaomeng",localName:"晓梦"},Xiaomo:{code:"zh-CN-XiaomoNeural",language:"zh-CN",displayName:"Xiaomo",localName:"晓莫"},Xiaoqiu:{code:"zh-CN-XiaoqiuNeural",language:"zh-CN",displayName:"Xiaoqiu",localName:"晓秋"},Xiaorui:{code:"zh-CN-XiaoruiNeural",language:"zh-CN",displayName:"Xiaorui",localName:"晓睿"},Xiaoshuang:{code:"zh-CN-XiaoshuangNeural",language:"zh-CN",displayName:"Xiaoshuang",localName:"晓双"},Xiaoyan:{code:"zh-CN-XiaoyanNeural",language:"zh-CN",displayName:"Xiaoyan",localName:"晓颜"},Xiaoxuan:{code:"zh-CN-XiaoxuanNeural",language:"zh-CN",displayName:"Xiaoxuan",localName:"晓萱"},Xiaoyou:{code:"zh-CN-XiaoyouNeural",language:"zh-CN",displayName:"Xiaoyou",localName:"晓悠"},Xiaozhen:{code:"zh-CN-XiaozhenNeural",language:"zh-CN",displayName:"Xiaozhen",localName:"晓甄"},Xiaorou:{code:"zh-CN-XiaorouNeural",language:"zh-CN",displayName:"Xiaorou",localName:"晓柔"},Xiaotong:{code:"wuu-CN-XiaotongNeural",language:"zh-CN",displayName:"Xiaotong",localName:"晓彤"},XiaoMin:{code:"yue-CN-XiaoMinNeural",language:"zh-CN",displayName:"XiaoMin",localName:"晓敏"},Xiaobei:{code:"zh-CN-liaoning-XiaobeiNeural",language:"zh-CN",displayName:"Xiaobei",localName:"晓北 辽宁"},Xiaoni:{code:"zh-CN-shaanxi-XiaoniNeural",language:"zh-CN",displayName:"Xiaoni",localName:"晓妮 陕西"},Yunfeng:{code:"zh-CN-yunfengNeural",language:"zh-CN",displayName:"Yunfeng",localName:"云枫"},Yunhao:{code:"zh-CN-yunhaoNeural",language:"zh-CN",displayName:"Yunhao",localName:"云皓"},Yunjie:{code:"zh-CN-yunjieNeural",language:"zh-CN",displayName:"Yunjie",localName:"云杰"},Yunye:{code:"zh-CN-yunyeNeural",language:"zh-CN",displayName:"Yunye",localName:"云野"},Yunze:{code:"zh-CN-yunzeNeural",language:"zh-CN",displayName:"Yunze",localName:"云泽"},Yunzhe:{code:"wuu-CN-YunzheNeural",language:"zh-CN",displayName:"Yunzhe",localName:"云哲"},YunSong:{code:"yue-CN-YunSongNeural",language:"zh-CN",displayName:"YunSong",localName:"云松"},Yunqi:{code:"zh-CN-guangxi-YunqiNeural",language:"zh-CN",displayName:"Yunqi",localName:"云奇 广西"},Yundeng:{code:"zh-CN-henan-YundengNeural",language:"zh-CN",displayName:"Yundeng",localName:"云登 河南"},Yunbiao:{code:"zh-CN-liaoning-YunbiaoNeural",language:"zh-CN",displayName:"Yunbiao",localName:"云彪 辽宁"},Yunxiang:{code:"zh-CN-shandong-YunxiangNeural",language:"zh-CN",displayName:"Yunxiang",localName:"云翔 山东"},"Yunxi-SiChuan":{code:"zh-CN-sichuan-YunxiNeural",language:"zh-CN",displayName:"Yunxi",localName:"云希 四川"},Emily:{code:"en-IE-EmilyNeural",language:"en-IE",displayName:"Emily",localName:"Emily"},Connor:{code:"en-IE-ConnorNeural",language:"en-IE",displayName:"Connor",localName:"Connor"},Noura:{code:"ar-KW-NouraNeural",language:"ar-KW",displayName:"Noura",localName:"نورا"},Fahed:{code:"ar-KW-FahedNeural",language:"ar-KW",displayName:"Fahed",localName:"فهد"},Rehema:{code:"sw-TZ-RehemaNeural",language:"sw-TZ",displayName:"Rehema",localName:"Rehema"},Daudi:{code:"sw-TZ-DaudiNeural",language:"sw-TZ",displayName:"Daudi",localName:"Daudi"},Yasmin:{code:"ms-MY-YasminNeural",language:"ms-MY",displayName:"Yasmin",localName:"Yasmin"},Osman:{code:"ms-MY-OsmanNeural",language:"ms-MY",displayName:"Osman",localName:"Osman"},Neerja:{code:"en-IN-NeerjaNeural",language:"en-IN",displayName:"Neerja",localName:"Neerja"},Prabhat:{code:"en-IN-PrabhatNeural",language:"en-IN",displayName:"Prabhat",localName:"Prabhat"},Sofia:{code:"es-BO-SofiaNeural",language:"es-BO",displayName:"Sofia",localName:"Sofia"},Marcelo:{code:"es-BO-MarceloNeural",language:"es-BO",displayName:"Marcelo",localName:"Marcelo"},Amany:{code:"ar-SY-AmanyNeural",language:"ar-SY",displayName:"Amany",localName:"أماني"},Laith:{code:"ar-SY-LaithNeural",language:"ar-SY",displayName:"Laith",localName:"ليث"},Leah:{code:"en-ZA-LeahNeural",language:"en-ZA",displayName:"Leah",localName:"Leah"},Luke:{code:"en-ZA-LukeNeural",language:"en-ZA",displayName:"Luke",localName:"Luke"},Pallavi:{code:"ta-IN-PallaviNeural",language:"ta-IN",displayName:"Pallavi",localName:"பல்லவி"},Valluvar:{code:"ta-IN-ValluvarNeural",language:"ta-IN",displayName:"Valluvar",localName:"வள்ளுவர்"},Athina:{code:"el-GR-AthinaNeural",language:"el-GR",displayName:"Athina",localName:"Αθηνά"},Nestoras:{code:"el-GR-NestorasNeural",language:"el-GR",displayName:"Nestoras",localName:"Νέστορας"},Fenna:{code:"nl-NL-FennaNeural",language:"nl-NL",displayName:"Fenna",localName:"Fenna"},Colette:{code:"nl-NL-ColetteNeural",language:"nl-NL",displayName:"Colette",localName:"Colette"},Maarten:{code:"nl-NL-MaartenNeural",language:"nl-NL",displayName:"Maarten",localName:"Maarten"},Thando:{code:"zu-ZA-ThandoNeural",language:"zu-ZA",displayName:"Thando",localName:"Thando"},Themba:{code:"zu-ZA-ThembaNeural",language:"zu-ZA",displayName:"Themba",localName:"Themba"},Layla:{code:"ar-LB-LaylaNeural",language:"ar-LB",displayName:"Layla",localName:"ليلى"},Rami:{code:"ar-LB-RamiNeural",language:"ar-LB",displayName:"Rami",localName:"رامي"},Natasha:{code:"en-AU-NatashaNeural",language:"en-AU",displayName:"Natasha",localName:"Natasha"},William:{code:"en-AU-WilliamNeural",language:"en-AU",displayName:"William",localName:"William"},Hila:{code:"he-IL-HilaNeural",language:"he-IL",displayName:"Hila",localName:"הילה"},Avri:{code:"he-IL-AvriNeural",language:"he-IL",displayName:"Avri",localName:"אברי"},Marija:{code:"mk-MK-MarijaNeural",language:"mk-MK",displayName:"Marija",localName:"Марија"},Aleksandar:{code:"mk-MK-AleksandarNeural",language:"mk-MK",displayName:"Aleksandar",localName:"Александар"},Reem:{code:"ar-TN-ReemNeural",language:"ar-TN",displayName:"Reem",localName:"ريم"},Hedi:{code:"ar-TN-HediNeural",language:"ar-TN",displayName:"Hedi",localName:"هادي"},Iman:{code:"ar-LY-ImanNeural",language:"ar-LY",displayName:"Iman",localName:"إيمان"},Omar:{code:"ar-LY-OmarNeural",language:"ar-LY",displayName:"Omar",localName:"أحمد"},Noemi:{code:"hu-HU-NoemiNeural",language:"hu-HU",displayName:"Noemi",localName:"Noémi"},Tamas:{code:"hu-HU-TamasNeural",language:"hu-HU",displayName:"Tamas",localName:"Tamás"},Sobhana:{code:"ml-IN-SobhanaNeural",language:"ml-IN",displayName:"Sobhana",localName:"ശോഭന"},Midhun:{code:"ml-IN-MidhunNeural",language:"ml-IN",displayName:"Midhun",localName:"മിഥുൻ"},Lorena:{code:"es-SV-LorenaNeural",language:"es-SV",displayName:"Lorena",localName:"Lorena"},Rodrigo:{code:"es-SV-RodrigoNeural",language:"es-SV",displayName:"Rodrigo",localName:"Rodrigo"},Maria:{code:"es-CR-MariaNeural",language:"es-CR",displayName:"Maria",localName:"María"},Juan:{code:"es-CR-JuanNeural",language:"es-CR",displayName:"Juan",localName:"Juan"},Catalina:{code:"es-CL-CatalinaNeural",language:"es-CL",displayName:"Catalina",localName:"Catalina"},Lorenzo:{code:"es-CL-LorenzoNeural",language:"es-CL",displayName:"Lorenzo",localName:"Lorenzo"},Sylvie:{code:"fr-CA-SylvieNeural",language:"fr-CA",displayName:"Sylvie",localName:"Sylvie"},Antoine:{code:"fr-CA-AntoineNeural",language:"fr-CA",displayName:"Antoine",localName:"Antoine"},Jean:{code:"fr-CA-JeanNeural",language:"fr-CA",displayName:"Jean",localName:"Jean"},Salome:{code:"es-CO-SalomeNeural",language:"es-CO",displayName:"Salome",localName:"Salome"},Gonzalo:{code:"es-CO-GonzaloNeural",language:"es-CO",displayName:"Gonzalo",localName:"Gonzalo"},Siti:{code:"jv-ID-SitiNeural",language:"jv-ID",displayName:"Siti",localName:"Siti"},Dimas:{code:"jv-ID-DimasNeural",language:"jv-ID",displayName:"Dimas",localName:"Dimas"},Zofia:{code:"pl-PL-ZofiaNeural",language:"pl-PL",displayName:"Zofia",localName:"Zofia"},Marek:{code:"pl-PL-MarekNeural",language:"pl-PL",displayName:"Marek",localName:"Marek"},Raquel:{code:"pt-PT-RaquelNeural",language:"pt-PT",displayName:"Raquel",localName:"Raquel"},Duarte:{code:"pt-PT-DuarteNeural",language:"pt-PT",displayName:"Duarte",localName:"Duarte"},Salma:{code:"ar-EG-SalmaNeural",language:"ar-EG",displayName:"Salma",localName:"سلمى"},Shakir:{code:"ar-EG-ShakirNeural",language:"ar-EG",displayName:"Shakir",localName:"شاكر"},Belkys:{code:"es-CU-BelkysNeural",language:"es-CU",displayName:"Belkys",localName:"Belkys"},Manuel:{code:"es-CU-ManuelNeural",language:"es-CU",displayName:"Manuel",localName:"Manuel"},Charline:{code:"fr-BE-CharlineNeural",language:"fr-BE",displayName:"Charline",localName:"Charline"},Gerard:{code:"fr-BE-GerardNeural",language:"fr-BE",displayName:"Gerard",localName:"Gerard"},Orla:{code:"ga-IE-OrlaNeural",language:"ga-IE",displayName:"Orla",localName:"Orla"},Colm:{code:"ga-IE-ColmNeural",language:"ga-IE",displayName:"Colm",localName:"Colm"},Nia:{code:"cy-GB-NiaNeural",language:"cy-GB",displayName:"Nia",localName:"Nia"},Aled:{code:"cy-GB-AledNeural",language:"cy-GB",displayName:"Aled",localName:"Aled"},Amina:{code:"ar-DZ-AminaNeural",language:"ar-DZ",displayName:"Amina",localName:"أمينة"},Ismael:{code:"ar-DZ-IsmaelNeural",language:"ar-DZ",displayName:"Ismael",localName:"إسماعيل"},Luna:{code:"en-SG-LunaNeural",language:"en-SG",displayName:"Luna",localName:"Luna"},Wayne:{code:"en-SG-WayneNeural",language:"en-SG",displayName:"Wayne",localName:"Wayne"},Mouna:{code:"ar-MA-MounaNeural",language:"ar-MA",displayName:"Mouna",localName:"منى"},Jamal:{code:"ar-MA-JamalNeural",language:"ar-MA",displayName:"Jamal",localName:"جمال"},Blessica:{code:"fil-PH-BlessicaNeural",language:"fil-PH",displayName:"Blessica",localName:"Blessica"},Angelo:{code:"fil-PH-AngeloNeural",language:"fil-PH",displayName:"Angelo",localName:"Angelo"},Venba:{code:"ta-SG-VenbaNeural",language:"ta-SG",displayName:"Venba",localName:"வெண்பா"},Anbu:{code:"ta-SG-AnbuNeural",language:"ta-SG",displayName:"Anbu",localName:"அன்பு"},Asilia:{code:"en-KE-AsiliaNeural",language:"en-KE",displayName:"Asilia",localName:"Asilia"},Chilemba:{code:"en-KE-ChilembaNeural",language:"en-KE",displayName:"Chilemba",localName:"Chilemba"},Karla:{code:"es-HN-KarlaNeural",language:"es-HN",displayName:"Karla",localName:"Karla"},Carlos:{code:"es-HN-CarlosNeural",language:"es-HN",displayName:"Carlos",localName:"Carlos"},Pernille:{code:"nb-NO-PernilleNeural",language:"nb-NO",displayName:"Pernille",localName:"Pernille"},Finn:{code:"nb-NO-FinnNeural",language:"nb-NO",displayName:"Finn",localName:"Finn"},Gabrijela:{code:"hr-HR-GabrijelaNeural",language:"hr-HR",displayName:"Gabrijela",localName:"Gabrijela"},Srecko:{code:"hr-HR-SreckoNeural",language:"hr-HR",displayName:"Srecko",localName:"Srecko"},Karina:{code:"es-PR-KarinaNeural",language:"es-PR",displayName:"Karina",localName:"Karina"},Victor:{code:"es-PR-VictorNeural",language:"es-PR",displayName:"Victor",localName:"Victor"},Adri:{code:"af-ZA-AdriNeural",language:"af-ZA",displayName:"Adri",localName:"Adri"},Willem:{code:"af-ZA-WillemNeural",language:"af-ZA",displayName:"Willem",localName:"Willem"},Sabela:{code:"gl-ES-SabelaNeural",language:"gl-ES",displayName:"Sabela",localName:"Sabela"},Roi:{code:"gl-ES-RoiNeural",language:"gl-ES",displayName:"Roi",localName:"Roi"},Tania:{code:"es-PY-TaniaNeural",language:"es-PY",displayName:"Tania",localName:"Tania"},Mario:{code:"es-PY-MarioNeural",language:"es-PY",displayName:"Mario",localName:"Mario"},Ingrid:{code:"de-AT-IngridNeural",language:"de-AT",displayName:"Ingrid",localName:"Ingrid"},Jonas:{code:"de-AT-JonasNeural",language:"de-AT",displayName:"Jonas",localName:"Jonas"},Saranya:{code:"ta-LK-SaranyaNeural",language:"ta-LK",displayName:"Saranya",localName:"சரண்யா"},Kumar:{code:"ta-LK-KumarNeural",language:"ta-LK",displayName:"Kumar",localName:"குமார்"},Gudrun:{code:"is-IS-GudrunNeural",language:"is-IS",displayName:"Gudrun",localName:"Guðrún"},Gunnar:{code:"is-IS-GunnarNeural",language:"is-IS",displayName:"Gunnar",localName:"Gunnar"},Kalina:{code:"bg-BG-KalinaNeural",language:"bg-BG",displayName:"Kalina",localName:"Калина"},Borislav:{code:"bg-BG-BorislavNeural",language:"bg-BG",displayName:"Borislav",localName:"Борислав"},Vlasta:{code:"cs-CZ-VlastaNeural",language:"cs-CZ",displayName:"Vlasta",localName:"Vlasta"},Antonin:{code:"cs-CZ-AntoninNeural",language:"cs-CZ",displayName:"Antonin",localName:"Antonin"},Rosa:{code:"en-PH-RosaNeural",language:"en-PH",displayName:"Rosa",localName:"Rosa"},James:{code:"en-PH-JamesNeural",language:"en-PH",displayName:"James",localName:"James"},Madina:{code:"uz-UZ-MadinaNeural",language:"uz-UZ",displayName:"Madina",localName:"Madina"},Sardor:{code:"uz-UZ-SardorNeural",language:"uz-UZ",displayName:"Sardor",localName:"Сардор"},HsiaoYu:{code:"zh-TW-HsiaoYuNeural",language:"zh-TW",displayName:"HsiaoYu",localName:"曉雨"},HsiaoChen:{code:"zh-TW-HsiaoChenNeural",language:"zh-TW",displayName:"HsiaoChen",localName:"曉臻"},YunJhe:{code:"zh-TW-YunJheNeural",language:"zh-TW",displayName:"YunJhe",localName:"雲哲"},Yan:{code:"en-HK-YanNeural",language:"en-HK",displayName:"Yan",localName:"Yan"},Sam:{code:"en-HK-SamNeural",language:"en-HK",displayName:"Sam",localName:"Sam"},SunHi:{code:"ko-KR-SunHiNeural",language:"ko-KR",displayName:"SunHi",localName:"선히"},InJoon:{code:"ko-KR-InJoonNeural",language:"ko-KR",displayName:"InJoon",localName:"인준"},Viktoria:{code:"sk-SK-ViktoriaNeural",language:"sk-SK",displayName:"Viktoria",localName:"Viktória"},Lukas:{code:"sk-SK-LukasNeural",language:"sk-SK",displayName:"Lukas",localName:"Lukáš"},Latifa:{code:"ps-AF-LatifaNeural",language:"ps-AF",displayName:"Latifa",localName:"لطيفه"},GulNawaz:{code:"ps-AF-GulNawazNeural",language:"ps-AF",displayName:"Gul Nawaz",localName:" ګل نواز"},Aysha:{code:"ar-OM-AyshaNeural",language:"ar-OM",displayName:"Aysha",localName:"عائشة"},Abdullah:{code:"ar-OM-AbdullahNeural",language:"ar-OM",displayName:"Abdullah",localName:"عبدالله"},Svetlana:{code:"ru-RU-SvetlanaNeural",language:"ru-RU",displayName:"Svetlana",localName:"Светлана"},Dmitry:{code:"ru-RU-DmitryNeural",language:"ru-RU",displayName:"Dmitry",localName:"Дмитрий"},Anila:{code:"sq-AL-AnilaNeural",language:"sq-AL",displayName:"Anila",localName:"Anila"},Ilir:{code:"sq-AL-IlirNeural",language:"sq-AL",displayName:"Ilir",localName:"Ilir"},Elena:{code:"es-AR-ElenaNeural",language:"es-AR",displayName:"Elena",localName:"Elena"},Tomas:{code:"es-AR-TomasNeural",language:"es-AR",displayName:"Tomas",localName:"Tomas"},Sofie:{code:"sv-SE-SofieNeural",language:"sv-SE",displayName:"Sofie",localName:"Sofie"},Mattias:{code:"sv-SE-MattiasNeural",language:"sv-SE",displayName:"Mattias",localName:"Mattias"},Mekdes:{code:"am-ET-MekdesNeural",language:"am-ET",displayName:"Mekdes",localName:"መቅደስ"},Ameha:{code:"am-ET-AmehaNeural",language:"am-ET",displayName:"Ameha",localName:"አምሀ"},Aarohi:{code:"mr-IN-AarohiNeural",language:"mr-IN",displayName:"Aarohi",localName:"आरोही"},Manohar:{code:"mr-IN-ManoharNeural",language:"mr-IN",displayName:"Manohar",localName:"मनोहर"},Christel:{code:"da-DK-ChristelNeural",language:"da-DK",displayName:"Christel",localName:"Christel"},Jeppe:{code:"da-DK-JeppeNeural",language:"da-DK",displayName:"Jeppe",localName:"Jeppe"},Yesui:{code:"mn-MN-YesuiNeural",language:"mn-MN",displayName:"Yesui",localName:"Есүй"},Bataa:{code:"mn-MN-BataaNeural",language:"mn-MN",displayName:"Bataa",localName:"Батаа"},Polina:{code:"uk-UA-PolinaNeural",language:"uk-UA",displayName:"Polina",localName:"Поліна"},Ostap:{code:"uk-UA-OstapNeural",language:"uk-UA",displayName:"Ostap",localName:"Остап"},Ana:{code:"en-US-AnaNeural",language:"en-US",displayName:"Ana",localName:"Ana"},Aria:{code:"en-US-AriaNeural",language:"en-US",displayName:"Aria",localName:"Aria"},Jenny:{code:"en-US-JennyNeural",language:"en-US",displayName:"Jenny",localName:"Jenny"},Roger:{code:"en-US-RogerNeural",language:"en-US",displayName:"Roger",localName:"Roger"},Christopher:{code:"en-US-ChristopherNeural",language:"en-US",displayName:"Christopher",localName:"Christopher"},Eric:{code:"en-US-EricNeural",language:"en-US",displayName:"Eric",localName:"Eric"},Steffan:{code:"en-US-SteffanNeural",language:"en-US",displayName:"Steffan",localName:"Steffan"},Guy:{code:"en-US-GuyNeural",language:"en-US",displayName:"Guy",localName:"Guy"},Kani:{code:"ta-MY-KaniNeural",language:"ta-MY",displayName:"Kani",localName:"கனி"},Surya:{code:"ta-MY-SuryaNeural",language:"ta-MY",displayName:"Surya",localName:"சூர்யா"},Dhwani:{code:"gu-IN-DhwaniNeural",language:"gu-IN",displayName:"Dhwani",localName:"ધ્વની"},Niranjan:{code:"gu-IN-NiranjanNeural",language:"gu-IN",displayName:"Niranjan",localName:"નિરંજન"},Everita:{code:"lv-LV-EveritaNeural",language:"lv-LV",displayName:"Everita",localName:"Everita"},Nils:{code:"lv-LV-NilsNeural",language:"lv-LV",displayName:"Nils",localName:"Nils"},Dena:{code:"nl-BE-DenaNeural",language:"nl-BE",displayName:"Dena",localName:"Dena"},Arnaud:{code:"nl-BE-ArnaudNeural",language:"nl-BE",displayName:"Arnaud",localName:"Arnaud"},Xiaoyi:{code:"zh-CN-XiaoyiNeural",language:"zh-CN",displayName:"Xiaoyi",localName:"晓伊"},Xiaoxiao:{code:"zh-CN-XiaoxiaoNeural",language:"zh-CN",displayName:"Xiaoxiao",localName:"晓晓"},Yunyang:{code:"zh-CN-YunyangNeural",language:"zh-CN",displayName:"Yunyang",localName:"云扬"},Yunxia:{code:"zh-CN-YunxiaNeural",language:"zh-CN",displayName:"Yunxia",localName:"云夏"},Yunxi:{code:"zh-CN-YunxiNeural",language:"zh-CN",displayName:"Yunxi",localName:"云希"},Yunjian:{code:"zh-CN-YunjianNeural",language:"zh-CN",displayName:"Yunjian",localName:"云健"},Uzma:{code:"ur-PK-UzmaNeural",language:"ur-PK",displayName:"Uzma",localName:"عظمیٰ"},Asad:{code:"ur-PK-AsadNeural",language:"ur-PK",displayName:"Asad",localName:"اسد"},Shruti:{code:"te-IN-ShrutiNeural",language:"te-IN",displayName:"Shruti",localName:"శ్రుతి"},Mohan:{code:"te-IN-MohanNeural",language:"te-IN",displayName:"Mohan",localName:"మోహన్"},Swara:{code:"hi-IN-SwaraNeural",language:"hi-IN",displayName:"Swara",localName:"स्वरा"},Madhur:{code:"hi-IN-MadhurNeural",language:"hi-IN",displayName:"Madhur",localName:"मधुर"},Ezinne:{code:"en-NG-EzinneNeural",language:"en-NG",displayName:"Ezinne",localName:"Ezinne"},Abeo:{code:"en-NG-AbeoNeural",language:"en-NG",displayName:"Abeo",localName:"Abeo"},Leni:{code:"de-CH-LeniNeural",language:"de-CH",displayName:"Leni",localName:"Leni"},Jan:{code:"de-CH-JanNeural",language:"de-CH",displayName:"Jan",localName:"Jan"},Nanami:{code:"ja-JP-NanamiNeural",language:"ja-JP",displayName:"Nanami",localName:"七海"},Keita:{code:"ja-JP-KeitaNeural",language:"ja-JP",displayName:"Keita",localName:"圭太"},Vesna:{code:"bs-BA-VesnaNeural",language:"bs-BA",displayName:"Vesna",localName:"Vesna"},Goran:{code:"bs-BA-GoranNeural",language:"bs-BA",displayName:"Goran",localName:"Goran"},Maryam:{code:"ar-YE-MaryamNeural",language:"ar-YE",displayName:"Maryam",localName:"مريم"},Saleh:{code:"ar-YE-SalehNeural",language:"ar-YE",displayName:"Saleh",localName:"صالح"},Hemkala:{code:"ne-NP-HemkalaNeural",language:"ne-NP",displayName:"Hemkala",localName:"हेमकला"},Sagar:{code:"ne-NP-SagarNeural",language:"ne-NP",displayName:"Sagar",localName:"सागर"},Eka:{code:"ka-GE-EkaNeural",language:"ka-GE",displayName:"Eka",localName:"ეკა"},Giorgi:{code:"ka-GE-GiorgiNeural",language:"ka-GE",displayName:"Giorgi",localName:"გიორგი"},Amal:{code:"ar-QA-AmalNeural",language:"ar-QA",displayName:"Amal",localName:"أمل"},Moaz:{code:"ar-QA-MoazNeural",language:"ar-QA",displayName:"Moaz",localName:"معاذ"},Marta:{code:"es-GT-MartaNeural",language:"es-GT",displayName:"Marta",localName:"Marta"},Andres:{code:"es-GT-AndresNeural",language:"es-GT",displayName:"Andres",localName:"Ándres"},Teresa:{code:"es-GQ-TeresaNeural",language:"es-GQ",displayName:"Teresa",localName:"Teresa"},Javier:{code:"es-GQ-JavierNeural",language:"es-GQ",displayName:"Javier",localName:"Javier"},Camila:{code:"es-PE-CamilaNeural",language:"es-PE",displayName:"Camila",localName:"Camila"},Alex:{code:"es-PE-AlexNeural",language:"es-PE",displayName:"Alex",localName:"Álex"},Molly:{code:"en-NZ-MollyNeural",language:"en-NZ",displayName:"Molly",localName:"Molly"},Mitchell:{code:"en-NZ-MitchellNeural",language:"en-NZ",displayName:"Mitchell",localName:"Mitchell"},Dilara:{code:"fa-IR-DilaraNeural",language:"fa-IR",displayName:"Dilara",localName:"دلارا"},Farid:{code:"fa-IR-FaridNeural",language:"fa-IR",displayName:"Farid",localName:"فرید"},Margarita:{code:"es-PA-MargaritaNeural",language:"es-PA",displayName:"Margarita",localName:"Margarita"},Roberto:{code:"es-PA-RobertoNeural",language:"es-PA",displayName:"Roberto",localName:"Roberto"},Alina:{code:"ro-RO-AlinaNeural",language:"ro-RO",displayName:"Alina",localName:"Alina"},Emil:{code:"ro-RO-EmilNeural",language:"ro-RO",displayName:"Emil",localName:"Emil"},Grace:{code:"mt-MT-GraceNeural",language:"mt-MT",displayName:"Grace",localName:"Grace"},Joseph:{code:"mt-MT-JosephNeural",language:"mt-MT",displayName:"Joseph",localName:"Joseph"},Anu:{code:"et-EE-AnuNeural",language:"et-EE",displayName:"Anu",localName:"Anu"},Kert:{code:"et-EE-KertNeural",language:"et-EE",displayName:"Kert",localName:"Kert"},Emel:{code:"tr-TR-EmelNeural",language:"tr-TR",displayName:"Emel",localName:"Emel"},Ahmet:{code:"tr-TR-AhmetNeural",language:"tr-TR",displayName:"Ahmet",localName:"Ahmet"},Denise:{code:"fr-FR-DeniseNeural",language:"fr-FR",displayName:"Denise",localName:"Denise"},Eloise:{code:"fr-FR-EloiseNeural",language:"fr-FR",displayName:"Eloise",localName:"Eloise"},Henri:{code:"fr-FR-HenriNeural",language:"fr-FR",displayName:"Henri",localName:"Henri"},HoaiMy:{code:"vi-VN-HoaiMyNeural",language:"vi-VN",displayName:"HoaiMy",localName:"Hoài My"},NamMinh:{code:"vi-VN-NamMinhNeural",language:"vi-VN",displayName:"NamMinh",localName:"Nam Minh"},Libby:{code:"en-GB-LibbyNeural",language:"en-GB",displayName:"Libby",localName:"Libby"},Sonia:{code:"en-GB-SoniaNeural",language:"en-GB",displayName:"Sonia",localName:"Sonia"},Thomas:{code:"en-GB-ThomasNeural",language:"en-GB",displayName:"Thomas",localName:"Thomas"},Ryan:{code:"en-GB-RyanNeural",language:"en-GB",displayName:"Ryan",localName:"Ryan"},Sreymom:{code:"km-KH-SreymomNeural",language:"km-KH",displayName:"Sreymom",localName:"ស្រីមុំ"},Piseth:{code:"km-KH-PisethNeural",language:"km-KH",displayName:"Piseth",localName:"ពិសិដ្ឋ"},Noora:{code:"fi-FI-NooraNeural",language:"fi-FI",displayName:"Noora",localName:"Noora"},Harri:{code:"fi-FI-HarriNeural",language:"fi-FI",displayName:"Harri",localName:"Harri"},Banu:{code:"az-AZ-BanuNeural",language:"az-AZ",displayName:"Banu",localName:"Banu"},Babek:{code:"az-AZ-BabekNeural",language:"az-AZ",displayName:"Babek",localName:"Babək"},Clara:{code:"en-CA-ClaraNeural",language:"en-CA",displayName:"Clara",localName:"Clara"},Liam:{code:"en-CA-LiamNeural",language:"en-CA",displayName:"Liam",localName:"Liam"},Ona:{code:"lt-LT-OnaNeural",language:"lt-LT",displayName:"Ona",localName:"Ona"},Leonas:{code:"lt-LT-LeonasNeural",language:"lt-LT",displayName:"Leonas",localName:"Leonas"},Fatima:{code:"ar-AE-FatimaNeural",language:"ar-AE",displayName:"Fatima",localName:"فاطمة"},Hamdan:{code:"ar-AE-HamdanNeural",language:"ar-AE",displayName:"Hamdan",localName:"حمدان"},Petra:{code:"sl-SI-PetraNeural",language:"sl-SI",displayName:"Petra",localName:"Petra"},Rok:{code:"sl-SI-RokNeural",language:"sl-SI",displayName:"Rok",localName:"Rok"},Ramona:{code:"es-DO-RamonaNeural",language:"es-DO",displayName:"Ramona",localName:"Ramona"},Emilio:{code:"es-DO-EmilioNeural",language:"es-DO",displayName:"Emilio",localName:"Emilio"},Rana:{code:"ar-IQ-RanaNeural",language:"ar-IQ",displayName:"Rana",localName:"رنا"},Bassel:{code:"ar-IQ-BasselNeural",language:"ar-IQ",displayName:"Bassel",localName:"باسل"},Tanishaa:{code:"bn-IN-TanishaaNeural",language:"bn-IN",displayName:"Tanishaa",localName:"তানিশা"},Bashkar:{code:"bn-IN-BashkarNeural",language:"bn-IN",displayName:"Bashkar",localName:"ভাস্কর"},Thilini:{code:"si-LK-ThiliniNeural",language:"si-LK",displayName:"Thilini",localName:"තිළිණි"},Sameera:{code:"si-LK-SameeraNeural",language:"si-LK",displayName:"Sameera",localName:"සමීර"},Ariane:{code:"fr-CH-ArianeNeural",language:"fr-CH",displayName:"Ariane",localName:"Ariane"},Fabrice:{code:"fr-CH-FabriceNeural",language:"fr-CH",displayName:"Fabrice",localName:"Fabrice"},Andrea:{code:"es-EC-AndreaNeural",language:"es-EC",displayName:"Andrea",localName:"Andrea"},Luis:{code:"es-EC-LuisNeural",language:"es-EC",displayName:"Luis",localName:"Luis"},Paloma:{code:"es-US-PalomaNeural",language:"es-US",displayName:"Paloma",localName:"Paloma"},Alonso:{code:"es-US-AlonsoNeural",language:"es-US",displayName:"Alonso",localName:"Alonso"},Sapna:{code:"kn-IN-SapnaNeural",language:"kn-IN",displayName:"Sapna",localName:"ಸಪ್ನಾ"},Gagan:{code:"kn-IN-GaganNeural",language:"kn-IN",displayName:"Gagan",localName:"ಗಗನ್"},Keomany:{code:"lo-LA-KeomanyNeural",language:"lo-LA",displayName:"Keomany",localName:"ແກ້ວມະນີ"},Chanthavong:{code:"lo-LA-ChanthavongNeural",language:"lo-LA",displayName:"Chanthavong",localName:"ຈັນທະວົງ"},Zariyah:{code:"ar-SA-ZariyahNeural",language:"ar-SA",displayName:"Zariyah",localName:"زارية"},Hamed:{code:"ar-SA-HamedNeural",language:"ar-SA",displayName:"Hamed",localName:"حامد"},Joana:{code:"ca-ES-JoanaNeural",language:"ca-ES",displayName:"Joana",localName:"Joana"},Enric:{code:"ca-ES-EnricNeural",language:"ca-ES",displayName:"Enric",localName:"Enric"},Katja:{code:"de-DE-KatjaNeural",language:"de-DE",displayName:"Katja",localName:"Katja"},Amala:{code:"de-DE-AmalaNeural",language:"de-DE",displayName:"Amala",localName:"Amala"},Conrad:{code:"de-DE-ConradNeural",language:"de-DE",displayName:"Conrad",localName:"Conrad"},Killian:{code:"de-DE-KillianNeural",language:"de-DE",displayName:"Killian",localName:"Killian"},HiuGaai:{code:"zh-HK-HiuGaaiNeural",language:"zh-HK",displayName:"HiuGaai",localName:"曉佳"},HiuMaan:{code:"zh-HK-HiuMaanNeural",language:"zh-HK",displayName:"HiuMaan",localName:"曉曼"},WanLung:{code:"zh-HK-WanLungNeural",language:"zh-HK",displayName:"WanLung",localName:"雲龍"},Francisca:{code:"pt-BR-FranciscaNeural",language:"pt-BR",displayName:"Francisca",localName:"Francisca"},Antonio:{code:"pt-BR-AntonioNeural",language:"pt-BR",displayName:"Antonio",localName:"Antonio"},Valentina:{code:"es-UY-ValentinaNeural",language:"es-UY",displayName:"Valentina",localName:"Valentina"},Mateo:{code:"es-UY-MateoNeural",language:"es-UY",displayName:"Mateo",localName:"Mateo"},Zuri:{code:"sw-KE-ZuriNeural",language:"sw-KE",displayName:"Zuri",localName:"Zuri"},Rafiki:{code:"sw-KE-RafikiNeural",language:"sw-KE",displayName:"Rafiki",localName:"Rafiki"},Laila:{code:"ar-BH-LailaNeural",language:"ar-BH",displayName:"Laila",localName:"ليلى"},Ali:{code:"ar-BH-AliNeural",language:"ar-BH",displayName:"Ali",localName:"علي"},Elvira:{code:"es-ES-ElviraNeural",language:"es-ES",displayName:"Elvira",localName:"Elvira"},Alvaro:{code:"es-ES-AlvaroNeural",language:"es-ES",displayName:"Alvaro",localName:"Alvaro"},Aigul:{code:"kk-KZ-AigulNeural",language:"kk-KZ",displayName:"Aigul",localName:"Айгүл"},Daulet:{code:"kk-KZ-DauletNeural",language:"kk-KZ",displayName:"Daulet",localName:"Дәулет"},Sana:{code:"ar-JO-SanaNeural",language:"ar-JO",displayName:"Sana",localName:"سناء"},Taim:{code:"ar-JO-TaimNeural",language:"ar-JO",displayName:"Taim",localName:"تيم"},Paola:{code:"es-VE-PaolaNeural",language:"es-VE",displayName:"Paola",localName:"Paola"},Sebastian:{code:"es-VE-SebastianNeural",language:"es-VE",displayName:"Sebastian",localName:"Sebastián"},Ubax:{code:"so-SO-UbaxNeural",language:"so-SO",displayName:"Ubax",localName:"Ubax"},Muuse:{code:"so-SO-MuuseNeural",language:"so-SO",displayName:"Muuse",localName:"Muuse"},Imani:{code:"en-TZ-ImaniNeural",language:"en-TZ",displayName:"Imani",localName:"Imani"},Elimu:{code:"en-TZ-ElimuNeural",language:"en-TZ",displayName:"Elimu",localName:"Elimu"},Tuti:{code:"su-ID-TutiNeural",language:"su-ID",displayName:"Tuti",localName:"Tuti"},Jajang:{code:"su-ID-JajangNeural",language:"su-ID",displayName:"Jajang",localName:"Jajang"},Dalia:{code:"es-MX-DaliaNeural",language:"es-MX",displayName:"Dalia",localName:"Dalia"},Jorge:{code:"es-MX-JorgeNeural",language:"es-MX",displayName:"Jorge",localName:"Jorge"},Elsa:{code:"it-IT-ElsaNeural",language:"it-IT",displayName:"Elsa",localName:"Elsa"},Isabella:{code:"it-IT-IsabellaNeural",language:"it-IT",displayName:"Isabella",localName:"Isabella"},Diego:{code:"it-IT-DiegoNeural",language:"it-IT",displayName:"Diego",localName:"Diego"},Gul:{code:"ur-IN-GulNeural",language:"ur-IN",displayName:"Gul",localName:"گل"},Salman:{code:"ur-IN-SalmanNeural",language:"ur-IN",displayName:"Salman",localName:"سلمان"},Nabanita:{code:"bn-BD-NabanitaNeural",language:"bn-BD",displayName:"Nabanita",localName:"নবনীতা"},Pradeep:{code:"bn-BD-PradeepNeural",language:"bn-BD",displayName:"Pradeep",localName:"প্রদ্বীপ"},Gadis:{code:"id-ID-GadisNeural",language:"id-ID",displayName:"Gadis",localName:"Gadis"},Ardi:{code:"id-ID-ArdiNeural",language:"id-ID",displayName:"Ardi",localName:"Ardi"},Yolanda:{code:"es-NI-YolandaNeural",language:"es-NI",displayName:"Yolanda",localName:"Yolanda"},Federico:{code:"es-NI-FedericoNeural",language:"es-NI",displayName:"Federico",localName:"Federico"},Premwadee:{code:"th-TH-PremwadeeNeural",language:"th-TH",displayName:"Premwadee",localName:"เปรมวดี"},Niwat:{code:"th-TH-NiwatNeural",language:"th-TH",displayName:"Niwat",localName:"นิวัฒน์"}},O1={"af-ZA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"am-ET":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ar-AE":{0:[],1:[]},"ar-BH":{0:[],1:[]},"ar-DZ":{0:[],1:[]},"ar-EG":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ar-IQ":{0:[],1:[]},"ar-JO":{0:[],1:[]},"ar-KW":{0:[],1:[]},"ar-LB":{0:[],1:[]},"ar-LY":{0:[],1:[]},"ar-MA":{0:[],1:[]},"ar-OM":{0:[],1:[]},"ar-QA":{0:[],1:[]},"ar-SA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ar-SY":{0:[],1:[]},"ar-TN":{0:[],1:[]},"ar-YE":{0:[],1:[]},"az-AZ":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"bg-BG":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"bn-BD":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"bn-IN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"bs-BA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ca-ES":{0:["Alba","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"cs-CZ":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"cy-GB":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"da-DK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"de-AT":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"de-CH":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"de-DE":{0:["Seraphina:DragonHDLatestNeural","Gisela","Elke","Klarissa","Louisa","Maja","Tanja","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Bernd","Kasper","Christoph","Klaus","Ralf","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"el-GR":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-AU":{0:["Annette","Carly","Elsie","Freya","Joanne","Kim","Tina","AvaMultilingual","EmmaMultilingual","JennyMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Darren","Duncan","Ken","Neil","Tim","AndrewMultilingual","BrianMultilingual","RyanMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-CA":{0:["AvaMultilingual","EmmaMultilingual","JennyMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","RyanMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-GB":{0:["Abbi","Bella","Hollie","Olivia","Mia","AvaMultilingual","EmmaMultilingual","JennyMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Alfie","Elliot","Ethan","Noah","Oliver","RyanMultilingual","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-HK":{0:["JennyMultilingual"],1:["RyanMultilingual"]},"en-IE":{0:["AvaMultilingual","EmmaMultilingual","JennyMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","RyanMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-IN":{0:["Aashi","Ananya","Kavya","AvaMultilingual","EmmaMultilingual","JennyMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","RyanMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-KE":{0:[],1:[]},"en-NG":{0:[],1:[]},"en-NZ":{0:[],1:[]},"en-PH":{0:[],1:[]},"en-SG":{0:[],1:[]},"en-TZ":{0:[],1:[]},"en-US":{0:["Aria:DragonHDLatestNeural","Ava:DragonHDLatestNeural","Emma:DragonHDLatestNeural","Emma2:DragonHDLatestNeural","Jenny:DragonHDLatestNeural","Jane","Sara","Nancy","Amber","Ashley","Cora","Elizabeth","Monica","AIGenerate2","Blue","JennyMultilingual","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Andrew:DragonHDLatestNeural","Andrew2:DragonHDLatestNeural","Davis:DragonHDLatestNeural","Steffan:DragonHDLatestNeural","Davis","Jason","Tony","Brandon","Jacob","AIGenerate1","Blue","AndrewMultilingual","BrianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual","FlorianMultilingual"]},"en-ZA":{0:[],1:[]},"es-AR":{0:[],1:[]},"es-BO":{0:[],1:[]},"es-CL":{0:[],1:[]},"es-CO":{0:[],1:[]},"es-CR":{0:[],1:[]},"es-CU":{0:[],1:[]},"es-DO":{0:[],1:[]},"es-EC":{0:[],1:[]},"es-ES":{0:["Abril","Estrella","Irene","Laia","Lia","Triana","Vera","Ximena","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Arnau","Dario","Elias","Nil","Saul","Teo","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"es-GQ":{0:[],1:[]},"es-GT":{0:[],1:[]},"es-HN":{0:[],1:[]},"es-MX":{0:["Beatriz","Candela","Carlota","Larissa","Marina","Nuria","Renata","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Cecilio","Gerardo","Liberto","Luciano","Pelayo","Yago","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"es-NI":{0:[],1:[]},"es-PA":{0:[],1:[]},"es-PE":{0:[],1:[]},"es-PR":{0:[],1:[]},"es-PY":{0:[],1:[]},"es-SV":{0:[],1:[]},"es-US":{0:[],1:[]},"es-UY":{0:[],1:[]},"es-VE":{0:[],1:[]},"et-EE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"eu-ES":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fa-IR":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fi-FI":{0:["Selma","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fil-PH":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","RyanMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fr-BE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fr-CA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Thierry","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fr-CH":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fr-FR":{0:["Jacqueline","Josephine","Brigitte","Coralie","Celeste","Yvette","AvaMultilingual","EmmaMultilingual","VivienneMultilingual","SeraphinaMultilingual","JennyMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Claude","Alain","Jerome","Maurice","Yves","AndrewMultilingual","BrianMultilingual","RemyMultilingual","FlorianMultilingual","RyanMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ga-IE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"gl-ES":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"gu-IN":{0:[],1:[]},"he-IL":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"hi-IN":{0:["Ananya-hi","Kavya-hi","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"hr-HR":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"hu-HU":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"hy-AM":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"id-ID":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"is-IS":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"it-IT":{0:["Fabiola","Fiamma","Imelda","Irma","Palmira","Pierina","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Benigno","Calimero","Cataldo","Gianni","Giuseppe","Lisandro","Rinaldo","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ja-JP":{0:["Shiori","Mayu","Aoi","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Masaru:DragonHDLatestNeural","Naoki","Daichi","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"jv-ID":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ka-GE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"kk-KZ":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"km-KH":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"kn-IN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ko-KR":{0:["JiMin","SeoHyeon","SoonBok","YuJin","SeraphinaMultilingual","AvaMultilingual","EmmaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["BongJin","GookMin","Hyunsu","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"lo-LA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"lt-LT":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"lv-LV":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"mk-MK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ml-IN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"mn-MN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"mr-IN":{0:[],1:[]},"ms-MY":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"mt-MT":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"my-MM":{0:["Nilar","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Thiha","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"nb-NO":{0:["Iselin","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ne-NP":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"nl-BE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"nl-NL":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"pl-PL":{0:["Agnieszka","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ps-AF":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"pt-BR":{0:["Giovanna","Leila","Leticia","Yara","Manuela","Thalita","Elza","Brenda","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Julio","Humberto","Nicolau","Valerio","Fabio","Donato","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"pt-PT":{0:["Fernanda","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ro-RO":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ru-RU":{0:["Dariya","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"si-LK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sk-SK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sl-SI":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"so-SO":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sq-AL":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sr-RS":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"su-ID":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sv-SE":{0:["Hillevi","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sw-KE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sw-TZ":{0:[],1:[]},"ta-IN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ta-LK":{0:[],1:[]},"ta-MY":{0:[],1:[]},"ta-SG":{0:[],1:[]},"te-IN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"th-TH":{0:["Achara","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"tr-TR":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"uk-UA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ur-IN":{0:[],1:[]},"ur-PK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"uz-UZ":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"vi-VN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"zh-CN":{0:["Xiaochen:DragonHDLatestNeural","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual","Xiaohan","Xiaomeng","Xiaomo","Xiaoqiu","Xiaorui","Xiaoshuang","Xiaoyan","Xiaoxuan","Xiaoyou","Xiaozhen","Xiaorou","Xiaotong","XiaoMin","Xiaobei","Xiaoni"],1:["YunyiMultilingual","Yunfeng","Yunhao","Yunjie","Yunye","Yunze","Yunzhe","YunSong","Yunqi","Yundeng","Yunbiao","Yunxiang","Yunxi-SiChuan"]},"zh-HK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"zh-TW":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"zu-ZA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]}};class P1{static isEdgeVoice(e){let t=M1[ci.toLanguage][0];if(mt.isArray(t)){for(let n of t)if(Au[n].code===e)return!0}let r=M1[ci.toLanguage][1];if(mt.isArray(r)){for(let n of r)if(Au[n].code===e)return!0}return!1}static isAzureVoice(e){let t=O1[ci.toLanguage][0];if(mt.isArray(t)){for(let n of t)if(Au[n].code===e)return!0}let r=O1[ci.toLanguage][1];if(mt.isArray(r)){for(let n of r)if(Au[n].code===e)return!0}return!1}}const Wt=class Wt{static get fromLanguage(){return this._fromLanguage}static set fromLanguage(e){this._fromLanguage=e}static get toLanguage(){return this._toLanguage}static set toLanguage(e){this._toLanguage=e}static get gender(){return this._gender}static set gender(e){this._gender=e}static get voice(){return this._voice}static set voice(e){this._voice=e}static get originalVolume(){return this._originalVolume}static set originalVolume(e){this._originalVolume=e}static get translationVolume(){return this._translationVolume}static set translationVolume(e){this._translationVolume=e}static get adjustmentModel(){return this._adjustmentModel}static set adjustmentModel(e){this._adjustmentModel=e}static get loadingContainerDiv(){return this._loadingContainerDiv}static set loadingContainerDiv(e){this._loadingContainerDiv=e}static get translateEngine(){return this._translateEngine}static set translateEngine(e){this._translateEngine=e}static set voicesType(e){this._voicesType=e}static get voicesType(){return this._voicesType}static set videoVolumeControlModel(e){this._videoVolumeControlModel=e}static get videoVolumeControlModel(){return this._videoVolumeControlModel}static set iosOpenOriginVolume(e){this._iosOpenOriginVolume=e}static get iosOpenOriginVolume(){return this._iosOpenOriginVolume}static set showSubtitle(e){this._showSubtitle=e}static get showSubtitle(){return this._showSubtitle}static set floatingBall(e){this._floatingBall=e}static get floatingBall(){return this._floatingBall}static set multiSpeaker(e){this._multiSpeaker=e}static get multiSpeaker(){return this._multiSpeaker}static hasMultipleSpeakers(){return this._multiSpeaker&&this._multiSpeaker.length>1}static set subtitleSize(e){this._subtitleSize=e}static get subtitleSize(){return this._subtitleSize}static isVoiceTypeMatchMultiVoice(){let e=Wt.multiSpeaker[0];return Wt.isUseFreeVoiceType()?P1.isEdgeVoice(e):P1.isAzureVoice(e)}static isUseFreeVoiceType(){return!Wt.voicesType||Wt.voicesType==="free"}static matchFromLanguage(e){let t=this._fromLanguage.toLowerCase(),r=e.toLowerCase();return t==="zh-cn"?r==="zh-hans"||r==="zh-cn"?!0:t.startsWith(e):t==="zh-hk"||t==="zh-tw"?r==="zh-hant"||r==="zh-hk"||r==="zh-tw"?!0:t.startsWith(e):r===t?!0:r.length>t.length?r.startsWith(t):t.startsWith(r)}};fe(Wt,"_fromLanguage","en-US"),fe(Wt,"_toLanguage","zh_CN"),fe(Wt,"_gender","1"),fe(Wt,"_voice",""),fe(Wt,"_originalVolume",0),fe(Wt,"_translationVolume",1),fe(Wt,"_videoVolumeControlModel",!1),fe(Wt,"_adjustmentModel",!0),fe(Wt,"_loadingContainerDiv"),fe(Wt,"_translateEngine","google"),fe(Wt,"_voicesType","free"),fe(Wt,"_iosOpenOriginVolume",!1),fe(Wt,"_showSubtitle",!1),fe(Wt,"_floatingBall",!0),fe(Wt,"_multiSpeaker",[]),fe(Wt,"_subtitleSize",20);let ci=Wt;class xu{getBestSubtitle(e,t){const r=this.getSubtitles(e,t),n=this.selectBestSubtitle(r);return this.postProcessSubtitle(n,t)}selectBestSubtitle(e){if(!(!e||mt.isEmpty(e))){if(e.length===1)return e[0];{let t=mt.groupBy(e,n=>n.isAsr);const r=t.false;return mt.isEmpty(r)?this.selectBestSubtitleByLanguage(t.true):this.selectBestSubtitleByLanguage(r)}}}selectBestSubtitleByLanguage(e){if(e.length===1)return e[0];try{return Ii.of(e).filter(t=>ci.matchFromLanguage(t.language)).toFirst()}catch{return e[0]}}postProcessSubtitle(e,t){return e}}class bn{static completeUrl(e){return e.startsWith("//")?window.location.protocol+e:e.startsWith("/")?window.location.origin+e:e}static resolveUrl(e,t){try{return new URL(e).href}catch{try{return new URL(e,t).href}catch{return e}}}static extractVideoId(e,t){const r=Lf.match(t),n=new URL(e).pathname,s=r(n);if(s)return s.params.videoId}static endsWith(e,t){try{return new URL(e).pathname.endsWith(t)}catch{return!1}}static removeQueryParams(e){try{const t=new URL(e);return t.search="",t.toString()}catch{return e}}}class k1 extends xu{getSubtitles(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract subtitles using JSONPath"),Error("Context vo object is missing, unable to extract subtitles using JSONPath");if(!e.subtitleListJsonPath)throw console.error("Subtitle extraction configuration is missing subtitleListJsonPath property",e),new Error("Subtitle extraction configuration is missing subtitleListJsonPath property");const r=wi(t.data,e.subtitleListJsonPath);return mt.isEmpty(r)?[]:Ii.of(r).map(n=>this.buildSubtitleMetaData(n,e)).toArray()}buildSubtitleMetaData(e,t){const r=this.isAsr(e,t);return{url:bn.completeUrl(e[t.subtitleUrlName]),language:e[t.subtitleLanguageName],isAsr:r,hasPunctuation:!r}}isAsr(e,t){return!t.subtitleAsrName||!t.subtitleAsrValue?!1:String(e[t.subtitleAsrName])===t.subtitleAsrValue}}class _w{getVideoLanguage(e,t){const r=e.subtitleExtract,n=new k1().getSubtitles(r,t);if(!mt.isEmpty(n)){for(const s of n)if(s.isAsr)return s.language}}}class Mw{getTitle(e,t){if(t.data===void 0)throw console.error("Context does not contain vo object, unable to extract video title"),new Error("Context vo is undefined, cannot extract title");if(!e.values||mt.isEmpty(e.values))throw console.error("Title extraction configuration is missing jsonPath expressions",e),new Error("ExtractTitleConfig values are empty or undefined");return Ii.of(e.values).map(n=>wi(t.data,n)).flatten().toArray()[0]}}class Ow{getTitle(e,t){if(!e.values||mt.isEmpty(e.values))throw console.error("Title extraction rule missing values property",e),new Error("Title extraction rule missing values property");const r=t.computeUrlMatchResultIfAbsent(()=>Lf.match(e.values[0],{decode:decodeURIComponent})(window.location.href));if(!r)throw console.error("Title extraction rule configuration error for current URL",e),new Error("Title extraction rule configuration error for current URL");return r.params[e.values[1]]}}const Tn=document,Su=window,F1=Tn.documentElement,qs=Tn.createElement.bind(Tn),B1=qs("div"),_f=qs("table"),Pw=qs("tbody"),U1=qs("tr"),{isArray:bu,prototype:$1}=Array,{concat:kw,filter:Mf,indexOf:G1,map:q1,push:Fw,slice:H1,some:Of,splice:Bw}=$1,Uw=/^#(?:[\w-]|\\.|[^\x00-\xa0])*$/,$w=/^\.(?:[\w-]|\\.|[^\x00-\xa0])*$/,Gw=/<.+>/,qw=/^\w+$/;function Pf(i,e){const t=Hw(e);return!i||!t&&!Hs(e)&&!or(e)?[]:!t&&$w.test(i)?e.getElementsByClassName(i.slice(1).replace(/\\/g,"")):!t&&qw.test(i)?e.getElementsByTagName(i):e.querySelectorAll(i)}class Tu{constructor(e,t){if(!e)return;if(kf(e))return e;let r=e;if(Mr(e)){const n=t||Tn;if(r=Uw.test(e)&&Hs(n)?n.getElementById(e.slice(1).replace(/\\/g,"")):Gw.test(e)?z1(e):kf(n)?n.find(e):Mr(n)?Ue(n).find(e):Pf(e,n),!r)return}else if(Vs(e))return this.ready(e);(r.nodeType||r===Su)&&(r=[r]),this.length=r.length;for(let n=0,s=this.length;n<s;n++)this[n]=r[n]}init(e,t){return new Tu(e,t)}}const be=Tu.prototype,Ue=be.init;Ue.fn=Ue.prototype=be,be.length=0,be.splice=Bw,typeof Symbol=="function"&&(be[Symbol.iterator]=$1[Symbol.iterator]);function kf(i){return i instanceof Tu}function $a(i){return!!i&&i===i.window}function Hs(i){return!!i&&i.nodeType===9}function Hw(i){return!!i&&i.nodeType===11}function or(i){return!!i&&i.nodeType===1}function Vw(i){return!!i&&i.nodeType===3}function Kw(i){return typeof i=="boolean"}function Vs(i){return typeof i=="function"}function Mr(i){return typeof i=="string"}function Jr(i){return i===void 0}function Xo(i){return i===null}function V1(i){return!isNaN(parseFloat(i))&&isFinite(i)}function Ff(i){if(typeof i!="object"||i===null)return!1;const e=Object.getPrototypeOf(i);return e===null||e===Object.prototype}Ue.isWindow=$a,Ue.isFunction=Vs,Ue.isArray=bu,Ue.isNumeric=V1,Ue.isPlainObject=Ff;function pr(i,e,t){if(t){let r=i.length;for(;r--;)if(e.call(i[r],r,i[r])===!1)return i}else if(Ff(i)){const r=Object.keys(i);for(let n=0,s=r.length;n<s;n++){const a=r[n];if(e.call(i[a],a,i[a])===!1)return i}}else for(let r=0,n=i.length;r<n;r++)if(e.call(i[r],r,i[r])===!1)return i;return i}Ue.each=pr,be.each=function(i){return pr(this,i)},be.empty=function(){return this.each((i,e)=>{for(;e.firstChild;)e.removeChild(e.firstChild)})};function Du(...i){const e=Kw(i[0])?i.shift():!1,t=i.shift(),r=i.length;if(!t)return{};if(!r)return Du(e,Ue,t);for(let n=0;n<r;n++){const s=i[n];for(const a in s)e&&(bu(s[a])||Ff(s[a]))?((!t[a]||t[a].constructor!==s[a].constructor)&&(t[a]=new s[a].constructor),Du(e,t[a],s[a])):t[a]=s[a]}return t}Ue.extend=Du,be.extend=function(i){return Du(be,i)};const Ww=/\S+/g;function Ru(i){return Mr(i)?i.match(Ww)||[]:[]}be.toggleClass=function(i,e){const t=Ru(i),r=!Jr(e);return this.each((n,s)=>{or(s)&&pr(t,(a,o)=>{r?e?s.classList.add(o):s.classList.remove(o):s.classList.toggle(o)})})},be.addClass=function(i){return this.toggleClass(i,!0)},be.removeAttr=function(i){const e=Ru(i);return this.each((t,r)=>{or(r)&&pr(e,(n,s)=>{r.removeAttribute(s)})})};function Yw(i,e){if(i){if(Mr(i)){if(arguments.length<2){if(!this[0]||!or(this[0]))return;const t=this[0].getAttribute(i);return Xo(t)?void 0:t}return Jr(e)?this:Xo(e)?this.removeAttr(i):this.each((t,r)=>{or(r)&&r.setAttribute(i,e)})}for(const t in i)this.attr(t,i[t]);return this}}be.attr=Yw,be.removeClass=function(i){return arguments.length?this.toggleClass(i,!1):this.attr("class","")},be.hasClass=function(i){return!!i&&Of.call(this,e=>or(e)&&e.classList.contains(i))},be.get=function(i){return Jr(i)?H1.call(this):(i=Number(i),this[i<0?i+this.length:i])},be.eq=function(i){return Ue(this.get(i))},be.first=function(){return this.eq(0)},be.last=function(){return this.eq(-1)};function Xw(i){return Jr(i)?this.get().map(e=>or(e)||Vw(e)?e.textContent:"").join(""):this.each((e,t)=>{or(t)&&(t.textContent=i)})}be.text=Xw;function Dn(i,e,t){if(!or(i))return;const r=Su.getComputedStyle(i,null);return t?r.getPropertyValue(e)||void 0:r[e]||i.style[e]}function ji(i,e){return parseInt(Dn(i,e),10)||0}function K1(i,e){return ji(i,`border${e?"Left":"Top"}Width`)+ji(i,`padding${e?"Left":"Top"}`)+ji(i,`padding${e?"Right":"Bottom"}`)+ji(i,`border${e?"Right":"Bottom"}Width`)}const Bf={};function zw(i){if(Bf[i])return Bf[i];const e=qs(i);Tn.body.insertBefore(e,null);const t=Dn(e,"display");return Tn.body.removeChild(e),Bf[i]=t!=="none"?t:"block"}function W1(i){return Dn(i,"display")==="none"}function Y1(i,e){const t=i&&(i.matches||i.webkitMatchesSelector||i.msMatchesSelector);return!!t&&!!e&&t.call(i,e)}function Iu(i){return Mr(i)?(e,t)=>Y1(t,i):Vs(i)?i:kf(i)?(e,t)=>i.is(t):i?(e,t)=>t===i:()=>!1}be.filter=function(i){const e=Iu(i);return Ue(Mf.call(this,(t,r)=>e.call(t,r,t)))};function ns(i,e){return e?i.filter(e):i}be.detach=function(i){return ns(this,i).each((e,t)=>{t.parentNode&&t.parentNode.removeChild(t)}),this};const jw=/^\s*<(\w+)[^>]*>/,Jw=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,X1={"*":B1,tr:Pw,td:U1,th:U1,thead:_f,tbody:_f,tfoot:_f};function z1(i){if(!Mr(i))return[];if(Jw.test(i))return[qs(RegExp.$1)];const e=jw.test(i)&&RegExp.$1,t=X1[e]||X1["*"];return t.innerHTML=i,Ue(t.childNodes).detach().get()}Ue.parseHTML=z1,be.has=function(i){const e=Mr(i)?(t,r)=>Pf(i,r).length:(t,r)=>r.contains(i);return this.filter(e)},be.not=function(i){const e=Iu(i);return this.filter((t,r)=>(!Mr(i)||or(r))&&!e.call(r,t,r))};function Rn(i,e,t,r){const n=[],s=Vs(e),a=r&&Iu(r);for(let o=0,u=i.length;o<u;o++)if(s){const l=e(i[o]);l.length&&Fw.apply(n,l)}else{let l=i[o][e];for(;l!=null&&!(r&&a(-1,l));)n.push(l),l=t?l[e]:null}return n}function j1(i){return i.multiple&&i.options?Rn(Mf.call(i.options,e=>e.selected&&!e.disabled&&!e.parentNode.disabled),"value"):i.value||""}function Qw(i){return arguments.length?this.each((e,t)=>{const r=t.multiple&&t.options;if(r||oE.test(t.type)){const n=bu(i)?q1.call(i,String):Xo(i)?[]:[String(i)];r?pr(t.options,(s,a)=>{a.selected=n.indexOf(a.value)>=0},!0):t.checked=n.indexOf(t.value)>=0}else t.value=Jr(i)||Xo(i)?"":i}):this[0]&&j1(this[0])}be.val=Qw,be.is=function(i){const e=Iu(i);return Of.call(this,(t,r)=>e.call(t,r,t))},Ue.guid=1;function Ji(i){return i.length>1?Mf.call(i,(e,t,r)=>G1.call(r,e)===t):i}Ue.unique=Ji,be.add=function(i,e){return Ue(Ji(this.get().concat(Ue(i,e).get())))},be.children=function(i){return ns(Ue(Ji(Rn(this,e=>e.children))),i)},be.parent=function(i){return ns(Ue(Ji(Rn(this,"parentNode"))),i)},be.index=function(i){const e=i?Ue(i)[0]:this[0],t=i?this:Ue(e).parent().children();return G1.call(t,e)},be.closest=function(i){const e=this.filter(i);if(e.length)return e;const t=this.parent();return t.length?t.closest(i):e},be.siblings=function(i){return ns(Ue(Ji(Rn(this,e=>Ue(e).parent().children().not(e)))),i)},be.find=function(i){return Ue(Ji(Rn(this,e=>Pf(i,e))))};const Zw=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,eC=/^$|^module$|\/(java|ecma)script/i,tC=["type","src","nonce","noModule"];function rC(i,e){const t=Ue(i);t.filter("script").add(t.find("script")).each((r,n)=>{if(eC.test(n.type)&&F1.contains(n)){const s=qs("script");s.text=n.textContent.replace(Zw,""),pr(tC,(a,o)=>{n[o]&&(s[o]=n[o])}),e.head.insertBefore(s,null),e.head.removeChild(s)}})}function iC(i,e,t,r,n){r?i.insertBefore(e,t?i.firstChild:null):i.nodeName==="HTML"?i.parentNode.replaceChild(e,i):i.parentNode.insertBefore(e,t?i:i.nextSibling),n&&rC(e,i.ownerDocument)}function ss(i,e,t,r,n,s,a,o){return pr(i,(u,l)=>{pr(Ue(l),(h,d)=>{pr(Ue(e),(p,g)=>{const m=t?d:g,v=t?g:d,E=t?h:p;iC(m,E?v.cloneNode(!0):v,r,n,!E)},o)},a)},s),e}be.after=function(){return ss(arguments,this,!1,!1,!1,!0,!0)},be.append=function(){return ss(arguments,this,!1,!1,!0)};function nC(i){if(!arguments.length)return this[0]&&this[0].innerHTML;if(Jr(i))return this;const e=/<script[\s>]/.test(i);return this.each((t,r)=>{or(r)&&(e?Ue(r).empty().append(i):r.innerHTML=i)})}be.html=nC,be.appendTo=function(i){return ss(arguments,this,!0,!1,!0)},be.wrapInner=function(i){return this.each((e,t)=>{const r=Ue(t),n=r.contents();n.length?n.wrapAll(i):r.append(i)})},be.before=function(){return ss(arguments,this,!1,!0)},be.wrapAll=function(i){let e=Ue(i),t=e[0];for(;t.children.length;)t=t.firstElementChild;return this.first().before(e),this.appendTo(t)},be.wrap=function(i){return this.each((e,t)=>{const r=Ue(i)[0];Ue(t).wrapAll(e?r.cloneNode(!0):r)})},be.insertAfter=function(i){return ss(arguments,this,!0,!1,!1,!1,!1,!0)},be.insertBefore=function(i){return ss(arguments,this,!0,!0)},be.prepend=function(){return ss(arguments,this,!1,!0,!0,!0,!0)},be.prependTo=function(i){return ss(arguments,this,!0,!0,!0,!1,!1,!0)},be.contents=function(){return Ue(Ji(Rn(this,i=>i.tagName==="IFRAME"?[i.contentDocument]:i.tagName==="TEMPLATE"?i.content.childNodes:i.childNodes)))},be.next=function(i,e,t){return ns(Ue(Ji(Rn(this,"nextElementSibling",e,t))),i)},be.nextAll=function(i){return this.next(i,!0)},be.nextUntil=function(i,e){return this.next(e,!0,i)},be.parents=function(i,e){return ns(Ue(Ji(Rn(this,"parentElement",!0,e))),i)},be.parentsUntil=function(i,e){return this.parents(e,i)},be.prev=function(i,e,t){return ns(Ue(Ji(Rn(this,"previousElementSibling",e,t))),i)},be.prevAll=function(i){return this.prev(i,!0)},be.prevUntil=function(i,e){return this.prev(e,!0,i)},be.map=function(i){return Ue(kw.apply([],q1.call(this,(e,t)=>i.call(e,t,e))))},be.clone=function(){return this.map((i,e)=>e.cloneNode(!0))},be.offsetParent=function(){return this.map((i,e)=>{let t=e.offsetParent;for(;t&&Dn(t,"position")==="static";)t=t.offsetParent;return t||F1})},be.slice=function(i,e){return Ue(H1.call(this,i,e))};const sC=/-([a-z])/g;function Uf(i){return i.replace(sC,(e,t)=>t.toUpperCase())}be.ready=function(i){const e=()=>setTimeout(i,0,Ue);return Tn.readyState!=="loading"?e():Tn.addEventListener("DOMContentLoaded",e),this},be.unwrap=function(){return this.parent().each((i,e)=>{if(e.tagName==="BODY")return;const t=Ue(e);t.replaceWith(t.children())}),this},be.offset=function(){const i=this[0];if(!i)return;const e=i.getBoundingClientRect();return{top:e.top+Su.pageYOffset,left:e.left+Su.pageXOffset}},be.position=function(){const i=this[0];if(!i)return;const e=Dn(i,"position")==="fixed",t=e?i.getBoundingClientRect():this.offset();if(!e){const r=i.ownerDocument;let n=i.offsetParent||r.documentElement;for(;(n===r.body||n===r.documentElement)&&Dn(n,"position")==="static";)n=n.parentNode;if(n!==i&&or(n)){const s=Ue(n).offset();t.top-=s.top+ji(n,"borderTopWidth"),t.left-=s.left+ji(n,"borderLeftWidth")}}return{top:t.top-ji(i,"marginTop"),left:t.left-ji(i,"marginLeft")}};const J1={class:"className",contenteditable:"contentEditable",for:"htmlFor",readonly:"readOnly",maxlength:"maxLength",tabindex:"tabIndex",colspan:"colSpan",rowspan:"rowSpan",usemap:"useMap"};be.prop=function(i,e){if(i){if(Mr(i))return i=J1[i]||i,arguments.length<2?this[0]&&this[0][i]:this.each((t,r)=>{r[i]=e});for(const t in i)this.prop(t,i[t]);return this}},be.removeProp=function(i){return this.each((e,t)=>{delete t[J1[i]||i]})};const aC=/^--/;function $f(i){return aC.test(i)}const Gf={},{style:oC}=B1,lC=["webkit","moz","ms"];function uC(i,e=$f(i)){if(e)return i;if(!Gf[i]){const t=Uf(i),r=`${t[0].toUpperCase()}${t.slice(1)}`,n=`${t} ${lC.join(`${r} `)}${r}`.split(" ");pr(n,(s,a)=>{if(a in oC)return Gf[i]=a,!1})}return Gf[i]}const cC={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function Q1(i,e,t=$f(i)){return!t&&!cC[i]&&V1(e)?`${e}px`:e}function hC(i,e){if(Mr(i)){const t=$f(i);return i=uC(i,t),arguments.length<2?this[0]&&Dn(this[0],i,t):i?(e=Q1(i,e,t),this.each((r,n)=>{or(n)&&(t?n.style.setProperty(i,e):n.style[i]=e)})):this}for(const t in i)this.css(t,i[t]);return this}be.css=hC;function Z1(i,e){try{return i(e)}catch{return e}}const dC=/^\s+|\s+$/;function eE(i,e){const t=i.dataset[e]||i.dataset[Uf(e)];return dC.test(t)?t:Z1(JSON.parse,t)}function fC(i,e,t){t=Z1(JSON.stringify,t),i.dataset[Uf(e)]=t}function gC(i,e){if(!i){if(!this[0])return;const t={};for(const r in this[0].dataset)t[r]=eE(this[0],r);return t}if(Mr(i))return arguments.length<2?this[0]&&eE(this[0],i):Jr(e)?this:this.each((t,r)=>{fC(r,i,e)});for(const t in i)this.data(t,i[t]);return this}be.data=gC;function tE(i,e){const t=i.documentElement;return Math.max(i.body[`scroll${e}`],t[`scroll${e}`],i.body[`offset${e}`],t[`offset${e}`],t[`client${e}`])}pr([!0,!1],(i,e)=>{pr(["Width","Height"],(t,r)=>{const n=`${e?"outer":"inner"}${r}`;be[n]=function(s){if(this[0])return $a(this[0])?e?this[0][`inner${r}`]:this[0].document.documentElement[`client${r}`]:Hs(this[0])?tE(this[0],r):this[0][`${e?"offset":"client"}${r}`]+(s&&e?ji(this[0],`margin${t?"Top":"Left"}`)+ji(this[0],`margin${t?"Bottom":"Right"}`):0)}})}),pr(["Width","Height"],(i,e)=>{const t=e.toLowerCase();be[t]=function(r){if(!this[0])return Jr(r)?void 0:this;if(!arguments.length)return $a(this[0])?this[0].document.documentElement[`client${e}`]:Hs(this[0])?tE(this[0],e):this[0].getBoundingClientRect()[t]-K1(this[0],!i);const n=parseInt(r,10);return this.each((s,a)=>{if(!or(a))return;const o=Dn(a,"boxSizing");a.style[t]=Q1(t,n+(o==="border-box"?K1(a,!i):0))})}});const rE="___cd";be.toggle=function(i){return this.each((e,t)=>{if(!or(t))return;const r=W1(t);(Jr(i)?r:i)?(t.style.display=t[rE]||"",W1(t)&&(t.style.display=zw(t.tagName))):r||(t[rE]=Dn(t,"display"),t.style.display="none")})},be.hide=function(){return this.toggle(!1)},be.show=function(){return this.toggle(!0)};const iE="___ce",qf=".",Hf={focus:"focusin",blur:"focusout"},nE={mouseenter:"mouseover",mouseleave:"mouseout"},pC=/^(mouse|pointer|contextmenu|drag|drop|click|dblclick)/i;function Vf(i){return nE[i]||Hf[i]||i}function Kf(i){const e=i.split(qf);return[e[0],e.slice(1).sort()]}be.trigger=function(i,e){if(Mr(i)){const[r,n]=Kf(i),s=Vf(r);if(!s)return this;const a=pC.test(s)?"MouseEvents":"HTMLEvents";i=Tn.createEvent(a),i.initEvent(s,!0,!0),i.namespace=n.join(qf),i.___ot=r}i.___td=e;const t=i.___ot in Hf;return this.each((r,n)=>{t&&Vs(n[i.___ot])&&(n[`___i${i.type}`]=!0,n[i.___ot](),n[`___i${i.type}`]=!1),n.dispatchEvent(i)})};function sE(i){return i[iE]=i[iE]||{}}function mC(i,e,t,r,n){const s=sE(i);s[e]=s[e]||[],s[e].push([t,r,n]),i.addEventListener(e,n)}function aE(i,e){return!e||!Of.call(e,t=>i.indexOf(t)<0)}function wu(i,e,t,r,n){const s=sE(i);if(e)s[e]&&(s[e]=s[e].filter(([a,o,u])=>{if(n&&u.guid!==n.guid||!aE(a,t)||r&&r!==o)return!0;i.removeEventListener(e,u)}));else for(e in s)wu(i,e,t,r,n)}be.off=function(i,e,t){if(Jr(i))this.each((r,n)=>{!or(n)&&!Hs(n)&&!$a(n)||wu(n)});else if(Mr(i))Vs(e)&&(t=e,e=""),pr(Ru(i),(r,n)=>{const[s,a]=Kf(n),o=Vf(s);this.each((u,l)=>{!or(l)&&!Hs(l)&&!$a(l)||wu(l,o,a,e,t)})});else for(const r in i)this.off(r,i[r]);return this},be.remove=function(i){return ns(this,i).detach().off(),this},be.replaceWith=function(i){return this.before(i).remove()},be.replaceAll=function(i){return Ue(i).replaceWith(this),this};function yC(i,e,t,r,n){if(!Mr(i)){for(const s in i)this.on(s,e,t,i[s],n);return this}return Mr(e)||(Jr(e)||Xo(e)?e="":Jr(t)?(t=e,e=""):(r=t,t=e,e="")),Vs(r)||(r=t,t=void 0),r?(pr(Ru(i),(s,a)=>{const[o,u]=Kf(a),l=Vf(o),h=o in nE,d=o in Hf;l&&this.each((p,g)=>{if(!or(g)&&!Hs(g)&&!$a(g))return;const m=function(v){if(v.target[`___i${v.type}`])return v.stopImmediatePropagation();if(v.namespace&&!aE(u,v.namespace.split(qf))||!e&&(d&&(v.target!==g||v.___ot===l)||h&&v.relatedTarget&&g.contains(v.relatedTarget)))return;let E=g;if(e){let T=v.target;for(;!Y1(T,e);)if(T===g||(T=T.parentNode,!T))return;E=T}Object.defineProperty(v,"currentTarget",{configurable:!0,get(){return E}}),Object.defineProperty(v,"delegateTarget",{configurable:!0,get(){return g}}),Object.defineProperty(v,"data",{configurable:!0,get(){return t}});const x=r.call(E,v,v.___td);n&&wu(g,l,u,e,m),x===!1&&(v.preventDefault(),v.stopPropagation())};m.guid=r.guid=r.guid||Ue.guid++,mC(g,l,u,e,m)})}),this):this}be.on=yC;function vC(i,e,t,r){return this.on(i,e,t,r,!0)}be.one=vC;const EC=/\r?\n/g;function AC(i,e){return`&${encodeURIComponent(i)}=${encodeURIComponent(e.replace(EC,`\r
`))}`}const xC=/file|reset|submit|button|image/i,oE=/radio|checkbox/i;be.serialize=function(){let i="";return this.each((e,t)=>{pr(t.elements||[t],(r,n)=>{if(n.disabled||!n.name||n.tagName==="FIELDSET"||xC.test(n.type)||oE.test(n.type)&&!n.checked)return;const s=j1(n);if(!Jr(s)){const a=bu(s)?s:[s];pr(a,(o,u)=>{i+=AC(n.name,u)})}})}),i.slice(1)};class SC{getTitle(e,t){if(!e.values||mt.isEmpty(e.values))throw console.error("Title extraction configuration is missing CSS selector values",e),new Error("ExtractTitleConfig values are empty or undefined");return Ue(e.values[0]).text()}}class bC{getTitle(e,t){if(!e.values||mt.isEmpty(e.values))throw console.error("Title extraction configuration is missing CSS selector values",e),new Error("ExtractTitleConfig values are empty or undefined");if(e.values.length!==2)throw console.error("Title extraction configuration requires exactly 2 values: [cssSelector, attributeName], but got",e.values.length,"values:",e.values),new Error(`ExtractTitleConfig values array must contain exactly 2 elements (cssSelector and attributeName), but got ${e.values.length} elements`);return Ue(e.values[0]).attr(e.values[1])}}class TC extends Ua{getVideoId(e,t){if(!e.values||mt.isEmpty(e.values))throw console.error("Video ID extraction configuration is missing CSS selector values",e),new Error("ExtractVideoIdConfig values are empty or undefined");if(e.values.length!==2)throw console.error("Video ID extraction configuration requires exactly 2 values: [cssSelector, attributeName], but got",e.values.length,"values:",e.values),new Error(`ExtractVideoIdConfig values array must contain exactly 2 elements (cssSelector and attributeName), but got ${e.values.length} elements`);const r=Ue(e.values[0]).attr(e.values[1]);return this.buildVideoId(e,[r])}}var lE=class{constructor(i){if(i==="<all_urls>")this.isAllUrls=!0,this.protocolMatches=[...lE.PROTOCOLS],this.hostnameMatch="*",this.pathnameMatch="*";else{const e=/(.*):\/\/(.*?)(\/.*)/.exec(i);if(e==null)throw new Cu(i,"Incorrect format");const[t,r,n,s]=e;DC(i,r),RC(i,n),this.protocolMatches=r==="*"?["http","https"]:[r],this.hostnameMatch=n,this.pathnameMatch=s}}includes(i){if(this.isAllUrls)return!0;const e=typeof i=="string"?new URL(i):i instanceof Location?new URL(i.href):i;return!!this.protocolMatches.find(t=>{if(t==="http")return this.isHttpMatch(e);if(t==="https")return this.isHttpsMatch(e);if(t==="file")return this.isFileMatch(e);if(t==="ftp")return this.isFtpMatch(e);if(t==="urn")return this.isUrnMatch(e)})}isHttpMatch(i){return i.protocol==="http:"&&this.isHostPathMatch(i)}isHttpsMatch(i){return i.protocol==="https:"&&this.isHostPathMatch(i)}isHostPathMatch(i){if(!this.hostnameMatch||!this.pathnameMatch)return!1;const e=[this.convertPatternToRegex(this.hostnameMatch),this.convertPatternToRegex(this.hostnameMatch.replace(/^\*\./,""))],t=this.convertPatternToRegex(this.pathnameMatch);return!!e.find(r=>r.test(i.hostname))&&t.test(i.pathname)}isFileMatch(i){throw Error("Not implemented: file:// pattern matching. Open a PR to add support")}isFtpMatch(i){throw Error("Not implemented: ftp:// pattern matching. Open a PR to add support")}isUrnMatch(i){throw Error("Not implemented: urn:// pattern matching. Open a PR to add support")}convertPatternToRegex(i){const t=this.escapeForRegex(i).replace(/\\\*/g,".*");return RegExp(`^${t}$`)}escapeForRegex(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}},as=lE;as.PROTOCOLS=["http","https","file","ftp","urn"];var Cu=class extends Error{constructor(i,e){super(`Invalid match pattern "${i}": ${e}`)}};function DC(i,e){if(!as.PROTOCOLS.includes(e)&&e!=="*")throw new Cu(i,`${e} not a valid protocol (${as.PROTOCOLS.join(", ")})`)}function RC(i,e){if(e.includes(":"))throw new Cu(i,"Hostname cannot include a port");if(e.includes("*")&&e.length>1&&!e.startsWith("*."))throw new Cu(i,"If using a wildcard (*), it must go at the start of the hostname")}class IC{constructor(){this.keyToValue=new Map,this.valueToKey=new Map}set(e,t){this.keyToValue.set(e,t),this.valueToKey.set(t,e)}getByKey(e){return this.keyToValue.get(e)}getByValue(e){return this.valueToKey.get(e)}clear(){this.keyToValue.clear(),this.valueToKey.clear()}}class uE{constructor(e){this.generateIdentifier=e,this.kv=new IC}register(e,t){this.kv.getByValue(e)||(t||(t=this.generateIdentifier(e)),this.kv.set(t,e))}clear(){this.kv.clear()}getIdentifier(e){return this.kv.getByValue(e)}getValue(e){return this.kv.getByKey(e)}}class wC extends uE{constructor(){super(e=>e.name),this.classToAllowedProps=new Map}register(e,t){typeof t=="object"?(t.allowProps&&this.classToAllowedProps.set(e,t.allowProps),super.register(e,t.identifier)):super.register(e,t)}getAllowedProps(e){return this.classToAllowedProps.get(e)}}function CC(i){if("values"in Object)return Object.values(i);const e=[];for(const t in i)i.hasOwnProperty(t)&&e.push(i[t]);return e}function NC(i,e){const t=CC(i);if("find"in t)return t.find(e);const r=t;for(let n=0;n<r.length;n++){const s=r[n];if(e(s))return s}}function Ga(i,e){Object.entries(i).forEach(([t,r])=>e(r,t))}function Nu(i,e){return i.indexOf(e)!==-1}function cE(i,e){for(let t=0;t<i.length;t++){const r=i[t];if(e(r))return r}}class LC{constructor(){this.transfomers={}}register(e){this.transfomers[e.name]=e}findApplicable(e){return NC(this.transfomers,t=>t.isApplicable(e))}findByName(e){return this.transfomers[e]}}const _C=i=>Object.prototype.toString.call(i).slice(8,-1),hE=i=>typeof i>"u",MC=i=>i===null,zo=i=>typeof i!="object"||i===null||i===Object.prototype?!1:Object.getPrototypeOf(i)===null?!0:Object.getPrototypeOf(i)===Object.prototype,Wf=i=>zo(i)&&Object.keys(i).length===0,os=i=>Array.isArray(i),OC=i=>typeof i=="string",PC=i=>typeof i=="number"&&!isNaN(i),kC=i=>typeof i=="boolean",FC=i=>i instanceof RegExp,jo=i=>i instanceof Map,Jo=i=>i instanceof Set,dE=i=>_C(i)==="Symbol",BC=i=>i instanceof Date&&!isNaN(i.valueOf()),UC=i=>i instanceof Error,fE=i=>typeof i=="number"&&isNaN(i),$C=i=>kC(i)||MC(i)||hE(i)||PC(i)||OC(i)||dE(i),GC=i=>typeof i=="bigint",qC=i=>i===1/0||i===-1/0,HC=i=>ArrayBuffer.isView(i)&&!(i instanceof DataView),VC=i=>i instanceof URL,gE=i=>i.replace(/\./g,"\\."),Yf=i=>i.map(String).map(gE).join("."),Qo=i=>{const e=[];let t="";for(let n=0;n<i.length;n++){let s=i.charAt(n);if(s==="\\"&&i.charAt(n+1)==="."){t+=".",n++;continue}if(s==="."){e.push(t),t="";continue}t+=s}const r=t;return e.push(r),e};function Qi(i,e,t,r){return{isApplicable:i,annotation:e,transform:t,untransform:r}}const pE=[Qi(hE,"undefined",()=>null,()=>{}),Qi(GC,"bigint",i=>i.toString(),i=>typeof BigInt<"u"?BigInt(i):(console.error("Please add a BigInt polyfill."),i)),Qi(BC,"Date",i=>i.toISOString(),i=>new Date(i)),Qi(UC,"Error",(i,e)=>{const t={name:i.name,message:i.message};return e.allowedErrorProps.forEach(r=>{t[r]=i[r]}),t},(i,e)=>{const t=new Error(i.message);return t.name=i.name,t.stack=i.stack,e.allowedErrorProps.forEach(r=>{t[r]=i[r]}),t}),Qi(FC,"regexp",i=>""+i,i=>{const e=i.slice(1,i.lastIndexOf("/")),t=i.slice(i.lastIndexOf("/")+1);return new RegExp(e,t)}),Qi(Jo,"set",i=>[...i.values()],i=>new Set(i)),Qi(jo,"map",i=>[...i.entries()],i=>new Map(i)),Qi(i=>fE(i)||qC(i),"number",i=>fE(i)?"NaN":i>0?"Infinity":"-Infinity",Number),Qi(i=>i===0&&1/i===-1/0,"number",()=>"-0",Number),Qi(VC,"URL",i=>i.toString(),i=>new URL(i))];function Lu(i,e,t,r){return{isApplicable:i,annotation:e,transform:t,untransform:r}}const mE=Lu((i,e)=>dE(i)?!!e.symbolRegistry.getIdentifier(i):!1,(i,e)=>["symbol",e.symbolRegistry.getIdentifier(i)],i=>i.description,(i,e,t)=>{const r=t.symbolRegistry.getValue(e[1]);if(!r)throw new Error("Trying to deserialize unknown symbol");return r}),KC=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray].reduce((i,e)=>(i[e.name]=e,i),{}),yE=Lu(HC,i=>["typed-array",i.constructor.name],i=>[...i],(i,e)=>{const t=KC[e[1]];if(!t)throw new Error("Trying to deserialize unknown typed array");return new t(i)});function vE(i,e){return i!=null&&i.constructor?!!e.classRegistry.getIdentifier(i.constructor):!1}const EE=Lu(vE,(i,e)=>["class",e.classRegistry.getIdentifier(i.constructor)],(i,e)=>{const t=e.classRegistry.getAllowedProps(i.constructor);if(!t)return{...i};const r={};return t.forEach(n=>{r[n]=i[n]}),r},(i,e,t)=>{const r=t.classRegistry.getValue(e[1]);if(!r)throw new Error(`Trying to deserialize unknown class '${e[1]}' - check https://github.com/blitz-js/superjson/issues/116#issuecomment-773996564`);return Object.assign(Object.create(r.prototype),i)}),AE=Lu((i,e)=>!!e.customTransformerRegistry.findApplicable(i),(i,e)=>["custom",e.customTransformerRegistry.findApplicable(i).name],(i,e)=>e.customTransformerRegistry.findApplicable(i).serialize(i),(i,e,t)=>{const r=t.customTransformerRegistry.findByName(e[1]);if(!r)throw new Error("Trying to deserialize unknown custom value");return r.deserialize(i)}),WC=[EE,mE,AE,yE],xE=(i,e)=>{const t=cE(WC,n=>n.isApplicable(i,e));if(t)return{value:t.transform(i,e),type:t.annotation(i,e)};const r=cE(pE,n=>n.isApplicable(i,e));if(r)return{value:r.transform(i,e),type:r.annotation}},SE={};pE.forEach(i=>{SE[i.annotation]=i});const YC=(i,e,t)=>{if(os(e))switch(e[0]){case"symbol":return mE.untransform(i,e,t);case"class":return EE.untransform(i,e,t);case"custom":return AE.untransform(i,e,t);case"typed-array":return yE.untransform(i,e,t);default:throw new Error("Unknown transformation: "+e)}else{const r=SE[e];if(!r)throw new Error("Unknown transformation: "+e);return r.untransform(i,t)}},qa=(i,e)=>{if(e>i.size)throw new Error("index out of bounds");const t=i.keys();for(;e>0;)t.next(),e--;return t.next().value};function bE(i){if(Nu(i,"__proto__"))throw new Error("__proto__ is not allowed as a property");if(Nu(i,"prototype"))throw new Error("prototype is not allowed as a property");if(Nu(i,"constructor"))throw new Error("constructor is not allowed as a property")}const XC=(i,e)=>{bE(e);for(let t=0;t<e.length;t++){const r=e[t];if(Jo(i))i=qa(i,+r);else if(jo(i)){const n=+r,s=+e[++t]==0?"key":"value",a=qa(i,n);switch(s){case"key":i=a;break;case"value":i=i.get(a);break}}else i=i[r]}return i},Xf=(i,e,t)=>{if(bE(e),e.length===0)return t(i);let r=i;for(let s=0;s<e.length-1;s++){const a=e[s];if(os(r)){const o=+a;r=r[o]}else if(zo(r))r=r[a];else if(Jo(r)){const o=+a;r=qa(r,o)}else if(jo(r)){if(s===e.length-2)break;const u=+a,l=+e[++s]==0?"key":"value",h=qa(r,u);switch(l){case"key":r=h;break;case"value":r=r.get(h);break}}}const n=e[e.length-1];if(os(r)?r[+n]=t(r[+n]):zo(r)&&(r[n]=t(r[n])),Jo(r)){const s=qa(r,+n),a=t(s);s!==a&&(r.delete(s),r.add(a))}if(jo(r)){const s=+e[e.length-2],a=qa(r,s);switch(+n==0?"key":"value"){case"key":{const u=t(a);r.set(u,r.get(a)),u!==a&&r.delete(a);break}case"value":{r.set(a,t(r.get(a)));break}}}return i};function zf(i,e,t=[]){if(!i)return;if(!os(i)){Ga(i,(s,a)=>zf(s,e,[...t,...Qo(a)]));return}const[r,n]=i;n&&Ga(n,(s,a)=>{zf(s,e,[...t,...Qo(a)])}),e(r,t)}function zC(i,e,t){return zf(e,(r,n)=>{i=Xf(i,n,s=>YC(s,r,t))}),i}function jC(i,e){function t(r,n){const s=XC(i,Qo(n));r.map(Qo).forEach(a=>{i=Xf(i,a,()=>s)})}if(os(e)){const[r,n]=e;r.forEach(s=>{i=Xf(i,Qo(s),()=>i)}),n&&Ga(n,t)}else Ga(e,t);return i}const JC=(i,e)=>zo(i)||os(i)||jo(i)||Jo(i)||vE(i,e);function QC(i,e,t){const r=t.get(i);r?r.push(e):t.set(i,[e])}function ZC(i,e){const t={};let r;return i.forEach(n=>{if(n.length<=1)return;e||(n=n.map(o=>o.map(String)).sort((o,u)=>o.length-u.length));const[s,...a]=n;s.length===0?r=a.map(Yf):t[Yf(s)]=a.map(Yf)}),r?Wf(t)?[r]:[r,t]:Wf(t)?void 0:t}const TE=(i,e,t,r,n=[],s=[],a=new Map)=>{const o=$C(i);if(!o){QC(i,n,e);const g=a.get(i);if(g)return r?{transformedValue:null}:g}if(!JC(i,t)){const g=xE(i,t),m=g?{transformedValue:g.value,annotations:[g.type]}:{transformedValue:i};return o||a.set(i,m),m}if(Nu(s,i))return{transformedValue:null};const u=xE(i,t),l=(u==null?void 0:u.value)??i,h=os(l)?[]:{},d={};Ga(l,(g,m)=>{if(m==="__proto__"||m==="constructor"||m==="prototype")throw new Error(`Detected property ${m}. This is a prototype pollution risk, please remove it from your object.`);const v=TE(g,e,t,r,[...n,m],[...s,i],a);h[m]=v.transformedValue,os(v.annotations)?d[m]=v.annotations:zo(v.annotations)&&Ga(v.annotations,(E,x)=>{d[gE(m)+"."+x]=E})});const p=Wf(d)?{transformedValue:h,annotations:u?[u.type]:void 0}:{transformedValue:h,annotations:u?[u.type,d]:d};return o||a.set(i,p),p};function DE(i){return Object.prototype.toString.call(i).slice(8,-1)}function RE(i){return DE(i)==="Array"}function eN(i){if(DE(i)!=="Object")return!1;const e=Object.getPrototypeOf(i);return!!e&&e.constructor===Object&&e===Object.prototype}function tN(i,e,t,r,n){const s={}.propertyIsEnumerable.call(r,e)?"enumerable":"nonenumerable";s==="enumerable"&&(i[e]=t),n&&s==="nonenumerable"&&Object.defineProperty(i,e,{value:t,enumerable:!1,writable:!0,configurable:!0})}function jf(i,e={}){if(RE(i))return i.map(n=>jf(n,e));if(!eN(i))return i;const t=Object.getOwnPropertyNames(i),r=Object.getOwnPropertySymbols(i);return[...t,...r].reduce((n,s)=>{if(RE(e.props)&&!e.props.includes(s))return n;const a=i[s],o=jf(a,e);return tN(n,s,o,i,e.nonenumerable),n},{})}class ct{constructor({dedupe:e=!1}={}){this.classRegistry=new wC,this.symbolRegistry=new uE(t=>t.description??""),this.customTransformerRegistry=new LC,this.allowedErrorProps=[],this.dedupe=e}serialize(e){const t=new Map,r=TE(e,t,this,this.dedupe),n={json:r.transformedValue};r.annotations&&(n.meta={...n.meta,values:r.annotations});const s=ZC(t,this.dedupe);return s&&(n.meta={...n.meta,referentialEqualities:s}),n}deserialize(e){const{json:t,meta:r}=e;let n=jf(t);return r!=null&&r.values&&(n=zC(n,r.values,this)),r!=null&&r.referentialEqualities&&(n=jC(n,r.referentialEqualities)),n}stringify(e){return JSON.stringify(this.serialize(e))}parse(e){return this.deserialize(JSON.parse(e))}registerClass(e,t){this.classRegistry.register(e,t)}registerSymbol(e,t){this.symbolRegistry.register(e,t)}registerCustom(e,t){this.customTransformerRegistry.register({name:t,...e})}allowErrorProps(...e){this.allowedErrorProps.push(...e)}}ct.defaultInstance=new ct,ct.serialize=ct.defaultInstance.serialize.bind(ct.defaultInstance),ct.deserialize=ct.defaultInstance.deserialize.bind(ct.defaultInstance),ct.stringify=ct.defaultInstance.stringify.bind(ct.defaultInstance),ct.parse=ct.defaultInstance.parse.bind(ct.defaultInstance),ct.registerClass=ct.defaultInstance.registerClass.bind(ct.defaultInstance),ct.registerSymbol=ct.defaultInstance.registerSymbol.bind(ct.defaultInstance),ct.registerCustom=ct.defaultInstance.registerCustom.bind(ct.defaultInstance),ct.allowErrorProps=ct.defaultInstance.allowErrorProps.bind(ct.defaultInstance),ct.serialize,ct.deserialize,ct.stringify,ct.parse,ct.registerClass,ct.registerCustom,ct.registerSymbol,ct.allowErrorProps;class rN extends Ua{getVideoId(e,t){if(mt.isEmpty(e.values))throw console.error("Video ID extraction rule missing values property",e),new Error("Video ID extraction rule missing values property");const r=ct.parse(e.values[0]);for(const[n,s]of r.configMap.entries())if(new as(n).includes(window.location.href))return Or.extractVideoId(s,t);throw new Error("No matching URL pattern found for current URL: "+window.location.href)}}class iN extends Ua{getVideoId(e,t){if(mt.isEmpty(e.values))throw console.error("Video ID extraction rule missing values property",e),new Error("Video ID extraction rule missing values property");const r=ct.parse(e.values[0]);return this.buildVideoId(e,r.configList.map(n=>Or.extractVideoId(n,t)))}}class Or{static extractBooleanByJsonPath(e,t,r){const n=Ii.of(e);return da(t).with("all",()=>n.allMatch(s=>wi(r,s))).with("any",()=>n.anyMatch(s=>wi(r,s))).exhaustive()}static extractVideoId(e,t){return da(e.type).with("urlQueryParam",()=>new ww().getVideoId(e,t)).with("urlPath",()=>new Nw().getVideoId(e,t)).with("jsonPath",()=>new Lw().getVideoId(e,t)).with("attr",()=>new TC().getVideoId(e,t)).with("multi-pattern",()=>new rN().getVideoId(e,t)).with("multi-type",()=>new iN().getVideoId(e,t)).with("undefined",()=>"undefined").exhaustive()}static extractTitle(e,t){return da(e.type).with("tab",()=>t.tabTitle).with("jsonPath",()=>new Mw().getTitle(e,t)).with("urlPath",()=>new Ow().getTitle(e,t)).with("selector",()=>new SC().getTitle(e,t)).with("attr",()=>new bC().getTitle(e,t)).exhaustive()}static extractVideoLanguage(e,t){return e.videoLanguageExtract?da(e.videoLanguageExtract.type).with("asr",()=>new _w().getVideoLanguage(e,t)).exhaustive()??ci.fromLanguage:ci.fromLanguage}}class IE extends xu{getSubtitles(e,t){console.log("media === ",t.media);const r=e.domKind?'track[kind="'+e.domKind+'"]':'track[kind="captions"], track[kind="subtitles"]';return Ii.of(Ue(t.media).find(r)).map(n=>this.buildSubtitleMediaData(n,e)).toArray()}buildSubtitleMediaData(e,t){const r=Ue(e);return{url:bn.completeUrl(r.prop("src")),language:r.prop(t.subtitleLanguageName).replaceAll("-x-autogen",""),isAsr:!1,hasPunctuation:!0}}}const Ce=Number.isFinite||function(i){return typeof i=="number"&&isFinite(i)},nN=Number.isSafeInteger||function(i){return typeof i=="number"&&Math.abs(i)<=sN},sN=Number.MAX_SAFE_INTEGER||9007199254740991;let ke=function(i){return i.NETWORK_ERROR="networkError",i.MEDIA_ERROR="mediaError",i.KEY_SYSTEM_ERROR="keySystemError",i.MUX_ERROR="muxError",i.OTHER_ERROR="otherError",i}({}),Q=function(i){return i.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",i.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",i.KEY_SYSTEM_NO_SESSION="keySystemNoSession",i.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",i.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",i.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",i.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",i.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",i.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",i.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",i.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",i.MANIFEST_LOAD_ERROR="manifestLoadError",i.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",i.MANIFEST_PARSING_ERROR="manifestParsingError",i.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",i.LEVEL_EMPTY_ERROR="levelEmptyError",i.LEVEL_LOAD_ERROR="levelLoadError",i.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",i.LEVEL_PARSING_ERROR="levelParsingError",i.LEVEL_SWITCH_ERROR="levelSwitchError",i.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",i.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",i.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",i.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",i.FRAG_LOAD_ERROR="fragLoadError",i.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",i.FRAG_DECRYPT_ERROR="fragDecryptError",i.FRAG_PARSING_ERROR="fragParsingError",i.FRAG_GAP="fragGap",i.REMUX_ALLOC_ERROR="remuxAllocError",i.KEY_LOAD_ERROR="keyLoadError",i.KEY_LOAD_TIMEOUT="keyLoadTimeOut",i.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",i.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",i.BUFFER_APPEND_ERROR="bufferAppendError",i.BUFFER_APPENDING_ERROR="bufferAppendingError",i.BUFFER_STALLED_ERROR="bufferStalledError",i.BUFFER_FULL_ERROR="bufferFullError",i.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",i.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",i.ASSET_LIST_LOAD_ERROR="assetListLoadError",i.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",i.ASSET_LIST_PARSING_ERROR="assetListParsingError",i.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",i.INTERNAL_EXCEPTION="internalException",i.INTERNAL_ABORTED="aborted",i.ATTACH_MEDIA_ERROR="attachMediaError",i.UNKNOWN="unknown",i}({}),b=function(i){return i.MEDIA_ATTACHING="hlsMediaAttaching",i.MEDIA_ATTACHED="hlsMediaAttached",i.MEDIA_DETACHING="hlsMediaDetaching",i.MEDIA_DETACHED="hlsMediaDetached",i.MEDIA_ENDED="hlsMediaEnded",i.STALL_RESOLVED="hlsStallResolved",i.BUFFER_RESET="hlsBufferReset",i.BUFFER_CODECS="hlsBufferCodecs",i.BUFFER_CREATED="hlsBufferCreated",i.BUFFER_APPENDING="hlsBufferAppending",i.BUFFER_APPENDED="hlsBufferAppended",i.BUFFER_EOS="hlsBufferEos",i.BUFFERED_TO_END="hlsBufferedToEnd",i.BUFFER_FLUSHING="hlsBufferFlushing",i.BUFFER_FLUSHED="hlsBufferFlushed",i.MANIFEST_LOADING="hlsManifestLoading",i.MANIFEST_LOADED="hlsManifestLoaded",i.MANIFEST_PARSED="hlsManifestParsed",i.LEVEL_SWITCHING="hlsLevelSwitching",i.LEVEL_SWITCHED="hlsLevelSwitched",i.LEVEL_LOADING="hlsLevelLoading",i.LEVEL_LOADED="hlsLevelLoaded",i.LEVEL_UPDATED="hlsLevelUpdated",i.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",i.LEVELS_UPDATED="hlsLevelsUpdated",i.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",i.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",i.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",i.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",i.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",i.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",i.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",i.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",i.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",i.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",i.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",i.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",i.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",i.CUES_PARSED="hlsCuesParsed",i.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",i.INIT_PTS_FOUND="hlsInitPtsFound",i.FRAG_LOADING="hlsFragLoading",i.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",i.FRAG_LOADED="hlsFragLoaded",i.FRAG_DECRYPTED="hlsFragDecrypted",i.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",i.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",i.FRAG_PARSING_METADATA="hlsFragParsingMetadata",i.FRAG_PARSED="hlsFragParsed",i.FRAG_BUFFERED="hlsFragBuffered",i.FRAG_CHANGED="hlsFragChanged",i.FPS_DROP="hlsFpsDrop",i.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",i.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",i.ERROR="hlsError",i.DESTROYING="hlsDestroying",i.KEY_LOADING="hlsKeyLoading",i.KEY_LOADED="hlsKeyLoaded",i.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",i.BACK_BUFFER_REACHED="hlsBackBufferReached",i.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",i.ASSET_LIST_LOADING="hlsAssetListLoading",i.ASSET_LIST_LOADED="hlsAssetListLoaded",i.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",i.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",i.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",i.INTERSTITIAL_STARTED="hlsInterstitialStarted",i.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",i.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",i.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",i.INTERSTITIAL_ENDED="hlsInterstitialEnded",i.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",i.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",i.EVENT_CUE_ENTER="hlsEventCueEnter",i}({});var ot={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Oe={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class Ha{constructor(e,t=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}sample(e,t){const r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class aN{constructor(e,t,r,n=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Ha(e),this.fast_=new Ha(t),this.defaultTTFB_=n,this.ttfb_=new Ha(e)}update(e,t){const{slow_:r,fast_:n,ttfb_:s}=this;r.halfLife!==e&&(this.slow_=new Ha(e,r.getEstimate(),r.getTotalWeight())),n.halfLife!==t&&(this.fast_=new Ha(t,n.getEstimate(),n.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new Ha(e,s.getEstimate(),s.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const r=8*t,n=e/1e3,s=r/n;this.fast_.sample(n,s),this.slow_.sample(n,s)}sampleTTFB(e){const t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function oN(i,e,t){return(e=uN(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Tt(){return Tt=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Tt.apply(null,arguments)}function wE(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),t.push.apply(t,r)}return t}function At(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?wE(Object(t),!0).forEach(function(r){oN(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):wE(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}function lN(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function uN(i){var e=lN(i,"string");return typeof e=="symbol"?e:e+""}class In{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const r=`[${e}]:`;this.trace=ls,this.debug=t.debug.bind(null,r),this.log=t.log.bind(null,r),this.warn=t.warn.bind(null,r),this.info=t.info.bind(null,r),this.error=t.error.bind(null,r)}}const ls=function(){},cN={trace:ls,debug:ls,log:ls,warn:ls,info:ls,error:ls};function Jf(){return Tt({},cN)}function hN(i,e){const t=self.console[i];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${i}] >`):ls}function CE(i,e,t){return e[i]?e[i].bind(e):hN(i,t)}const Qf=Jf();function dN(i,e,t){const r=Jf();if(typeof console=="object"&&i===!0||typeof i=="object"){const n=["debug","log","info","warn","error"];n.forEach(s=>{r[s]=CE(s,i,t)});try{r.log(`Debug logs enabled for "${e}" in hls.js version 1.6.5`)}catch{return Jf()}n.forEach(s=>{Qf[s]=CE(s,i)})}else Tt(Qf,r);return r}const yt=Qf;function us(i=!0){return typeof self>"u"?void 0:(i||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function fN(i){return typeof self<"u"&&i===self.ManagedMediaSource}function NE(i,e){const t=Object.keys(i),r=Object.keys(e),n=t.length,s=r.length;return!n||!s||n===s&&!t.some(a=>r.indexOf(a)===-1)}function Qr(i,e=!1){if(typeof TextDecoder<"u"){const l=new TextDecoder("utf-8").decode(i);if(e){const h=l.indexOf("\0");return h!==-1?l.substring(0,h):l}return l.replace(/\0/g,"")}const t=i.length;let r,n,s,a="",o=0;for(;o<t;){if(r=i[o++],r===0&&e)return a;if(r===0||r===3)continue;switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(r);break;case 12:case 13:n=i[o++],a+=String.fromCharCode((r&31)<<6|n&63);break;case 14:n=i[o++],s=i[o++],a+=String.fromCharCode((r&15)<<12|(n&63)<<6|(s&63)<<0);break}}return a}const Zi={hexDump:function(i){let e="";for(let t=0;t<i.length;t++){let r=i[t].toString(16);r.length<2&&(r="0"+r),e+=r}return e}};function gN(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Zf={exports:{}},LE;function pN(){return LE||(LE=1,function(i,e){(function(t){var r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(u,l,h){if(h=h||{},u=u.trim(),l=l.trim(),!l){if(!h.alwaysNormalize)return u;var d=o.parseURL(u);if(!d)throw new Error("Error trying to parse base URL.");return d.path=o.normalizePath(d.path),o.buildURLFromParts(d)}var p=o.parseURL(l);if(!p)throw new Error("Error trying to parse relative URL.");if(p.scheme)return h.alwaysNormalize?(p.path=o.normalizePath(p.path),o.buildURLFromParts(p)):l;var g=o.parseURL(u);if(!g)throw new Error("Error trying to parse base URL.");if(!g.netLoc&&g.path&&g.path[0]!=="/"){var m=n.exec(g.path);g.netLoc=m[1],g.path=m[2]}g.netLoc&&!g.path&&(g.path="/");var v={scheme:g.scheme,netLoc:p.netLoc,path:null,params:p.params,query:p.query,fragment:p.fragment};if(!p.netLoc&&(v.netLoc=g.netLoc,p.path[0]!=="/"))if(!p.path)v.path=g.path,p.params||(v.params=g.params,p.query||(v.query=g.query));else{var E=g.path,x=E.substring(0,E.lastIndexOf("/")+1)+p.path;v.path=o.normalizePath(x)}return v.path===null&&(v.path=h.alwaysNormalize?o.normalizePath(p.path):p.path),o.buildURLFromParts(v)},parseURL:function(u){var l=r.exec(u);return l?{scheme:l[1]||"",netLoc:l[2]||"",path:l[3]||"",params:l[4]||"",query:l[5]||"",fragment:l[6]||""}:null},normalizePath:function(u){for(u=u.split("").reverse().join("").replace(s,"");u.length!==(u=u.replace(a,"")).length;);return u.split("").reverse().join("")},buildURLFromParts:function(u){return u.scheme+u.netLoc+u.path+u.params+u.query+u.fragment}};i.exports=o})()}(Zf)),Zf.exports}var eg=pN();class tg{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var wt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class _E{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,yN(this,"stats")}setByteRange(e,t){const r=e.split("@",2);let n;r.length===1?n=(t==null?void 0:t.byteRangeEndOffset)||0:n=parseInt(r[1]),this._byteRange=[n,parseInt(r[0])+n]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[wt.AUDIO]:null,[wt.VIDEO]:null,[wt.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new tg),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=eg.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[wt.AUDIO]=null,e[wt.VIDEO]=null,e[wt.AUDIOVIDEO]=null}}function lr(i){return i.sn!=="initSegment"}class rg extends _E{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange){const e=this.byteRange[0],t=this.byteRange[1];if(Ce(e)&&Ce(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const r=Object.keys(this.levelkeys);if(r.length===1)return this._decryptdata=this.levelkeys[r[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=Ce(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),r=t.length;if(r>1||r===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!Ce(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return lr(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,r,n,s,a=!1){const{elementaryStreams:o}=this,u=o[e];if(!u){o[e]={startPTS:t,endPTS:r,startDTS:n,endDTS:s,partial:a};return}u.startPTS=Math.min(u.startPTS,t),u.endPTS=Math.max(u.endPTS,r),u.startDTS=Math.min(u.startDTS,n),u.endDTS=Math.max(u.endDTS,s)}}class mN extends _E{constructor(e,t,r,n,s){super(r),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=n;const a=e.enumeratedString("BYTERANGE");a&&this.setByteRange(a,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function ME(i,e){const t=Object.getPrototypeOf(i);if(t){const r=Object.getOwnPropertyDescriptor(t,e);return r||ME(t,e)}}function yN(i,e){const t=ME(i,e);t&&(t.enumerable=!0,Object.defineProperty(i,e,t))}const _u=Math.pow(2,32)-1,vN=[].push,OE={video:1,audio:2,id3:3,text:4};function er(i){return String.fromCharCode.apply(null,i)}function PE(i,e){const t=i[e]<<8|i[e+1];return t<0?65536+t:t}function He(i,e){const t=FE(i,e);return t<0?4294967296+t:t}function kE(i,e){let t=He(i,e);return t*=Math.pow(2,32),t+=He(i,e+4),t}function FE(i,e){return i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}function ig(i,e,t){i[e]=t>>24,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=t&255}function EN(i){const e=i.byteLength;for(let t=0;t<e;){const r=He(i,t);if(r>8&&i[t+4]===109&&i[t+5]===111&&i[t+6]===111&&i[t+7]===102)return!0;t=r>1?t+r:e}return!1}function Qe(i,e){const t=[];if(!e.length)return t;const r=i.byteLength;for(let n=0;n<r;){const s=He(i,n),a=er(i.subarray(n+4,n+8)),o=s>1?n+s:r;if(a===e[0])if(e.length===1)t.push(i.subarray(n+8,o));else{const u=Qe(i.subarray(n+8,o),e.slice(1));u.length&&vN.apply(t,u)}n=o}return t}function AN(i){const e=[],t=i[0];let r=8;const n=He(i,r);r+=4;let s=0,a=0;t===0?(s=He(i,r),a=He(i,r+4),r+=8):(s=kE(i,r),a=kE(i,r+8),r+=16),r+=2;let o=i.length+a;const u=PE(i,r);r+=2;for(let l=0;l<u;l++){let h=r;const d=He(i,h);h+=4;const p=d&2147483647;if((d&2147483648)>>>31===1)return yt.warn("SIDX has hierarchical references (not supported)"),null;const m=He(i,h);h+=4,e.push({referenceSize:p,subsegmentDuration:m,info:{duration:m/n,start:o,end:o+p-1}}),o+=p,h+=4,r=h}return{earliestPresentationTime:s,timescale:n,version:t,referencesCount:u,references:e}}function BE(i){const e=[],t=Qe(i,["moov","trak"]);for(let n=0;n<t.length;n++){const s=t[n],a=Qe(s,["tkhd"])[0];if(a){let o=a[0];const u=He(a,o===0?12:20),l=Qe(s,["mdia","mdhd"])[0];if(l){o=l[0];const h=He(l,o===0?12:20),d=Qe(s,["mdia","hdlr"])[0];if(d){const p=er(d.subarray(8,12)),g={soun:wt.AUDIO,vide:wt.VIDEO}[p],m=Qe(s,["mdia","minf","stbl","stsd"])[0],v=xN(m);g?(e[u]={timescale:h,type:g,stsd:v},e[g]=At({timescale:h,id:u},v)):e[u]={timescale:h,type:p,stsd:v}}}}}return Qe(i,["moov","mvex","trex"]).forEach(n=>{const s=He(n,4),a=e[s];a&&(a.default={duration:He(n,12),flags:He(n,20)})}),e}function xN(i){const e=i.subarray(8),t=e.subarray(86),r=er(e.subarray(4,8));let n=r,s;const a=r==="enca"||r==="encv";if(a){const l=Qe(e,[r])[0].subarray(r==="enca"?28:78);Qe(l,["sinf"]).forEach(d=>{const p=Qe(d,["schm"])[0];if(p){const g=er(p.subarray(4,8));if(g==="cbcs"||g==="cenc"){const m=Qe(d,["frma"])[0];m&&(n=er(m))}}})}const o=n;switch(n){case"avc1":case"avc2":case"avc3":case"avc4":{const u=Qe(t,["avcC"])[0];u&&u.length>3&&(n+="."+Ou(u[1])+Ou(u[2])+Ou(u[3]),s=Mu(o==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const u=Qe(e,[r])[0],l=Qe(u.subarray(28),["esds"])[0];if(l&&l.length>7){let h=4;if(l[h++]!==3)break;h=ng(l,h),h+=2;const d=l[h++];if(d&128&&(h+=2),d&64&&(h+=l[h++]),l[h++]!==4)break;h=ng(l,h);const p=l[h++];if(p===64)n+="."+Ou(p);else break;if(h+=12,l[h++]!==5)break;h=ng(l,h);const g=l[h++];let m=(g&248)>>3;m===31&&(m+=1+((g&7)<<3)+((l[h]&224)>>5)),n+="."+m}break}case"hvc1":case"hev1":{const u=Qe(t,["hvcC"])[0];if(u&&u.length>12){const l=u[1],h=["","A","B","C"][l>>6],d=l&31,p=He(u,2),g=(l&32)>>5?"H":"L",m=u[12],v=u.subarray(6,12);n+="."+h+d,n+="."+SN(p).toString(16).toUpperCase(),n+="."+g+m;let E="";for(let x=v.length;x--;){const T=v[x];(T||E)&&(E="."+T.toString(16).toUpperCase()+E)}n+=E}s=Mu(o=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{n=Mu(n,t)||n;break}case"vp09":{const u=Qe(t,["vpcC"])[0];if(u&&u.length>6){const l=u[4],h=u[5],d=u[6]>>4&15;n+="."+en(l)+"."+en(h)+"."+en(d)}break}case"av01":{const u=Qe(t,["av1C"])[0];if(u&&u.length>2){const l=u[1]>>>5,h=u[1]&31,d=u[2]>>>7?"H":"M",p=(u[2]&64)>>6,g=(u[2]&32)>>5,m=l===2&&p?g?12:10:p?10:8,v=(u[2]&16)>>4,E=(u[2]&8)>>3,x=(u[2]&4)>>2,T=u[2]&3;n+="."+l+"."+en(h)+d+"."+en(m)+"."+v+"."+E+x+T+"."+en(1)+"."+en(1)+"."+en(1)+"."+0,s=Mu("dav1",t)}break}}return{codec:n,encrypted:a,supplemental:s}}function Mu(i,e){const t=Qe(e,["dvvC"]),r=t.length?t[0]:Qe(e,["dvcC"])[0];if(r){const n=r[2]>>1&127,s=r[2]<<5&32|r[3]>>3&31;return i+"."+en(n)+"."+en(s)}}function SN(i){let e=0;for(let t=0;t<32;t++)e|=(i>>t&1)<<31-t;return e>>>0}function ng(i,e){const t=e+5;for(;i[e++]&128&&e<t;);return e}function Ou(i){return("0"+i.toString(16).toUpperCase()).slice(-2)}function en(i){return(i<10?"0":"")+i}function bN(i,e){if(!i||!e)return i;const t=e.keyId;return t&&e.isCommonEncryption&&Qe(i,["moov","trak"]).forEach(n=>{const a=Qe(n,["mdia","minf","stbl","stsd"])[0].subarray(8);let o=Qe(a,["enca"]);const u=o.length>0;u||(o=Qe(a,["encv"])),o.forEach(l=>{const h=u?l.subarray(28):l.subarray(78);Qe(h,["sinf"]).forEach(p=>{const g=UE(p);if(g){const m=g.subarray(8,24);m.some(v=>v!==0)||(yt.log(`[eme] Patching keyId in 'enc${u?"a":"v"}>sinf>>tenc' box: ${Zi.hexDump(m)} -> ${Zi.hexDump(t)}`),g.set(t,8))}})})}),i}function UE(i){const e=Qe(i,["schm"])[0];if(e){const t=er(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return Qe(i,["schi","tenc"])[0]}return null}function TN(i,e,t){const r={},n=Qe(i,["moof","traf"]);for(let s=0;s<n.length;s++){const a=n[s],o=Qe(a,["tfhd"])[0],u=He(o,4),l=e[u];if(!l)continue;const h=r[u]||(r[u]={start:NaN,duration:0,sampleCount:0,timescale:l.timescale,type:l.type}),d=Qe(a,["tfdt"])[0];if(d){const R=d[0];let _=He(d,4);R===1&&(_===_u?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(_*=_u+1,_+=He(d,8))),Ce(_)&&(!Ce(h.start)||_<h.start)&&(h.start=_)}const p=l.default,g=He(o,0)|(p==null?void 0:p.flags);let m=(p==null?void 0:p.duration)||0;g&8&&(g&2?m=He(o,12):m=He(o,8));const v=Qe(a,["trun"]);let E=h.start||0,x=0,T=m;for(let R=0;R<v.length;R++){const _=v[R],F=He(_,4),N=h.sampleCount;h.sampleCount+=F;const C=_[3]&1,M=_[3]&4,L=_[2]&1,I=_[2]&2,U=_[2]&4,q=_[2]&8;let $=8,X=F;for(C&&($+=4),M&&F&&(!(_[$+1]&1)&&h.keyFrameIndex===void 0&&(h.keyFrameIndex=N),$+=4,L?(T=He(_,$),$+=4):T=m,I&&($+=4),q&&($+=4),E+=T,x+=T,X--);X--;)L?(T=He(_,$),$+=4):T=m,I&&($+=4),U&&(_[$+1]&1||h.keyFrameIndex===void 0&&(h.keyFrameIndex=h.sampleCount-(X+1),h.keyFrameStart=E),$+=4),q&&($+=4),E+=T,x+=T;!x&&m&&(x+=m*F)}h.duration+=x}if(!Object.keys(r).some(s=>r[s].duration)){let s=1/0,a=0;const o=Qe(i,["sidx"]);for(let u=0;u<o.length;u++){const l=AN(o[u]);if(l!=null&&l.references){s=Math.min(s,l.earliestPresentationTime/l.timescale);const h=l.references.reduce((d,p)=>d+p.info.duration||0,0);a=Math.max(a,h+l.earliestPresentationTime/l.timescale)}}a&&Ce(a)&&Object.keys(r).forEach(u=>{r[u].duration||(r[u].duration=a*r[u].timescale-r[u].start)})}return r}function DN(i,e,t){Qe(e,["moof","traf"]).forEach(r=>{Qe(r,["tfhd"]).forEach(n=>{const s=He(n,4),a=i[s];if(!a)return;const o=a.timescale||9e4;Qe(r,["tfdt"]).forEach(u=>{const l=u[0],h=t*o;if(h){let d=He(u,4);if(l===0)d-=h,d=Math.max(d,0),ig(u,4,d);else{d*=Math.pow(2,32),d+=He(u,8),d-=h,d=Math.max(d,0);const p=Math.floor(d/(_u+1)),g=Math.floor(d%(_u+1));ig(u,4,p),ig(u,8,g)}}})})})}function RN(i){const e={valid:null,remainder:null},t=Qe(i,["moof"]);if(t.length<2)return e.remainder=i,e;const r=t[t.length-1];return e.valid=i.slice(0,r.byteOffset-8),e.remainder=i.slice(r.byteOffset-8),e}function hi(i,e){const t=new Uint8Array(i.length+e.length);return t.set(i),t.set(e,i.length),t}function $E(i,e){const t=[],r=e.samples,n=e.timescale,s=e.id;let a=!1;return Qe(r,["moof"]).map(u=>{const l=u.byteOffset-8;Qe(u,["traf"]).map(d=>{const p=Qe(d,["tfdt"]).map(g=>{const m=g[0];let v=He(g,4);return m===1&&(v*=Math.pow(2,32),v+=He(g,8)),v/n})[0];return p!==void 0&&(i=p),Qe(d,["tfhd"]).map(g=>{const m=He(g,4),v=He(g,0)&16777215,E=(v&1)!==0,x=(v&2)!==0,T=(v&8)!==0;let R=0;const _=(v&16)!==0;let F=0;const N=(v&32)!==0;let C=8;m===s&&(E&&(C+=8),x&&(C+=4),T&&(R=He(g,C),C+=4),_&&(F=He(g,C),C+=4),N&&(C+=4),e.type==="video"&&(a=Pu(e.codec)),Qe(d,["trun"]).map(M=>{const L=M[0],I=He(M,0)&16777215,U=(I&1)!==0;let q=0;const $=(I&4)!==0,X=(I&256)!==0;let ie=0;const ne=(I&512)!==0;let ue=0;const re=(I&1024)!==0,V=(I&2048)!==0;let J=0;const ve=He(M,4);let de=8;U&&(q=He(M,de),de+=4),$&&(de+=4);let De=q+l;for(let Ie=0;Ie<ve;Ie++){if(X?(ie=He(M,de),de+=4):ie=R,ne?(ue=He(M,de),de+=4):ue=F,re&&(de+=4),V&&(L===0?J=He(M,de):J=FE(M,de),de+=4),e.type===wt.VIDEO){let Ne=0;for(;Ne<ue;){const Be=He(r,De);if(De+=4,IN(a,r[De])){const $e=r.subarray(De,De+Be);sg($e,a?2:1,i+J/n,t)}De+=Be,Ne+=Be+4}}i+=ie/n}}))})})}),t}function Pu(i){if(!i)return!1;const e=i.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function IN(i,e){if(i){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function sg(i,e,t,r){const n=GE(i);let s=0;s+=e;let a=0,o=0,u=0;for(;s<n.length;){a=0;do{if(s>=n.length)break;u=n[s++],a+=u}while(u===255);o=0;do{if(s>=n.length)break;u=n[s++],o+=u}while(u===255);const l=n.length-s;let h=s;if(o<l)s+=o;else if(o>l){yt.error(`Malformed SEI payload. ${o} is too small, only ${l} bytes left to parse.`);break}if(a===4){if(n[h++]===181){const p=PE(n,h);if(h+=2,p===49){const g=He(n,h);if(h+=4,g===1195456820){const m=n[h++];if(m===3){const v=n[h++],E=31&v,x=64&v,T=x?2+E*3:0,R=new Uint8Array(T);if(x){R[0]=v;for(let _=1;_<T;_++)R[_]=n[h++]}r.push({type:m,payloadType:a,pts:t,bytes:R})}}}}}else if(a===5&&o>16){const d=[];for(let m=0;m<16;m++){const v=n[h++].toString(16);d.push(v.length==1?"0"+v:v),(m===3||m===5||m===7||m===9)&&d.push("-")}const p=o-16,g=new Uint8Array(p);for(let m=0;m<p;m++)g[m]=n[h++];r.push({payloadType:a,pts:t,uuid:d.join(""),userData:Qr(g),userDataBytes:g})}}}function GE(i){const e=i.byteLength,t=[];let r=1;for(;r<e-2;)i[r]===0&&i[r+1]===0&&i[r+2]===3?(t.push(r+2),r+=2):r++;if(t.length===0)return i;const n=e-t.length,s=new Uint8Array(n);let a=0;for(r=0;r<n;a++,r++)a===t[0]&&(a++,t.shift()),s[r]=i[a];return s}function wN(i){const e=i[0];let t="",r="",n=0,s=0,a=0,o=0,u=0,l=0;if(e===0){for(;er(i.subarray(l,l+1))!=="\0";)t+=er(i.subarray(l,l+1)),l+=1;for(t+=er(i.subarray(l,l+1)),l+=1;er(i.subarray(l,l+1))!=="\0";)r+=er(i.subarray(l,l+1)),l+=1;r+=er(i.subarray(l,l+1)),l+=1,n=He(i,12),s=He(i,16),o=He(i,20),u=He(i,24),l=28}else if(e===1){l+=4,n=He(i,l),l+=4;const d=He(i,l);l+=4;const p=He(i,l);for(l+=4,a=4294967296*d+p,nN(a)||(a=Number.MAX_SAFE_INTEGER,yt.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=He(i,l),l+=4,u=He(i,l),l+=4;er(i.subarray(l,l+1))!=="\0";)t+=er(i.subarray(l,l+1)),l+=1;for(t+=er(i.subarray(l,l+1)),l+=1;er(i.subarray(l,l+1))!=="\0";)r+=er(i.subarray(l,l+1)),l+=1;r+=er(i.subarray(l,l+1)),l+=1}const h=i.subarray(l,i.byteLength);return{schemeIdUri:t,value:r,timeScale:n,presentationTime:a,presentationTimeDelta:s,eventDuration:o,id:u,payload:h}}function CN(i,...e){const t=e.length;let r=8,n=t;for(;n--;)r+=e[n].byteLength;const s=new Uint8Array(r);for(s[0]=r>>24&255,s[1]=r>>16&255,s[2]=r>>8&255,s[3]=r&255,s.set(i,4),n=0,r=8;n<t;n++)s.set(e[n],r),r+=e[n].byteLength;return s}function NN(i,e,t){if(i.byteLength!==16)throw new RangeError("Invalid system id");let r,n;r=0,n=new Uint8Array;let s;r>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;const a=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(a.buffer).setUint32(0,t.byteLength,!1),CN([112,115,115,104],new Uint8Array([r,0,0,0]),i,s,n,a,t||new Uint8Array)}function LN(i){const e=[];if(i instanceof ArrayBuffer){const t=i.byteLength;let r=0;for(;r+32<t;){const n=new DataView(i,r),s=_N(n);e.push(s),r+=s.size}}return e}function _N(i){const e=i.getUint32(0),t=i.byteOffset,r=i.byteLength;if(r<e)return{offset:t,size:r};if(i.getUint32(4)!==1886614376)return{offset:t,size:e};const s=i.getUint32(8)>>>24;if(s!==0&&s!==1)return{offset:t,size:e};const a=i.buffer,o=Zi.hexDump(new Uint8Array(a,t+12,16)),u=i.getUint32(28);let l=null,h=null;if(s===0){if(e-32<u||u<22)return{offset:t,size:e};h=new Uint8Array(a,t+32,u)}else if(s===1){if(!u||r<t+32+u*16+16)return{offset:t,size:e};l=[];for(let d=0;d<u;d++)l.push(new Uint8Array(a,t+32+d*16,16))}return{version:s,systemId:o,kids:l,data:h,offset:t,size:e}}const qE=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),Va={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function HE(i,e){const t=Va[e];return!!t&&!!t[i.slice(0,4)]}function ag(i,e,t=!0){return!i.split(",").some(r=>!VE(r,e,t))}function VE(i,e,t=!0){var r;const n=us(t);return(r=n==null?void 0:n.isTypeSupported(Zo(i,e)))!=null?r:!1}function Zo(i,e){return`${e}/mp4;codecs=${i}`}function KE(i){if(i){const e=i.substring(0,4);return Va.video[e]}return 2}function ku(i){const e=qE();return i.split(",").reduce((t,r)=>{const s=e&&Pu(r)?9:Va.video[r];return s?(s*2+t)/(t?3:2):(Va.audio[r]+t)/(t?2:1)},0)}const og={};function MN(i,e=!0){if(og[i])return og[i];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[i];for(let n=0;n<t.length;n++){var r;if(VE(t[n],"audio",e))return og[i]=t[n],t[n];if(t[n]==="mp3"&&(r=us(e))!=null&&r.isTypeSupported("audio/mpeg"))return""}return i}const ON=/flac|opus|mp4a\.40\.34/i;function Fu(i,e=!0){return i.replace(ON,t=>MN(t.toLowerCase(),e))}function PN(i,e){const t=[];if(i){const r=i.split(",");for(let n=0;n<r.length;n++)HE(r[n],"video")||t.push(r[n])}return e&&t.push(e),t.join(",")}function Bu(i,e){if(i&&(i.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(i)!==-1))return i;if(e){const t=e.split(",");if(t.length>1){if(i){for(let r=t.length;r--;)if(t[r].substring(0,4)===i.substring(0,4))return t[r]}return t[0]}}return e||i}function kN(i){const e=i.split(",");for(let t=0;t<e.length;t++){const r=e[t].split(".");r.length>2&&r[0]==="avc1"&&(e[t]=`avc1.${parseInt(r[1]).toString(16)}${("000"+parseInt(r[2]).toString(16)).slice(-4)}`)}return e.join(",")}function FN(i){if(i.startsWith("av01.")){const e=i.split("."),t=["0","111","01","01","01","0"];for(let r=e.length;r>4&&r<10;r++)e[r]=t[r-4];return e.join(".")}return i}function WE(i){const e=us(i)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function YE(i){return i.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const XE={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function zE(i,e){return{supported:!1,configurations:e,decodingInfoResults:[{supported:!1,smooth:!1,powerEfficient:!1}],error:i}}const jE={};function BN(i,e,t,r,n,s){const a=i.audioCodec?i.audioGroups:null,o=s==null?void 0:s.audioCodec,u=s==null?void 0:s.channels,l=u?parseInt(u):o?1/0:2;let h=null;if(a!=null&&a.length)try{a.length===1&&a[0]?h=e.groups[a[0]].channels:h=a.reduce((d,p)=>{if(p){const g=e.groups[p];if(!g)throw new Error(`Audio track group ${p} not found`);Object.keys(g.channels).forEach(m=>{d[m]=(d[m]||0)+g.channels[m]})}return d},{2:0})}catch{return!0}return i.videoCodec!==void 0&&(i.width>1920&&i.height>1088||i.height>1920&&i.width>1088||i.frameRate>Math.max(r,30)||i.videoRange!=="SDR"&&i.videoRange!==t||i.bitrate>Math.max(n,8e6))||!!h&&Ce(l)&&Object.keys(h).some(d=>parseInt(d)>l)}function JE(i,e,t){const r=i.videoCodec,n=i.audioCodec;if(!r&&!n||!t)return Promise.resolve(XE);const s=[];if(r){const a={width:i.width,height:i.height,bitrate:Math.ceil(Math.max(i.bitrate*.9,i.averageBitrate)),framerate:i.frameRate||30},o=i.videoRange;o!=="SDR"&&(a.transferFunction=o.toLowerCase());const u=r.split(","),l=navigator.userAgent;if(u.some(h=>Pu(h))&&qE())return Promise.resolve(zE(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent sting: (${l})`),s));s.push.apply(s,u.map(h=>({type:"media-source",video:At(At({},a),{},{contentType:Zo(FN(h),"video")})})))}return n&&i.audioGroups&&i.audioGroups.forEach(a=>{var o;a&&((o=e.groups[a])==null||o.tracks.forEach(u=>{if(u.groupId===a){const l=u.channels||"",h=parseFloat(l);Ce(h)&&h>2&&s.push.apply(s,n.split(",").map(d=>({type:"media-source",audio:{contentType:Zo(d,"audio"),channels:""+h}})))}}))}),Promise.all(s.map(a=>{const o=UN(a);return jE[o]||(jE[o]=t.decodingInfo(a))})).then(a=>({supported:!a.some(o=>!o.supported),configurations:s,decodingInfoResults:a})).catch(a=>({supported:!1,configurations:s,decodingInfoResults:[],error:a}))}function UN(i){const{audio:e,video:t}=i,r=t||e;if(r){const n=YE(r.contentType);if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${n}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${n}`}return""}const lg=["NONE","TYPE-0","TYPE-1",null];function $N(i){return lg.indexOf(i)>-1}const Uu=["SDR","PQ","HLG"];function GN(i){return!!i&&Uu.indexOf(i)>-1}var $u={No:"",Yes:"YES",v2:"v2"};function QE(i){const{canSkipUntil:e,canSkipDateRanges:t,age:r}=i,n=r<e/2;return e&&n?t?$u.v2:$u.Yes:$u.No}class ZE{constructor(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class el{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(r=>!!r).map(r=>r.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const r=(t=e.supplemental)==null?void 0:t.videoCodec;r&&r!==e.videoCodec&&(this.codecSet+=`,${r.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return e2(this._audioGroups,e)}hasSubtitleGroup(e){return e2(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let r=this._audioGroups;r||(r=this._audioGroups=[]),r.indexOf(t)===-1&&r.push(t)}else if(e==="text"){let r=this._subtitleGroups;r||(r=this._subtitleGroups=[]),r.indexOf(t)===-1&&r.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function e2(i,e){return!e||!i?!1:i.indexOf(e)!==-1}function qN(){if(typeof matchMedia=="function"){const i=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(i.media!==e.media)return i.matches===!0}return!1}function HN(i,e){let t=!1,r=[];if(i&&(t=i!=="SDR",r=[i]),e){r=e.allowedVideoRanges||Uu.slice(0);const n=r.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:n&&qN(),t||(r=["SDR"])}return{preferHDR:t,allowedVideoRanges:r}}const VN=i=>{const e=new WeakSet;return(t,r)=>{if(i&&(r=i(t,r)),typeof r=="object"&&r!==null){if(e.has(r))return;e.add(r)}return r}},Bt=(i,e)=>JSON.stringify(i,VN(e));function KN(i,e,t,r,n){const s=Object.keys(i),a=r==null?void 0:r.channels,o=r==null?void 0:r.audioCodec,u=n==null?void 0:n.videoCodec,l=a&&parseInt(a)===2;let h=!1,d=!1,p=1/0,g=1/0,m=1/0,v=1/0,E=0,x=[];const{preferHDR:T,allowedVideoRanges:R}=HN(e,n);for(let M=s.length;M--;){const L=i[s[M]];h||(h=L.channels[2]>0),p=Math.min(p,L.minHeight),g=Math.min(g,L.minFramerate),m=Math.min(m,L.minBitrate),R.filter(U=>L.videoRanges[U]>0).length>0&&(d=!0)}p=Ce(p)?p:0,g=Ce(g)?g:0;const _=Math.max(1080,p),F=Math.max(30,g);m=Ce(m)?m:t,t=Math.max(m,t),d||(e=void 0);const N=s.length>1;return{codecSet:s.reduce((M,L)=>{const I=i[L];if(L===M)return M;if(x=d?R.filter(U=>I.videoRanges[U]>0):[],N){if(I.minBitrate>t)return tn(L,`min bitrate of ${I.minBitrate} > current estimate of ${t}`),M;if(!I.hasDefaultAudio)return tn(L,"no renditions with default or auto-select sound found"),M;if(o&&L.indexOf(o.substring(0,4))%5!==0)return tn(L,`audio codec preference "${o}" not found`),M;if(a&&!l){if(!I.channels[a])return tn(L,`no renditions with ${a} channel sound found (channels options: ${Object.keys(I.channels)})`),M}else if((!o||l)&&h&&I.channels[2]===0)return tn(L,"no renditions with stereo sound found"),M;if(I.minHeight>_)return tn(L,`min resolution of ${I.minHeight} > maximum of ${_}`),M;if(I.minFramerate>F)return tn(L,`min framerate of ${I.minFramerate} > maximum of ${F}`),M;if(!x.some(U=>I.videoRanges[U]>0))return tn(L,`no variants with VIDEO-RANGE of ${Bt(x)} found`),M;if(u&&L.indexOf(u.substring(0,4))%5!==0)return tn(L,`video codec preference "${u}" not found`),M;if(I.maxScore<E)return tn(L,`max score of ${I.maxScore} < selected max of ${E}`),M}return M&&(ku(L)>=ku(M)||I.fragmentError>i[M].fragmentError)?M:(v=I.minIndex,E=I.maxScore,L)},void 0),videoRanges:x,preferHDR:T,minFramerate:g,minBitrate:m,minIndex:v}}function tn(i,e){yt.log(`[abr] start candidates with "${i}" ignored because ${e}`)}function t2(i){return i.reduce((e,t)=>{let r=e.groups[t.groupId];r||(r=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),r.tracks.push(t);const n=t.channels||"2";return r.channels[n]=(r.channels[n]||0)+1,r.hasDefault=r.hasDefault||t.default,r.hasAutoSelect=r.hasAutoSelect||t.autoselect,r.hasDefault&&(e.hasDefaultAudio=!0),r.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function WN(i,e,t,r){return i.slice(t,r+1).reduce((n,s,a)=>{if(!s.codecSet)return n;const o=s.audioGroups;let u=n[s.codecSet];u||(n[s.codecSet]=u={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:a,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!o,fragmentError:0}),u.minBitrate=Math.min(u.minBitrate,s.bitrate);const l=Math.min(s.height,s.width);return u.minHeight=Math.min(u.minHeight,l),u.minFramerate=Math.min(u.minFramerate,s.frameRate),u.minIndex=Math.min(u.minIndex,a),u.maxScore=Math.max(u.maxScore,s.score),u.fragmentError+=s.fragmentError,u.videoRanges[s.videoRange]=(u.videoRanges[s.videoRange]||0)+1,o&&o.forEach(h=>{if(!h)return;const d=e.groups[h];d&&(u.hasDefaultAudio=u.hasDefaultAudio||e.hasDefaultAudio?d.hasDefault:d.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(d.channels).forEach(p=>{u.channels[p]=(u.channels[p]||0)+d.channels[p]}))}),n},{})}function r2(i){if(!i)return i;const{lang:e,assocLang:t,characteristics:r,channels:n,audioCodec:s}=i;return{lang:e,assocLang:t,characteristics:r,channels:n,audioCodec:s}}function rn(i,e,t){if("attrs"in i){const r=e.indexOf(i);if(r!==-1)return r}for(let r=0;r<e.length;r++){const n=e[r];if(Ks(i,n,t))return r}return-1}function Ks(i,e,t){const{groupId:r,name:n,lang:s,assocLang:a,default:o}=i,u=i.forced;return(r===void 0||e.groupId===r)&&(n===void 0||e.name===n)&&(s===void 0||YN(s,e.lang))&&(s===void 0||e.assocLang===a)&&(o===void 0||e.default===o)&&(u===void 0||e.forced===u)&&(!("characteristics"in i)||XN(i.characteristics||"",e.characteristics))&&(t===void 0||t(i,e))}function YN(i,e="--"){return i.length===e.length?i===e:i.startsWith(e)||e.startsWith(i)}function XN(i,e=""){const t=i.split(","),r=e.split(",");return t.length===r.length&&!t.some(n=>r.indexOf(n)===-1)}function Ws(i,e){const{audioCodec:t,channels:r}=i;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(r===void 0||r===(e.channels||"2"))}function zN(i,e,t,r,n){const s=e[r],o=e.reduce((p,g,m)=>{const v=g.uri;return(p[v]||(p[v]=[])).push(m),p},{})[s.uri];o.length>1&&(r=Math.max.apply(Math,o));const u=s.videoRange,l=s.frameRate,h=s.codecSet.substring(0,4),d=i2(e,r,p=>{if(p.videoRange!==u||p.frameRate!==l||p.codecSet.substring(0,4)!==h)return!1;const g=p.audioGroups,m=t.filter(v=>!g||g.indexOf(v.groupId)!==-1);return rn(i,m,n)>-1});return d>-1?d:i2(e,r,p=>{const g=p.audioGroups,m=t.filter(v=>!g||g.indexOf(v.groupId)!==-1);return rn(i,m,n)>-1})}function i2(i,e,t){for(let r=e;r>-1;r--)if(t(i[r]))return r;for(let r=e+1;r<i.length;r++)if(t(i[r]))return r;return-1}function Gu(i,e){var t;return!!i&&i!==((t=e.loadLevelObj)==null?void 0:t.uri)}class jN extends In{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var r;const{fragCurrent:n,partCurrent:s,hls:a}=this,{autoLevelEnabled:o,media:u}=a;if(!n||!u)return;const l=performance.now(),h=s?s.stats:n.stats,d=s?s.duration:n.duration,p=l-h.loading.start,g=a.minAutoLevel,m=n.level,v=this._nextAutoLevel;if(h.aborted||h.loaded&&h.loaded===h.total||m<=g){this.clearTimer(),this._nextAutoLevel=-1;return}if(!o)return;const E=v>-1&&v!==m,x=!!t||E;if(!x&&(u.paused||!u.playbackRate||!u.readyState))return;const T=a.mainForwardBufferInfo;if(!x&&T===null)return;const R=this.bwEstimator.getEstimateTTFB(),_=Math.abs(u.playbackRate);if(p<=Math.max(R,1e3*(d/(_*2))))return;const F=T?T.len/_:0,N=h.loading.first?h.loading.first-h.loading.start:-1,C=h.loaded&&N>-1,M=this.getBwEstimate(),L=a.levels,I=L[m],U=Math.max(h.loaded,Math.round(d*(n.bitrate||I.averageBitrate)/8));let q=C?p-N:p;q<1&&C&&(q=Math.min(p,h.loaded*8/M));const $=C?h.loaded*1e3/q:0,X=R/1e3,ie=$?(U-h.loaded)/$:U*8/M+X;if(ie<=F)return;const ne=$?$*8:M,ue=((r=(t==null?void 0:t.details)||this.hls.latestLevelDetails)==null?void 0:r.live)===!0,re=this.hls.config.abrBandWidthUpFactor;let V=Number.POSITIVE_INFINITY,J;for(J=m-1;J>g;J--){const Ie=L[J].maxBitrate,Ne=!L[J].details||ue;if(V=this.getTimeToLoadFrag(X,ne,d*Ie,Ne),V<Math.min(F,d+X))break}if(V>=ie||V>d*10)return;C?this.bwEstimator.sample(p-Math.min(R,N),h.loaded):this.bwEstimator.sampleTTFB(p);const ve=L[J].maxBitrate;this.getBwEstimate()*re>ve&&this.resetEstimator(ve);const de=this.findBestLevel(ve,g,J,0,F,1,1);de>-1&&(J=de),this.warn(`Fragment ${n.sn}${s?" part "+s.index:""} of level ${m} is loading too slowly;
      Fragment duration: ${n.duration.toFixed(3)}
      Time to underbuffer: ${F.toFixed(3)} s
      Estimated load time for current fragment: ${ie.toFixed(3)} s
      Estimated load time for down switch fragment: ${V.toFixed(3)} s
      TTFB estimate: ${N|0} ms
      Current BW estimate: ${Ce(M)?M|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${J} @ ${ve|0} bps`),a.nextLoadLevel=a.nextAutoLevel=J,this.clearTimer();const De=()=>{if(this.clearTimer(),this.fragCurrent===n&&this.hls.loadLevel===J&&J>0){const Ie=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${J>0?"and switching down":""}
      Fragment duration: ${n.duration.toFixed(3)} s
      Time to underbuffer: ${Ie.toFixed(3)} s`),n.abortRequests(),this.fragCurrent=this.partCurrent=null,J>g){let Ne=this.findBestLevel(this.hls.levels[g].bitrate,g,J,0,Ie,1,1);Ne===-1&&(Ne=g),this.hls.nextLoadLevel=this.hls.nextAutoLevel=Ne,this.resetEstimator(this.hls.levels[Ne].bitrate)}}};E||ie>V*2?De():this.timer=self.setInterval(De,V*1e3),a.trigger(b.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,part:s,stats:h})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new aN(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.FRAG_LOADING,this.onFragLoading,this),e.on(b.FRAG_LOADED,this.onFragLoaded,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this),e.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(b.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.FRAG_LOADING,this.onFragLoading,this),e.off(b.FRAG_LOADED,this.onFragLoaded,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this),e.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(b.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const r=t.frag;if(!this.ignoreFragment(r)){if(!r.bitrateTest){var n;this.fragCurrent=r,this.partCurrent=(n=t.part)!=null?n:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Q.FRAG_LOAD_TIMEOUT:{const r=t.frag,{fragCurrent:n,partCurrent:s}=this;if(r&&n&&r.sn===n.sn&&r.level===n.level){const a=performance.now(),o=s?s.stats:r.stats,u=a-o.loading.start,l=o.loading.first?o.loading.first-o.loading.start:-1;if(o.loaded&&l>-1){const d=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(u-Math.min(d,l),o.loaded)}else this.bwEstimator.sampleTTFB(u)}break}}}getTimeToLoadFrag(e,t,r,n){const s=e+r/t,a=n?e+this.lastLevelLoadSec:0;return s+a}onLevelLoaded(e,t){const r=this.hls.config,{loading:n}=t.stats,s=n.end-n.first;Ce(s)&&(this.lastLevelLoadSec=s/1e3),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:r}){const n=r?r.stats:t.stats;if(t.type===Oe.MAIN&&this.bwEstimator.sampleTTFB(n.loading.first-n.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const s=r?r.duration:t.duration,a=this.hls.levels[t.level],o=(a.loaded?a.loaded.bytes:0)+n.loaded,u=(a.loaded?a.loaded.duration:0)+s;a.loaded={bytes:o,duration:u},a.realBitrate=Math.round(8*o/u)}if(t.bitrateTest){const s={stats:n,frag:t,part:r,id:t.type};this.onFragBuffered(b.FRAG_BUFFERED,s),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:r,part:n}=t,s=n!=null&&n.stats.loaded?n.stats:r.stats;if(s.aborted||this.ignoreFragment(r))return;const a=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,s.loaded),s.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Oe.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,r=this.getBwEstimate(),n=this.hls.config.maxStarvationDelay,s=this.findBestLevel(r,t,e,0,n,1,1);if(s>-1)return s;const a=this.hls.firstLevel,o=Math.min(Math.max(a,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${a} clamped to ${o}`),o}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,r=this.bwEstimator.canEstimate(),n=this.lastLoadedFragLevel>-1;if(e!==-1&&(!r||!n||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const s=r&&n?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const a=this.hls.levels;if(a.length>Math.max(e,s)&&a[e].loadError<=a[s].loadError)return e}return this._nextAutoLevel=s,this.nextAutoLevelKey=this.getAutoLevelKey(),s}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:r}=this;if(r.levels.length<=1)return r.loadLevel;const{maxAutoLevel:n,config:s,minAutoLevel:a}=r,o=t?t.duration:e?e.duration:0,u=this.getBwEstimate(),l=this.getStarvationDelay();let h=s.abrBandWidthFactor,d=s.abrBandWidthUpFactor;if(l){const E=this.findBestLevel(u,a,n,l,0,h,d);if(E>=0)return this.rebufferNotice=-1,E}let p=o?Math.min(o,s.maxStarvationDelay):s.maxStarvationDelay;if(!l){const E=this.bitrateTestDelay;E&&(p=(o?Math.min(o,s.maxLoadingDelay):s.maxLoadingDelay)-E,this.info(`bitrate test took ${Math.round(1e3*E)}ms, set first fragment max fetchDuration to ${Math.round(1e3*p)} ms`),h=d=1)}const g=this.findBestLevel(u,a,n,l,p,h,d);if(this.rebufferNotice!==g&&(this.rebufferNotice=g,this.info(`${l?"rebuffering expected":"buffer is empty"}, optimal quality level ${g}`)),g>-1)return g;const m=r.levels[a],v=r.loadLevelObj;return v&&(m==null?void 0:m.bitrate)<v.bitrate?a:r.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const r=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,n=e.mainForwardBufferInfo;return(n?n.len:0)/r}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,r,n,s,a,o){var u;const l=n+s,h=this.lastLoadedFragLevel,d=h===-1?this.hls.firstLevel:h,{fragCurrent:p,partCurrent:g}=this,{levels:m,allAudioTracks:v,loadLevel:E,config:x}=this.hls;if(m.length===1)return 0;const T=m[d],R=!!((u=this.hls.latestLevelDetails)!=null&&u.live),_=E===-1||h===-1;let F,N="SDR",C=(T==null?void 0:T.frameRate)||0;const{audioPreference:M,videoPreference:L}=x,I=this.audioTracksByGroup||(this.audioTracksByGroup=t2(v));let U=-1;if(_){if(this.firstSelection!==-1)return this.firstSelection;const ne=this.codecTiers||(this.codecTiers=WN(m,I,t,r)),ue=KN(ne,N,e,M,L),{codecSet:re,videoRanges:V,minFramerate:J,minBitrate:ve,minIndex:de,preferHDR:De}=ue;U=de,F=re,N=De?V[V.length-1]:V[0],C=J,e=Math.max(e,ve),this.log(`picked start tier ${Bt(ue)}`)}else F=T==null?void 0:T.codecSet,N=T==null?void 0:T.videoRange;const q=g?g.duration:p?p.duration:0,$=this.bwEstimator.getEstimateTTFB()/1e3,X=[];for(let ne=r;ne>=t;ne--){var ie;const ue=m[ne],re=ne>d;if(!ue)continue;if(x.useMediaCapabilities&&!ue.supportedResult&&!ue.supportedPromise){const Ne=navigator.mediaCapabilities;typeof(Ne==null?void 0:Ne.decodingInfo)=="function"&&(BN(ue,I,N,C,e,M)||Pu(ue.videoCodec))?(ue.supportedPromise=JE(ue,I,Ne),ue.supportedPromise.then(Be=>{if(!this.hls)return;ue.supportedResult=Be;const $e=this.hls.levels,et=$e.indexOf(ue);Be.error?this.warn(`MediaCapabilities decodingInfo error: "${Be.error}" for level ${et} ${Bt(Be)}`):Be.supported||(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${et} ${Bt(Be)}`),et>-1&&$e.length>1&&(this.log(`Removing unsupported level ${et}`),this.hls.removeLevel(et),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))})):ue.supportedResult=XE}if((F&&ue.codecSet!==F||N&&ue.videoRange!==N||re&&C>ue.frameRate||!re&&C>0&&C<ue.frameRate||ue.supportedResult&&!((ie=ue.supportedResult.decodingInfoResults)!=null&&ie[0].smooth))&&(!_||ne!==U)){X.push(ne);continue}const V=ue.details,J=(g?V==null?void 0:V.partTarget:V==null?void 0:V.averagetargetduration)||q;let ve;re?ve=o*e:ve=a*e;const de=q&&n>=q*2&&s===0?ue.averageBitrate:ue.maxBitrate,De=this.getTimeToLoadFrag($,ve,de*J,V===void 0);if(ve>=de&&(ne===h||ue.loadError===0&&ue.fragmentError===0)&&(De<=$||!Ce(De)||R&&!this.bitrateTestDelay||De<l)){const Ne=this.forcedAutoLevel;return ne!==E&&(Ne===-1||Ne!==E)&&(X.length&&this.trace(`Skipped level(s) ${X.join(",")} of ${r} max with CODECS and VIDEO-RANGE:"${m[X[0]].codecs}" ${m[X[0]].videoRange}; not compatible with "${F}" ${N}`),this.info(`switch candidate:${d}->${ne} adjustedbw(${Math.round(ve)})-bitrate=${Math.round(ve-de)} ttfb:${$.toFixed(1)} avgDuration:${J.toFixed(1)} maxFetchDuration:${l.toFixed(1)} fetchDuration:${De.toFixed(1)} firstSelection:${_} codecSet:${ue.codecSet} videoRange:${ue.videoRange} hls.loadLevel:${E}`)),_&&(this.firstSelection=ne),ne}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:r}=this.hls;return Math.min(Math.max(e,r),t)}}const n2={search:function(i,e){let t=0,r=i.length-1,n=null,s=null;for(;t<=r;){n=(t+r)/2|0,s=i[n];const a=e(s);if(a>0)t=n+1;else if(a<0)r=n-1;else return s}return null}};function JN(i,e,t){if(e===null||!Array.isArray(i)||!i.length||!Ce(e))return null;const r=i[0].programDateTime;if(e<(r||0))return null;const n=i[i.length-1].endProgramDateTime;if(e>=(n||0))return null;for(let s=0;s<i.length;++s){const a=i[s];if(ZN(e,t,a))return a}return null}function Ys(i,e,t=0,r=0,n=.005){let s=null;if(i){s=e[1+i.sn-e[0].sn]||null;const o=i.endDTS-t;o>0&&o<15e-7&&(t+=15e-7),s&&i.level!==s.level&&s.end<=i.end&&(s=e[2+i.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(s=e[0]);if(s&&((!i||i.level===s.level)&&s2(t,r,s)===0||QN(s,i,Math.min(n,r))))return s;const a=n2.search(e,s2.bind(null,t,r));return a&&(a!==i||!s)?a:s}function QN(i,e,t){if(e&&e.start===0&&e.level<i.level&&(e.endPTS||0)>0){const r=e.tagList.reduce((n,s)=>(s[0]==="INF"&&(n+=parseFloat(s[1])),n),t);return i.start<=r}return!1}function s2(i=0,e=0,t){if(t.start<=i&&t.start+t.duration>i)return 0;const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-r<=i?1:t.start-r>i&&t.start?-1:0}function ZN(i,e,t){const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-r>i}function a2(i,e,t){if(i&&i.startCC<=e&&i.endCC>=e){let r=i.fragments;const{fragmentHint:n}=i;n&&(r=r.concat(n));let s;return n2.search(r,a=>a.cc<e?1:a.cc>e?-1:(s=a,a.end<=t?1:a.start>t?-1:0)),s||null}return null}function qu(i){switch(i.details){case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_TIMEOUT:case Q.LEVEL_LOAD_TIMEOUT:case Q.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function o2(i,e){const t=qu(e);return i.default[`${t?"timeout":"error"}Retry`]}function ug(i,e){const t=i.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*i.retryDelayMs,i.maxRetryDelayMs)}function l2(i){return At(At({},i),{errorRetry:null,timeoutRetry:null})}function Hu(i,e,t,r){if(!i)return!1;const n=r==null?void 0:r.code,s=e<i.maxNumRetry&&(eL(n)||!!t);return i.shouldRetry?i.shouldRetry(i,e,t,r,s):s}function eL(i){return i===0&&navigator.onLine===!1||!!i&&(i<400||i>499)}var Sr={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},Ni={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2};class tL extends In{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(b.ERROR,this.onError,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(b.ERROR,this.onError,this),e.off(b.ERROR,this.onErrorOut,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Oe.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var r;if(t.fatal)return;const n=this.hls,s=t.context;switch(t.details){case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case Q.FRAG_PARSING_ERROR:if((r=t.frag)!=null&&r.gap){t.errorAction=tl();return}case Q.FRAG_GAP:case Q.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Sr.SendAlternateToPenaltyBox;return}case Q.LEVEL_EMPTY_ERROR:case Q.LEVEL_PARSING_ERROR:{var a,o;const l=t.parent===Oe.MAIN?t.level:n.loadLevel;t.details===Q.LEVEL_EMPTY_ERROR&&((a=t.context)!=null&&(o=a.levelDetails)!=null&&o.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,l):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,l))}return;case Q.LEVEL_LOAD_ERROR:case Q.LEVEL_LOAD_TIMEOUT:typeof(s==null?void 0:s.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.level));return;case Q.AUDIO_TRACK_LOAD_ERROR:case Q.AUDIO_TRACK_LOAD_TIMEOUT:case Q.SUBTITLE_LOAD_ERROR:case Q.SUBTITLE_TRACK_LOAD_TIMEOUT:if(s){const l=n.loadLevelObj;if(l&&(s.type===ot.AUDIO_TRACK&&l.hasAudioGroup(s.groupId)||s.type===ot.SUBTITLE_TRACK&&l.hasSubtitleGroup(s.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,n.loadLevel),t.errorAction.action=Sr.SendAlternateToPenaltyBox,t.errorAction.flags=Ni.MoveAllAlternatesMatchingHost;return}}return;case Q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const l=n.loadLevelObj,h=l==null?void 0:l.attrs["HDCP-LEVEL"];h?t.errorAction={action:Sr.SendAlternateToPenaltyBox,flags:Ni.MoveAllAlternatesMatchingHDCP,hdcpLevel:h}:this.keySystemError(t)}return;case Q.BUFFER_ADD_CODEC_ERROR:case Q.REMUX_ALLOC_ERROR:case Q.BUFFER_APPEND_ERROR:if(!t.errorAction){var u;t.errorAction=this.getLevelSwitchAction(t,(u=t.level)!=null?u:n.loadLevel)}return;case Q.INTERNAL_EXCEPTION:case Q.BUFFER_APPENDING_ERROR:case Q.BUFFER_FULL_ERROR:case Q.LEVEL_SWITCH_ERROR:case Q.BUFFER_STALLED_ERROR:case Q.BUFFER_SEEK_OVER_HOLE:case Q.BUFFER_NUDGE_ON_STALL:t.errorAction=tl();return}t.type===ke.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const r=this.hls,n=o2(r.config.playlistLoadPolicy,e),s=this.playlistError++;if(Hu(n,s,qu(e),e.response))return{action:Sr.RetryRequest,flags:Ni.None,retryConfig:n,retryCount:s};const o=this.getLevelSwitchAction(e,t);return n&&(o.retryConfig=n,o.retryCount=s),o}getFragRetryOrSwitchAction(e){const t=this.hls,r=this.getVariantLevelIndex(e.frag),n=t.levels[r],{fragLoadPolicy:s,keyLoadPolicy:a}=t.config,o=o2(e.details.startsWith("key")?a:s,e),u=t.levels.reduce((h,d)=>h+d.fragmentError,0);if(n&&(e.details!==Q.FRAG_GAP&&n.fragmentError++,Hu(o,u,qu(e),e.response)))return{action:Sr.RetryRequest,flags:Ni.None,retryConfig:o,retryCount:u};const l=this.getLevelSwitchAction(e,r);return o&&(l.retryConfig=o,l.retryCount=u),l}getLevelSwitchAction(e,t){const r=this.hls;t==null&&(t=r.loadLevel);const n=this.hls.levels[t];if(n){var s,a;const l=e.details;n.loadError++,l===Q.BUFFER_APPEND_ERROR&&n.fragmentError++;let h=-1;const{levels:d,loadLevel:p,minAutoLevel:g,maxAutoLevel:m}=r;!r.autoLevelEnabled&&!r.config.preserveManualLevelOnError&&(r.loadLevel=-1);const v=(s=e.frag)==null?void 0:s.type,x=(v===Oe.AUDIO&&l===Q.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(l===Q.BUFFER_ADD_CODEC_ERROR||l===Q.BUFFER_APPEND_ERROR))&&d.some(({audioCodec:N})=>n.audioCodec!==N),R=e.sourceBufferName==="video"&&(l===Q.BUFFER_ADD_CODEC_ERROR||l===Q.BUFFER_APPEND_ERROR)&&d.some(({codecSet:N,audioCodec:C})=>n.codecSet!==N&&n.audioCodec===C),{type:_,groupId:F}=(a=e.context)!=null?a:{};for(let N=d.length;N--;){const C=(N+p)%d.length;if(C!==p&&C>=g&&C<=m&&d[C].loadError===0){var o,u;const M=d[C];if(l===Q.FRAG_GAP&&v===Oe.MAIN&&e.frag){const L=d[C].details;if(L){const I=Ys(e.frag,L.fragments,e.frag.start);if(I!=null&&I.gap)continue}}else{if(_===ot.AUDIO_TRACK&&M.hasAudioGroup(F)||_===ot.SUBTITLE_TRACK&&M.hasSubtitleGroup(F))continue;if(v===Oe.AUDIO&&(o=n.audioGroups)!=null&&o.some(L=>M.hasAudioGroup(L))||v===Oe.SUBTITLE&&(u=n.subtitleGroups)!=null&&u.some(L=>M.hasSubtitleGroup(L))||x&&n.audioCodec===M.audioCodec||!x&&n.audioCodec!==M.audioCodec||R&&n.codecSet===M.codecSet)continue}h=C;break}}if(h>-1&&r.loadLevel!==h)return e.levelRetry=!0,this.playlistError=0,{action:Sr.SendAlternateToPenaltyBox,flags:Ni.None,nextAutoLevel:h}}return{action:Sr.SendAlternateToPenaltyBox,flags:Ni.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var r;switch((r=t.errorAction)==null?void 0:r.action){case Sr.DoNothing:break;case Sr.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==Q.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,r=e.errorAction;if(!r)return;const{flags:n,hdcpLevel:s,nextAutoLevel:a}=r;switch(n){case Ni.None:this.switchLevel(e,a);break;case Ni.MoveAllAlternatesMatchingHDCP:s&&(t.maxHdcpLevel=lg[lg.indexOf(s)-1],r.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}r.resolved||this.switchLevel(e,a)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===Q.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const r=YE(e.mimeType),n=this.hls.levels;for(let s=n.length;s--;)n[s][`${e.sourceBufferName}Codec`]===r&&this.hls.removeLevel(s)}}}function tl(i){const e={action:Sr.DoNothing,flags:Ni.None};return i&&(e.resolved=!0),e}var tr={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class rL{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.BUFFER_APPENDED,this.onBufferAppended,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this),e.on(b.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.BUFFER_APPENDED,this.onBufferAppended,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this),e.off(b.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const r=this.activePartLists[t];if(r)for(let n=r.length;n--;){const s=r[n];if(!s)break;const a=s.end;if(s.start<=e&&a!==null&&e<=a)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,r){const{fragments:n}=this,s=Object.keys(n);for(let a=s.length;a--;){const o=n[s[a]];if((o==null?void 0:o.body.type)===t&&(!r||o.buffered)){const u=o.body;if(u.start<=e&&e<=u.end)return u}}return null}detectEvictedFragments(e,t,r,n,s){this.timeRanges&&(this.timeRanges[e]=t);const a=(n==null?void 0:n.fragment.sn)||-1;Object.keys(this.fragments).forEach(o=>{const u=this.fragments[o];if(!u||a>=u.body.sn)return;if(!u.buffered&&(!u.loaded||s)){u.body.type===r&&this.removeFragment(u.body);return}const l=u.range[e];if(l){if(l.time.length===0){this.removeFragment(u.body);return}l.time.some(h=>{const d=!this.isTimeBuffered(h.startPTS,h.endPTS,t);return d&&this.removeFragment(u.body),d})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const r=e.frag,n=Ka(r),s=this.fragments[n];if(!s||s.buffered&&r.gap)return;const a=!r.relurl;Object.keys(t).forEach(o=>{const u=r.elementaryStreams[o];if(!u)return;const l=t[o],h=a||u.partial===!0;s.range[o]=this.getBufferedTimes(r,e.part,h,l)}),s.loaded=null,Object.keys(s.range).length?(s.buffered=!0,(s.body.endList=r.endList||s.body.endList)&&(this.endListFragments[s.body.type]=s),Vu(s)||this.removeParts(r.sn-1,r.type)):this.removeFragment(s.body)}removeParts(e,t){const r=this.activePartLists[t];r&&(this.activePartLists[t]=u2(r,n=>n.fragment.sn>=e))}fragBuffered(e,t){const r=Ka(e);let n=this.fragments[r];!n&&t&&(n=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),n&&(n.loaded=null,n.buffered=!0)}getBufferedTimes(e,t,r,n){const s={time:[],partial:r},a=e.start,o=e.end,u=e.minEndPTS||o,l=e.maxStartPTS||a;for(let h=0;h<n.length;h++){const d=n.start(h)-this.bufferPadding,p=n.end(h)+this.bufferPadding;if(l>=d&&u<=p){s.time.push({startPTS:Math.max(a,n.start(h)),endPTS:Math.min(o,n.end(h))});break}else if(a<p&&o>d){const g=Math.max(a,n.start(h)),m=Math.min(o,n.end(h));m>g&&(s.partial=!0,s.time.push({startPTS:g,endPTS:m}))}else if(o<=d)break}return s}getPartialFragment(e){let t=null,r,n,s,a=0;const{bufferPadding:o,fragments:u}=this;return Object.keys(u).forEach(l=>{const h=u[l];h&&Vu(h)&&(n=h.body.start-o,s=h.body.end+o,e>=n&&e<=s&&(r=Math.min(e-n,s-e),a<=r&&(t=h.body,a=r)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||Vu(t))}getState(e){const t=Ka(e),r=this.fragments[t];return r?r.buffered?Vu(r)?tr.PARTIAL:tr.OK:tr.APPENDING:tr.NOT_LOADED}isTimeBuffered(e,t,r){let n,s;for(let a=0;a<r.length;a++){if(n=r.start(a)-this.bufferPadding,s=r.end(a)+this.bufferPadding,e>=n&&t<=s)return!0;if(t<=n)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const r=t.frag,n=t.part?null:t,s=Ka(r);this.fragments[s]={body:r,appendedPTS:null,loaded:n,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:r,part:n,timeRanges:s,type:a}=t;if(r.sn==="initSegment")return;const o=r.type;if(n){let l=this.activePartLists[o];l||(this.activePartLists[o]=l=[]),l.push(n)}this.timeRanges=s;const u=s[a];this.detectEvictedFragments(a,u,o,n)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Ka(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,r=Object.keys(t);if(!e)return r.length>0;for(let n=r.length;n--;){const s=t[r[n]];if((s==null?void 0:s.body.type)===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,r,n,s){n&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{const o=this.fragments[a];if(!o)return;const u=o.body;u.type!==r||n&&!u.gap||u.start<t&&u.end>e&&(o.buffered||s)&&this.removeFragment(u)})}removeFragment(e){const t=Ka(e);e.clearElementaryStreamInfo();const r=this.activePartLists[e.type];if(r){const n=e.sn;this.activePartLists[e.type]=u2(r,s=>s.fragment.sn!==n)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e,t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const r=(e=this.hls)==null||(t=e.latestLevelDetails)==null?void 0:t.partList;r&&r.forEach(n=>n.clearElementaryStreamInfo())}}function Vu(i){var e,t,r;return i.buffered&&(i.body.gap||((e=i.range.video)==null?void 0:e.partial)||((t=i.range.audio)==null?void 0:t.partial)||((r=i.range.audiovideo)==null?void 0:r.partial))}function Ka(i){return`${i.type}_${i.level}_${i.sn}`}function u2(i,e){return i.filter(t=>{const r=e(t);return r||t.clearElementaryStreamInfo(),r})}var cs={cbc:0,ctr:1};class iL{constructor(e,t,r){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=r}decrypt(e,t){switch(this.aesMode){case cs.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case cs.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function nL(i){const e=i.byteLength,t=e&&new DataView(i.buffer).getUint8(e-1);return t?i.slice(0,e-t):i}class sL{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),r=new Uint32Array(4);for(let n=0;n<4;n++)r[n]=t.getUint32(n*4);return r}initTable(){const e=this.sBox,t=this.invSBox,r=this.subMix,n=r[0],s=r[1],a=r[2],o=r[3],u=this.invSubMix,l=u[0],h=u[1],d=u[2],p=u[3],g=new Uint32Array(256);let m=0,v=0,E=0;for(E=0;E<256;E++)E<128?g[E]=E<<1:g[E]=E<<1^283;for(E=0;E<256;E++){let x=v^v<<1^v<<2^v<<3^v<<4;x=x>>>8^x&255^99,e[m]=x,t[x]=m;const T=g[m],R=g[T],_=g[R];let F=g[x]*257^x*16843008;n[m]=F<<24|F>>>8,s[m]=F<<16|F>>>16,a[m]=F<<8|F>>>24,o[m]=F,F=_*16843009^R*65537^T*257^m*16843008,l[x]=F<<24|F>>>8,h[x]=F<<16|F>>>16,d[x]=F<<8|F>>>24,p[x]=F,m?(m=T^g[g[g[_^T]]],v^=g[g[v]]):m=v=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let r=!0,n=0;for(;n<t.length&&r;)r=t[n]===this.key[n],n++;if(r)return;this.key=t;const s=this.keySize=t.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);const a=this.ksRows=(s+6+1)*4;let o,u;const l=this.keySchedule=new Uint32Array(a),h=this.invKeySchedule=new Uint32Array(a),d=this.sBox,p=this.rcon,g=this.invSubMix,m=g[0],v=g[1],E=g[2],x=g[3];let T,R;for(o=0;o<a;o++){if(o<s){T=l[o]=t[o];continue}R=T,o%s===0?(R=R<<8|R>>>24,R=d[R>>>24]<<24|d[R>>>16&255]<<16|d[R>>>8&255]<<8|d[R&255],R^=p[o/s|0]<<24):s>6&&o%s===4&&(R=d[R>>>24]<<24|d[R>>>16&255]<<16|d[R>>>8&255]<<8|d[R&255]),l[o]=T=(l[o-s]^R)>>>0}for(u=0;u<a;u++)o=a-u,u&3?R=l[o]:R=l[o-4],u<4||o<=4?h[u]=R:h[u]=m[d[R>>>24]]^v[d[R>>>16&255]]^E[d[R>>>8&255]]^x[d[R&255]],h[u]=h[u]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,r){const n=this.keySize+6,s=this.invKeySchedule,a=this.invSBox,o=this.invSubMix,u=o[0],l=o[1],h=o[2],d=o[3],p=this.uint8ArrayToUint32Array_(r);let g=p[0],m=p[1],v=p[2],E=p[3];const x=new Int32Array(e),T=new Int32Array(x.length);let R,_,F,N,C,M,L,I,U,q,$,X,ie,ne;const ue=this.networkToHostOrderSwap;for(;t<x.length;){for(U=ue(x[t]),q=ue(x[t+1]),$=ue(x[t+2]),X=ue(x[t+3]),C=U^s[0],M=X^s[1],L=$^s[2],I=q^s[3],ie=4,ne=1;ne<n;ne++)R=u[C>>>24]^l[M>>16&255]^h[L>>8&255]^d[I&255]^s[ie],_=u[M>>>24]^l[L>>16&255]^h[I>>8&255]^d[C&255]^s[ie+1],F=u[L>>>24]^l[I>>16&255]^h[C>>8&255]^d[M&255]^s[ie+2],N=u[I>>>24]^l[C>>16&255]^h[M>>8&255]^d[L&255]^s[ie+3],C=R,M=_,L=F,I=N,ie=ie+4;R=a[C>>>24]<<24^a[M>>16&255]<<16^a[L>>8&255]<<8^a[I&255]^s[ie],_=a[M>>>24]<<24^a[L>>16&255]<<16^a[I>>8&255]<<8^a[C&255]^s[ie+1],F=a[L>>>24]<<24^a[I>>16&255]<<16^a[C>>8&255]<<8^a[M&255]^s[ie+2],N=a[I>>>24]<<24^a[C>>16&255]<<16^a[M>>8&255]<<8^a[L&255]^s[ie+3],T[t]=ue(R^g),T[t+1]=ue(N^m),T[t+2]=ue(F^v),T[t+3]=ue(_^E),g=U,m=q,v=$,E=X,t=t+4}return T.buffer}}class aL{constructor(e,t,r){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=r}expandKey(){const e=oL(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function oL(i){switch(i){case cs.cbc:return"AES-CBC";case cs.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${i}`)}}const lL=16;class cg{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const r=self.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const r=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?nL(r):r}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,r,n){return this.useSoftware?new Promise((s,a)=>{const o=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(o,t,r,n);const u=this.flush();u?s(u.buffer):a(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,r,n)}softwareDecrypt(e,t,r,n){const{currentIV:s,currentResult:a,remainderData:o}=this;if(n!==cs.cbc||t.byteLength!==16)return yt.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),o&&(e=hi(o,e),this.remainderData=null);const u=this.getValidChunk(e);if(!u.length)return null;s&&(r=s);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new sL),l.expandKey(t);const h=a;return this.currentResult=l.decrypt(u.buffer,0,r),this.currentIV=u.slice(-16).buffer,h||null}webCryptoDecrypt(e,t,r,n){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,r,n));this.key=t,this.fastAesKey=new aL(this.subtle,t,n)}return this.fastAesKey.expandKey().then(s=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new iL(this.subtle,new Uint8Array(r),n).decrypt(e.buffer,s)):Promise.reject(new Error("web crypto not initialized"))).catch(s=>(yt.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${s.name}: ${s.message}`),this.onWebCryptoError(e,t,r,n)))}onWebCryptoError(e,t,r,n){const s=this.enableSoftwareAES;if(s){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r,n);const a=this.flush();if(a)return a.buffer}throw new Error("WebCrypto"+(s?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const r=e.length-e.length%lL;return r!==e.length&&(t=e.slice(0,r),this.remainderData=e.slice(r)),t}logOnce(e){this.logEnabled&&(yt.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const c2=Math.pow(2,17);class uL{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const r=e.url;if(!r)return Promise.reject(new wn({type:ke.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${r?"part list":"url"}`),networkDetails:null}));this.abort();const n=this.config,s=n.fLoader,a=n.loader;return new Promise((o,u)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(m=>m[0]==="GAP")){u(d2(e));return}else e.gap=!1;const l=this.loader=s?new s(n):new a(n),h=h2(e);e.loader=l;const d=l2(n.fragLoadPolicy.default),p={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:c2};e.stats=l.stats;const g={onSuccess:(m,v,E,x)=>{this.resetLoader(e,l);let T=m.data;E.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(T.slice(0,16)),T=T.slice(16)),o({frag:e,part:null,payload:T,networkDetails:x})},onError:(m,v,E,x)=>{this.resetLoader(e,l),u(new wn({type:ke.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:At({url:r,data:void 0},m),error:new Error(`HTTP Error ${m.code} ${m.text}`),networkDetails:E,stats:x}))},onAbort:(m,v,E)=>{this.resetLoader(e,l),u(new wn({type:ke.NETWORK_ERROR,details:Q.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:E,stats:m}))},onTimeout:(m,v,E)=>{this.resetLoader(e,l),u(new wn({type:ke.NETWORK_ERROR,details:Q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:E,stats:m}))}};t&&(g.onProgress=(m,v,E,x)=>t({frag:e,part:null,payload:E,networkDetails:x})),l.load(h,p,g)})}loadPart(e,t,r){this.abort();const n=this.config,s=n.fLoader,a=n.loader;return new Promise((o,u)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){u(d2(e,t));return}const l=this.loader=s?new s(n):new a(n),h=h2(e,t);e.loader=l;const d=l2(n.fragLoadPolicy.default),p={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:c2};t.stats=l.stats,l.load(h,p,{onSuccess:(g,m,v,E)=>{this.resetLoader(e,l),this.updateStatsFromPart(e,t);const x={frag:e,part:t,payload:g.data,networkDetails:E};r(x),o(x)},onError:(g,m,v,E)=>{this.resetLoader(e,l),u(new wn({type:ke.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:At({url:h.url,data:void 0},g),error:new Error(`HTTP Error ${g.code} ${g.text}`),networkDetails:v,stats:E}))},onAbort:(g,m,v)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,l),u(new wn({type:ke.NETWORK_ERROR,details:Q.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:v,stats:g}))},onTimeout:(g,m,v)=>{this.resetLoader(e,l),u(new wn({type:ke.NETWORK_ERROR,details:Q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:v,stats:g}))}})})}updateStatsFromPart(e,t){const r=e.stats,n=t.stats,s=n.total;if(r.loaded+=n.loaded,s){const u=Math.round(e.duration/t.duration),l=Math.min(Math.round(r.loaded/s),u),d=(u-l)*Math.round(r.loaded/l);r.total=r.loaded+d}else r.total=Math.max(r.loaded,r.total);const a=r.loading,o=n.loading;a.start?a.first+=o.first-o.start:(a.start=o.start,a.first=o.first),a.end=o.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function h2(i,e=null){const t=e||i,r={frag:i,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},n=t.byteRangeStartOffset,s=t.byteRangeEndOffset;if(Ce(n)&&Ce(s)){var a;let o=n,u=s;if(i.sn==="initSegment"&&cL((a=i.decryptdata)==null?void 0:a.method)){const l=s-n;l%16&&(u=s+(16-l%16)),n!==0&&(r.resetIV=!0,o=n-16)}r.rangeStart=o,r.rangeEnd=u}return r}function d2(i,e){const t=new Error(`GAP ${i.gap?"tag":"attribute"} found`),r={type:ke.MEDIA_ERROR,details:Q.FRAG_GAP,fatal:!1,frag:i,error:t,networkDetails:null};return e&&(r.part=e),(e||i).stats.aborted=!0,new wn(r)}function cL(i){return i==="AES-128"||i==="AES-256"}class wn extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class f2 extends In{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class hg{constructor(e,t,r,n=0,s=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Ku(),this.buffering={audio:Ku(),video:Ku(),audiovideo:Ku()},this.level=e,this.sn=t,this.id=r,this.size=n,this.part=s,this.partial=a}}function Ku(){return{start:0,executeStart:0,executeEnd:0,end:0}}const g2={length:0,start:()=>0,end:()=>0};class Xe{static isBuffered(e,t){if(e){const r=Xe.getBuffered(e);for(let n=r.length;n--;)if(t>=r.start(n)&&t<=r.end(n))return!0}return!1}static bufferedRanges(e){if(e){const t=Xe.getBuffered(e);return Xe.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}static bufferInfo(e,t,r){if(e){const n=Xe.bufferedRanges(e);if(n.length)return Xe.bufferedInfo(n,t,r)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,r){t=Math.max(0,t),e.length>1&&e.sort((h,d)=>h.start-d.start||d.end-h.end);let n=-1,s=[];if(r)for(let h=0;h<e.length;h++){t>=e[h].start&&t<=e[h].end&&(n=h);const d=s.length;if(d){const p=s[d-1].end;e[h].start-p<r?e[h].end>p&&(s[d-1].end=e[h].end):s.push(e[h])}else s.push(e[h])}else s=e;let a=0,o,u=t,l=t;for(let h=0;h<s.length;h++){const d=s[h].start,p=s[h].end;if(n===-1&&t>=d&&t<=p&&(n=h),t+r>=d&&t<p)u=d,l=p,a=l-t;else if(t+r<d){o=d;break}}return{len:a,start:u||0,end:l||0,nextStart:o,buffered:e,bufferedIndex:n}}static getBuffered(e){try{return e.buffered||g2}catch(t){return yt.log("failed to get media.buffered",t),g2}}}const p2=/\{\$([a-zA-Z0-9-_]+)\}/g;function m2(i){return p2.test(i)}function dg(i,e){if(i.variableList!==null||i.hasVariableRefs){const t=i.variableList;return e.replace(p2,r=>{const n=r.substring(2,r.length-1),s=t==null?void 0:t[n];return s===void 0?(i.playlistParsingError||(i.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${n}"`)),r):s})}return e}function y2(i,e,t){let r=i.variableList;r||(i.variableList=r={});let n,s;if("QUERYPARAM"in e){n=e.QUERYPARAM;try{const a=new self.URL(t).searchParams;if(a.has(n))s=a.get(n);else throw new Error(`"${n}" does not match any query parameter in URI: "${t}"`)}catch(a){i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else n=e.NAME,s=e.VALUE;n in r?i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${n}"`)):r[n]=s||""}function hL(i,e,t){const r=e.IMPORT;if(t&&r in t){let n=i.variableList;n||(i.variableList=n={}),n[r]=t[r]}else i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${r}"`))}const dL=/^(\d+)x(\d+)$/,v2=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Gt{constructor(e,t){typeof e=="string"&&(e=Gt.parseAttrList(e,t)),Tt(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const r=new Uint8Array(t.length/2);for(let n=0;n<t.length/2;n++)r[n]=parseInt(t.slice(n*2,n*2+2),16);return r}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const r=this[e];return r?parseFloat(r):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const r=this[e];return(r?r.split(/[ ,]+/):[]).reduce((n,s)=>(n[s.toLowerCase()]=!0,n),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=dL.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let r;const n={},s='"';for(v2.lastIndex=0;(r=v2.exec(e))!==null;){const a=r[1].trim();let o=r[2];const u=o.indexOf(s)===0&&o.lastIndexOf(s)===o.length-1;let l=!1;if(u)o=o.slice(1,-1);else switch(a){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":l=!0}if(t&&(u||l))o=dg(t,o);else if(!l&&!u)switch(a){case"CLOSED-CAPTIONS":if(o==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":yt.warn(`${e}: attribute ${a} is missing quotes`)}n[a]=o}return n}}const fL="com.apple.hls.interstitial";function gL(i){return i!=="ID"&&i!=="CLASS"&&i!=="CUE"&&i!=="START-DATE"&&i!=="DURATION"&&i!=="END-DATE"&&i!=="END-ON-NEXT"}function pL(i){return i==="SCTE35-OUT"||i==="SCTE35-IN"||i==="SCTE35-CMD"}class E2{constructor(e,t,r=0){var n;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(t==null?void 0:t.tagAnchor)||null,this.tagOrder=(n=t==null?void 0:t.tagOrder)!=null?n:r,t){const s=t.attr;for(const a in s)if(Object.prototype.hasOwnProperty.call(e,a)&&e[a]!==s[a]){yt.warn(`DATERANGE tag attribute: "${a}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=a;break}e=Tt(new Gt({}),s,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const s=(t==null?void 0:t.endDate)||new Date(this.attr["END-DATE"]);Ce(s.getTime())&&(this._endDate=s)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(yt.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(Ce(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===fL}get isValid(){return!!this.id&&!this._badValueForSameId&&Ce(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const mL=10;class yL{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&r>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}get hasProgramDateTime(){return this.fragments.length?Ce(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||mL}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let r=e.length;r--;)if(e[r].index>t)return e[r].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function Wa(i){return i==="AES-128"||i==="AES-256"||i==="AES-256-CTR"}function fg(i){switch(i){case"AES-128":case"AES-256":return cs.cbc;case"AES-256-CTR":return cs.ctr;default:throw new Error(`invalid full segment method ${i}`)}}function gg(i){return Uint8Array.from(atob(i),e=>e.charCodeAt(0))}function pg(i){return Uint8Array.from(unescape(encodeURIComponent(i)),e=>e.charCodeAt(0))}function vL(i){const e=pg(i).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function EL(i){const e=function(r,n,s){const a=r[n];r[n]=r[s],r[s]=a};e(i,0,3),e(i,1,2),e(i,4,5),e(i,6,7)}function AL(i){const e=i.split(":");let t=null;if(e[0]==="data"&&e.length===2){const r=e[1].split(";"),n=r[r.length-1].split(",");if(n.length===2){const s=n[0]==="base64",a=n[1];s?(r.splice(-1,1),t=gg(a)):t=vL(a)}}return t}const Wu=typeof self<"u"?self:void 0;var xt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Hr={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Yu(i){switch(i){case Hr.FAIRPLAY:return xt.FAIRPLAY;case Hr.PLAYREADY:return xt.PLAYREADY;case Hr.WIDEVINE:return xt.WIDEVINE;case Hr.CLEARKEY:return xt.CLEARKEY}}var Xu={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function mg(i){if(i===Xu.WIDEVINE)return xt.WIDEVINE;if(i===Xu.PLAYREADY)return xt.PLAYREADY;if(i===Xu.CENC||i===Xu.CLEARKEY)return xt.CLEARKEY}function zu(i){switch(i){case xt.FAIRPLAY:return Hr.FAIRPLAY;case xt.PLAYREADY:return Hr.PLAYREADY;case xt.WIDEVINE:return Hr.WIDEVINE;case xt.CLEARKEY:return Hr.CLEARKEY}}function rl(i){const{drmSystems:e,widevineLicenseUrl:t}=i,r=e?[xt.FAIRPLAY,xt.WIDEVINE,xt.PLAYREADY,xt.CLEARKEY].filter(n=>!!e[n]):[];return!r[xt.WIDEVINE]&&t&&r.push(xt.WIDEVINE),r}const A2=function(i){return Wu!=null&&(i=Wu.navigator)!=null&&i.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function xL(i,e,t,r){let n;switch(i){case xt.FAIRPLAY:n=["cenc","sinf"];break;case xt.WIDEVINE:case xt.PLAYREADY:n=["cenc"];break;case xt.CLEARKEY:n=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${i}`)}return SL(n,e,t,r)}function SL(i,e,t,r){return[{initDataTypes:i,persistentState:r.persistentState||"optional",distinctiveIdentifier:r.distinctiveIdentifier||"optional",sessionTypes:r.sessionTypes||[r.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs=${s}`,robustness:r.audioRobustness||"",encryptionScheme:r.audioEncryptionScheme||null})),videoCapabilities:t.map(s=>({contentType:`video/mp4; codecs=${s}`,robustness:r.videoRobustness||"",encryptionScheme:r.videoEncryptionScheme||null}))}]}function bL(i){var e;return i.sessionType==="persistent-license"||!!((e=i.sessionTypes)!=null&&e.some(t=>t==="persistent-license"))}function x2(i){const e=new Uint16Array(i.buffer,i.byteOffset,i.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),r=t.substring(t.indexOf("<"),t.length),a=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("KID")[0];if(a){const o=a.childNodes[0]?a.childNodes[0].nodeValue:a.getAttribute("VALUE");if(o){const u=gg(o).subarray(0,16);return EL(u),u}}return null}let ju={};class il{static clearKeyUriToKeyIdMap(){ju={}}constructor(e,t,r,n=[1],s=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=n,this.iv=s,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!Wa(e)}isSupported(){if(this.method){if(Wa(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Hr.FAIRPLAY:case Hr.WIDEVINE:case Hr.PLAYREADY:case Hr.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(Wa(this.method)&&this.uri&&!this.iv){typeof e!="number"&&(yt.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const r=TL(e);return new il(this.method,this.uri,"identity",this.keyFormatVersions,r)}const t=AL(this.uri);if(t)switch(this.keyFormat){case Hr.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case Hr.PLAYREADY:{const r=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=NN(r,null,t),this.keyId=x2(t);break}default:{let r=t.subarray(0,16);if(r.length!==16){const n=new Uint8Array(16);n.set(r,16-r.length),r=n}this.keyId=r;break}}if(!this.keyId||this.keyId.byteLength!==16){let r=ju[this.uri];if(!r){const n=Object.keys(ju).length%Number.MAX_SAFE_INTEGER;r=new Uint8Array(16),new DataView(r.buffer,12,4).setUint32(0,n),ju[this.uri]=r}this.keyId=r}return this}}function TL(i){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=i>>8*(15-t)&255;return e}const S2=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,b2=/#EXT-X-MEDIA:(.*)/g,DL=/^#EXT(?:INF|-X-TARGETDURATION):/m,yg=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),RL=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class nn{static findGroup(e,t){for(let r=0;r<e.length;r++){const n=e[r];if(n.id===t)return n}}static resolve(e,t){return eg.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return DL.test(e)}static parseMasterPlaylist(e,t){const r=m2(e),n={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:r},s=[];S2.lastIndex=0;let a;for(;(a=S2.exec(e))!=null;)if(a[1]){var o;const l=new Gt(a[1],n),h=dg(n,a[2]),d={attrs:l,bitrate:l.decimalInteger("BANDWIDTH")||l.decimalInteger("AVERAGE-BANDWIDTH"),name:l.NAME,url:nn.resolve(h,t)},p=l.decimalResolution("RESOLUTION");p&&(d.width=p.width,d.height=p.height),I2(l.CODECS,d);const g=l["SUPPLEMENTAL-CODECS"];g&&(d.supplemental={},I2(g,d.supplemental)),(o=d.unknownCodecs)!=null&&o.length||s.push(d),n.levels.push(d)}else if(a[3]){const l=a[3],h=a[4];switch(l){case"SESSION-DATA":{const d=new Gt(h,n),p=d["DATA-ID"];p&&(n.sessionData===null&&(n.sessionData={}),n.sessionData[p]=d);break}case"SESSION-KEY":{const d=D2(h,t,n);d.encrypted&&d.isSupported()?(n.sessionKeys===null&&(n.sessionKeys=[]),n.sessionKeys.push(d)):yt.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${h}"`);break}case"DEFINE":{{const d=new Gt(h,n);y2(n,d,t)}break}case"CONTENT-STEERING":{const d=new Gt(h,n);n.contentSteering={uri:nn.resolve(d["SERVER-URI"],t),pathwayId:d["PATHWAY-ID"]||"."};break}case"START":{n.startTimeOffset=R2(h);break}}}const u=s.length>0&&s.length<n.levels.length;return n.levels=u?s:n.levels,n.levels.length===0&&(n.playlistParsingError=new Error("no levels found in manifest")),n}static parseMasterPlaylistMedia(e,t,r){let n;const s={},a=r.levels,o={AUDIO:a.map(l=>({id:l.attrs.AUDIO,audioCodec:l.audioCodec})),SUBTITLES:a.map(l=>({id:l.attrs.SUBTITLES,textCodec:l.textCodec})),"CLOSED-CAPTIONS":[]};let u=0;for(b2.lastIndex=0;(n=b2.exec(e))!==null;){const l=new Gt(n[1],r),h=l.TYPE;if(h){const d=o[h],p=s[h]||[];s[h]=p;const g=l.LANGUAGE,m=l["ASSOC-LANGUAGE"],v=l.CHANNELS,E=l.CHARACTERISTICS,x=l["INSTREAM-ID"],T={attrs:l,bitrate:0,id:u++,groupId:l["GROUP-ID"]||"",name:l.NAME||g||"",type:h,default:l.bool("DEFAULT"),autoselect:l.bool("AUTOSELECT"),forced:l.bool("FORCED"),lang:g,url:l.URI?nn.resolve(l.URI,t):""};if(m&&(T.assocLang=m),v&&(T.channels=v),E&&(T.characteristics=E),x&&(T.instreamId=x),d!=null&&d.length){const R=nn.findGroup(d,T.groupId)||d[0];w2(T,R,"audioCodec"),w2(T,R,"textCodec")}p.push(T)}}return s}static parseLevelPlaylist(e,t,r,n,s,a){var o;const u={url:t},l=new yL(t),h=l.fragments,d=[];let p=null,g=0,m=0,v=0,E=0,x=0,T=null,R=new rg(n,u),_,F,N,C=-1,M=!1,L=null,I;if(yg.lastIndex=0,l.m3u8=e,l.hasVariableRefs=m2(e),((o=yg.exec(e))==null?void 0:o[0])!=="#EXTM3U")return l.playlistParsingError=new Error("Missing format identifier #EXTM3U"),l;for(;(_=yg.exec(e))!==null;){M&&(M=!1,R=new rg(n,u),R.playlistOffset=v,R.start=v,R.sn=g,R.cc=E,x&&(R.bitrate=x),R.level=r,p&&(R.initSegment=p,p.rawProgramDateTime&&(R.rawProgramDateTime=p.rawProgramDateTime,p.rawProgramDateTime=null),L&&(R.setByteRange(L),L=null)));const X=_[1];if(X){R.duration=parseFloat(X);const ie=(" "+_[2]).slice(1);R.title=ie||null,R.tagList.push(ie?["INF",X,ie]:["INF",X])}else if(_[3]){if(Ce(R.duration)){R.playlistOffset=v,R.start=v,N&&N2(R,N,l),R.sn=g,R.level=r,R.cc=E,h.push(R);const ie=(" "+_[3]).slice(1);R.relurl=dg(l,ie),vg(R,T,d),T=R,v+=R.duration,g++,m=0,M=!0}}else{if(_=_[0].match(RL),!_){yt.warn("No matches on slow regex match for level playlist!");continue}for(F=1;F<_.length&&_[F]===void 0;F++);const ie=(" "+_[F]).slice(1),ne=(" "+_[F+1]).slice(1),ue=_[F+2]?(" "+_[F+2]).slice(1):null;switch(ie){case"BYTERANGE":T?R.setByteRange(ne,T):R.setByteRange(ne);break;case"PROGRAM-DATE-TIME":R.rawProgramDateTime=ne,R.tagList.push(["PROGRAM-DATE-TIME",ne]),C===-1&&(C=h.length);break;case"PLAYLIST-TYPE":l.type&&Cn(l,ie,_),l.type=ne.toUpperCase();break;case"MEDIA-SEQUENCE":l.startSN!==0?Cn(l,ie,_):h.length>0&&L2(l,ie,_),g=l.startSN=parseInt(ne);break;case"SKIP":{l.skippedSegments&&Cn(l,ie,_);const re=new Gt(ne,l),V=re.decimalInteger("SKIPPED-SEGMENTS");if(Ce(V)){l.skippedSegments+=V;for(let ve=V;ve--;)h.push(null);g+=V}const J=re.enumeratedString("RECENTLY-REMOVED-DATERANGES");J&&(l.recentlyRemovedDateranges=(l.recentlyRemovedDateranges||[]).concat(J.split("	")));break}case"TARGETDURATION":l.targetduration!==0&&Cn(l,ie,_),l.targetduration=Math.max(parseInt(ne),1);break;case"VERSION":l.version!==null&&Cn(l,ie,_),l.version=parseInt(ne);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":l.live||Cn(l,ie,_),l.live=!1;break;case"#":(ne||ue)&&R.tagList.push(ue?[ne,ue]:[ne]);break;case"DISCONTINUITY":E++,R.tagList.push(["DIS"]);break;case"GAP":R.gap=!0,R.tagList.push([ie]);break;case"BITRATE":R.tagList.push([ie,ne]),x=parseInt(ne)*1e3,Ce(x)?R.bitrate=x:x=0;break;case"DATERANGE":{const re=new Gt(ne,l),V=new E2(re,l.dateRanges[re.ID],l.dateRangeTagCount);l.dateRangeTagCount++,V.isValid||l.skippedSegments?l.dateRanges[V.id]=V:yt.warn(`Ignoring invalid DATERANGE tag: "${ne}"`),R.tagList.push(["EXT-X-DATERANGE",ne]);break}case"DEFINE":{{const re=new Gt(ne,l);"IMPORT"in re?hL(l,re,a):y2(l,re,t)}break}case"DISCONTINUITY-SEQUENCE":l.startCC!==0?Cn(l,ie,_):h.length>0&&L2(l,ie,_),l.startCC=E=parseInt(ne);break;case"KEY":{const re=D2(ne,t,l);if(re.isSupported()){if(re.method==="NONE"){N=void 0;break}N||(N={}),N[re.keyFormat]&&(N=Tt({},N)),N[re.keyFormat]=re}else yt.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${ne}"`);break}case"START":l.startTimeOffset=R2(ne);break;case"MAP":{const re=new Gt(ne,l);if(R.duration){const V=new rg(n,u);C2(V,re,r,N),p=V,R.initSegment=p,p.rawProgramDateTime&&!R.rawProgramDateTime&&(R.rawProgramDateTime=p.rawProgramDateTime)}else{const V=R.byteRangeEndOffset;if(V){const J=R.byteRangeStartOffset;L=`${V-J}@${J}`}else L=null;C2(R,re,r,N),p=R,M=!0}p.cc=E;break}case"SERVER-CONTROL":{I&&Cn(l,ie,_),I=new Gt(ne),l.canBlockReload=I.bool("CAN-BLOCK-RELOAD"),l.canSkipUntil=I.optionalFloat("CAN-SKIP-UNTIL",0),l.canSkipDateRanges=l.canSkipUntil>0&&I.bool("CAN-SKIP-DATERANGES"),l.partHoldBack=I.optionalFloat("PART-HOLD-BACK",0),l.holdBack=I.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{l.partTarget&&Cn(l,ie,_);const re=new Gt(ne);l.partTarget=re.decimalFloatingPoint("PART-TARGET");break}case"PART":{let re=l.partList;re||(re=l.partList=[]);const V=m>0?re[re.length-1]:void 0,J=m++,ve=new Gt(ne,l),de=new mN(ve,R,u,J,V);re.push(de),R.duration+=de.duration;break}case"PRELOAD-HINT":{const re=new Gt(ne,l);l.preloadHint=re;break}case"RENDITION-REPORT":{const re=new Gt(ne,l);l.renditionReports=l.renditionReports||[],l.renditionReports.push(re);break}default:yt.warn(`line parsed but not handled: ${_}`);break}}}T&&!T.relurl?(h.pop(),v-=T.duration,l.partList&&(l.fragmentHint=T)):l.partList&&(vg(R,T,d),R.cc=E,l.fragmentHint=R,N&&N2(R,N,l)),l.targetduration||(l.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));const U=h.length,q=h[0],$=h[U-1];if(v+=l.skippedSegments*l.targetduration,v>0&&U&&$){l.averagetargetduration=v/U;const X=$.sn;l.endSN=X!=="initSegment"?X:0,l.live||($.endList=!0),q&&l.startCC===void 0&&(l.startCC=q.cc),C>0&&(wL(h,C),q&&d.unshift(q))}else l.endSN=0,l.startCC=0;return l.fragmentHint&&(v+=l.fragmentHint.duration),l.totalduration=v,d.length&&l.dateRangeTagCount&&q&&T2(d,l),l.endCC=E,l}}function T2(i,e){const t=i.length;if(!t)return;const r=i[t-1],n=e.live?1/0:e.totalduration,s=Object.keys(e.dateRanges);for(let a=s.length;a--;){const o=e.dateRanges[s[a]],u=o.startDate.getTime();o.tagAnchor=r.ref;for(let l=t;l--;){const h=IL(e,u,i,l,n);if(h!==-1){o.tagAnchor=e.fragments[h].ref;break}}}}function IL(i,e,t,r,n){const s=t[r];if(s){const o=s.programDateTime;if(e>=o||r===0){var a;const u=(((a=t[r+1])==null?void 0:a.start)||n)-s.start;if(e<=o+u*1e3){const l=t[r].sn-i.startSN,h=i.fragments;if(h.length>t.length){const p=(t[r+1]||h[h.length-1]).sn-i.startSN;for(let g=p;g>l;g--){const m=h[g].programDateTime;if(e>=m&&e<m+h[g].duration*1e3)return g}}return l}}}return-1}function D2(i,e,t){var r,n;const s=new Gt(i,t),a=(r=s.METHOD)!=null?r:"",o=s.URI,u=s.hexadecimalInteger("IV"),l=s.KEYFORMATVERSIONS,h=(n=s.KEYFORMAT)!=null?n:"identity";o&&s.IV&&!u&&yt.error(`Invalid IV: ${s.IV}`);const d=o?nn.resolve(o,e):"",p=(l||"1").split("/").map(Number).filter(Number.isFinite);return new il(a,d,h,p,u)}function R2(i){const t=new Gt(i).decimalFloatingPoint("TIME-OFFSET");return Ce(t)?t:null}function I2(i,e){let t=(i||"").split(/[ ,]+/).filter(r=>r);["video","audio","text"].forEach(r=>{const n=t.filter(s=>HE(s,r));n.length&&(e[`${r}Codec`]=n.map(s=>s.split("/")[0]).join(","),t=t.filter(s=>n.indexOf(s)===-1))}),e.unknownCodecs=t}function w2(i,e,t){const r=e[t];r&&(i[t]=r)}function wL(i,e){let t=i[e];for(let r=e;r--;){const n=i[r];if(!n)return;n.programDateTime=t.programDateTime-n.duration*1e3,t=n}}function vg(i,e,t){i.rawProgramDateTime?t.push(i):e!=null&&e.programDateTime&&(i.programDateTime=e.endProgramDateTime)}function C2(i,e,t,r){i.relurl=e.URI,e.BYTERANGE&&i.setByteRange(e.BYTERANGE),i.level=t,i.sn="initSegment",r&&(i.levelkeys=r),i.initSegment=null}function N2(i,e,t){i.levelkeys=e;const{encryptedFragments:r}=t;(!r.length||r[r.length-1].levelkeys!==e)&&Object.keys(e).some(n=>e[n].isCommonEncryption)&&r.push(i)}function Cn(i,e,t){i.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function L2(i,e,t){i.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function Eg(i,e){const t=e.startPTS;if(Ce(t)){let r=0,n;e.sn>i.sn?(r=t-i.start,n=i):(r=i.start-t,n=e),n.duration!==r&&n.setDuration(r)}else e.sn>i.sn?i.cc===e.cc&&i.minEndPTS?e.setStart(i.start+(i.minEndPTS-i.start)):e.setStart(i.start+i.duration):e.setStart(Math.max(i.start-e.duration,0))}function _2(i,e,t,r,n,s){r-t<=0&&(yt.warn("Fragment should have a positive duration",e),r=t+e.duration,s=n+e.duration);let o=t,u=r;const l=e.startPTS,h=e.endPTS;if(Ce(l)){const E=Math.abs(l-t);Ce(e.deltaPTS)?e.deltaPTS=Math.max(E,e.deltaPTS):e.deltaPTS=E,o=Math.max(t,l),t=Math.min(t,l),n=Math.min(n,e.startDTS),u=Math.min(r,h),r=Math.max(r,h),s=Math.max(s,e.endDTS)}const d=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(r-e.start),e.startPTS=t,e.maxStartPTS=o,e.startDTS=n,e.endPTS=r,e.minEndPTS=u,e.endDTS=s;const p=e.sn;if(!i||p<i.startSN||p>i.endSN)return 0;let g;const m=p-i.startSN,v=i.fragments;for(v[m]=e,g=m;g>0;g--)Eg(v[g],v[g-1]);for(g=m;g<v.length-1;g++)Eg(v[g],v[g+1]);return i.fragmentHint&&Eg(v[v.length-1],i.fragmentHint),i.PTSKnown=i.alignedSliding=!0,d}function CL(i,e){if(i===e)return;let t=null;const r=i.fragments;for(let l=r.length-1;l>=0;l--){const h=r[l].initSegment;if(h){t=h;break}}i.fragmentHint&&delete i.fragmentHint.endPTS;let n;_L(i,e,(l,h,d,p)=>{if((!e.startCC||e.skippedSegments)&&h.cc!==l.cc){const g=l.cc-h.cc;for(let m=d;m<p.length;m++)p[m].cc+=g;e.endCC=p[p.length-1].cc}Ce(l.startPTS)&&Ce(l.endPTS)&&(h.setStart(h.startPTS=l.startPTS),h.startDTS=l.startDTS,h.maxStartPTS=l.maxStartPTS,h.endPTS=l.endPTS,h.endDTS=l.endDTS,h.minEndPTS=l.minEndPTS,h.setDuration(l.endPTS-l.startPTS),h.duration&&(n=h),e.PTSKnown=e.alignedSliding=!0),l.hasStreams&&(h.elementaryStreams=l.elementaryStreams),h.loader=l.loader,l.hasStats&&(h.stats=l.stats),l.initSegment&&(h.initSegment=l.initSegment,t=l.initSegment)});const s=e.fragments,a=e.fragmentHint?s.concat(e.fragmentHint):s;if(t&&a.forEach(l=>{var h;l&&(!l.initSegment||l.initSegment.relurl===((h=t)==null?void 0:h.relurl))&&(l.initSegment=t)}),e.skippedSegments){if(e.deltaUpdateFailed=s.some(l=>!l),e.deltaUpdateFailed){yt.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let l=e.skippedSegments;l--;)s.shift();e.startSN=s[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=NL(i.dateRanges,e));const l=i.fragments.filter(h=>h.rawProgramDateTime);if(i.hasProgramDateTime&&!e.hasProgramDateTime)for(let h=1;h<a.length;h++)a[h].programDateTime===null&&vg(a[h],a[h-1],l);T2(l,e)}e.endCC=s[s.length-1].cc}if(!e.startCC){var o;const l=k2(i,e.startSN-1);e.startCC=(o=l==null?void 0:l.cc)!=null?o:s[0].cc}LL(i.partList,e.partList,(l,h)=>{h.elementaryStreams=l.elementaryStreams,h.stats=l.stats}),n?_2(e,n,n.startPTS,n.endPTS,n.startDTS,n.endDTS):O2(i,e),s.length&&(e.totalduration=e.edge-s[0].start),e.driftStartTime=i.driftStartTime,e.driftStart=i.driftStart;const u=e.advancedDateTime;if(e.advanced&&u){const l=e.edge;e.driftStart||(e.driftStartTime=u,e.driftStart=l),e.driftEndTime=u,e.driftEnd=l}else e.driftEndTime=i.driftEndTime,e.driftEnd=i.driftEnd,e.advancedDateTime=i.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=i.requestScheduled)}function NL(i,e){const{dateRanges:t,recentlyRemovedDateranges:r}=e,n=Tt({},i);r&&r.forEach(o=>{delete n[o]});const a=Object.keys(n).length;return a&&Object.keys(t).forEach(o=>{const u=n[o],l=new E2(t[o].attr,u);l.isValid?(n[o]=l,u||(l.tagOrder+=a)):yt.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${Bt(t[o].attr)}"`)}),n}function LL(i,e,t){if(i&&e){let r=0;for(let n=0,s=i.length;n<=s;n++){const a=i[n],o=e[n+r];a&&o&&a.index===o.index&&a.fragment.sn===o.fragment.sn?t(a,o):r--}}}function _L(i,e,t){const r=e.skippedSegments,n=Math.max(i.startSN,e.startSN)-e.startSN,s=(i.fragmentHint?1:0)+(r?e.endSN:Math.min(i.endSN,e.endSN))-e.startSN,a=e.startSN-i.startSN,o=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,u=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments;for(let l=n;l<=s;l++){const h=u[a+l];let d=o[l];if(r&&!d&&h&&(d=e.fragments[l]=h),h&&d){if(t(h,d,l,o),h.url&&h.url!==d.url){e.playlistParsingError=M2(`media sequence mismatch ${d.sn}:`,i,e,h,d);return}else if(h.cc!==d.cc){e.playlistParsingError=M2(`discontinuity sequence mismatch (${h.cc}!=${d.cc})`,i,e,h,d);return}}}}function M2(i,e,t,r,n){return new Error(`${i} ${n.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function O2(i,e,t=!0){const r=e.startSN+e.skippedSegments-i.startSN,n=i.fragments,s=r>=0;let a=0;if(s&&r<n.length)a=n[r].start;else if(s&&e.startSN===i.endSN+1)a=i.fragmentEnd;else if(s&&t)a=i.fragmentStart+r*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)a=i.fragmentStart;else return;Ag(e,a)}function Ag(i,e){if(e){const t=i.fragments;for(let r=i.skippedSegments;r<t.length;r++)t[r].addStart(e);i.fragmentHint&&i.fragmentHint.addStart(e)}}function P2(i,e=1/0){let t=1e3*i.targetduration;if(i.updated){const r=i.fragments;if(r.length&&t*4>e){const s=r[r.length-1].duration*1e3;s<t&&(t=s)}}else t/=2;return Math.round(t)}function k2(i,e,t){if(!i)return null;let r=i.fragments[e-i.startSN];return r||(r=i.fragmentHint,r&&r.sn===e)?r:e<i.startSN&&t&&t.sn===e?t:null}function F2(i,e,t){return i?B2(i.partList,e,t):null}function B2(i,e,t){if(i)for(let r=i.length;r--;){const n=i[r];if(n.index===t&&n.fragment.sn===e)return n}return null}function U2(i){i.forEach((e,t)=>{var r;(r=e.details)==null||r.fragments.forEach(n=>{n.level=t,n.initSegment&&(n.initSegment.level=t)})})}function nl(i,e){for(let r=0,n=i.length;r<n;r++){var t;if(((t=i[r])==null?void 0:t.cc)===e)return i[r]}return null}function ML(i,e){return!!(i&&e.startCC<i.endCC&&e.endCC>i.startCC)}function $2(i,e){if(i){const t=i.start+e;i.start=i.startPTS=t,i.endPTS=t+i.duration}}function G2(i,e){const t=e.fragments;for(let r=0,n=t.length;r<n;r++)$2(t[r],i);e.fragmentHint&&$2(e.fragmentHint,i),e.alignedSliding=!0}function OL(i,e){i&&(q2(e,i),!e.alignedSliding&&i&&Ju(e,i),!e.alignedSliding&&i&&!e.skippedSegments&&O2(i,e,!1))}function q2(i,e){if(!ML(e,i))return;const t=Math.min(e.endCC,i.endCC),r=nl(e.fragments,t),n=nl(i.fragments,t);if(!r||!n)return;yt.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const s=r.start-n.start;G2(s,i)}function Ju(i,e){if(!i.hasProgramDateTime||!e.hasProgramDateTime)return;const t=i.fragments,r=e.fragments;if(!t.length||!r.length)return;let n,s;const a=Math.min(e.endCC,i.endCC);e.startCC<a&&i.startCC<a&&(n=nl(r,a),s=nl(t,a)),(!n||!s)&&(n=r[Math.floor(r.length/2)],s=nl(t,n.cc)||t[Math.floor(t.length/2)]);const o=n.programDateTime,u=s.programDateTime;if(!o||!u)return;const l=(u-o)/1e3-(s.start-n.start);G2(l,i)}const PL={toString:function(i){let e="";const t=i.length;for(let r=0;r<t;r++)e+=`[${i.start(r).toFixed(3)}-${i.end(r).toFixed(3)}]`;return e}},oe={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class xg extends f2{constructor(e,t,r,n,s){super(n,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=oe.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:a,fragCurrent:o,media:u,mediaBuffer:l,state:h}=this,d=u?u.currentTime:0,p=Xe.bufferInfo(l||u,d,a.maxBufferHole);if(this.log(`media seeking to ${Ce(d)?d.toFixed(3):d}, state: ${h}`),this.state===oe.ENDED)this.resetLoadingState();else if(o){const g=a.maxFragLookUpTolerance,m=o.start-g,v=o.start+o.duration+g;if(!p.len||v<p.start||m>p.end){const E=d>v;(d<m||E)&&(E&&o.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),o.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(u){this.fragmentTracker.removeFragmentsInRange(d,1/0,this.playlistType,!0);const g=this.lastCurrentTime;if(d>g&&(this.lastCurrentTime=d),!this.loadingParts){const m=Math.max(p.end,d),v=this.shouldLoadParts(this.getLevelDetails(),m);v&&(this.log(`LL-Part loading ON after seeking to ${d.toFixed(2)} with buffer @${m.toFixed(2)}`),this.loadingParts=v)}}!this.hls.hasEnoughToStart&&!p.len&&(this.log(`setting startPosition to ${d} because of seek before start`),this.nextLoadPosition=this.startPosition=d),this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=s,this.hls=e,this.fragmentLoader=new uL(e.config),this.keyLoader=r,this.fragmentTracker=t,this.config=e.config,this.decrypter=new cg(e.config)}registerListeners(){const{hls:e}=this;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(b.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===oe.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=oe.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const r=e.end||0,n=this.config.timelineOffset||0;if(r<=n)return!1;const s=e.buffered;this.config.maxBufferHole&&s&&s.length>1&&(e=Xe.bufferedInfo(s,e.start,0));const a=e.nextStart;if(a&&a>n&&a<t.edge||this.media.currentTime<e.start)return!1;const u=t.partList;if(u!=null&&u.length){const h=u[u.length-1];return Xe.isBuffered(this.media,h.start+h.duration/2)}const l=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(l)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const r=this.media=this.mediaBuffer=t.media;r.removeEventListener("seeking",this.onMediaSeeking),r.removeEventListener("ended",this.onMediaEnded),r.addEventListener("seeking",this.onMediaSeeking),r.addEventListener("ended",this.onMediaEnded);const n=this.config;this.levels&&n.autoStartLoad&&this.state===oe.STOPPED&&this.startLoad(n.startPosition)}onMediaDetaching(e,t){const r=!!t.transferMedia,n=this.media;if(n!==null){if(n.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),n.removeEventListener("seeking",this.onMediaSeeking),n.removeEventListener("ended",this.onMediaEnded),this.keyLoader&&!r&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,r){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=oe.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,r){this.startFragRequested=!0,this._loadFragForPlayback(e,t,r)}_loadFragForPlayback(e,t,r){const n=s=>{const a=s.frag;if(this.fragContextChanged(a)){this.warn(`${a.type} sn: ${a.sn}${s.part?" part: "+s.part.index:""} of ${this.fragInfo(a,!1,s.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(a);return}a.stats.chunkCount++,this._handleFragmentLoadProgress(s)};this._doFragLoad(e,t,r,n).then(s=>{if(!s)return;const a=this.state,o=s.frag;if(this.fragContextChanged(o)){(a===oe.FRAG_LOADING||!this.fragCurrent&&a===oe.PARSING)&&(this.fragmentTracker.removeFragment(o),this.state=oe.IDLE);return}"payload"in s&&(this.log(`Loaded ${o.type} sn: ${o.sn} of ${this.playlistLabel()} ${o.level}`),this.hls.trigger(b.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s)}).catch(s=>{this.state===oe.STOPPED||this.state===oe.ERROR||(this.warn(`Frag error: ${(s==null?void 0:s.message)||s}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:r}=this;if(r.getState(e)===tr.APPENDING){const s=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,s),o=Math.max(e.duration,a?a.len:this.config.maxBufferLength),u=this.backtrackFragment;((u?e.sn-u.sn:0)===1||this.reduceMaxBufferLength(o,e.duration))&&r.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===tr.PARTIAL&&r.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(t==null?void 0:t.live)&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,r=null){if(!(e-t))return;const n={startOffset:e,endOffset:t,type:r};this.hls.trigger(b.BUFFER_FLUSHING,n)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(r=>{const n=r==null?void 0:r.frag;if(!n||this.fragContextChanged(n)||!this.levels)throw new Error("init load aborted");return r}).then(r=>{const{hls:n}=this,{frag:s,payload:a}=r,o=s.decryptdata;if(a&&a.byteLength>0&&o!=null&&o.key&&o.iv&&Wa(o.method)){const u=self.performance.now();return this.decrypter.decrypt(new Uint8Array(a),o.key.buffer,o.iv.buffer,fg(o.method)).catch(l=>{throw n.trigger(b.ERROR,{type:ke.MEDIA_ERROR,details:Q.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:s}),l}).then(l=>{const h=self.performance.now();return n.trigger(b.FRAG_DECRYPTED,{frag:s,payload:l,stats:{tstart:u,tdecrypt:h}}),r.payload=l,this.completeInitSegmentLoad(r)})}return this.completeInitSegmentLoad(r)}).catch(r=>{this.state===oe.STOPPED||this.state===oe.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const r=e.frag.stats;this.state!==oe.STOPPED&&(this.state=oe.IDLE),e.frag.data=new Uint8Array(e.payload),r.parsing.start=r.buffering.start=self.performance.now(),r.parsing.end=r.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const r=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${r?PL.toString(Xe.getBuffered(r)):"(detached)"})`),lr(e)){var n;if(e.type!==Oe.SUBTITLE){const a=e.elementaryStreams;if(!Object.keys(a).some(o=>!!a[o])){this.state=oe.IDLE;return}}const s=(n=this.levels)==null?void 0:n[e.level];s!=null&&s.fragmentError&&(this.log(`Resetting level fragment error count of ${s.fragmentError} on frag buffered`),s.fragmentError=0)}this.state=oe.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:r,part:n,partsLoaded:s}=e,a=!s||s.length===0||s.some(u=>!u),o=new hg(r.level,r.sn,r.stats.chunkCount+1,0,n?n.index:-1,!a);t.flush(o)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,r=null,n){var s;this.fragCurrent=e;const a=t==null?void 0:t.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let o=null;e.encrypted&&!((s=e.decryptdata)!=null&&s.key)?(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=oe.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then(d=>{if(!this.fragContextChanged(d.frag))return this.hls.trigger(b.KEY_LOADED,d),this.state===oe.KEY_LOADING&&(this.state=oe.IDLE),d}),this.hls.trigger(b.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(o=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):e.encrypted||(o=this.keyLoader.loadClear(e,a.encryptedFragments),o&&this.log("[eme] blocking frag load until media-keys acquired"));const u=this.fragPrevious;if(lr(e)&&(!u||e.sn!==u.sn)){const d=this.shouldLoadParts(t.details,e.end);d!==this.loadingParts&&(this.log(`LL-Part loading ${d?"ON":"OFF"} loading sn ${u==null?void 0:u.sn}->${e.sn}`),this.loadingParts=d)}if(r=Math.max(e.start,r||0),this.loadingParts&&lr(e)){const d=a.partList;if(d&&n){r>e.end&&a.fragmentHint&&(e=a.fragmentHint);const p=this.getNextPart(d,e,r);if(p>-1){const g=d[p];e=this.fragCurrent=g.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${g.index} (${p}/${d.length-1}) of ${this.fragInfo(e,!1,g)}) cc: ${e.cc} [${a.startSN}-${a.endSN}], target: ${parseFloat(r.toFixed(3))}`),this.nextLoadPosition=g.start+g.duration,this.state=oe.FRAG_LOADING;let m;return o?m=o.then(v=>!v||this.fragContextChanged(v.frag)?null:this.doFragPartsLoad(e,g,t,n)).catch(v=>this.handleFragLoadError(v)):m=this.doFragPartsLoad(e,g,t,n).catch(v=>this.handleFragLoadError(v)),this.hls.trigger(b.FRAG_LOADING,{frag:e,part:g,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):m}else if(!e.url||this.loadedEndOfParts(d,r))return Promise.resolve(null)}}if(lr(e)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${r.toFixed(2)}`),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${a?"["+a.startSN+"-"+a.endSN+"]":""}, target: ${parseFloat(r.toFixed(3))}`),Ce(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=oe.FRAG_LOADING;const l=this.config.progressive;let h;return l&&o?h=o.then(d=>!d||this.fragContextChanged(d==null?void 0:d.frag)?null:this.fragmentLoader.load(e,n)).catch(d=>this.handleFragLoadError(d)):h=Promise.all([this.fragmentLoader.load(e,l?n:void 0),o]).then(([d])=>(!l&&d&&n&&n(d),d)).catch(d=>this.handleFragLoadError(d)),this.hls.trigger(b.FRAG_LOADING,{frag:e,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):h}doFragPartsLoad(e,t,r,n){return new Promise((s,a)=>{var o;const u=[],l=(o=r.details)==null?void 0:o.partList,h=d=>{this.fragmentLoader.loadPart(e,d,n).then(p=>{u[d.index]=p;const g=p.part;this.hls.trigger(b.FRAG_LOADED,p);const m=F2(r.details,e.sn,d.index+1)||B2(l,e.sn,d.index+1);if(m)h(m);else return s({frag:e,part:g,partsLoaded:u})}).catch(a)};h(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===Q.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(b.ERROR,t)}else this.hls.trigger(b.ERROR,{type:ke.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==oe.PARSING){!this.fragCurrent&&this.state!==oe.STOPPED&&this.state!==oe.ERROR&&(this.state=oe.IDLE);return}const{frag:r,part:n,level:s}=t,a=self.performance.now();r.stats.parsing.end=a,n&&(n.stats.parsing.end=a);const o=this.getLevelDetails(),l=o&&r.sn>o.endSN||this.shouldLoadParts(o,r.end);l!==this.loadingParts&&(this.log(`LL-Part loading ${l?"ON":"OFF"} after parsing segment ending @${r.end.toFixed(2)}`),this.loadingParts=l),this.updateLevelTiming(r,n,s,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e!=null&&e.partList){var r;const s=e.partList[0],a=s.end+(((r=e.fragmentHint)==null?void 0:r.duration)||0);if(t>=a){var n;if((this.hls.hasEnoughToStart?((n=this.media)==null?void 0:n.currentTime)||this.lastCurrentTime:this.getLoadPosition())>s.start-s.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:r}=this,{level:n,sn:s,part:a}=e;if(!(t!=null&&t[n]))return this.warn(`Levels object was unset while buffering fragment ${s} of ${this.playlistLabel()} ${n}. The current chunk will not be buffered.`),null;const o=t[n],u=o.details,l=a>-1?F2(u,s,a):null,h=l?l.fragment:k2(u,s,r);return h?(r&&r!==h&&(h.stats=r.stats),{frag:h,part:l,level:o}):null}bufferFragmentData(e,t,r,n,s){var a;if(!e||this.state!==oe.PARSING)return;const{data1:o,data2:u}=e;let l=o;if(o&&u&&(l=hi(o,u)),!((a=l)!=null&&a.length))return;const h={type:e.type,frag:t,part:r,chunkMeta:n,parent:t.type,data:l};if(this.hls.trigger(b.BUFFER_APPENDING,h),e.dropped&&e.independent&&!r){if(s)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Xe.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const r=t.currentTime,n=Xe.bufferInfo(t,r,0),s=e.duration,a=Math.min(this.config.maxFragLookUpTolerance*2,s*.25),o=Math.max(Math.min(e.start-a,n.end-a),r+a);e.start-o>a&&this.flushMainBuffer(o,e.start)}getFwdBufferInfo(e,t){var r;const n=this.getLoadPosition();if(!Ce(n))return null;const a=this.lastCurrentTime>n||(r=this.media)!=null&&r.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,n,t,a)}getFwdBufferInfoAtPos(e,t,r,n){const s=Xe.bufferInfo(e,t,n);if(s.len===0&&s.nextStart!==void 0){const a=this.fragmentTracker.getBufferedFrag(t,r);if(a&&(s.nextStart<=a.end||a.gap)){const o=Math.max(Math.min(s.nextStart,a.end)-t,n);return Xe.bufferInfo(e,t,o)}}return s}getMaxBufferLength(e){const{config:t}=this;let r;return e?r=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):r=t.maxBufferLength,Math.min(r,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const r=this.config,n=Math.max(Math.min(e-t,r.maxBufferLength),t),s=Math.max(e-t*3,r.maxMaxBufferLength/2,n);return s>=n?(r.maxMaxBufferLength=s,this.warn(`Reduce max buffer length to ${s}s`),!0):!1}getAppendedFrag(e,t=Oe.MAIN){var r;const n=(r=this.fragmentTracker)==null?void 0:r.getAppendedFrag(e,t);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const r=t.fragments,n=r.length;if(!n)return null;const{config:s}=this,a=r[0].start,o=s.lowLatencyMode&&!!t.partList;let u=null;if(t.live){const d=s.initialLiveManifestSize;if(n<d)return this.warn(`Not enough fragments to start playback (have: ${n}, need: ${d})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<a){var l;o&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),u=this.getInitialLiveFragment(t);const p=this.hls.startPosition,g=this.hls.liveSyncPosition,m=u?(p!==-1&&p>=a?p:g)||u.start:e;this.log(`Setting startPosition to ${m} to match start frag at live edge. mainStart: ${p} liveSyncPosition: ${g} frag.start: ${(l=u)==null?void 0:l.start}`),this.startPosition=this.nextLoadPosition=m}}else e<=a&&(u=r[0]);if(!u){const d=this.loadingParts?t.partEnd:t.fragmentEnd;u=this.getFragmentAtPosition(e,d,t)}let h=this.filterReplacedPrimary(u,t);if(!h&&u){const d=u.sn-t.startSN;h=this.filterReplacedPrimary(r[d+1]||null,t)}return this.mapToInitFragWhenRequired(h)}isLoopLoading(e,t){const r=this.fragmentTracker.getState(e);return(r===tr.OK||r===tr.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,r,n,s){let a=null;if(e.gap&&(a=this.getNextFragment(this.nextLoadPosition,t),a&&!a.gap&&r.nextStart)){const o=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,n,0);if(o!==null&&r.len+o.len>=s){const u=a.sn;return this.loopSn!==u&&(this.log(`buffer full after gaps in "${n}" playlist starting at sn: ${u}`),this.loopSn=u),null}}return this.loopSn=void 0,a}get primaryPrefetch(){if(H2(this.hls.config)){var e,t;if((e=this.hls.interstitialsManager)==null||(t=e.playingItem)==null?void 0:t.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(H2(this.hls.config)&&e.type!==Oe.SUBTITLE){const r=this.hls.interstitialsManager,n=r==null?void 0:r.bufferingItem;if(n){const a=n.event;if(a){if(a.appendInPlace||Math.abs(e.start-n.start)>1||n.start===0)return null}else if(e.end<=n.start&&(t==null?void 0:t.live)===!1||e.start>n.end&&n.nextEvent&&(n.nextEvent.appendInPlace||e.start-n.end>1))return null}const s=r==null?void 0:r.playerQueue;if(s)for(let a=s.length;a--;){const o=s[a].interstitial;if(o.appendInPlace&&e.start>=o.startTime&&e.end<=o.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,r){let n=-1,s=!1,a=!0;for(let o=0,u=e.length;o<u;o++){const l=e[o];if(a=a&&!l.independent,n>-1&&r<l.start)break;const h=l.loaded;h?n=-1:(s||l.independent||a)&&l.fragment===t&&(n=o),s=h}return n}loadedEndOfParts(e,t){const r=e[e.length-1];return r&&t>r.start&&r.loaded}getInitialLiveFragment(e){const t=e.fragments,r=this.fragPrevious;let n=null;if(r){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${r.programDateTime}`),n=JN(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!n){const s=r.sn+1;if(s>=e.startSN&&s<=e.endSN){const a=t[s-e.startSN];r.cc===a.cc&&(n=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${n.sn}`))}n||(n=a2(e,r.cc,r.end),n&&this.log(`Live playlist, switching playlist, load frag with same CC: ${n.sn}`))}}else{const s=this.hls.liveSyncPosition;s!==null&&(n=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return n}getFragmentAtPosition(e,t,r){const{config:n}=this;let{fragPrevious:s}=this,{fragments:a,endSN:o}=r;const{fragmentHint:u}=r,{maxFragLookUpTolerance:l}=n,h=r.partList,d=!!(this.loadingParts&&h!=null&&h.length&&u);d&&u&&!this.bitrateTest&&h[h.length-1].fragment.sn===u.sn&&(a=a.concat(u),o=u.sn);let p;if(e<t){var g;const v=e<this.lastCurrentTime||e>t-l||(g=this.media)!=null&&g.paused||!this.startFragRequested?0:l;p=Ys(s,a,e,v)}else p=a[a.length-1];if(p){const m=p.sn-r.startSN,v=this.fragmentTracker.getState(p);if((v===tr.OK||v===tr.PARTIAL&&p.gap)&&(s=p),s&&p.sn===s.sn&&(!d||h[0].fragment.sn>p.sn||!r.live&&!d)&&s&&p.level===s.level){const x=a[m+1];p.sn<o&&this.fragmentTracker.getState(x)!==tr.OK?p=x:p=null}}return p}alignPlaylists(e,t,r){const n=e.fragments.length;if(!n)return this.warn("No fragments in live playlist"),0;const s=e.fragmentStart,a=!t,o=e.alignedSliding&&Ce(s);if(a||!o&&!s){OL(r,e);const u=e.fragmentStart;return this.log(`Live playlist sliding: ${u.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${n}`),u}return s}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let r=this.startPosition;r<t&&(r=-1);const n=this.timelineOffset;if(r===-1){const s=this.startTimeOffset!==null,a=s?this.startTimeOffset:e.startTimeOffset;a!==null&&Ce(a)?(r=t+a,a<0&&(r+=e.edge),r=Math.min(Math.max(t,r),t+e.totalduration),this.log(`Setting startPosition to ${r} for start time offset ${a} found in ${s?"multivariant":"media"} playlist`),this.startPosition=r):e.live?(r=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${r}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=r=0),this.lastCurrentTime=r+n}this.nextLoadPosition=r+n}getLoadPosition(){var e;const{media:t}=this;let r=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?r=t.currentTime:this.nextLoadPosition>=0&&(r=this.nextLoadPosition),r}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&lr(e)&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==oe.FRAG_LOADING_WAITING_RETRY)&&(this.state=oe.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const m=this.getCurrentContext(t.chunkMeta);m&&(t.frag=m.frag)}const r=t.frag;if(!r||r.type!==e||!this.levels)return;if(this.fragContextChanged(r)){var n;this.warn(`Frag load error must match current frag to retry ${r.url} > ${(n=this.fragCurrent)==null?void 0:n.url}`);return}const s=t.details===Q.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(r,!0);const a=t.errorAction,{action:o,flags:u,retryCount:l=0,retryConfig:h}=a||{},d=!!a&&!!h,p=d&&o===Sr.RetryRequest,g=d&&!a.resolved&&u===Ni.MoveAllAlternatesMatchingHost;if(!p&&g&&lr(r)&&!r.endList)this.resetFragmentErrors(e),this.treatAsGap(r),a.resolved=!0;else if((p||g)&&l<h.maxNumRetry){this.resetStartWhenNotLoaded(this.levelLastLoaded);const m=ug(h,l);this.warn(`Fragment ${r.sn} of ${e} ${r.level} errored with ${t.details}, retrying loading ${l+1}/${h.maxNumRetry} in ${m}ms`),a.resolved=!0,this.retryDate=self.performance.now()+m,this.state=oe.FRAG_LOADING_WAITING_RETRY}else if(h&&a)if(this.resetFragmentErrors(e),l<h.maxNumRetry)!s&&o!==Sr.RemoveAlternatePermanently&&(a.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${l})`);return}else o===Sr.SendAlternateToPenaltyBox?this.state=oe.WAITING_LEVEL:this.state=oe.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===oe.PARSING||this.state===oe.PARSED){const t=e.frag,r=e.parent,n=this.getFwdBufferInfo(this.mediaBuffer,r),s=n&&n.len>.5;s&&this.reduceMaxBufferLength(n.len,(t==null?void 0:t.duration)||10);const a=!s;return a&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${r} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),a}return!1}resetFragmentErrors(e){e===Oe.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==oe.STOPPED&&(this.state=oe.IDLE)}afterBufferFlushed(e,t,r){if(!e)return;const n=Xe.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,n,r),this.state===oe.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==oe.STOPPED&&(this.state=oe.IDLE)}resetStartWhenNotLoaded(e){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of ${this.playlistLabel()} ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,r,n){const s=r.details;if(!s){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((u,l)=>{const h=e.elementaryStreams[l];if(h){const d=h.endPTS-h.startPTS;if(d<=0)return this.warn(`Could not parse fragment ${e.sn} ${l} duration reliably (${d})`),u||!1;const p=n?0:_2(s,e,h.startPTS,h.endPTS,h.startDTS,h.endDTS);return this.hls.trigger(b.LEVEL_PTS_UPDATED,{details:s,level:r,drift:p,type:l,frag:e,start:h.startPTS,end:h.endPTS}),!0}return u},!1)){var o;if(r.fragmentError===0&&this.treatAsGap(e,r),((o=this.transmuxer)==null?void 0:o.error)===null){const u=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(u.message),this.hls.trigger(b.ERROR,{type:ke.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,error:u,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${r.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=oe.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(b.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===Oe.MAIN?"level":"track"}fragInfo(e,t=!0,r){var n,s;return`${this.playlistLabel()} ${e.level} (${r?"part":"frag"}:[${((n=t&&!r?e.startPTS:(r||e).start)!=null?n:NaN).toFixed(3)}-${((s=t&&!r?e.endPTS:(r||e).end)!=null?s:NaN).toFixed(3)}]${r&&e.type==="main"?"INDEPENDENT="+(r.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function H2(i){return!!i.interstitialsController&&i.enableInterstitialPlayback!==!1}class V2{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let r;if(e.length)e.length===1?r=e[0]:r=kL(e,t);else return new Uint8Array(0);return this.reset(),r}reset(){this.chunks.length=0,this.dataLength=0}}function kL(i,e){const t=new Uint8Array(e);let r=0;for(let n=0;n<i.length;n++){const s=i[n];t.set(s,r),r+=s.length}return t}var Sg={exports:{}},K2;function FL(){return K2||(K2=1,function(i){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function n(u,l,h){this.fn=u,this.context=l,this.once=h||!1}function s(u,l,h,d,p){if(typeof h!="function")throw new TypeError("The listener must be a function");var g=new n(h,d||u,p),m=t?t+l:l;return u._events[m]?u._events[m].fn?u._events[m]=[u._events[m],g]:u._events[m].push(g):(u._events[m]=g,u._eventsCount++),u}function a(u,l){--u._eventsCount===0?u._events=new r:delete u._events[l]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],h,d;if(this._eventsCount===0)return l;for(d in h=this._events)e.call(h,d)&&l.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(h)):l},o.prototype.listeners=function(l){var h=t?t+l:l,d=this._events[h];if(!d)return[];if(d.fn)return[d.fn];for(var p=0,g=d.length,m=new Array(g);p<g;p++)m[p]=d[p].fn;return m},o.prototype.listenerCount=function(l){var h=t?t+l:l,d=this._events[h];return d?d.fn?1:d.length:0},o.prototype.emit=function(l,h,d,p,g,m){var v=t?t+l:l;if(!this._events[v])return!1;var E=this._events[v],x=arguments.length,T,R;if(E.fn){switch(E.once&&this.removeListener(l,E.fn,void 0,!0),x){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,h),!0;case 3:return E.fn.call(E.context,h,d),!0;case 4:return E.fn.call(E.context,h,d,p),!0;case 5:return E.fn.call(E.context,h,d,p,g),!0;case 6:return E.fn.call(E.context,h,d,p,g,m),!0}for(R=1,T=new Array(x-1);R<x;R++)T[R-1]=arguments[R];E.fn.apply(E.context,T)}else{var _=E.length,F;for(R=0;R<_;R++)switch(E[R].once&&this.removeListener(l,E[R].fn,void 0,!0),x){case 1:E[R].fn.call(E[R].context);break;case 2:E[R].fn.call(E[R].context,h);break;case 3:E[R].fn.call(E[R].context,h,d);break;case 4:E[R].fn.call(E[R].context,h,d,p);break;default:if(!T)for(F=1,T=new Array(x-1);F<x;F++)T[F-1]=arguments[F];E[R].fn.apply(E[R].context,T)}}return!0},o.prototype.on=function(l,h,d){return s(this,l,h,d,!1)},o.prototype.once=function(l,h,d){return s(this,l,h,d,!0)},o.prototype.removeListener=function(l,h,d,p){var g=t?t+l:l;if(!this._events[g])return this;if(!h)return a(this,g),this;var m=this._events[g];if(m.fn)m.fn===h&&(!p||m.once)&&(!d||m.context===d)&&a(this,g);else{for(var v=0,E=[],x=m.length;v<x;v++)(m[v].fn!==h||p&&!m[v].once||d&&m[v].context!==d)&&E.push(m[v]);E.length?this._events[g]=E.length===1?E[0]:E:a(this,g)}return this},o.prototype.removeAllListeners=function(l){var h;return l?(h=t?t+l:l,this._events[h]&&a(this,h)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,i.exports=o}(Sg)),Sg.exports}var BL=FL(),bg=gN(BL);const sl="1.6.5",Ya={};function UL(){return typeof __HLS_WORKER_BUNDLE__=="function"}function $L(){const i=Ya[sl];if(i)return i.clientCount++,i;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),n={worker:new self.Worker(t),objectURL:t,clientCount:1};return Ya[sl]=n,n}function GL(i){const e=Ya[i];if(e)return e.clientCount++,e;const t=new self.URL(i,self.location.href).href,n={worker:new self.Worker(t),scriptURL:t,clientCount:1};return Ya[i]=n,n}function qL(i){const e=Ya[i||sl];if(e&&e.clientCount--===1){const{worker:r,objectURL:n}=e;delete Ya[i||sl],n&&self.URL.revokeObjectURL(n),r.terminate()}}function W2(i,e){return e+10<=i.length&&i[e]===51&&i[e+1]===68&&i[e+2]===73&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128}function Tg(i,e){return e+10<=i.length&&i[e]===73&&i[e+1]===68&&i[e+2]===51&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128}function Qu(i,e){let t=0;return t=(i[e]&127)<<21,t|=(i[e+1]&127)<<14,t|=(i[e+2]&127)<<7,t|=i[e+3]&127,t}function al(i,e){const t=e;let r=0;for(;Tg(i,e);){r+=10;const n=Qu(i,e+6);r+=n,W2(i,e+10)&&(r+=10),e+=r}if(r>0)return i.subarray(t,t+r)}function HL(i,e,t,r){const n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],s=e[t+2],a=s>>2&15;if(a>12){const g=new Error(`invalid ADTS sampling index:${a}`);i.emit(b.ERROR,b.ERROR,{type:ke.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!0,error:g,reason:g.message});return}const o=(s>>6&3)+1,u=e[t+3]>>6&3|(s&1)<<2,l="mp4a.40."+o,h=n[a];let d=a;(o===5||o===29)&&(d-=3);const p=[o<<3|(d&14)>>1,(d&1)<<7|u<<3];return yt.log(`manifest codec:${r}, parsed codec:${l}, channels:${u}, rate:${h} (ADTS object type:${o} sampling index:${a})`),{config:p,samplerate:h,channelCount:u,codec:l,parsedCodec:l,manifestCodec:r}}function Y2(i,e){return i[e]===255&&(i[e+1]&246)===240}function X2(i,e){return i[e+1]&1?7:9}function Dg(i,e){return(i[e+3]&3)<<11|i[e+4]<<3|(i[e+5]&224)>>>5}function VL(i,e){return e+5<i.length}function Zu(i,e){return e+1<i.length&&Y2(i,e)}function KL(i,e){return VL(i,e)&&Y2(i,e)&&Dg(i,e)<=i.length-e}function WL(i,e){if(Zu(i,e)){const t=X2(i,e);if(e+t>=i.length)return!1;const r=Dg(i,e);if(r<=t)return!1;const n=e+r;return n===i.length||Zu(i,n)}return!1}function z2(i,e,t,r,n){if(!i.samplerate){const s=HL(e,t,r,n);if(!s)return;Tt(i,s)}}function j2(i){return 9216e4/i}function YL(i,e){const t=X2(i,e);if(e+t<=i.length){const r=Dg(i,e)-t;if(r>0)return{headerLength:t,frameLength:r}}}function J2(i,e,t,r,n){const s=j2(i.samplerate),a=r+n*s,o=YL(e,t);let u;if(o){const{frameLength:d,headerLength:p}=o,g=p+d,m=Math.max(0,t+g-e.length);m?(u=new Uint8Array(g-p),u.set(e.subarray(t+p,e.length),0)):u=e.subarray(t+p,t+g);const v={unit:u,pts:a};return m||i.samples.push(v),{sample:v,length:g,missing:m}}const l=e.length-t;return u=new Uint8Array(l),u.set(e.subarray(t,e.length),0),{sample:{unit:u,pts:a},length:l,missing:-1}}function XL(i,e){return Tg(i,e)&&Qu(i,e+6)+10<=i.length-e}function zL(i){return i instanceof ArrayBuffer?i:i.byteOffset==0&&i.byteLength==i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer}function Rg(i,e=0,t=1/0){return jL(i,e,t,Uint8Array)}function jL(i,e,t,r){const n=JL(i);let s=1;"BYTES_PER_ELEMENT"in r&&(s=r.BYTES_PER_ELEMENT);const a=QL(i)?i.byteOffset:0,o=(a+i.byteLength)/s,u=(a+e)/s,l=Math.floor(Math.max(0,Math.min(u,o))),h=Math.floor(Math.min(l+Math.max(t,0),o));return new r(n,l,h-l)}function JL(i){return i instanceof ArrayBuffer?i:i.buffer}function QL(i){return i&&i.buffer instanceof ArrayBuffer&&i.byteLength!==void 0&&i.byteOffset!==void 0}function ZL(i){const e={key:i.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(i.size<2)return;if(i.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const r=i.data.subarray(1).indexOf(0);if(r===-1)return;const n=Qr(Rg(i.data,1,r)),s=i.data[2+r],a=i.data.subarray(3+r).indexOf(0);if(a===-1)return;const o=Qr(Rg(i.data,3+r,a));let u;return n==="-->"?u=Qr(Rg(i.data,4+r+a)):u=zL(i.data.subarray(4+r+a)),e.mimeType=n,e.pictureType=s,e.description=o,e.data=u,e}function e_(i){if(i.size<2)return;const e=Qr(i.data,!0),t=new Uint8Array(i.data.subarray(e.length+1));return{key:i.type,info:e,data:t.buffer}}function t_(i){if(i.size<2)return;if(i.type==="TXXX"){let t=1;const r=Qr(i.data.subarray(t),!0);t+=r.length+1;const n=Qr(i.data.subarray(t));return{key:i.type,info:r,data:n}}const e=Qr(i.data.subarray(1));return{key:i.type,info:"",data:e}}function r_(i){if(i.type==="WXXX"){if(i.size<2)return;let t=1;const r=Qr(i.data.subarray(t),!0);t+=r.length+1;const n=Qr(i.data.subarray(t));return{key:i.type,info:r,data:n}}const e=Qr(i.data);return{key:i.type,info:"",data:e}}function i_(i){return i.type==="PRIV"?e_(i):i.type[0]==="W"?r_(i):i.type==="APIC"?ZL(i):t_(i)}function n_(i){const e=String.fromCharCode(i[0],i[1],i[2],i[3]),t=Qu(i,4),r=10;return{type:e,size:t,data:i.subarray(r,r+t)}}const ec=10,s_=10;function Q2(i){let e=0;const t=[];for(;Tg(i,e);){const r=Qu(i,e+6);i[e+5]>>6&1&&(e+=ec),e+=ec;const n=e+r;for(;e+s_<n;){const s=n_(i.subarray(e)),a=i_(s);a&&t.push(a),e+=s.size+ec}W2(i,e)&&(e+=ec)}return t}function Z2(i){return i&&i.key==="PRIV"&&i.info==="com.apple.streaming.transportStreamTimestamp"}function a_(i){if(i.data.byteLength===8){const e=new Uint8Array(i.data),t=e[3]&1;let r=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return r/=45,t&&(r+=4772185884e-2),Math.round(r)}}function Ig(i){const e=Q2(i);for(let t=0;t<e.length;t++){const r=e[t];if(Z2(r))return a_(r)}}let Zr=function(i){return i.audioId3="org.id3",i.dateRange="com.apple.quicktime.HLS",i.emsg="https://aomedia.org/emsg/ID3",i.misbklv="urn:misb:KLV:bin:1910.1",i}({});function sn(i="",e=9e4){return{type:i,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class wg{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,r,n){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,r){}demux(e,t){this.cachedData&&(e=hi(this.cachedData,e),this.cachedData=null);let r=al(e,0),n=r?r.length:0,s;const a=this._audioTrack,o=this._id3Track,u=r?Ig(r):void 0,l=e.length;for((this.basePTS===null||this.frameIndex===0&&Ce(u))&&(this.basePTS=o_(u,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),r&&r.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Zr.audioId3,duration:Number.POSITIVE_INFINITY});n<l;){if(this.canParse(e,n)){const h=this.appendFrame(a,e,n);h?(this.frameIndex++,this.lastPTS=h.sample.pts,n+=h.length,s=n):n=l}else XL(e,n)?(r=al(e,n),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Zr.audioId3,duration:Number.POSITIVE_INFINITY}),n+=r.length,s=n):n++;if(n===l&&s!==l){const h=e.slice(s);this.cachedData?this.cachedData=hi(this.cachedData,h):this.cachedData=h}}return{audioTrack:a,videoTrack:sn(),id3Track:o,textTrack:sn()}}demuxSampleAes(e,t,r){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:sn(),id3Track:this._id3Track,textTrack:sn()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const o_=(i,e,t)=>{if(Ce(i))return i*90;const r=t?t.baseTime*9e4/t.timescale:0;return e*9e4+r};let tc=null;const l_=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],u_=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],c_=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],h_=[0,1,1,4];function eA(i,e,t,r,n){if(t+24>e.length)return;const s=tA(e,t);if(s&&t+s.frameLength<=e.length){const a=s.samplesPerFrame*9e4/s.sampleRate,o=r+n*a,u={unit:e.subarray(t,t+s.frameLength),pts:o,dts:o};return i.config=[],i.channelCount=s.channelCount,i.samplerate=s.sampleRate,i.samples.push(u),{sample:u,length:s.frameLength,missing:0}}}function tA(i,e){const t=i[e+1]>>3&3,r=i[e+1]>>1&3,n=i[e+2]>>4&15,s=i[e+2]>>2&3;if(t!==1&&n!==0&&n!==15&&s!==3){const a=i[e+2]>>1&1,o=i[e+3]>>6,u=t===3?3-r:r===3?3:4,l=l_[u*14+n-1]*1e3,d=u_[(t===3?0:t===2?1:2)*3+s],p=o===3?1:2,g=c_[t][r],m=h_[r],v=g*8*m,E=Math.floor(g*l/d+a)*m;if(tc===null){const R=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);tc=R?parseInt(R[1]):0}return!!tc&&tc<=87&&r===2&&l>=224e3&&o===0&&(i[e+3]=i[e+3]|128),{sampleRate:d,channelCount:p,frameLength:E,samplesPerFrame:v}}}function Cg(i,e){return i[e]===255&&(i[e+1]&224)===224&&(i[e+1]&6)!==0}function rA(i,e){return e+1<i.length&&Cg(i,e)}function d_(i,e){return Cg(i,e)&&4<=i.length-e}function iA(i,e){if(e+1<i.length&&Cg(i,e)){const r=tA(i,e);let n=4;r!=null&&r.frameLength&&(n=r.frameLength);const s=e+n;return s===i.length||rA(i,s)}return!1}class f_ extends wg{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,r,n){super.resetInitSegment(e,t,r,n),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const r=al(e,0);let n=(r==null?void 0:r.length)||0;if(iA(e,n))return!1;for(let s=e.length;n<s;n++)if(WL(e,n))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return KL(e,t)}appendFrame(e,t,r){z2(e,this.observer,t,r,e.manifestCodec);const n=J2(e,t,r,this.basePTS,this.frameIndex);if(n&&n.missing===0)return n}}const nA=(i,e)=>{let t=0,r=5;e+=r;const n=new Uint32Array(1),s=new Uint32Array(1),a=new Uint8Array(1);for(;r>0;){a[0]=i[e];const o=Math.min(r,8),u=8-o;s[0]=4278190080>>>24+u<<u,n[0]=(a[0]&s[0])>>u,t=t?t<<o|n[0]:n[0],e+=1,r-=o}return t};class g_ extends wg{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,r,n){super.resetInitSegment(e,t,r,n),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,r){const n=sA(e,t,r,this.basePTS,this.frameIndex);if(n!==-1)return{sample:e.samples[e.samples.length-1],length:n,missing:0}}static probe(e){if(!e)return!1;const t=al(e,0);if(!t)return!1;const r=t.length;return e[r]===11&&e[r+1]===119&&Ig(t)!==void 0&&nA(e,r)<16}}function sA(i,e,t,r,n){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const s=e[t+4]>>6;if(s>=3)return-1;const o=[48e3,44100,32e3][s],u=e[t+4]&63,h=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][u*3+s]*2;if(t+h>e.length)return-1;const d=e[t+6]>>5;let p=0;d===2?p+=2:(d&1&&d!==1&&(p+=2),d&4&&(p+=2));const g=(e[t+6]<<8|e[t+7])>>12-p&1,v=[2,1,2,3,3,4,4,5][d]+g,E=e[t+5]>>3,x=e[t+5]&7,T=new Uint8Array([s<<6|E<<1|x>>2,(x&3)<<6|d<<3|g<<2|u>>4,u<<4&224]),R=1536/o*9e4,_=r+n*R,F=e.subarray(t,t+h);return i.config=T,i.channelCount=v,i.samplerate=o,i.samples.push({unit:F,pts:_}),h}class p_ extends wg{resetInitSegment(e,t,r,n){super.resetInitSegment(e,t,r,n),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=al(e,0);let r=(t==null?void 0:t.length)||0;if(t&&e[r]===11&&e[r+1]===119&&Ig(t)!==void 0&&nA(e,r)<=16)return!1;for(let n=e.length;r<n;r++)if(iA(e,r))return yt.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return d_(e,t)}appendFrame(e,t,r){if(this.basePTS!==null)return eA(e,t,r,this.basePTS,this.frameIndex)}}const m_=/\/emsg[-/]ID3/i;class y_{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,r,n){const s=this.videoTrack=sn("video",1),a=this.audioTrack=sn("audio",1),o=this.txtTrack=sn("text",1);if(this.id3Track=sn("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const u=BE(e);if(u.video){const{id:l,timescale:h,codec:d,supplemental:p}=u.video;s.id=l,s.timescale=o.timescale=h,s.codec=d,s.supplemental=p}if(u.audio){const{id:l,timescale:h,codec:d}=u.audio;a.id=l,a.timescale=h,a.codec=d}o.id=OE.text,s.sampleDuration=0,s.duration=a.duration=n}resetContiguity(){this.remainderData=null}static probe(e){return EN(e)}demux(e,t){this.timeOffset=t;let r=e;const n=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=hi(this.remainderData,e));const o=RN(r);this.remainderData=o.remainder,n.samples=o.valid||new Uint8Array}else n.samples=r;const a=this.extractID3Track(n,t);return s.samples=$E(t,n),{videoTrack:n,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const n=this.extractID3Track(t,this.timeOffset);return r.samples=$E(e,t),{videoTrack:t,audioTrack:sn(),id3Track:n,textTrack:sn()}}extractID3Track(e,t){const r=this.id3Track;if(e.samples.length){const n=Qe(e.samples,["emsg"]);n&&n.forEach(s=>{const a=wN(s);if(m_.test(a.schemeIdUri)){const o=aA(a,t);let u=a.eventDuration===4294967295?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;u<=.001&&(u=Number.POSITIVE_INFINITY);const l=a.payload;r.samples.push({data:l,len:l.byteLength,dts:o,pts:o,type:Zr.emsg,duration:u})}else if(this.config.enableEmsgKLVMetadata&&a.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const o=aA(a,t);r.samples.push({data:a.payload,len:a.payload.byteLength,dts:o,pts:o,type:Zr.misbklv,duration:Number.POSITIVE_INFINITY})}})}return r}demuxSampleAes(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function aA(i,e){return Ce(i.presentationTime)?i.presentationTime/i.timeScale:e+i.presentationTimeDelta/i.timeScale}class v_{constructor(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new cg(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,cs.cbc)}decryptAacSample(e,t,r){const n=e[t].unit;if(n.length<=16)return;const s=n.subarray(16,n.length-n.length%16),a=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(a).then(o=>{const u=new Uint8Array(o);n.set(u,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,r)})}decryptAacSamples(e,t,r){for(;;t++){if(t>=e.length){r();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,r),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,r=new Int8Array(t);let n=0;for(let s=32;s<e.length-16;s+=160,n+=16)r.set(e.subarray(s,s+16),n);return r}getAvcDecryptedUnit(e,t){const r=new Uint8Array(t);let n=0;for(let s=32;s<e.length-16;s+=160,n+=16)e.set(r.subarray(n,n+16),s);return e}decryptAvcSample(e,t,r,n,s){const a=GE(s.data),o=this.getAvcEncryptedData(a);this.decryptBuffer(o.buffer).then(u=>{s.data=this.getAvcDecryptedUnit(a,u),this.decrypter.isSync()||this.decryptAvcSamples(e,t,r+1,n)})}decryptAvcSamples(e,t,r,n){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length){n();return}const s=e[t].units;for(;!(r>=s.length);r++){const a=s[r];if(!(a.data.length<=48||a.type!==1&&a.type!==5)&&(this.decryptAvcSample(e,t,r,n,a),!this.decrypter.isSync()))return}}}}class oA{constructor(){this.VideoSample=null}createVideoSample(e,t,r){return{key:e,frame:!1,pts:t,dts:r,units:[],length:0}}getLastNalUnit(e){var t;let r=this.VideoSample,n;if((!r||r.units.length===0)&&(r=e[e.length-1]),(t=r)!=null&&t.units){const s=r.units;n=s[s.length-1]}return n}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const r=t.samples,n=r.length;if(n){const s=r[n-1];e.pts=s.pts,e.dts=s.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,r){const n=t.byteLength;let s=e.naluState||0;const a=s,o=[];let u=0,l,h,d,p=-1,g=0;for(s===-1&&(p=0,g=this.getNALuType(t,0),s=0,u=1);u<n;){if(l=t[u++],!s){s=l?0:1;continue}if(s===1){s=l?0:2;continue}if(!l)s=3;else if(l===1){if(h=u-s-1,p>=0){const m={data:t.subarray(p,h),type:g};o.push(m)}else{const m=this.getLastNalUnit(e.samples);m&&(a&&u<=4-a&&m.state&&(m.data=m.data.subarray(0,m.data.byteLength-a)),h>0&&(m.data=hi(m.data,t.subarray(0,h)),m.state=0))}u<n?(d=this.getNALuType(t,u),p=u,g=d,s=0):s=-1}else s=0}if(p>=0&&s>=0){const m={data:t.subarray(p,n),type:g,state:s};o.push(m)}if(o.length===0){const m=this.getLastNalUnit(e.samples);m&&(m.data=hi(m.data,t))}return e.naluState=s,o}}class ol{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,r=e.byteLength-t,n=new Uint8Array(4),s=Math.min(4,t);if(s===0)throw new Error("no bytes available");n.set(e.subarray(r,r+s)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const r=this.word>>>32-t;if(e>32&&yt.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?r<<t|this.readBits(t):r}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class lA extends oA{parsePES(e,t,r,n){const s=this.parseNALu(e,r.data,n);let a=this.VideoSample,o,u=!1;r.data=null,a&&s.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),s.forEach(l=>{var h,d;switch(l.type){case 1:{let v=!1;o=!0;const E=l.data;if(u&&E.length>4){const x=this.readSliceType(E);(x===2||x===4||x===7||x===9)&&(v=!0)}if(v){var p;(p=a)!=null&&p.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.frame=!0,a.key=v;break}case 5:o=!0,(h=a)!=null&&h.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0,a.frame=!0;break;case 6:{o=!0,sg(l.data,1,r.pts,t.samples);break}case 7:{var g,m;o=!0,u=!0;const v=l.data,E=this.readSPS(v);if(!e.sps||e.width!==E.width||e.height!==E.height||((g=e.pixelRatio)==null?void 0:g[0])!==E.pixelRatio[0]||((m=e.pixelRatio)==null?void 0:m[1])!==E.pixelRatio[1]){e.width=E.width,e.height=E.height,e.pixelRatio=E.pixelRatio,e.sps=[v];const x=v.subarray(1,4);let T="avc1.";for(let R=0;R<3;R++){let _=x[R].toString(16);_.length<2&&(_="0"+_),T+=_}e.codec=T}break}case 8:o=!0,e.pps=[l.data];break;case 9:o=!0,e.audFound=!0,(d=a)!=null&&d.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;case 12:o=!0;break;default:o=!1;break}a&&o&&a.units.push(l)}),n&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new ol(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let r=8,n=8,s;for(let a=0;a<e;a++)n!==0&&(s=t.readEG(),n=(r+s+256)%256),r=n===0?r:n}readSPS(e){const t=new ol(e);let r=0,n=0,s=0,a=0,o,u,l;const h=t.readUByte.bind(t),d=t.readBits.bind(t),p=t.readUEG.bind(t),g=t.readBoolean.bind(t),m=t.skipBits.bind(t),v=t.skipEG.bind(t),E=t.skipUEG.bind(t),x=this.skipScalingList.bind(this);h();const T=h();if(d(5),m(3),h(),E(),T===100||T===110||T===122||T===244||T===44||T===83||T===86||T===118||T===128){const M=p();if(M===3&&m(1),E(),E(),m(1),g())for(u=M!==3?8:12,l=0;l<u;l++)g()&&(l<6?x(16,t):x(64,t))}E();const R=p();if(R===0)p();else if(R===1)for(m(1),v(),v(),o=p(),l=0;l<o;l++)v();E(),m(1);const _=p(),F=p(),N=d(1);N===0&&m(1),m(1),g()&&(r=p(),n=p(),s=p(),a=p());let C=[1,1];if(g()&&g())switch(h()){case 1:C=[1,1];break;case 2:C=[12,11];break;case 3:C=[10,11];break;case 4:C=[16,11];break;case 5:C=[40,33];break;case 6:C=[24,11];break;case 7:C=[20,11];break;case 8:C=[32,11];break;case 9:C=[80,33];break;case 10:C=[18,11];break;case 11:C=[15,11];break;case 12:C=[64,33];break;case 13:C=[160,99];break;case 14:C=[4,3];break;case 15:C=[3,2];break;case 16:C=[2,1];break;case 255:{C=[h()<<8|h(),h()<<8|h()];break}}return{width:Math.ceil((_+1)*16-r*2-n*2),height:(2-N)*(F+1)*16-(N?2:4)*(s+a),pixelRatio:C}}}class uA extends oA{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,r,n){const s=this.parseNALu(e,r.data,n);let a=this.VideoSample,o,u=!1;r.data=null,a&&s.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),s.forEach(l=>{var h,d;switch(l.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:a||(a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),a.frame=!0,o=!0;break;case 16:case 17:case 18:case 21:if(o=!0,u){var p;(p=a)!=null&&p.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0,a.frame=!0;break;case 19:case 20:o=!0,(h=a)!=null&&h.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0,a.frame=!0;break;case 39:o=!0,sg(l.data,2,r.pts,t.samples);break;case 32:o=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=Tt(e.params,this.readVPS(l.data)),this.initVPS=l.data),e.vps=[l.data];break;case 33:if(o=!0,u=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],l.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const g=this.readSPS(l.data);e.width=g.width,e.height=g.height,e.pixelRatio=g.pixelRatio,e.codec=g.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const m in g.params)e.params[m]=g.params[m]}this.pushParameterSet(e.sps,l.data,e.vps),a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0;break;case 34:if(o=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const g=this.readPPS(l.data);for(const m in g)e.params[m]=g[m]}this.pushParameterSet(e.pps,l.data,e.vps)}break;case 35:o=!0,e.audFound=!0,(d=a)!=null&&d.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;default:o=!1;break}a&&o&&a.units.push(l)}),n&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}pushParameterSet(e,t,r){(r&&r[0]===this.initVPS||!r&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let r=0;for(let n=0;n<e.byteLength;n++)n>=2&&e[n]===3&&e[n-1]===0&&e[n-2]===0||(t[r]=e[n],r++);return new Uint8Array(t.buffer,0,r)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new ol(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const r=t.readBits(3),n=t.readBoolean();return{numTemporalLayers:r+1,temporalIdNested:n}}readSPS(e){const t=new ol(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const r=t.readBits(3);t.readBoolean();const n=t.readBits(2),s=t.readBoolean(),a=t.readBits(5),o=t.readUByte(),u=t.readUByte(),l=t.readUByte(),h=t.readUByte(),d=t.readUByte(),p=t.readUByte(),g=t.readUByte(),m=t.readUByte(),v=t.readUByte(),E=t.readUByte(),x=t.readUByte(),T=[],R=[];for(let ge=0;ge<r;ge++)T.push(t.readBoolean()),R.push(t.readBoolean());if(r>0)for(let ge=r;ge<8;ge++)t.readBits(2);for(let ge=0;ge<r;ge++)T[ge]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),R[ge]&&t.readUByte();t.readUEG();const _=t.readUEG();_==3&&t.skipBits(1);const F=t.readUEG(),N=t.readUEG(),C=t.readBoolean();let M=0,L=0,I=0,U=0;C&&(M+=t.readUEG(),L+=t.readUEG(),I+=t.readUEG(),U+=t.readUEG());const q=t.readUEG(),$=t.readUEG(),X=t.readUEG(),ie=t.readBoolean();for(let ge=ie?0:r;ge<=r;ge++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let we=0;we<4;we++)for(let Me=0;Me<(we===3?2:6);Me++)if(!t.readBoolean())t.readUEG();else{const K=Math.min(64,1<<4+(we<<1));we>1&&t.readEG();for(let D=0;D<K;D++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const re=t.readUEG();let V=0;for(let ge=0;ge<re;ge++){let we=!1;if(ge!==0&&(we=t.readBoolean()),we){ge===re&&t.readUEG(),t.readBoolean(),t.readUEG();let Me=0;for(let le=0;le<=V;le++){const K=t.readBoolean();let D=!1;K||(D=t.readBoolean()),(K||D)&&Me++}V=Me}else{const Me=t.readUEG(),le=t.readUEG();V=Me+le;for(let K=0;K<Me;K++)t.readUEG(),t.readBoolean();for(let K=0;K<le;K++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const ge=t.readUEG();for(let we=0;we<ge;we++){for(let Me=0;Me<X+4;Me++)t.readBits(1);t.readBits(1)}}let ve=0,de=1,De=1,Ie=!0,Ne=1,Be=0;t.readBoolean(),t.readBoolean();let $e=!1;if(t.readBoolean()){if(t.readBoolean()){const S=t.readUByte(),P=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],z=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];S>0&&S<16?(de=P[S-1],De=z[S-1]):S===255&&(de=t.readBits(16),De=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),$e=t.readBoolean(),$e&&(M+=t.readUEG(),L+=t.readUEG(),I+=t.readUEG(),U+=t.readUEG()),t.readBoolean()&&(Ne=t.readBits(32),Be=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const z=t.readBoolean(),Te=t.readBoolean();let me=!1;(z||Te)&&(me=t.readBoolean(),me&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),me&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let ye=0;ye<=r;ye++){Ie=t.readBoolean();const st=Ie||t.readBoolean();let qt=!1;st?t.readEG():qt=t.readBoolean();const pi=qt?1:t.readUEG()+1;if(z)for(let br=0;br<pi;br++)t.readUEG(),t.readUEG(),me&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(Te)for(let br=0;br<pi;br++)t.readUEG(),t.readUEG(),me&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),ve=t.readUEG())}let rt=F,Ge=N;if(C||$e){let ge=1,we=1;_===1?ge=we=2:_==2&&(ge=2),rt=F-ge*L-ge*M,Ge=N-we*U-we*I}const nt=n?["A","B","C"][n]:"",B=o<<24|u<<16|l<<8|h;let se=0;for(let ge=0;ge<32;ge++)se=(se|(B>>ge&1)<<31-ge)>>>0;let xe=se.toString(16);return a===1&&xe==="2"&&(xe="6"),{codecString:`hvc1.${nt}${a}.${xe}.${s?"H":"L"}${x}.B0`,params:{general_tier_flag:s,general_profile_idc:a,general_profile_space:n,general_profile_compatibility_flags:[o,u,l,h],general_constraint_indicator_flags:[d,p,g,m,v,E],general_level_idc:x,bit_depth:q+8,bit_depth_luma_minus8:q,bit_depth_chroma_minus8:$,min_spatial_segmentation_idc:ve,chroma_format_idc:_,frame_rate:{fixed:Ie,fps:Be/Ne}},width:rt,height:Ge,pixelRatio:[de,De]}}readPPS(e){const t=new ol(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const n=t.readBoolean(),s=t.readBoolean();let a=1;return s&&n?a=0:s?a=3:n&&(a=2),{parallelismType:a}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const ur=188;class hs{constructor(e,t,r,n){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.logger=n,this.videoParser=null}static probe(e,t){const r=hs.syncOffset(e);return r>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${r}`),r!==-1}static syncOffset(e){const t=e.length;let r=Math.min(ur*5,t-ur)+1,n=0;for(;n<r;){let s=!1,a=-1,o=0;for(let u=n;u<t;u+=ur)if(e[u]===71&&(t-u===ur||e[u+ur]===71)){if(o++,a===-1&&(a=u,a!==0&&(r=Math.min(a+ur*99,e.length-ur)+1)),s||(s=Ng(e,u)===0),s&&o>1&&(a===0&&o>2||u+ur>r))return a}else{if(o)return-1;break}n++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:OE[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,r,n){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=hs.createTrack("video"),this._videoTrack.duration=n,this._audioTrack=hs.createTrack("audio",n),this._id3Track=hs.createTrack("id3"),this._txtTrack=hs.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:r}=this;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,r=!1,n=!1){r||(this.sampleAes=null);let s;const a=this._videoTrack,o=this._audioTrack,u=this._id3Track,l=this._txtTrack;let h=a.pid,d=a.pesData,p=o.pid,g=u.pid,m=o.pesData,v=u.pesData,E=null,x=this.pmtParsed,T=this._pmtId,R=e.length;if(this.remainderData&&(e=hi(this.remainderData,e),R=e.length,this.remainderData=null),R<ur&&!n)return this.remainderData=e,{audioTrack:o,videoTrack:a,id3Track:u,textTrack:l};const _=Math.max(0,hs.syncOffset(e));R-=(R-_)%ur,R<e.byteLength&&!n&&(this.remainderData=new Uint8Array(e.buffer,R,e.buffer.byteLength-R));let F=0;for(let C=_;C<R;C+=ur)if(e[C]===71){const M=!!(e[C+1]&64),L=Ng(e,C),I=(e[C+3]&48)>>4;let U;if(I>1){if(U=C+5+e[C+4],U===C+ur)continue}else U=C+4;switch(L){case h:if(M){if(d&&(s=Xa(d,this.logger))){if(this.videoParser===null)switch(a.segmentCodec){case"avc":this.videoParser=new lA;break;case"hevc":this.videoParser=new uA;break}this.videoParser!==null&&this.videoParser.parsePES(a,l,s,!1)}d={data:[],size:0}}d&&(d.data.push(e.subarray(U,C+ur)),d.size+=C+ur-U);break;case p:if(M){if(m&&(s=Xa(m,this.logger)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,s);break;case"mp3":this.parseMPEGPES(o,s);break;case"ac3":this.parseAC3PES(o,s);break}m={data:[],size:0}}m&&(m.data.push(e.subarray(U,C+ur)),m.size+=C+ur-U);break;case g:M&&(v&&(s=Xa(v,this.logger))&&this.parseID3PES(u,s),v={data:[],size:0}),v&&(v.data.push(e.subarray(U,C+ur)),v.size+=C+ur-U);break;case 0:M&&(U+=e[U]+1),T=this._pmtId=E_(e,U);break;case T:{M&&(U+=e[U]+1);const q=A_(e,U,this.typeSupported,r,this.observer,this.logger);h=q.videoPid,h>0&&(a.pid=h,a.segmentCodec=q.segmentVideoCodec),p=q.audioPid,p>0&&(o.pid=p,o.segmentCodec=q.segmentAudioCodec),g=q.id3Pid,g>0&&(u.pid=g),E!==null&&!x&&(this.logger.warn(`MPEG-TS PMT found at ${C} after unknown PID '${E}'. Backtracking to sync byte @${_} to parse all TS packets.`),E=null,C=_-188),x=this.pmtParsed=!0;break}case 17:case 8191:break;default:E=L;break}}else F++;F>0&&Lg(this.observer,new Error(`Found ${F} TS packet/s that do not start with 0x47`),void 0,this.logger),a.pesData=d,o.pesData=m,u.pesData=v;const N={audioTrack:o,videoTrack:a,id3Track:u,textTrack:l};return n&&this.extractRemainingSamples(N),N}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:r,id3Track:n,textTrack:s}=e,a=r.pesData,o=t.pesData,u=n.pesData;let l;if(a&&(l=Xa(a,this.logger))){if(this.videoParser===null)switch(r.segmentCodec){case"avc":this.videoParser=new lA;break;case"hevc":this.videoParser=new uA;break}this.videoParser!==null&&(this.videoParser.parsePES(r,s,l,!0),r.pesData=null)}else r.pesData=a;if(o&&(l=Xa(o,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,l);break;case"mp3":this.parseMPEGPES(t,l);break;case"ac3":this.parseAC3PES(t,l);break}t.pesData=null}else o!=null&&o.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=o;u&&(l=Xa(u,this.logger))?(this.parseID3PES(n,l),n.pesData=null):n.pesData=u}demuxSampleAes(e,t,r){const n=this.demux(e,r,!0,!this.config.progressive),s=this.sampleAes=new v_(this.observer,this.config,t);return this.decrypt(n,s)}decrypt(e,t){return new Promise(r=>{const{audioTrack:n,videoTrack:s}=e;n.samples&&n.segmentCodec==="aac"?t.decryptAacSamples(n.samples,0,()=>{s.samples?t.decryptAvcSamples(s.samples,0,0,()=>{r(e)}):r(e)}):s.samples&&t.decryptAvcSamples(s.samples,0,0,()=>{r(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let r=0;const n=this.aacOverFlow;let s=t.data;if(n){this.aacOverFlow=null;const d=n.missing,p=n.sample.unit.byteLength;if(d===-1)s=hi(n.sample.unit,s);else{const g=p-d;n.sample.unit.set(s.subarray(0,d),g),e.samples.push(n.sample),r=n.missing}}let a,o;for(a=r,o=s.length;a<o-1&&!Zu(s,a);a++);if(a!==r){let d;const p=a<o-1;if(p?d=`AAC PES did not start with ADTS header,offset:${a}`:d="No ADTS header found in AAC PES",Lg(this.observer,new Error(d),p,this.logger),!p)return}z2(e,this.observer,s,a,this.audioCodec);let u;if(t.pts!==void 0)u=t.pts;else if(n){const d=j2(e.samplerate);u=n.sample.pts+d}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let l=0,h;for(;a<o;)if(h=J2(e,s,a,u,l),a+=h.length,h.missing){this.aacOverFlow=h;break}else for(l++;a<o-1&&!Zu(s,a);a++);}parseMPEGPES(e,t){const r=t.data,n=r.length;let s=0,a=0;const o=t.pts;if(o===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;a<n;)if(rA(r,a)){const u=eA(e,r,a,o,s);if(u)a+=u.length,s++;else break}else a++}parseAC3PES(e,t){{const r=t.data,n=t.pts;if(n===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const s=r.length;let a=0,o=0,u;for(;o<s&&(u=sA(e,r,o,n,a++))>0;)o+=u}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const r=Tt({},t,{type:this._videoTrack?Zr.emsg:Zr.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}}function Ng(i,e){return((i[e+1]&31)<<8)+i[e+2]}function E_(i,e){return(i[e+10]&31)<<8|i[e+11]}function A_(i,e,t,r,n,s){const a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=(i[e+1]&15)<<8|i[e+2],u=e+3+o-4,l=(i[e+10]&15)<<8|i[e+11];for(e+=12+l;e<u;){const h=Ng(i,e),d=(i[e+3]&15)<<8|i[e+4];switch(i[e]){case 207:if(!r){_g("ADTS AAC",s);break}case 15:a.audioPid===-1&&(a.audioPid=h);break;case 21:a.id3Pid===-1&&(a.id3Pid=h);break;case 219:if(!r){_g("H.264",s);break}case 27:a.videoPid===-1&&(a.videoPid=h);break;case 3:case 4:!t.mpeg&&!t.mp3?s.log("MPEG audio found, not supported in this browser"):a.audioPid===-1&&(a.audioPid=h,a.segmentAudioCodec="mp3");break;case 193:if(!r){_g("AC-3",s);break}case 129:t.ac3?a.audioPid===-1&&(a.audioPid=h,a.segmentAudioCodec="ac3"):s.log("AC-3 audio found, not supported in this browser");break;case 6:if(a.audioPid===-1&&d>0){let p=e+5,g=d;for(;g>2;){switch(i[p]){case 106:t.ac3!==!0?s.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=h,a.segmentAudioCodec="ac3");break}const v=i[p+1]+2;p+=v,g-=v}}break;case 194:case 135:return Lg(n,new Error("Unsupported EC-3 in M2TS found"),void 0,s),a;case 36:a.videoPid===-1&&(a.videoPid=h,a.segmentVideoCodec="hevc",s.log("HEVC in M2TS found"));break}e+=d+5}return a}function Lg(i,e,t,r){r.warn(`parsing error: ${e.message}`),i.emit(b.ERROR,b.ERROR,{type:ke.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function _g(i,e){e.log(`${i} with AES-128-CBC encryption found in unencrypted stream`)}function Xa(i,e){let t=0,r,n,s,a,o;const u=i.data;if(!i||i.size===0)return null;for(;u[0].length<19&&u.length>1;)u[0]=hi(u[0],u[1]),u.splice(1,1);if(r=u[0],(r[0]<<16)+(r[1]<<8)+r[2]===1){if(n=(r[4]<<8)+r[5],n&&n>i.size-6)return null;const h=r[7];h&192&&(a=(r[9]&14)*536870912+(r[10]&255)*4194304+(r[11]&254)*16384+(r[12]&255)*128+(r[13]&254)/2,h&64?(o=(r[14]&14)*536870912+(r[15]&255)*4194304+(r[16]&254)*16384+(r[17]&255)*128+(r[18]&254)/2,a-o>54e5&&(e.warn(`${Math.round((a-o)/9e4)}s delta between PTS and DTS, align them`),a=o)):o=a),s=r[8];let d=s+9;if(i.size<=d)return null;i.size-=d;const p=new Uint8Array(i.size);for(let g=0,m=u.length;g<m;g++){r=u[g];let v=r.byteLength;if(d)if(d>v){d-=v;continue}else r=r.subarray(d),v-=d,d=0;p.set(r,t),t+=v}return n&&(n-=s+3),{data:p,pts:a,dts:o,len:n}}return null}class x_{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const ds=Math.pow(2,32)-1;class j{static init(){j.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in j.types)j.types.hasOwnProperty(e)&&(j.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);j.HDLR_TYPES={video:t,audio:r};const n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);j.STTS=j.STSC=j.STCO=s,j.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),j.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),j.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),j.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const a=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),u=new Uint8Array([0,0,0,1]);j.FTYP=j.box(j.types.ftyp,a,u,a,o),j.DINF=j.box(j.types.dinf,j.box(j.types.dref,n))}static box(e,...t){let r=8,n=t.length;const s=n;for(;n--;)r+=t[n].byteLength;const a=new Uint8Array(r);for(a[0]=r>>24&255,a[1]=r>>16&255,a[2]=r>>8&255,a[3]=r&255,a.set(e,4),n=0,r=8;n<s;n++)a.set(t[n],r),r+=t[n].byteLength;return a}static hdlr(e){return j.box(j.types.hdlr,j.HDLR_TYPES[e])}static mdat(e){return j.box(j.types.mdat,e)}static mdhd(e,t){t*=e;const r=Math.floor(t/(ds+1)),n=Math.floor(t%(ds+1));return j.box(j.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,n>>24,n>>16&255,n>>8&255,n&255,85,196,0,0]))}static mdia(e){return j.box(j.types.mdia,j.mdhd(e.timescale||0,e.duration||0),j.hdlr(e.type),j.minf(e))}static mfhd(e){return j.box(j.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?j.box(j.types.minf,j.box(j.types.smhd,j.SMHD),j.DINF,j.stbl(e)):j.box(j.types.minf,j.box(j.types.vmhd,j.VMHD),j.DINF,j.stbl(e))}static moof(e,t,r){return j.box(j.types.moof,j.mfhd(e),j.traf(r,t))}static moov(e){let t=e.length;const r=[];for(;t--;)r[t]=j.trak(e[t]);return j.box.apply(null,[j.types.moov,j.mvhd(e[0].timescale||0,e[0].duration||0)].concat(r).concat(j.mvex(e)))}static mvex(e){let t=e.length;const r=[];for(;t--;)r[t]=j.trex(e[t]);return j.box.apply(null,[j.types.mvex,...r])}static mvhd(e,t){t*=e;const r=Math.floor(t/(ds+1)),n=Math.floor(t%(ds+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,n>>24,n>>16&255,n>>8&255,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return j.box(j.types.mvhd,s)}static sdtp(e){const t=e.samples||[],r=new Uint8Array(4+t.length);let n,s;for(n=0;n<t.length;n++)s=t[n].flags,r[n+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return j.box(j.types.sdtp,r)}static stbl(e){return j.box(j.types.stbl,j.stsd(e),j.box(j.types.stts,j.STTS),j.box(j.types.stsc,j.STSC),j.box(j.types.stsz,j.STSZ),j.box(j.types.stco,j.STCO))}static avc1(e){let t=[],r=[],n,s,a;for(n=0;n<e.sps.length;n++)s=e.sps[n],a=s.byteLength,t.push(a>>>8&255),t.push(a&255),t=t.concat(Array.prototype.slice.call(s));for(n=0;n<e.pps.length;n++)s=e.pps[n],a=s.byteLength,r.push(a>>>8&255),r.push(a&255),r=r.concat(Array.prototype.slice.call(s));const o=j.box(j.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(r))),u=e.width,l=e.height,h=e.pixelRatio[0],d=e.pixelRatio[1];return j.box(j.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,u&255,l>>8&255,l&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,j.box(j.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),j.box(j.types.pasp,new Uint8Array([h>>24,h>>16&255,h>>8&255,h&255,d>>24,d>>16&255,d>>8&255,d&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return j.box(j.types.mp4a,j.audioStsd(e),j.box(j.types.esds,j.esds(e)))}static mp3(e){return j.box(j.types[".mp3"],j.audioStsd(e))}static ac3(e){return j.box(j.types["ac-3"],j.audioStsd(e),j.box(j.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return j.box(j.types.stsd,j.STSD,j.mp4a(e));if(t==="ac3"&&e.config)return j.box(j.types.stsd,j.STSD,j.ac3(e));if(t==="mp3"&&e.codec==="mp3")return j.box(j.types.stsd,j.STSD,j.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return j.box(j.types.stsd,j.STSD,j.avc1(e));if(t==="hevc"&&e.vps)return j.box(j.types.stsd,j.STSD,j.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,r=(e.duration||0)*(e.timescale||0),n=e.width||0,s=e.height||0,a=Math.floor(r/(ds+1)),o=Math.floor(r%(ds+1));return j.box(j.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,n&255,0,0,s>>8&255,s&255,0,0]))}static traf(e,t){const r=j.sdtp(e),n=e.id,s=Math.floor(t/(ds+1)),a=Math.floor(t%(ds+1));return j.box(j.types.traf,j.box(j.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255])),j.box(j.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,a>>24,a>>16&255,a>>8&255,a&255])),j.trun(e,r.length+16+20+8+16+8+8),r)}static trak(e){return e.duration=e.duration||4294967295,j.box(j.types.trak,j.tkhd(e),j.mdia(e))}static trex(e){const t=e.id;return j.box(j.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const r=e.samples||[],n=r.length,s=12+16*n,a=new Uint8Array(s);let o,u,l,h,d,p;for(t+=8+s,a.set([e.type==="video"?1:0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,n&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),o=0;o<n;o++)u=r[o],l=u.duration,h=u.size,d=u.flags,p=u.cts,a.set([l>>>24&255,l>>>16&255,l>>>8&255,l&255,h>>>24&255,h>>>16&255,h>>>8&255,h&255,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,d.degradPrio&61440,d.degradPrio&15,p>>>24&255,p>>>16&255,p>>>8&255,p&255],12+16*o);return j.box(j.types.trun,a)}static initSegment(e){j.types||j.init();const t=j.moov(e);return hi(j.FTYP,t)}static hvc1(e){const t=e.params,r=[e.vps,e.sps,e.pps],n=4,s=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),n-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),r.length]);let a=s.length;for(let m=0;m<r.length;m+=1){a+=3;for(let v=0;v<r[m].length;v+=1)a+=2+r[m][v].length}const o=new Uint8Array(a);o.set(s,0),a=s.length;const u=r.length-1;for(let m=0;m<r.length;m+=1){o.set(new Uint8Array([32+m|(m===u?128:0),0,r[m].length]),a),a+=3;for(let v=0;v<r[m].length;v+=1)o.set(new Uint8Array([r[m][v].length>>8,r[m][v].length&255]),a),a+=2,o.set(r[m][v],a),a+=r[m][v].length}const l=j.box(j.types.hvcC,o),h=e.width,d=e.height,p=e.pixelRatio[0],g=e.pixelRatio[1];return j.box(j.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,h&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l,j.box(j.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),j.box(j.types.pasp,new Uint8Array([p>>24,p>>16&255,p>>8&255,p&255,g>>24,g>>16&255,g>>8&255,g&255])))}}j.types=void 0,j.HDLR_TYPES=void 0,j.STTS=void 0,j.STSC=void 0,j.STCO=void 0,j.STSZ=void 0,j.VMHD=void 0,j.SMHD=void 0,j.STSD=void 0,j.FTYP=void 0,j.DINF=void 0;const cA=9e4;function Mg(i,e,t=1,r=!1){const n=i*e*t;return r?Math.round(n):n}function S_(i,e,t=1,r=!1){return Mg(i,e,1/t,r)}function ll(i,e=!1){return Mg(i,1e3,1/cA,e)}function b_(i,e=1){return Mg(i,cA,1/e)}const T_=10*1e3,D_=1024,R_=1152,I_=1536;let za=null,Og=null;function hA(i,e,t,r){return{duration:e,size:t,cts:r,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:i?2:1,isNonSync:i?0:1}}}class rc{constructor(e,t,r,n){if(this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.logger=n,this.ISGenerated=!1,za===null){const a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);za=a?parseInt(a[1]):0}if(Og===null){const s=navigator.userAgent.match(/Safari\/(\d+)/i);Og=s?parseInt(s[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const r=e[0].pts,n=e.reduce((s,a)=>{let o=a.pts,u=o-s;return u<-4294967296&&(t=!0,o=di(o,r),u=o-s),u>0?s:o},r);return t&&this.logger.debug("PTS rollover detected"),n}remux(e,t,r,n,s,a,o,u){let l,h,d,p,g,m,v=s,E=s;const x=e.pid>-1,T=t.pid>-1,R=t.samples.length,_=e.samples.length>0,F=o&&R>0||R>1;if((!x||_)&&(!T||F)||this.ISGenerated||o){if(this.ISGenerated){var C,M,L,I;const X=this.videoTrackConfig;(X&&(t.width!==X.width||t.height!==X.height||((C=t.pixelRatio)==null?void 0:C[0])!==((M=X.pixelRatio)==null?void 0:M[0])||((L=t.pixelRatio)==null?void 0:L[1])!==((I=X.pixelRatio)==null?void 0:I[1]))||!X&&F||this.nextAudioPts===null&&_)&&this.resetInitSegment()}this.ISGenerated||(d=this.generateIS(e,t,s,a));const U=this.isVideoContiguous;let q=-1,$;if(F&&(q=w_(t.samples),!U&&this.config.forceKeyFrameOnDiscontinuity))if(m=!0,q>0){this.logger.warn(`[mp4-remuxer]: Dropped ${q} out of ${R} video samples due to a missing keyframe`);const X=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(q),t.dropped+=q,E+=(t.samples[0].pts-X)/t.inputTimeScale,$=E}else q===-1&&(this.logger.warn(`[mp4-remuxer]: No keyframe found out of ${R} video samples`),m=!1);if(this.ISGenerated){if(_&&F){const X=this.getVideoStartPts(t.samples),ne=(di(e.samples[0].pts,X)-X)/t.inputTimeScale;v+=Math.max(0,ne),E+=Math.max(0,-ne)}if(_){if(e.samplerate||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),d=this.generateIS(e,t,s,a)),h=this.remuxAudio(e,v,this.isAudioContiguous,a,T||F||u===Oe.AUDIO?E:void 0),F){const X=h?h.endPTS-h.startPTS:0;t.inputTimeScale||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),d=this.generateIS(e,t,s,a)),l=this.remuxVideo(t,E,U,X)}}else F&&(l=this.remuxVideo(t,E,U,0));l&&(l.firstKeyFrame=q,l.independent=q!==-1,l.firstKeyFramePTS=$)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(g=dA(r,s,this._initPTS,this._initDTS)),n.samples.length&&(p=fA(n,s,this._initPTS))),{audio:h,video:l,initSegment:d,independent:m,text:p,id3:g}}generateIS(e,t,r,n){const s=e.samples,a=t.samples,o=this.typeSupported,u={},l=this._initPTS;let h=!l||n,d="audio/mp4",p,g,m,v;if(h&&(p=g=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":o.mpeg?(d="audio/mpeg",e.codec=""):o.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}u.audio={id:"audio",container:d,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&o.mpeg?new Uint8Array(0):j.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(v=e.id,m=e.inputTimeScale,!l||m!==l.timescale?p=g=s[0].pts-Math.round(m*r):h=!1)}if(t.sps&&t.pps&&a.length){if(t.timescale=t.inputTimeScale,u.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:j.initSegment([t]),metadata:{width:t.width,height:t.height}},h)if(v=t.id,m=t.inputTimeScale,!l||m!==l.timescale){const E=this.getVideoStartPts(a),x=Math.round(m*r);g=Math.min(g,di(a[0].dts,E)-x),p=Math.min(p,E-x)}else h=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(u).length)return this.ISGenerated=!0,h?(this._initPTS={baseTime:p,timescale:m},this._initDTS={baseTime:g,timescale:m}):p=m=void 0,{tracks:u,initPTS:p,timescale:m,trackId:v}}remuxVideo(e,t,r,n){const s=e.inputTimeScale,a=e.samples,o=[],u=a.length,l=this._initPTS;let h=this.nextAvcDts,d=8,p=this.videoSampleDuration,g,m,v=Number.POSITIVE_INFINITY,E=Number.NEGATIVE_INFINITY,x=!1;if(!r||h===null){const V=t*s,J=a[0].pts-di(a[0].dts,a[0].pts);za&&h!==null&&Math.abs(V-J-h)<15e3?r=!0:h=V-J}const T=l.baseTime*s/l.timescale;for(let V=0;V<u;V++){const J=a[V];J.pts=di(J.pts-T,h),J.dts=di(J.dts-T,h),J.dts<a[V>0?V-1:V].dts&&(x=!0)}x&&a.sort(function(V,J){const ve=V.dts-J.dts,de=V.pts-J.pts;return ve||de}),g=a[0].dts,m=a[a.length-1].dts;const R=m-g,_=R?Math.round(R/(u-1)):p||e.inputTimeScale/30;if(r){const V=g-h,J=V>_,ve=V<-1;if((J||ve)&&(J?this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${ll(V,!0)} ms (${V}dts) hole between fragments detected at ${t.toFixed(3)}`):this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${ll(-V,!0)} ms (${V}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!ve||h>=a[0].pts||za)){g=h;const de=a[0].pts-V;if(J)a[0].dts=g,a[0].pts=de;else{let De=!0;for(let Ie=0;Ie<a.length&&!(a[Ie].dts>de&&De);Ie++){const Ne=a[Ie].pts;if(a[Ie].dts-=V,a[Ie].pts-=V,Ie<a.length-1){const Be=a[Ie+1].pts,$e=a[Ie].pts,et=Be<=$e,rt=Be<=Ne;De=et==rt}}}this.logger.log(`Video: Initial PTS/DTS adjusted: ${ll(de,!0)}/${ll(g,!0)}, delta: ${ll(V,!0)} ms`)}}g=Math.max(0,g);let F=0,N=0,C=g;for(let V=0;V<u;V++){const J=a[V],ve=J.units,de=ve.length;let De=0;for(let Ie=0;Ie<de;Ie++)De+=ve[Ie].data.length;N+=De,F+=de,J.length=De,J.dts<C?(J.dts=C,C+=_/4|0||1):C=J.dts,v=Math.min(J.pts,v),E=Math.max(J.pts,E)}m=a[u-1].dts;const M=N+4*F+8;let L;try{L=new Uint8Array(M)}catch(V){this.observer.emit(b.ERROR,b.ERROR,{type:ke.MUX_ERROR,details:Q.REMUX_ALLOC_ERROR,fatal:!1,error:V,bytes:M,reason:`fail allocating video mdat ${M}`});return}const I=new DataView(L.buffer);I.setUint32(0,M),L.set(j.types.mdat,4);let U=!1,q=Number.POSITIVE_INFINITY,$=Number.POSITIVE_INFINITY,X=Number.NEGATIVE_INFINITY,ie=Number.NEGATIVE_INFINITY;for(let V=0;V<u;V++){const J=a[V],ve=J.units;let de=0;for(let Ne=0,Be=ve.length;Ne<Be;Ne++){const $e=ve[Ne],et=$e.data,rt=$e.data.byteLength;I.setUint32(d,rt),d+=4,L.set(et,d),d+=rt,de+=4+rt}let De;if(V<u-1)p=a[V+1].dts-J.dts,De=a[V+1].pts-J.pts;else{const Ne=this.config,Be=V>0?J.dts-a[V-1].dts:_;if(De=V>0?J.pts-a[V-1].pts:_,Ne.stretchShortVideoTrack&&this.nextAudioPts!==null){const $e=Math.floor(Ne.maxBufferHole*s),et=(n?v+n*s:this.nextAudioPts)-J.pts;et>$e?(p=et-Be,p<0?p=Be:U=!0,this.logger.log(`[mp4-remuxer]: It is approximately ${et/90} ms to the next segment; using duration ${p/90} ms for the last video frame.`)):p=Be}else p=Be}const Ie=Math.round(J.pts-J.dts);q=Math.min(q,p),X=Math.max(X,p),$=Math.min($,De),ie=Math.max(ie,De),o.push(hA(J.key,p,de,Ie))}if(o.length){if(za){if(za<70){const V=o[0].flags;V.dependsOn=2,V.isNonSync=0}}else if(Og&&ie-$<X-q&&_/X<.025&&o[0].cts===0){this.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let V=g;for(let J=0,ve=o.length;J<ve;J++){const de=V+o[J].duration,De=V+o[J].cts;if(J<ve-1){const Ie=de+o[J+1].cts;o[J].duration=Ie-De}else o[J].duration=J?o[J-1].duration:_;o[J].cts=0,V=de}}}p=U||!p?_:p,this.nextAvcDts=h=m+p,this.videoSampleDuration=p,this.isVideoContiguous=!0;const re={data1:j.moof(e.sequenceNumber++,g,Tt(e,{samples:o})),data2:L,startPTS:v/s,endPTS:(E+p)/s,startDTS:g/s,endDTS:h/s,type:"video",hasAudio:!1,hasVideo:!0,nb:o.length,dropped:e.dropped};return e.samples=[],e.dropped=0,re}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return R_;case"ac3":return I_;default:return D_}}remuxAudio(e,t,r,n,s){const a=e.inputTimeScale,o=e.samplerate?e.samplerate:a,u=a/o,l=this.getSamplesPerFrame(e),h=l*u,d=this._initPTS,p=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,g=[],m=s!==void 0;let v=e.samples,E=p?0:8,x=this.nextAudioPts||-1;const T=t*a,R=d.baseTime*a/d.timescale;if(this.isAudioContiguous=r=r||v.length&&x>0&&(n&&Math.abs(T-x)<9e3||Math.abs(di(v[0].pts-R,T)-x)<20*h),v.forEach(function(ne){ne.pts=di(ne.pts-R,T)}),!r||x<0){if(v=v.filter(ne=>ne.pts>=0),!v.length)return;s===0?x=0:n&&!m?x=Math.max(0,T):x=v[0].pts}if(e.segmentCodec==="aac"){const ne=this.config.maxAudioFramesDrift;for(let ue=0,re=x;ue<v.length;ue++){const V=v[ue],J=V.pts,ve=J-re,de=Math.abs(1e3*ve/a);if(ve<=-ne*h&&m)ue===0&&(this.logger.warn(`Audio frame @ ${(J/a).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*ve/a)} ms.`),this.nextAudioPts=x=re=J);else if(ve>=ne*h&&de<T_&&m){let De=Math.round(ve/h);re=J-De*h,re<0&&(De--,re+=h),ue===0&&(this.nextAudioPts=x=re),this.logger.warn(`[mp4-remuxer]: Injecting ${De} audio frame @ ${(re/a).toFixed(3)}s due to ${Math.round(1e3*ve/a)} ms gap.`);for(let Ie=0;Ie<De;Ie++){const Ne=Math.max(re,0);let Be=x_.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);Be||(this.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Be=V.unit.subarray()),v.splice(ue,0,{unit:Be,pts:Ne}),re+=h,ue++}}V.pts=re,re+=h}}let _=null,F=null,N,C=0,M=v.length;for(;M--;)C+=v[M].unit.byteLength;for(let ne=0,ue=v.length;ne<ue;ne++){const re=v[ne],V=re.unit;let J=re.pts;if(F!==null){const de=g[ne-1];de.duration=Math.round((J-F)/u)}else if(r&&e.segmentCodec==="aac"&&(J=x),_=J,C>0){C+=E;try{N=new Uint8Array(C)}catch(de){this.observer.emit(b.ERROR,b.ERROR,{type:ke.MUX_ERROR,details:Q.REMUX_ALLOC_ERROR,fatal:!1,error:de,bytes:C,reason:`fail allocating audio mdat ${C}`});return}p||(new DataView(N.buffer).setUint32(0,C),N.set(j.types.mdat,4))}else return;N.set(V,E);const ve=V.byteLength;E+=ve,g.push(hA(!0,l,ve,0)),F=J}const L=g.length;if(!L)return;const I=g[g.length-1];this.nextAudioPts=x=F+u*I.duration;const U=p?new Uint8Array(0):j.moof(e.sequenceNumber++,_/u,Tt({},e,{samples:g}));e.samples=[];const q=_/a,$=x/a,ie={data1:U,data2:N,startPTS:q,endPTS:$,startDTS:q,endDTS:$,type:"audio",hasAudio:!0,hasVideo:!1,nb:L};return this.isAudioContiguous=!0,ie}}function di(i,e){let t;if(e===null)return i;for(e<i?t=-8589934592:t=8589934592;Math.abs(i-e)>4294967296;)i+=t;return i}function w_(i){for(let e=0;e<i.length;e++)if(i[e].key)return e;return-1}function dA(i,e,t,r){const n=i.samples.length;if(!n)return;const s=i.inputTimeScale;for(let o=0;o<n;o++){const u=i.samples[o];u.pts=di(u.pts-t.baseTime*s/t.timescale,e*s)/s,u.dts=di(u.dts-r.baseTime*s/r.timescale,e*s)/s}const a=i.samples;return i.samples=[],{samples:a}}function fA(i,e,t){const r=i.samples.length;if(!r)return;const n=i.inputTimeScale;for(let a=0;a<r;a++){const o=i.samples[a];o.pts=di(o.pts-t.baseTime*n/t.timescale,e*n)/n}i.samples.sort((a,o)=>a.pts-o.pts);const s=i.samples;return i.samples=[],{samples:s}}class C_{constructor(e,t,r,n){this.logger=void 0,this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1,this.logger=n}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,r,n){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(bN(e,n)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:r}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const n=this.initData=BE(e);n.audio&&(t=gA(n.audio,wt.AUDIO,this.logger)),n.video&&(r=gA(n.video,wt.VIDEO,this.logger));const s={};n.audio&&n.video?s.audiovideo={container:"video/mp4",codec:t+","+r,supplemental:n.video.supplemental,initSegment:e,id:"main"}:n.audio?s.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:n.video?s.video={container:"video/mp4",codec:r,supplemental:n.video.supplemental,initSegment:e,id:"main"}:this.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s}remux(e,t,r,n,s,a){var o,u;let{initPTS:l,lastEndTime:h}=this;const d={audio:void 0,video:void 0,text:n,id3:r,initSegment:void 0};Ce(h)||(h=this.lastEndTime=s||0);const p=t.samples;if(!(p!=null&&p.length))return d;const g={initPTS:void 0,timescale:void 0,trackId:void 0};let m=this.initData;if((o=m)!=null&&o.length||(this.generateInitSegment(p),m=this.initData),!((u=m)!=null&&u.length))return this.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(g.tracks=this.initTracks,this.emitInitSegment=!1);const v=TN(p,m,this.logger),E=m.audio?v[m.audio.id]:null,x=m.video?v[m.video.id]:null,T=ic(x,1/0),R=ic(E,1/0),_=ic(x,0,!0),F=ic(E,0,!0);let N,C=s,M=0;if(E&&(!x||!l&&R<T||l&&l.trackId===m.audio.id)?(g.trackId=m.audio.id,N=E,M=F-R):x&&(g.trackId=m.video.id,N=x,M=_-T),N){const ne=N.timescale;C=N.start/ne,g.timescale=ne,l||(g.initPTS=N.start-s*ne,this.initPTS=l={baseTime:g.initPTS,timescale:ne,trackId:g.trackId})}(a||!l)&&(N_(l,C,s,M)||g.timescale!==l.timescale)&&(g.initPTS=C-s,l&&l.timescale===1&&this.logger.warn(`Adjusting initPTS @${s} from ${l.baseTime/l.timescale} to ${g.initPTS}`),this.initPTS=l={baseTime:g.initPTS,timescale:1});const L=e?C-l.baseTime/l.timescale:h;DN(m,p,l.baseTime/l.timescale);const I=L+M;M>0?this.lastEndTime=I:(this.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const U=!!m.audio,q=!!m.video;let $="";U&&($+="audio"),q&&($+="video");const X={data1:p,startPTS:L,startDTS:L,endPTS:I,endDTS:I,type:$,hasAudio:U,hasVideo:q,nb:1,dropped:0};d.audio=U&&!q?X:void 0,d.video=q?X:void 0;const ie=x==null?void 0:x.sampleCount;if(ie){const ne=x.keyFrameIndex,ue=ne!==-1;X.nb=ie,X.dropped=ne===0||this.isVideoContiguous?0:ue?ne:ie,X.independent=ue,X.firstKeyFrame=ne,ue&&x.keyFrameStart&&(X.firstKeyFramePTS=x.keyFrameStart-l.baseTime/l.timescale),this.isVideoContiguous||(d.independent=ue),this.isVideoContiguous||(this.isVideoContiguous=ue),X.dropped&&this.logger.warn(`fmp4 does not start with IDR: firstIDR ${ne}/${ie} dropped: ${X.dropped} pts: ${X.firstKeyFramePTS||"NA"}`)}return d.initSegment=g,d.id3=dA(r,s,l,l),n.samples.length&&(d.text=fA(n,s,l)),d}}function ic(i,e,t=!1){return(i==null?void 0:i.start)!==void 0?(i.start+(t?i.duration:0))/i.timescale:e}function N_(i,e,t,r){if(i===null)return!0;const n=Math.max(r,1),s=e-i.baseTime/i.timescale;return Math.abs(s-t)>n}function gA(i,e,t){const r=i==null?void 0:i.codec;return r&&r.length>4?r:e===wt.AUDIO?r==="ec-3"||r==="ac-3"||r==="alac"?r:r==="fLaC"||r==="Opus"?Fu(r,!1):(t.warn(`Unhandled audio codec "${r}" in mp4 MAP`),r||"mp4a"):(t.warn(`Unhandled video codec "${r}" in mp4 MAP`),r||"avc1")}let Nn;try{Nn=self.performance.now.bind(self.performance)}catch{Nn=Date.now}const nc=[{demux:y_,remux:C_},{demux:hs,remux:rc},{demux:f_,remux:rc},{demux:p_,remux:rc}];nc.splice(2,0,{demux:g_,remux:rc});class pA{constructor(e,t,r,n,s,a){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.id=s,this.logger=a}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,r,n){const s=r.transmuxing;s.executeStart=Nn();let a=new Uint8Array(e);const{currentTransmuxState:o,transmuxConfig:u}=this;n&&(this.currentTransmuxState=n);const{contiguous:l,discontinuity:h,trackSwitch:d,accurateTimeOffset:p,timeOffset:g,initSegmentChange:m}=n||o,{audioCodec:v,videoCodec:E,defaultInitPts:x,duration:T,initSegmentData:R}=u,_=L_(a,t);if(_&&Wa(_.method)){const M=this.getDecrypter(),L=fg(_.method);if(M.isSync()){let I=M.softwareDecrypt(a,_.key.buffer,_.iv.buffer,L);if(r.part>-1){const q=M.flush();I=q&&q.buffer}if(!I)return s.executeEnd=Nn(),Pg(r);a=new Uint8Array(I)}else return this.asyncResult=!0,this.decryptionPromise=M.webCryptoDecrypt(a,_.key.buffer,_.iv.buffer,L).then(I=>{const U=this.push(I,null,r);return this.decryptionPromise=null,U}),this.decryptionPromise}const F=this.needsProbing(h,d);if(F){const M=this.configureTransmuxer(a);if(M)return this.logger.warn(`[transmuxer] ${M.message}`),this.observer.emit(b.ERROR,b.ERROR,{type:ke.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,error:M,reason:M.message}),s.executeEnd=Nn(),Pg(r)}(h||d||m||F)&&this.resetInitSegment(R,v,E,T,t),(h||m||F)&&this.resetInitialTimestamp(x),l||this.resetContiguity();const N=this.transmux(a,_,g,p,r);this.asyncResult=ul(N);const C=this.currentTransmuxState;return C.contiguous=!0,C.discontinuity=!1,C.trackSwitch=!1,s.executeEnd=Nn(),N}flush(e){const t=e.transmuxing;t.executeStart=Nn();const{decrypter:r,currentTransmuxState:n,decryptionPromise:s}=this;if(s)return this.asyncResult=!0,s.then(()=>this.flush(e));const a=[],{timeOffset:o}=n;if(r){const d=r.flush();d&&a.push(this.push(d.buffer,null,e))}const{demuxer:u,remuxer:l}=this;if(!u||!l){t.executeEnd=Nn();const d=[Pg(e)];return this.asyncResult?Promise.resolve(d):d}const h=u.flush(o);return ul(h)?(this.asyncResult=!0,h.then(d=>(this.flushRemux(a,d,e),a))):(this.flushRemux(a,h,e),this.asyncResult?Promise.resolve(a):a)}flushRemux(e,t,r){const{audioTrack:n,videoTrack:s,id3Track:a,textTrack:o}=t,{accurateTimeOffset:u,timeOffset:l}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${r.sn}${r.part>-1?" part: "+r.part:""} of ${this.id===Oe.MAIN?"level":"track"} ${r.level}`);const h=this.remuxer.remux(n,s,a,o,l,u,!0,this.id);e.push({remuxResult:h,chunkMeta:r}),r.transmuxing.executeEnd=Nn()}resetInitialTimestamp(e){const{demuxer:t,remuxer:r}=this;!t||!r||(t.resetTimeStamp(e),r.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,r,n,s){const{demuxer:a,remuxer:o}=this;!a||!o||(a.resetInitSegment(e,t,r,n),o.resetInitSegment(e,t,r,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,r,n,s){let a;return t&&t.method==="SAMPLE-AES"?a=this.transmuxSampleAes(e,t,r,n,s):a=this.transmuxUnencrypted(e,r,n,s),a}transmuxUnencrypted(e,t,r,n){const{audioTrack:s,videoTrack:a,id3Track:o,textTrack:u}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,a,o,u,t,r,!1,this.id),chunkMeta:n}}transmuxSampleAes(e,t,r,n,s){return this.demuxer.demuxSampleAes(e,t,r).then(a=>({remuxResult:this.remuxer.remux(a.audioTrack,a.videoTrack,a.id3Track,a.textTrack,r,n,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){const{config:t,observer:r,typeSupported:n}=this;let s;for(let d=0,p=nc.length;d<p;d++){var a;if((a=nc[d].demux)!=null&&a.probe(e,this.logger)){s=nc[d];break}}if(!s)return new Error("Failed to find demuxer by probing fragment data");const o=this.demuxer,u=this.remuxer,l=s.remux,h=s.demux;(!u||!(u instanceof l))&&(this.remuxer=new l(r,t,n,this.logger)),(!o||!(o instanceof h))&&(this.demuxer=new h(r,t,n,this.logger),this.probe=h.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new cg(this.config)),e}}function L_(i,e){let t=null;return i.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const Pg=i=>({remuxResult:{},chunkMeta:i});function ul(i){return"then"in i&&i.then instanceof Function}class __{constructor(e,t,r,n,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=n,this.defaultInitPts=s||null}}class M_{constructor(e,t,r,n,s,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=n,this.timeOffset=s,this.initSegmentChange=a}}let mA=0;class yA{constructor(e,t,r,n){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=mA++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=u=>{const l=u.data,h=this.hls;if(!(!h||!(l!=null&&l.event)||l.instanceNo!==this.instanceNo))switch(l.event){case"init":{var d;const p=(d=this.workerContext)==null?void 0:d.objectURL;p&&self.URL.revokeObjectURL(p);break}case"transmuxComplete":{this.handleTransmuxComplete(l.data);break}case"flush":{this.onFlush(l.data);break}case"workerLog":{h.logger[l.data.logType]&&h.logger[l.data.logType](l.data.message);break}default:{l.data=l.data||{},l.data.frag=this.frag,l.data.part=this.part,l.data.id=this.id,h.trigger(l.event,l.data);break}}},this.onWorkerError=u=>{if(!this.hls)return;const l=new Error(`${u.message}  (${u.filename}:${u.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(b.ERROR,{type:ke.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:l})};const s=e.config;this.hls=e,this.id=t,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=r,this.onFlush=n;const a=(u,l)=>{l=l||{},l.frag=this.frag||void 0,u===b.ERROR&&(l=l,l.parent=this.id,l.part=this.part,this.error=l.error),this.hls.trigger(u,l)};this.observer=new bg,this.observer.on(b.FRAG_DECRYPTED,a),this.observer.on(b.ERROR,a);const o=WE(s.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const u=this.hls.logger;if(s.workerPath||UL()){try{s.workerPath?(u.log(`loading Web Worker ${s.workerPath} for "${t}"`),this.workerContext=GL(s.workerPath)):(u.log(`injecting Web Worker for "${t}"`),this.workerContext=$L());const{worker:h}=this.workerContext;h.addEventListener("message",this.onWorkerMessage),h.addEventListener("error",this.onWorkerError),h.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:o,id:t,config:Bt(s)})}catch(h){u.warn(`Error setting up "${t}" Web Worker, fallback to inline`,h),this.terminateWorker(),this.error=null,this.transmuxer=new pA(this.observer,o,s,"",t,e.logger)}return}}this.transmuxer=new pA(this.observer,o,s,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=mA++;const t=this.hls.config,r=WE(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:r,id:this.id,config:Bt(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),qL(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,r,n,s,a,o,u,l,h){var d,p;l.transmuxing.start=self.performance.now();const{instanceNo:g,transmuxer:m}=this,v=a?a.start:s.start,E=s.decryptdata,x=this.frag,T=!(x&&s.cc===x.cc),R=!(x&&l.level===x.level),_=x?l.sn-x.sn:-1,F=this.part?l.part-this.part.index:-1,N=_===0&&l.id>1&&l.id===(x==null?void 0:x.stats.chunkCount),C=!R&&(_===1||_===0&&(F===1||N&&F<=0)),M=self.performance.now();(R||_||s.stats.parsing.start===0)&&(s.stats.parsing.start=M),a&&(F||!C)&&(a.stats.parsing.start=M);const L=!(x&&((d=s.initSegment)==null?void 0:d.url)===((p=x.initSegment)==null?void 0:p.url)),I=new M_(T,C,u,R,v,L);if(!C||T||L){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${s.type} sn: ${l.sn}${l.part>-1?" part: "+l.part:""} ${this.id===Oe.MAIN?"level":"track"}: ${l.level} id: ${l.id}
        discontinuity: ${T}
        trackSwitch: ${R}
        contiguous: ${C}
        accurateTimeOffset: ${u}
        timeOffset: ${v}
        initSegmentChange: ${L}`);const U=new __(r,n,t,o,h);this.configureTransmuxer(U)}if(this.frag=s,this.part=a,this.workerContext)this.workerContext.worker.postMessage({instanceNo:g,cmd:"demux",data:e,decryptdata:E,chunkMeta:l,state:I},e instanceof ArrayBuffer?[e]:[]);else if(m){const U=m.push(e,E,l,I);ul(U)?U.then(q=>{this.handleTransmuxComplete(q)}).catch(q=>{this.transmuxerError(q,l,"transmuxer-interface push error")}):this.handleTransmuxComplete(U)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:r}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(r){const n=r.flush(e);ul(n)?n.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")}):this.handleFlushResult(n,e)}}transmuxerError(e,t,r){this.hls&&(this.error=e,this.hls.trigger(b.ERROR,{type:ke.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:r}))}handleFlushResult(e,t){e.forEach(r=>{this.handleTransmuxComplete(r)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:r}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):r&&r.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const vA=100;class O_ extends xg{constructor(e,t,r){super(e,t,r,"audio-stream-controller",Oe.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(b.BUFFER_RESET,this.onBufferReset,this),e.on(b.BUFFER_CREATED,this.onBufferCreated,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(b.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(b.FRAG_LOADING,this.onFragLoading,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(b.BUFFER_RESET,this.onBufferReset,this),e.off(b.BUFFER_CREATED,this.onBufferCreated,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(b.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(b.FRAG_LOADING,this.onFragLoading,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:r,initPTS:n,timescale:s}){if(r===Oe.MAIN){const a=t.cc,o=this.fragCurrent;if(this.initPTS[a]={baseTime:n,timescale:s},this.log(`InitPTS for cc: ${a} found from main: ${n}/${s}`),this.mainAnchor=t,this.state===oe.WAITING_INIT_PTS){const u=this.waitingData;(!u&&!this.loadingParts||u&&u.frag.cc!==a)&&this.syncWithAnchor(t,u==null?void 0:u.frag)}else!this.hls.hasEnoughToStart&&o&&o.cc!==a?(o.abortRequests(),this.syncWithAnchor(t,o)):this.state===oe.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var r;const n=((r=this.mainFragLoading)==null?void 0:r.frag)||null;if(t&&(n==null?void 0:n.cc)===t.cc)return;const s=(n||e).cc,a=this.getLevelDetails(),o=this.getLoadPosition(),u=a2(a,s,o);u&&(this.log(`Waiting fragment cc (${t==null?void 0:t.cc}) cancelled because video is at cc ${e.cc}`),this.startFragRequested=!1,this.nextLoadPosition=u.start,this.resetLoadingState(),this.state===oe.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=oe.STOPPED;return}const r=this.lastCurrentTime;this.stopLoad(),this.setInterval(vA),r>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r,this.state=oe.IDLE):this.state=oe.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case oe.IDLE:this.doTickIdle();break;case oe.WAITING_TRACK:{const{levels:t,trackId:r}=this,n=t==null?void 0:t[r],s=n==null?void 0:n.details;if(s&&!this.waitForLive(n)){if(this.waitForCdnTuneIn(s))break;this.state=oe.WAITING_INIT_PTS}break}case oe.FRAG_LOADING_WAITING_RETRY:{var e;const t=performance.now(),r=this.retryDate;if(!r||t>=r||(e=this.media)!=null&&e.seeking){const{levels:n,trackId:s}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((n==null?void 0:n[s])||null),this.state=oe.IDLE}break}case oe.WAITING_INIT_PTS:{const t=this.waitingData;if(t){const{frag:r,part:n,cache:s,complete:a}=t,o=this.mainAnchor;if(this.initPTS[r.cc]!==void 0){this.waitingData=null,this.state=oe.FRAG_LOADING;const u=s.flush().buffer,l={frag:r,part:n,payload:u,networkDetails:null};this._handleFragmentLoadProgress(l),a&&super._handleFragmentLoadComplete(l)}else o&&o.cc!==t.frag.cc&&this.syncWithAnchor(o,t.frag)}else this.state=oe.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:r,media:n,trackId:s}=this,a=t.config;if(!this.buffering||!n&&!this.primaryPrefetch&&(this.startFragRequested||!a.startFragPrefetch)||!(r!=null&&r[s]))return;const o=r[s],u=o.details;if(!u||this.waitForLive(o)||this.waitForCdnTuneIn(u)){this.state=oe.WAITING_TRACK,this.startFragRequested=!1;return}const l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,wt.AUDIO,Oe.AUDIO));const h=this.getFwdBufferInfo(l,Oe.AUDIO);if(h===null)return;if(!this.switchingTrack&&this._streamEnded(h,u)){t.trigger(b.BUFFER_EOS,{type:"audio"}),this.state=oe.ENDED;return}const d=h.len,p=t.maxBufferLength,g=u.fragments,m=g[0].start,v=this.getLoadPosition(),E=this.flushing?v:h.end;if(this.switchingTrack&&n){const R=v;u.PTSKnown&&R<m&&(h.end>m||h.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=m+.05)}if(d>=p&&!this.switchingTrack&&E<g[g.length-1].start)return;let x=this.getNextFragment(E,u);if(x&&this.isLoopLoading(x,E)&&(x=this.getNextFragmentLoopLoading(x,u,h,Oe.MAIN,p)),!x){this.bufferFlushed=!0;return}let T=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&T&&lr(x)&&!x.endList&&(!u.live||!this.loadingParts&&E<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(T)===tr.OK&&(this.mainFragLoading=T=null),T&&lr(T))){if(x.start>T.end){const _=this.fragmentTracker.getFragAtPos(E,Oe.MAIN);_&&_.end>T.end&&(T=_,this.mainFragLoading={frag:_,targetBufferTime:null})}if(x.start>T.end)return}this.loadFragment(x,o,E)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(r=>new el(r))}onAudioTrackSwitching(e,t){const r=!!t.url;this.trackId=t.id;const{fragCurrent:n}=this;n&&(n.abortRequests(),this.removeUnbufferedFrags(n.start)),this.resetLoadingState(),r?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==oe.STOPPED&&(this.setInterval(vA),this.state=oe.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const r=this.cachedTrackLoadedData;r&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(b.AUDIO_TRACK_LOADED,r))}onAudioTrackLoaded(e,t){var r;const{levels:n}=this,{details:s,id:a,groupId:o,track:u}=t;if(!n){this.warn(`Audio tracks reset while loading track ${a} "${u.name}" of "${o}"`);return}const l=this.mainDetails;if(!l||s.endCC>l.endCC||l.expired){this.cachedTrackLoadedData=t,this.state!==oe.STOPPED&&(this.state=oe.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${a} "${u.name}" of "${o}" loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const h=n[a];let d=0;if(s.live||(r=h.details)!=null&&r.live){if(this.checkLiveUpdate(s),s.deltaUpdateFailed)return;if(h.details){var p;d=this.alignPlaylists(s,h.details,(p=this.levelLastLoaded)==null?void 0:p.details)}s.alignedSliding||(q2(s,l),s.alignedSliding||Ju(s,l),d=s.fragmentStart)}h.details=s,this.levelLastLoaded=h,this.startFragRequested||this.setStartPosition(l,d),this.hls.trigger(b.AUDIO_TRACK_UPDATED,{details:s,id:a,groupId:t.groupId}),this.state===oe.WAITING_TRACK&&!this.waitForCdnTuneIn(s)&&(this.state=oe.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const r=e.frag,{part:n,payload:s}=e,{config:a,trackId:o,levels:u}=this;if(!u){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const l=u[o];if(!l){this.warn("Audio track is undefined on fragment load progress");return}const h=l.details;if(!h){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(r.start);return}const d=a.defaultAudioCodec||l.audioCodec||"mp4a.40.2";let p=this.transmuxer;p||(p=this.transmuxer=new yA(this.hls,Oe.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const g=this.initPTS[r.cc],m=(t=r.initSegment)==null?void 0:t.data;if(g!==void 0){const E=n?n.index:-1,x=E!==-1,T=new hg(r.level,r.sn,r.stats.chunkCount,s.byteLength,E,x);p.push(s,m,d,"",r,n,h.totalduration,!1,T,g)}else{this.log(`Unknown video PTS for cc ${r.cc}, waiting for video PTS before demuxing audio frag ${r.sn} of [${h.startSN} ,${h.endSN}],track ${o}`);const{cache:v}=this.waitingData=this.waitingData||{frag:r,part:n,cache:new V2,complete:!1};v.push(new Uint8Array(s)),this.state!==oe.STOPPED&&(this.state=oe.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===Oe.MAIN&&lr(t.frag)&&(this.mainFragLoading=t,this.state===oe.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:r,part:n}=t;if(r.type!==Oe.AUDIO){!this.audioOnly&&r.type===Oe.MAIN&&!r.elementaryStreams.video&&!r.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${n?" p: "+n.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(lr(r)){this.fragPrevious=r;const s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(b.AUDIO_TRACK_SWITCHED,At({},s)))}this.fragBufferedComplete(r,n),this.media&&this.tick()}onError(e,t){var r;if(t.fatal){this.state=oe.ERROR;return}switch(t.details){case Q.FRAG_GAP:case Q.FRAG_PARSING_ERROR:case Q.FRAG_DECRYPT_ERROR:case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Oe.AUDIO,t);break;case Q.AUDIO_TRACK_LOAD_ERROR:case Q.AUDIO_TRACK_LOAD_TIMEOUT:case Q.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===oe.WAITING_TRACK&&((r=t.context)==null?void 0:r.type)===ot.AUDIO_TRACK&&(this.state=oe.IDLE);break;case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.resetLoadingState();break;case Q.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Q.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==wt.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==wt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===oe.ENDED&&(this.state=oe.IDLE);const r=this.mediaBuffer||this.media;r&&(this.afterBufferFlushed(r,t,Oe.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const r="audio",{hls:n}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:u,part:l,level:h}=o,{details:d}=h,{audio:p,text:g,id3:m,initSegment:v}=s;if(this.fragContextChanged(u)||!d){this.fragmentTracker.removeFragment(u);return}if(this.state=oe.PARSING,this.switchingTrack&&p&&this.completeAudioSwitch(this.switchingTrack),v!=null&&v.tracks){const E=u.initSegment||u;this._bufferInitSegment(h,v.tracks,E,a),n.trigger(b.FRAG_PARSING_INIT_SEGMENT,{frag:E,id:r,tracks:v.tracks})}if(p){const{startPTS:E,endPTS:x,startDTS:T,endDTS:R}=p;l&&(l.elementaryStreams[wt.AUDIO]={startPTS:E,endPTS:x,startDTS:T,endDTS:R}),u.setElementaryStreamInfo(wt.AUDIO,E,x,T,R),this.bufferFragmentData(p,u,l,a)}if(m!=null&&(t=m.samples)!=null&&t.length){const E=Tt({id:r,frag:u,details:d},m);n.trigger(b.FRAG_PARSING_METADATA,E)}if(g){const E=Tt({id:r,frag:u,details:d},g);n.trigger(b.FRAG_PARSING_USERDATA,E)}}_bufferInitSegment(e,t,r,n){if(this.state!==oe.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const s=t.audio;s.id=Oe.AUDIO;const a=e.audioCodec;this.log(`Init audio buffer, container:${s.container}, codecs[level/parsed]=[${a}/${s.codec}]`),a&&a.split(",").length===1&&(s.levelCodec=a),this.hls.trigger(b.BUFFER_CODECS,t);const o=s.initSegment;if(o!=null&&o.byteLength){const u={type:"audio",frag:r,part:null,chunkMeta:n,parent:r.type,data:o};this.hls.trigger(b.BUFFER_APPENDING,u)}this.tickImmediate()}loadFragment(e,t,r){const n=this.fragmentTracker.getState(e);if(this.switchingTrack||n===tr.NOT_LOADED||n===tr.PARTIAL){var s;if(!lr(e))this._loadInitSegment(e,t);else if((s=t.details)!=null&&s.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=oe.WAITING_INIT_PTS;const a=this.mainDetails;a&&a.fragmentStart!==t.details.fragmentStart&&Ju(t.details,a)}else super.loadFragment(e,t,r)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:r,assocLang:n,characteristics:s,audioCodec:a,channels:o}=this.bufferedTrack;Ks({name:t,lang:r,assocLang:n,characteristics:s,audioCodec:a,channels:o},e,Ws)||(Gu(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(b.AUDIO_TRACK_SWITCHED,At({},e))}}class kg extends In{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,r){const n=t==null?void 0:t.renditionReports;if(n){let s=-1;for(let a=0;a<n.length;a++){const o=n[a];let u;try{u=new self.URL(o.URI,t.url).href}catch(l){this.warn(`Could not construct new URL for Rendition Report: ${l}`),u=o.URI||""}if(u===e){s=a;break}else u===e.substring(0,u.length)&&(s=a)}if(s!==-1){const a=n[s],o=parseInt(a["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let u=parseInt(a["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const h=Math.min(t.age-t.partTarget,t.targetduration);u>=0&&h>t.partTarget&&(u+=1)}const l=r&&QE(r);return new ZE(o,u>=0?u:void 0,l)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(r){this.warn(`Could not construct new URL with HLS Delivery Directives: ${r}`)}return e}playlistLoaded(e,t,r){const{details:n,stats:s}=t,a=self.performance.now(),o=s.loading.first?Math.max(0,a-s.loading.first):0;n.advancedDateTime=Date.now()-o;const u=this.hls.config.timelineOffset;if(u!==n.appliedTimelineOffset){const h=Math.max(u||0,0);n.appliedTimelineOffset=h,n.fragments.forEach(d=>{d.start=d.playlistOffset+h})}if(n.live||r!=null&&r.live){const h="levelInfo"in t?t.levelInfo:t.track;if(n.reloaded(r),r&&n.fragments.length>0){CL(r,n);const T=n.playlistParsingError;if(T){this.warn(T);const R=this.hls;if(!R.config.ignorePlaylistParsingErrors){var l;const{networkDetails:_}=t;R.trigger(b.ERROR,{type:ke.NETWORK_ERROR,details:Q.LEVEL_PARSING_ERROR,fatal:!1,url:n.url,error:T,reason:T.message,level:t.level||void 0,parent:(l=n.fragments[0])==null?void 0:l.type,networkDetails:_,stats:s});return}n.playlistParsingError=null}}n.requestScheduled===-1&&(n.requestScheduled=s.loading.start);const d=this.hls.mainForwardBufferInfo,p=d?d.end-d.len:0,g=(n.edge-p)*1e3,m=P2(n,g);if(n.requestScheduled+m<a?n.requestScheduled=a:n.requestScheduled+=m,this.log(`live playlist ${e} ${n.advanced?"REFRESHED "+n.lastPartSn+"-"+n.lastPartIndex:n.updated?"UPDATED":"MISSED"}`),!this.canLoad||!n.live)return;let v,E,x;if(n.canBlockReload&&n.endSN&&n.advanced){const T=this.hls.config.lowLatencyMode,R=n.lastPartSn,_=n.endSN,F=n.lastPartIndex,N=F!==-1,C=R===_;N?C?(E=_+1,x=T?0:F):(E=R,x=T?F+1:n.maxPartIndex):E=_+1;const M=n.age,L=M+n.ageHeader;let I=Math.min(L-n.partTarget,n.targetduration*1.5);if(I>0){if(L>n.targetduration*3)this.log(`Playlist last advanced ${M.toFixed(2)}s ago. Omitting segment and part directives.`),E=void 0,x=void 0;else if(r!=null&&r.tuneInGoal&&L-n.partTarget>r.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${r.tuneInGoal} to: ${I} with playlist age: ${n.age}`),I=0;else{const U=Math.floor(I/n.targetduration);if(E+=U,x!==void 0){const q=Math.round(I%n.targetduration/n.partTarget);x+=q}this.log(`CDN Tune-in age: ${n.ageHeader}s last advanced ${M.toFixed(2)}s goal: ${I} skip sn ${U} to part ${x}`)}n.tuneInGoal=I}if(v=this.getDeliveryDirectives(n,t.deliveryDirectives,E,x),T||!C){n.requestScheduled=a,this.loadingPlaylist(h,v);return}}else(n.canBlockReload||n.canSkipUntil)&&(v=this.getDeliveryDirectives(n,t.deliveryDirectives,E,x));v&&E!==void 0&&n.canBlockReload&&(n.requestScheduled=s.loading.first+Math.max(m-o*2,m/2)),this.scheduleLoading(h,v,n)}else this.clearTimer()}scheduleLoading(e,t,r){const n=r||e.details;if(!n){this.loadingPlaylist(e,t);return}const s=self.performance.now(),a=n.requestScheduled;if(s>=a){this.loadingPlaylist(e,t);return}const o=a-s;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(o)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),o)}getDeliveryDirectives(e,t,r,n){let s=QE(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,n=t.part,s=$u.No),new ZE(r,n,s)}checkRetry(e){const t=e.details,r=qu(e),n=e.errorAction,{action:s,retryCount:a=0,retryConfig:o}=n||{},u=!!n&&!!o&&(s===Sr.RetryRequest||!n.resolved&&s===Sr.SendAlternateToPenaltyBox);if(u){var l;if(a>=o.maxNumRetry)return!1;if(r&&(l=e.context)!=null&&l.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const h=ug(o,a);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),h),this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" in ${h}ms`)}e.levelRetry=!0,n.resolved=!0}return u}}function EA(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!cl(i[t].attrs,e[t].attrs))return!1;return!0}function cl(i,e,t){const r=i["STABLE-RENDITION-ID"];return r&&!t?r===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(n=>i[n]!==e[n])}function Fg(i,e){return e.label.toLowerCase()===i.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(i.lang||"").toLowerCase())}class P_ extends kg{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(b.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVEL_LOADING,this.onLevelLoading,this),e.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(b.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:r,groupId:n,details:s}=t,a=this.tracksInGroup[r];if(!a||a.groupId!==n){this.warn(`Audio track with id:${r} and group:${n} not found in active group ${a==null?void 0:a.groupId}`);return}const o=a.details;a.details=t.details,this.log(`Audio track ${r} "${a.name}" lang:${a.lang} group:${n} loaded [${s.startSN}-${s.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.audioGroups||null,n=this.groupIds;let s=this.currentTrack;if(!r||(n==null?void 0:n.length)!==(r==null?void 0:r.length)||r!=null&&r.some(o=>(n==null?void 0:n.indexOf(o))===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(p=>!r||r.indexOf(p.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(p=>p.default)&&(this.selectDefaultTrack=!1),o.forEach((p,g)=>{p.id=g});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const u=this.hls.config.audioPreference;if(!s&&u){const p=rn(u,o,Ws);if(p>-1)s=o[p];else{const g=rn(u,this.tracks);s=this.tracks[g]}}let l=this.findTrackId(s);l===-1&&s&&(l=this.findTrackId(null));const h={audioTracks:o};this.log(`Updating audio tracks, ${o.length} track(s) found in group(s): ${r==null?void 0:r.join(",")}`),this.hls.trigger(b.AUDIO_TRACKS_UPDATED,h);const d=this.trackId;if(l!==-1&&d===-1)this.setAudioTrack(l);else if(o.length&&d===-1){var a;const p=new Error(`No audio track selected for current audio group-ID(s): ${(a=this.groupIds)==null?void 0:a.join(",")} track count: ${o.length}`);this.warn(p.message),this.hls.trigger(b.ERROR,{type:ke.MEDIA_ERROR,details:Q.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:p})}}}onError(e,t){t.fatal||!t.context||t.context.type===ot.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const r=this.allAudioTracks;if(this.selectDefaultTrack=!1,r.length){const n=this.currentTrack;if(n&&Ks(e,n,Ws))return n;const s=rn(e,this.tracksInGroup,Ws);if(s>-1){const a=this.tracksInGroup[s];return this.setAudioTrack(s),a}else if(n){let a=t.loadLevel;a===-1&&(a=t.firstAutoLevel);const o=zN(e,t.levels,r,a,Ws);if(o===-1)return null;t.nextLoadLevel=o}if(e.channels||e.audioCodec){const a=rn(e,r);if(a>-1)return r[a]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,n=t[e],s=n.details&&!n.details.live;if(e===this.trackId&&n===r&&s||(this.log(`Switching to audio-track ${e} "${n.name}" lang:${n.lang} group:${n.groupId} channels:${n.channels}`),this.trackId=e,this.currentTrack=n,this.hls.trigger(b.AUDIO_TRACK_SWITCHING,At({},n)),s))return;const a=this.switchParams(n.url,r==null?void 0:r.details,n.details);this.loadPlaylist(a)}findTrackId(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const n=t[r];if(!(this.selectDefaultTrack&&!n.default)&&(!e||Ks(e,n,Ws)))return r}if(e){const{name:r,lang:n,assocLang:s,characteristics:a,audioCodec:o,channels:u}=e;for(let l=0;l<t.length;l++){const h=t[l];if(Ks({name:r,lang:n,assocLang:s,characteristics:a,audioCodec:o,channels:u},h,Ws))return l}for(let l=0;l<t.length;l++){const h=t[l];if(cl(e.attrs,h.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return l}for(let l=0;l<t.length;l++){const h=t[l];if(cl(e.attrs,h.attrs,["LANGUAGE"]))return l}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&Gu(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,n=e.groupId,s=this.getUrlWithDirectives(e.url,t),a=e.details,o=a==null?void 0:a.age;this.log(`Loading audio-track ${r} "${e.name}" lang:${e.lang} group:${n}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${s}`),this.hls.trigger(b.AUDIO_TRACK_LOADING,{url:s,id:r,groupId:n,deliveryDirectives:t||null,track:e})}}class k_{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,r){if(this.queues===null||this.tracks===null)return;const n=this.queues[t];n.push(e),n.length===1&&!r&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const r={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(r,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const r={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(r)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const r=(t=e[0])==null?void 0:t.label;(r==="async-blocker"||r==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const n=t[0];try{n.execute()}catch(s){var r;if(n.onError(s),this.queues===null||this.tracks===null)return;const a=(r=this.tracks[e])==null?void 0:r.buffer;a!=null&&a.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,r;return(t=this.queues)!=null&&t[e]||(r=this.tracks)!=null&&r[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const r=(t=this.tracks)==null?void 0:t[e],n=r==null?void 0:r.buffer;return n?`SourceBuffer${n.updating?" updating":""}${r.ended?" ended":""}${r.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(r=>r.label).join(", "))||""}}const AA=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,xA="HlsJsTrackRemovedError";class F_ extends Error{constructor(e){super(e),this.name=xA}}class B_ extends In{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=r=>{var n;this.hls&&((n=this.mediaSource)==null?void 0:n.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=r=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=r=>{const{media:n,mediaSource:s}=this;r&&this.log("Media source opened"),!(!n||!s)&&(s.removeEventListener("sourceopen",this._onMediaSourceOpen),n.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(b.MEDIA_ATTACHED,{media:n,mediaSource:s}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:r,_objectUrl:n}=this;r!==n&&this.error(`Media element src was set while attaching MediaSource (${n} > ${r})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=fN(us(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.BUFFER_RESET,this.onBufferReset,this),e.on(b.BUFFER_APPENDING,this.onBufferAppending,this),e.on(b.BUFFER_CODECS,this.onBufferCodecs,this),e.on(b.BUFFER_EOS,this.onBufferEos,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(b.FRAG_PARSED,this.onFragParsed,this),e.on(b.FRAG_CHANGED,this.onFragChanged,this),e.on(b.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.BUFFER_RESET,this.onBufferReset,this),e.off(b.BUFFER_APPENDING,this.onBufferAppending,this),e.off(b.BUFFER_CODECS,this.onBufferCodecs,this),e.off(b.BUFFER_EOS,this.onBufferEos,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(b.FRAG_PARSED,this.onFragParsed,this),e.off(b.FRAG_CHANGED,this.onFragChanged,this),e.off(b.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const r={};if(this.operationQueue){const s=this.isUpdating();s||this.operationQueue.removeBlockers();const a=this.isQueued();(s||a)&&this.warn(`Transfering MediaSource with${a?" operations in queue":""}${s?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const n=this.transferData;return!this.sourceBufferCount&&n&&n.mediaSource===t?Tt(r,n.tracks):this.sourceBuffers.forEach(s=>{const[a]=s;a&&(r[a]=Tt({},this.tracks[a]),this.removeBuffer(a)),s[0]=s[1]=null}),{media:e,mediaSource:t,tracks:r}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var r;let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsTotal=n,this.log(`${n} bufferCodec event(s) expected.`),(r=this.transferData)!=null&&r.mediaSource&&this.sourceBufferCount&&n&&this.bufferCreated()}onMediaAttaching(e,t){const r=this.media=t.media,n=us(this.appendSource);if(this.transferData=this.overrides=void 0,r&&n){const s=!!t.mediaSource;(s||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const a=this.mediaSource=t.mediaSource||new n;if(this.assignMediaSource(a),s)this._objectUrl=r.src,this.attachTransferred();else{const o=this._objectUrl=self.URL.createObjectURL(a);if(this.appendSource)try{r.removeAttribute("src");const u=self.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||u&&a instanceof u,SA(r),U_(r,o),r.load()}catch{r.src=o}else r.src=o}r.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,r;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(r=e.constructor)==null?void 0:r.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const r=this.tracks,n=t.tracks,s=n?Object.keys(n):null,a=s?s.length:0,o=()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()};if(n&&s&&a){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${Bt(r,(u,l)=>u==="initSegment"?void 0:l)};
transfer tracks: ${Bt(n,(u,l)=>u==="initSegment"?void 0:l)}}`),!NE(n,r)){t.mediaSource=null,t.tracks=void 0;const u=e.currentTime,l=this.details,h=Math.max(u,(l==null?void 0:l.fragments[0].start)||0);if(h-u>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${u} -> ${h}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(n)}"->"${Object.keys(r)}") start time: ${h} currentTime: ${u}`),this.onMediaDetaching(b.MEDIA_DETACHING,{}),this.onMediaAttaching(b.MEDIA_ATTACHING,t),e.currentTime=h;return}this.transferData=void 0,s.forEach(u=>{const l=u,h=n[l];if(h){const d=h.buffer;if(d){const p=this.fragmentTracker,g=h.id;if(p.hasFragments(g)||p.hasParts(g)){const E=Xe.getBuffered(d);p.detectEvictedFragments(l,E,g,null,!0)}const m=Bg(l),v=[l,d];this.sourceBuffers[m]=v,d.updating&&this.operationQueue&&this.operationQueue.prependBlocker(l),this.trackSourceBuffer(l,h)}}}),o(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),o()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const r=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:n,mediaSource:s,_objectUrl:a}=this;if(s){if(this.log(`media source ${r?"transferring":"detaching"}`),r)this.sourceBuffers.forEach(([o])=>{o&&this.removeBuffer(o)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const o=s.readyState==="open";try{const u=s.sourceBuffers;for(let l=u.length;l--;)o&&u[l].abort(),s.removeSourceBuffer(u[l]);o&&s.endOfStream()}catch(u){this.warn(`onMediaDetaching: ${u.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}s.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("sourceended",this._onMediaSourceEnded),s.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(s.removeEventListener("startstreaming",this._onStartStreaming),s.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}n&&(n.removeEventListener("emptied",this._onMediaEmptied),r||(a&&self.URL.revokeObjectURL(a),this.mediaSrc===a?(n.removeAttribute("src"),this.appendSource&&SA(n),n.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(b.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const r=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),r)try{var n;(n=this.mediaSource)!=null&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(r)}catch(s){this.warn(`onBufferReset ${e}`,s)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[Bg(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new k_(this.tracks)}onBufferCodecs(e,t){const r=this.tracks,n=Object.keys(t);this.log(`BUFFER_CODECS: "${n}" (current SB count ${this.sourceBufferCount})`);const s="audiovideo"in t&&(r.audio||r.video)||r.audiovideo&&("audio"in t||"video"in t),a=!s&&this.sourceBufferCount&&this.media&&n.some(o=>!r[o]);if(s||a){this.warn(`Unsupported transition between "${Object.keys(r)}" and "${n}" SourceBuffers`);return}n.forEach(o=>{var u,l,h;const d=t[o],{id:p,codec:g,levelCodec:m,container:v,metadata:E,supplemental:x}=d;let T=r[o];const R=(u=this.transferData)==null||(l=u.tracks)==null?void 0:l[o],_=R!=null&&R.buffer?R:T,F=(_==null?void 0:_.pendingCodec)||(_==null?void 0:_.codec),N=_==null?void 0:_.levelCodec;T||(T=r[o]={buffer:void 0,listeners:[],codec:g,supplemental:x,container:v,levelCodec:m,metadata:E,id:p});const C=Bu(F,N),M=C==null?void 0:C.replace(AA,"$1");let L=Bu(g,m);const I=(h=L)==null?void 0:h.replace(AA,"$1");L&&C&&M!==I&&(o.slice(0,5)==="audio"&&(L=Fu(L,this.appendSource)),this.log(`switching codec ${F} to ${L}`),L!==(T.pendingCodec||T.codec)&&(T.pendingCodec=L),T.container=v,this.appendChangeType(o,v,L))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&this.mediaSourceOpenOrEnded&&this.checkPendingTracks()}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const r=this.tracks[t];return e[t]={id:r.id,container:r.container,codec:r.codec,levelCodec:r.levelCodec},e},{})}appendChangeType(e,t,r){const n=`${t};codecs=${r}`,s={label:`change-type=${n}`,execute:()=>{const a=this.tracks[e];if(a){const o=a.buffer;o!=null&&o.changeType&&(this.log(`changing ${e} sourceBuffer type to ${n}`),o.changeType(n),a.codec=r,a.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:a=>{this.warn(`Failed to change ${e} SourceBuffer type`,a)}};this.append(s,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const r=e.start,n=r+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(r,Oe.MAIN))==null?void 0:t.gap)===!0)return;const a={label:"block-audio",execute:()=>{var o;const u=this.tracks.video;(this.lastVideoAppendEnd>n||u!=null&&u.buffer&&Xe.isBuffered(u.buffer,n)||((o=this.fragmentTracker.getAppendedFrag(n,Oe.MAIN))==null?void 0:o.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn("Error executing block-audio operation",o)}};this.blockedAudioAppend={op:a,frag:e},this.append(a,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:r}=this,{data:n,type:s,parent:a,frag:o,part:u,chunkMeta:l}=t,h=l.buffering[s],d=o.sn,p=self.performance.now();h.start=p;const g=o.stats.buffering,m=u?u.stats.buffering:null;g.start===0&&(g.start=p),m&&m.start===0&&(m.start=p);const v=r.audio;let E=!1;s==="audio"&&(v==null?void 0:v.container)==="audio/mpeg"&&(E=!this.lastMpegAudioChunk||l.id===1||this.lastMpegAudioChunk.sn!==l.sn,this.lastMpegAudioChunk=l);const x=this.tracks.video,T=x==null?void 0:x.buffer;if(T&&d!=="initSegment"){const F=u||o,N=this.blockedAudioAppend;if(s==="audio"&&a!=="main"&&!this.blockedAudioAppend){const M=F.start+F.duration*.05,L=T.buffered,I=this.currentOp("video");!L.length&&!I?this.blockAudio(F):!I&&!Xe.isBuffered(T,M)&&this.lastVideoAppendEnd<M&&this.blockAudio(F)}else if(s==="video"){const C=F.end;if(N){const M=N.frag.start;(C>M||C<this.lastVideoAppendEnd||Xe.isBuffered(T,M))&&this.unblockAudio()}this.lastVideoAppendEnd=C}}const R=(u||o).start,_={label:`append-${s}`,execute:()=>{if(h.executeStart=self.performance.now(),E){const F=this.tracks[s];if(F){const N=F.buffer;if(N){const C=R-N.timestampOffset;Math.abs(C)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${R} (delta: ${C}) sn: ${d})`),N.timestampOffset=R)}}}this.appendExecutor(n,s)},onStart:()=>{},onComplete:()=>{const F=self.performance.now();h.executeEnd=h.end=F,g.first===0&&(g.first=F),m&&m.first===0&&(m.first=F);const N={};this.sourceBuffers.forEach(([C,M])=>{C&&(N[C]=Xe.getBuffered(M))}),this.appendErrors[s]=0,s==="audio"||s==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(b.BUFFER_APPENDED,{type:s,frag:o,part:u,chunkMeta:l,parent:o.type,timeRanges:N})},onError:F=>{var N;const C={type:ke.MEDIA_ERROR,parent:o.type,details:Q.BUFFER_APPEND_ERROR,sourceBufferName:s,frag:o,part:u,chunkMeta:l,error:F,err:F,fatal:!1},M=(N=this.media)==null?void 0:N.error;if(F.code===DOMException.QUOTA_EXCEEDED_ERR)C.details=Q.BUFFER_FULL_ERROR;else if(F.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!M)C.errorAction=tl(!0);else if(F.name===xA&&this.sourceBufferCount===0)C.errorAction=tl(!0);else{const L=++this.appendErrors[s];this.warn(`Failed ${L}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${s}" sourceBuffer (${M||"no media error"})`),(L>=this.hls.config.appendErrorMaxRetry||M)&&(C.fatal=!0)}this.hls.trigger(b.ERROR,C)}};this.append(_,s,this.isPending(this.tracks[s]))}getFlushOp(e,t,r){return this.log(`queuing "${e}" remove ${t}-${r}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,r)},onStart:()=>{},onComplete:()=>{this.hls.trigger(b.BUFFER_FLUSHED,{type:e})},onError:n=>{this.warn(`Failed to remove ${t}-${r} from "${e}" SourceBuffer`,n)}}}onBufferFlushing(e,t){const{type:r,startOffset:n,endOffset:s}=t;r?this.append(this.getFlushOp(r,n,s),r):this.sourceBuffers.forEach(([a])=>{a&&this.append(this.getFlushOp(a,n,s),a)})}onFragParsed(e,t){const{frag:r,part:n}=t,s=[],a=n?n.elementaryStreams:r.elementaryStreams;a[wt.AUDIOVIDEO]?s.push("audiovideo"):(a[wt.AUDIO]&&s.push("audio"),a[wt.VIDEO]&&s.push("video"));const o=()=>{const u=self.performance.now();r.stats.buffering.end=u,n&&(n.stats.buffering.end=u);const l=n?n.stats:r.stats;this.hls.trigger(b.FRAG_BUFFERED,{frag:r,part:n,stats:l,id:r.type})};s.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: ${r.sn}`),this.blockBuffers(o,s).catch(u=>{this.warn(`Fragment buffered callback ${u}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{var t,r;return e&&(!((t=this.tracks[e])!=null&&t.ended)||((r=this.tracks[e])==null?void 0:r.ending))})}onBufferEos(e,t){var r;this.sourceBuffers.forEach(([a])=>{if(a){const o=this.tracks[a];(!t.type||t.type===a)&&(o.ending=!0,o.ended||(o.ended=!0,this.log(`${a} buffer reached EOS`)))}});const n=((r=this.overrides)==null?void 0:r.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([a])=>{var o;return a&&!((o=this.tracks[a])!=null&&o.ended)})&&(n?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:a}=this;if(!a||a.readyState!=="open"){a&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${a.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),a.endOfStream(),this.hls.trigger(b.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(b.BUFFERED_TO_END,void 0)))}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){const e=this.getDurationAndRange();e&&this.blockUntilOpen(()=>this.updateMediaSource(e))}onError(e,t){if(t.details===Q.BUFFER_APPEND_ERROR&&t.frag){var r;const n=(r=t.errorAction)==null?void 0:r.nextAutoLevel;Ce(n)&&n!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:r}=this;if(!r||t===null||!this.sourceBufferCount)return;const n=e.config,s=r.currentTime,a=t.levelTargetDuration,o=t.live&&n.liveBackBufferLength!==null?n.liveBackBufferLength:n.backBufferLength;if(Ce(o)&&o>=0){const u=Math.max(o,a),l=Math.floor(s/a)*a-u;this.flushBackBuffer(s,a,l)}if(Ce(n.frontBufferFlushThreshold)&&n.frontBufferFlushThreshold>0){const u=Math.max(n.maxBufferLength,n.frontBufferFlushThreshold),l=Math.max(u,a),h=Math.floor(s/a)*a+l;this.flushFrontBuffer(s,a,h)}}flushBackBuffer(e,t,r){this.sourceBuffers.forEach(([n,s])=>{if(s){const o=Xe.getBuffered(s);if(o.length>0&&r>o.start(0)){var a;this.hls.trigger(b.BACK_BUFFER_REACHED,{bufferEnd:r});const u=this.tracks[n];if((a=this.details)!=null&&a.live)this.hls.trigger(b.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(u!=null&&u.ended){this.log(`Cannot flush ${n} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(b.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:n})}}})}flushFrontBuffer(e,t,r){this.sourceBuffers.forEach(([n,s])=>{if(s){const a=Xe.getBuffered(s),o=a.length;if(o<2)return;const u=a.start(o-1),l=a.end(o-1);if(r>u||e>=u&&e<=l)return;this.hls.trigger(b.BUFFER_FLUSHING,{startOffset:u,endOffset:1/0,type:n})}})}getDurationAndRange(){var e;const{details:t,mediaSource:r}=this;if(!t||!this.media||(r==null?void 0:r.readyState)!=="open")return null;const n=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&t.live&&r.setLiveSeekableRange){const l=Math.max(0,t.fragmentStart),h=Math.max(l,n);return{duration:1/0,start:l,end:h}}return{duration:1/0}}const s=(e=this.overrides)==null?void 0:e.duration;if(s)return Ce(s)?{duration:s}:null;const a=this.media.duration,o=Ce(r.duration)?r.duration:0;return n>o&&n>a||!Ce(a)?{duration:n}:null}updateMediaSource({duration:e,start:t,end:r}){const n=this.mediaSource;!this.media||!n||n.readyState!=="open"||(n.duration!==e&&(Ce(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),n.duration=e),t!==void 0&&r!==void 0&&(this.log(`MediaSource duration is set to ${n.duration}. Setting seekable range to ${t}-${r}.`),n.setLiveSeekableRange(t,r)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:r}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${Bt(r)}`),this.tracksReady){var n;const s=(n=this.transferData)==null?void 0:n.tracks;s&&Object.keys(s).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,r])=>{if(t){const n=this.tracks[t];e[t]={buffer:r,container:n.container,codec:n.codec,supplemental:n.supplemental,levelCodec:n.levelCodec,id:n.id,metadata:n.metadata}}}),this.hls.trigger(b.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(b.ERROR,{type:ke.MEDIA_ERROR,details:Q.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:r}=this;if(!r)throw new Error("createSourceBuffers called when mediaSource was null");for(const s in e){const a=s,o=e[a];if(this.isPending(o)){const u=this.getTrackCodec(o,a),l=`${o.container};codecs=${u}`;o.codec=u,this.log(`creating sourceBuffer(${l})${this.currentOp(a)?" Queued":""} ${Bt(o)}`);try{const h=r.addSourceBuffer(l),d=Bg(a),p=[a,h];t[d]=p,o.buffer=h}catch(h){var n;this.error(`error while trying to add sourceBuffer: ${h.message}`),this.shiftAndExecuteNext(a),(n=this.operationQueue)==null||n.removeBlockers(),delete this.tracks[a],this.hls.trigger(b.ERROR,{type:ke.MEDIA_ERROR,details:Q.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:h,sourceBufferName:a,mimeType:l,parent:o.id});return}this.trackSourceBuffer(a,o)}}this.bufferCreated()}getTrackCodec(e,t){const r=e.supplemental;let n=e.codec;r&&(t==="video"||t==="audiovideo")&&ag(r,"video")&&(n=PN(n,r));const s=Bu(n,e.levelCodec);return s?t.slice(0,5)==="audio"?Fu(s,this.appendSource):s:""}trackSourceBuffer(e,t){const r=t.buffer;if(!r)return;const n=this.getTrackCodec(t,e);this.tracks[e]={buffer:r,codec:n,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(s,a)=>{const o=a.removedRanges;o!=null&&o.length&&this.hls.trigger(b.BUFFER_FLUSHED,{type:s})})}get mediaSrc(){var e,t;const r=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return r==null?void 0:r.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const r=this.currentOp(e);r&&(r.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var r;const n=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(r=this.mediaSource)==null?void 0:r.readyState}`);this.error(`${n}`,t),this.hls.trigger(b.ERROR,{type:ke.MEDIA_ERROR,details:Q.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:n,fatal:!1});const s=this.currentOp(e);s&&s.onError(n)}removeExecutor(e,t,r){const{media:n,mediaSource:s}=this,a=this.tracks[e],o=a==null?void 0:a.buffer;if(!n||!s||!o){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const u=Ce(n.duration)?n.duration:1/0,l=Ce(s.duration)?s.duration:1/0,h=Math.max(0,t),d=Math.min(r,u,l);d>h&&(!a.ending||a.ended)?(a.ended=!1,this.log(`Removing [${h},${d}] from the ${e} SourceBuffer`),o.remove(h,d)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const r=this.tracks[t],n=r==null?void 0:r.buffer;if(!n)throw new F_(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);r.ending=!1,r.ended=!1,n.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:r}=this,n=t.map(a=>this.appendBlocker(a));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(n).then(a=>{r===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var r;const n=(r=this.tracks[t])==null?void 0:r.buffer;!n||n.updating||this.shiftAndExecuteNext(t)})}append(e,t,r){this.operationQueue&&this.operationQueue.append(e,t,r)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,r){const n=this.tracks[e];if(!n)return;const s=n.buffer;if(!s)return;const a=r.bind(this,e);n.listeners.push({event:t,listener:a}),s.addEventListener(t,a)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const r=t.buffer;r&&(t.listeners.forEach(n=>{r.removeEventListener(n.event,n.listener)}),t.listeners.length=0)}}function SA(i){const e=i.querySelectorAll("source");[].slice.call(e).forEach(t=>{i.removeChild(t)})}function U_(i,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,i.appendChild(t)}function Bg(i){return i==="audio"?1:0}class Ug{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(b.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.BUFFER_CODECS,this.onBufferCodecs,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(b.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.BUFFER_CODECS,this.onBufferCodecs,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&Ce(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,r=this.getMaxLevel(e.length-1);r!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${r}: ${e[r].height}p@${e[r].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=r,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const r=t.filter((n,s)=>this.isLevelAllowed(n)&&s<=e);return this.clientRect=null,Ug.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,!t.width&&!t.height&&(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(r=>e.bitrate===r.bitrate&&e.width===r.width&&e.height===r.height)}static getMaxLevelByMediaSize(e,t,r){if(!(e!=null&&e.length))return-1;const n=(o,u)=>u?o.width!==u.width||o.height!==u.height:!0;let s=e.length-1;const a=Math.max(t,r);for(let o=0;o<e.length;o+=1){const u=e[o];if((u.width>=a||u.height>=a)&&n(u,e[o+1])){s=o;break}}return s}}const Vr={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},$_={HLS:"h"},hl={OBJECT:"CMCD-Object",REQUEST:"CMCD-Request",SESSION:"CMCD-Session",STATUS:"CMCD-Status"},G_={[hl.OBJECT]:["br","d","ot","tb"],[hl.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[hl.SESSION]:["cid","pr","sf","sid","st","v"],[hl.STATUS]:["bs","rtp"]};class ja{constructor(e,t){Array.isArray(e)&&(e=e.map(r=>r instanceof ja?r:new ja(r))),this.value=e,this.params=t}}const q_="Dict";function H_(i){return Array.isArray(i)?JSON.stringify(i):i instanceof Map?"Map{}":i instanceof Set?"Set{}":typeof i=="object"?JSON.stringify(i):String(i)}function V_(i,e,t,r){return new Error(`failed to ${i} "${H_(e)}" as ${t}`,{cause:r})}function an(i,e,t){return V_("serialize",i,e,t)}class bA{constructor(e){this.description=e}}const TA="Bare Item",K_="Boolean";function W_(i){if(typeof i!="boolean")throw an(i,K_);return i?"?1":"?0"}function Y_(i){return btoa(String.fromCharCode(...i))}const X_="Byte Sequence";function z_(i){if(ArrayBuffer.isView(i)===!1)throw an(i,X_);return`:${Y_(i)}:`}const j_="Integer";function J_(i){return i<-999999999999999||999999999999999<i}function DA(i){if(J_(i))throw an(i,j_);return i.toString()}function Q_(i){return`@${DA(i.getTime()/1e3)}`}function RA(i,e){if(i<0)return-RA(-i,e);const t=Math.pow(10,e);if(Math.abs(i*t%1-.5)<Number.EPSILON){const n=Math.floor(i*t);return(n%2===0?n:n+1)/t}else return Math.round(i*t)/t}const Z_="Decimal";function eM(i){const e=RA(i,3);if(Math.floor(Math.abs(e)).toString().length>12)throw an(i,Z_);const t=e.toString();return t.includes(".")?t:`${t}.0`}const tM="String",rM=/[\x00-\x1f\x7f]+/;function iM(i){if(rM.test(i))throw an(i,tM);return`"${i.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function nM(i){return i.description||i.toString().slice(7,-1)}const sM="Token";function IA(i){const e=nM(i);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw an(e,sM);return e}function $g(i){switch(typeof i){case"number":if(!Ce(i))throw an(i,TA);return Number.isInteger(i)?DA(i):eM(i);case"string":return iM(i);case"symbol":return IA(i);case"boolean":return W_(i);case"object":if(i instanceof Date)return Q_(i);if(i instanceof Uint8Array)return z_(i);if(i instanceof bA)return IA(i);default:throw an(i,TA)}}const aM="Key";function Gg(i){if(/^[a-z*][a-z0-9\-_.*]*$/.test(i)===!1)throw an(i,aM);return i}function qg(i){return i==null?"":Object.entries(i).map(([e,t])=>t===!0?`;${Gg(e)}`:`;${Gg(e)}=${$g(t)}`).join("")}function wA(i){return i instanceof ja?`${$g(i.value)}${qg(i.params)}`:$g(i)}function oM(i){return`(${i.value.map(wA).join(" ")})${qg(i.params)}`}function lM(i,e={whitespace:!0}){if(typeof i!="object")throw an(i,q_);const t=i instanceof Map?i.entries():Object.entries(i),r=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([n,s])=>{s instanceof ja||(s=new ja(s));let a=Gg(n);return s.value===!0?a+=qg(s.params):(a+="=",Array.isArray(s.value)?a+=oM(s):a+=wA(s)),a}).join(`,${r}`)}function uM(i,e){return lM(i,e)}function cM(i){return i==="ot"||i==="sf"||i==="st"}function hM(i){return typeof i=="number"?Ce(i):i!=null&&i!==""&&i!==!1}function dM(i,e){const t=new URL(i),r=new URL(e);if(t.origin!==r.origin)return i;const n=t.pathname.split("/").slice(1),s=r.pathname.split("/").slice(1,-1);for(;n[0]===s[0];)n.shift(),s.shift();for(;s.length;)s.shift(),n.unshift("..");return n.join("/")}const sc=i=>Math.round(i),fM=(i,e)=>(e!=null&&e.baseUrl&&(i=dM(i,e.baseUrl)),encodeURIComponent(i)),ac=i=>sc(i/100)*100,gM={br:sc,d:sc,bl:ac,dl:ac,mtp:ac,nor:fM,rtp:ac,tb:sc};function pM(i,e){const t={};if(i==null||typeof i!="object")return t;const r=Object.keys(i).sort(),n=Tt({},gM,e==null?void 0:e.formatters),s=e==null?void 0:e.filter;return r.forEach(a=>{if(s!=null&&s(a))return;let o=i[a];const u=n[a];u&&(o=u(o,e)),!(a==="v"&&o===1)&&(a=="pr"&&o===1||hM(o)&&(cM(a)&&typeof o=="string"&&(o=new bA(o)),t[a]=o))}),t}function CA(i,e={}){return i?uM(pM(i,e),Tt({whitespace:!1},e)):""}function mM(i,e={}){const t={};if(!i)return t;const r=Object.entries(i),n=Object.entries(G_).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),s=r.reduce((a,o)=>{var u,l;const[h,d]=o,p=((u=n.find(g=>g[1].includes(h)))===null||u===void 0?void 0:u[0])||hl.REQUEST;return(l=a[p])!==null&&l!==void 0||(a[p]={}),a[p][h]=d,a},{});return Object.entries(s).reduce((a,[o,u])=>(a[o]=CA(u,e),a),t)}function yM(i,e,t){return Tt(i,mM(e,t))}const vM="CMCD";function EM(i,e={}){if(!i)return"";const t=CA(i,e);return`${vM}=${encodeURIComponent(t)}`}const NA=/CMCD=[^&#]+/;function AM(i,e,t){const r=EM(e,t);if(!r)return i;if(NA.test(i))return i.replace(NA,r);const n=i.includes("?")?"&":"?";return`${i}${n}${r}`}class xM{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=n=>{try{this.apply(n,{ot:Vr.MANIFEST,su:!this.initialized})}catch(s){this.hls.logger.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=n=>{try{const{frag:s,part:a}=n,o=this.hls.levels[s.level],u=this.getObjectType(s),l={d:(a||s).duration*1e3,ot:u};(u===Vr.VIDEO||u===Vr.AUDIO||u==Vr.MUXED)&&(l.br=o.bitrate/1e3,l.tb=this.getTopBandwidth(u)/1e3,l.bl=this.getBufferLength(u));const h=a?this.getNextPart(a):this.getNextFrag(s);h!=null&&h.url&&h.url!==s.url&&(l.nor=h.url),this.apply(n,l)}catch(s){this.hls.logger.warn("Could not generate segment CMCD data.",s)}},this.hls=e;const t=this.config=e.config,{cmcd:r}=t;r!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||e.sessionId,this.cid=r.contentId,this.useHeaders=r.useHeaders===!0,this.includeKeys=r.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHED,this.onMediaDetached,this),e.on(b.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHED,this.onMediaDetached,this),e.off(b.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var r,n;this.audioBuffer=(r=t.tracks.audio)==null?void 0:r.buffer,this.videoBuffer=(n=t.tracks.video)==null?void 0:n.buffer}createData(){var e;return{v:1,sf:$_.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Tt(t,this.createData());const r=t.ot===Vr.INIT||t.ot===Vr.VIDEO||t.ot===Vr.MUXED;this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:n}=this;n&&(t=Object.keys(t).reduce((a,o)=>(n.includes(o)&&(a[o]=t[o]),a),{}));const s={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),yM(e.headers,t,s)):e.url=AM(e.url,t,s)}getNextFrag(e){var t;const r=(t=this.hls.levels[e.level])==null?void 0:t.details;if(r){const n=e.sn-r.startSN;return r.fragments[n+1]}}getNextPart(e){var t,r;const{index:n,fragment:s}=e,a=(t=this.hls.levels[s.level])==null||(r=t.details)==null?void 0:r.partList;if(a){const{sn:o}=s;for(let u=a.length-1;u>=0;u--){const l=a[u];if(l.index===n&&l.fragment.sn===o)return a[u+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return Vr.TIMED_TEXT;if(e.sn==="initSegment")return Vr.INIT;if(t==="audio")return Vr.AUDIO;if(t==="main")return this.hls.audioTracks.length?Vr.VIDEO:Vr.MUXED}getTopBandwidth(e){let t=0,r;const n=this.hls;if(e===Vr.AUDIO)r=n.audioTracks;else{const s=n.maxAutoLevel,a=s>-1?s+1:n.levels.length;r=n.levels.slice(0,a)}return r.forEach(s=>{s.bitrate>t&&(t=s.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,r=e===Vr.AUDIO?this.audioBuffer:this.videoBuffer;return!r||!t?NaN:Xe.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,r=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new r(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){t(s),this.loader.load(s,a,o)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,r=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new r(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){t(s),this.loader.load(s,a,o)}}}}const SM=3e5;class bM extends In{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(r=>r!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:r}=t;r!==null&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:r}=t;if((r==null?void 0:r.action)===Sr.SendAlternateToPenaltyBox&&r.flags===Ni.MoveAllAlternatesMatchingHost){const n=this.levels;let s=this._pathwayPriority,a=this.pathwayId;if(t.context){const{groupId:o,pathwayId:u,type:l}=t.context;o&&n?a=this.getPathwayForGroupId(o,l,a):u&&(a=u)}a in this.penalizedPathways||(this.penalizedPathways[a]=performance.now()),!s&&n&&(s=this.pathways()),s&&s.length>1&&(this.updatePathwayPriority(s),r.resolved=this.pathwayId!==a),r.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${a} levels: ${n&&n.length} priorities: ${Bt(s)} penalized: ${Bt(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const r=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const r=this.penalizedPathways,n=performance.now();Object.keys(r).forEach(s=>{n-r[s]>SM&&delete r[s]});for(let s=0;s<e.length;s++){const a=e[s];if(a in r)continue;if(a===this.pathwayId)return;const o=this.hls.nextLoadLevel,u=this.hls.levels[o];if(t=this.getLevelsForPathway(a),t.length>0){this.log(`Setting Pathway to "${a}"`),this.pathwayId=a,U2(t),this.hls.trigger(b.LEVELS_UPDATED,{levels:t});const l=this.hls.levels[o];u&&l&&this.levels&&(l.attrs["STABLE-VARIANT-ID"]!==u.attrs["STABLE-VARIANT-ID"]&&l.bitrate!==u.bitrate&&this.log(`Unstable Pathways change from bitrate ${u.bitrate} to ${l.bitrate}`),this.hls.nextLoadLevel=o);break}}}getPathwayForGroupId(e,t,r){const n=this.getLevelsForPathway(r).concat(this.levels||[]);for(let s=0;s<n.length;s++)if(t===ot.AUDIO_TRACK&&n[s].hasAudioGroup(e)||t===ot.SUBTITLE_TRACK&&n[s].hasSubtitleGroup(e))return n[s].pathwayId;return r}clonePathways(e){const t=this.levels;if(!t)return;const r={},n={};e.forEach(s=>{const{ID:a,"BASE-ID":o,"URI-REPLACEMENT":u}=s;if(t.some(h=>h.pathwayId===a))return;const l=this.getLevelsForPathway(o).map(h=>{const d=new Gt(h.attrs);d["PATHWAY-ID"]=a;const p=d.AUDIO&&`${d.AUDIO}_clone_${a}`,g=d.SUBTITLES&&`${d.SUBTITLES}_clone_${a}`;p&&(r[d.AUDIO]=p,d.AUDIO=p),g&&(n[d.SUBTITLES]=g,d.SUBTITLES=g);const m=_A(h.uri,d["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",u),v=new el({attrs:d,audioCodec:h.audioCodec,bitrate:h.bitrate,height:h.height,name:h.name,url:m,videoCodec:h.videoCodec,width:h.width});if(h.audioGroups)for(let E=1;E<h.audioGroups.length;E++)v.addGroupId("audio",`${h.audioGroups[E]}_clone_${a}`);if(h.subtitleGroups)for(let E=1;E<h.subtitleGroups.length;E++)v.addGroupId("text",`${h.subtitleGroups[E]}_clone_${a}`);return v});t.push(...l),LA(this.audioTracks,r,u,a),LA(this.subtitleTracks,n,u,a)})}loadSteeringManifest(e){const t=this.hls.config,r=t.loader;this.loader&&this.loader.destroy(),this.loader=new r(t);let n;try{n=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(n.protocol!=="data:"){const h=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;n.searchParams.set("_HLS_pathway",this.pathwayId),n.searchParams.set("_HLS_throughput",""+h)}const s={responseType:"json",url:n.href},a=t.steeringManifestLoadPolicy.default,o=a.errorRetry||a.timeoutRetry||{},u={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},l={onSuccess:(h,d,p,g)=>{this.log(`Loaded steering manifest: "${n}"`);const m=h.data;if((m==null?void 0:m.VERSION)!==1){this.log(`Steering VERSION ${m.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=m.TTL;const{"RELOAD-URI":v,"PATHWAY-CLONES":E,"PATHWAY-PRIORITY":x}=m;if(v)try{this.uri=new self.URL(v,n).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${v}`);return}this.scheduleRefresh(this.uri||p.url),E&&this.clonePathways(E);const T={steeringManifest:m,url:n.toString()};this.hls.trigger(b.STEERING_MANIFEST_LOADED,T),x&&this.updatePathwayPriority(x)},onError:(h,d,p,g)=>{if(this.log(`Error loading steering manifest: ${h.code} ${h.text} (${d.url})`),this.stopLoad(),h.code===410){this.enabled=!1,this.log(`Steering manifest ${d.url} no longer available`);return}let m=this.timeToLoad*1e3;if(h.code===429){const v=this.loader;if(typeof(v==null?void 0:v.getResponseHeader)=="function"){const E=v.getResponseHeader("Retry-After");E&&(m=parseFloat(E)*1e3)}this.log(`Steering manifest ${d.url} rate limited`);return}this.scheduleRefresh(this.uri||d.url,m)},onTimeout:(h,d,p)=>{this.log(`Timeout loading steering manifest (${d.url})`),this.scheduleRefresh(this.uri||d.url)}};this.log(`Requesting steering manifest: ${n}`),this.loader.load(s,u,l)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var r;const n=(r=this.hls)==null?void 0:r.media;if(n&&!n.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function LA(i,e,t,r){i&&Object.keys(e).forEach(n=>{const s=i.filter(a=>a.groupId===n).map(a=>{const o=Tt({},a);return o.details=void 0,o.attrs=new Gt(o.attrs),o.url=o.attrs.URI=_A(a.url,a.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),o.groupId=o.attrs["GROUP-ID"]=e[n],o.attrs["PATHWAY-ID"]=r,o});i.push(...s)})}function _A(i,e,t,r){const{HOST:n,PARAMS:s,[t]:a}=r;let o;e&&(o=a==null?void 0:a[e],o&&(i=o));const u=new self.URL(i);return n&&!o&&(u.host=n),s&&Object.keys(s).sort().forEach(l=>{l&&u.searchParams.set(l,s[l])}),u.href}function ei(i,e,t){fi(i,e,t),i.addEventListener(e,t)}function fi(i,e,t){i.removeEventListener(e,t)}class Ja extends In{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=Ja.CDMCleanupPromise?[Ja.CDMCleanupPromise]:[],this.onMediaEncrypted=t=>{const{initDataType:r,initData:n}=t,s=`"${t.type}" event: init data type: "${r}"`;if(this.debug(s),n!==null){if(!this.keyFormatPromise){let a=Object.keys(this.keySystemAccessPromises);a.length||(a=rl(this.config));const o=a.map(zu).filter(u=>!!u);this.keyFormatPromise=this.getKeyFormatPromise(o)}this.keyFormatPromise.then(a=>{const o=Yu(a);let u,l;if(r==="sinf"){if(o!==xt.FAIRPLAY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${r}" for selected key-system ${o}`);return}const m=er(new Uint8Array(n));try{const v=gg(JSON.parse(m).sinf),E=UE(v);if(!E)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");u=new Uint8Array(E.subarray(8,24)),l=xt.FAIRPLAY}catch(v){this.warn(`${s} Failed to parse sinf: ${v}`);return}}else{if(o!==xt.WIDEVINE&&o!==xt.PLAYREADY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${r}" for selected key-system ${o}`);return}const m=LN(n),v=m.filter(x=>!!x.systemId&&mg(x.systemId)===o);v.length>1&&this.warn(`${s} Using first of ${v.length} pssh found for selected key-system ${o}`);const E=v[0];if(!E){m.length===0||m.some(x=>!x.systemId)?this.warn(`${s} contains incomplete or invalid pssh data`):this.log(`ignoring ${s} for ${m.map(x=>mg(x.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(l=mg(E.systemId),E.version===0&&E.data)if(l===xt.WIDEVINE){const x=E.data.length-22;u=new Uint8Array(E.data.subarray(x,x+16))}else l===xt.PLAYREADY&&(u=x2(E.data))}if(!l||!u)return;const h=Zi.hexDump(u),{keyIdToKeySessionPromise:d,mediaKeySessions:p}=this;let g=d[h];for(let m=0;m<p.length;m++){const v=p[m],E=v.decryptdata;if(!E.keyId)continue;const x=Zi.hexDump(E.keyId);if(h===x||E.uri.replace(/-/g,"").indexOf(h)!==-1){if(g=d[x],E.pssh)break;delete d[x],E.pssh=new Uint8Array(n),E.keyId=u,g=d[h]=g.then(()=>this.generateRequestWithPreferredKeySession(v,r,n,"encrypted-event-key-match")),g.catch(T=>this.handleError(T));break}}if(!g){if(l!==o){this.log(`Ignoring "${t.type}" event with ${l} init data for selected key-system ${o}`);return}g=d[h]=this.getKeySystemSelectionPromise([l]).then(({keySystem:m,mediaKeys:v})=>{var E;this.throwIfDestroyed();const x=new il("ISO-23001-7",h,(E=zu(m))!=null?E:"");return x.pssh=new Uint8Array(n),x.keyId=u,this.attemptSetMediaKeys(m,v).then(()=>{this.throwIfDestroyed();const T=this.createMediaKeySessionContext({decryptdata:x,keySystem:m,mediaKeys:v});return this.generateRequestWithPreferredKeySession(T,r,n,"encrypted-event-no-match")})}),g.catch(m=>this.handleError(m))}})}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(b.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(b.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(b.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(b.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:r}=this.config,n=t[e];if(n)return n.licenseUrl;if(e===xt.WIDEVINE&&r)return r}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,r=t[e];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,r=(a,o,u)=>!!a&&u.indexOf(a)===o,n=t.map(a=>a.audioCodec).filter(r),s=t.map(a=>a.videoCodec).filter(r);return n.length+s.length===0&&s.push("avc1.42e01e"),new Promise((a,o)=>{const u=l=>{const h=l.shift();this.getMediaKeysPromise(h,n,s).then(d=>a({keySystem:h,mediaKeys:d})).catch(d=>{l.length?u(l):d instanceof gi?o(d):o(new gi({type:ke.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_ACCESS,error:d,fatal:!0},d.message))})};u(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:r}=this.config;if(typeof r!="function"){let n=`Configured requestMediaKeySystemAccess is not a function ${r}`;return A2===null&&self.location.protocol==="http:"&&(n=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(n))}return r(e,t)}getMediaKeysPromise(e,t,r){const n=xL(e,t,r,this.config.drmSystemOptions),s=this.keySystemAccessPromises[e];let a=s==null?void 0:s.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${e}" key-system access with config: ${Bt(n)}`),a=this.requestMediaKeySystemAccess(e,n);const o=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(u=>{this.log(`Failed to obtain access to key-system "${e}": ${u}`)}),a.then(u=>{this.log(`Access for key-system "${u.keySystem}" obtained`);const l=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),o.mediaKeys=u.createMediaKeys().then(h=>(this.log(`Media-keys created for "${e}"`),o.hasMediaKeys=!0,l.then(d=>d?this.setMediaKeysServerCertificate(h,e,d):h))),o.mediaKeys.catch(h=>{this.error(`Failed to create media-keys for "${e}"}: ${h}`)}),o.mediaKeys})}return a.then(()=>s.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:r}){this.log(`Creating key-system session "${t}" keyId: ${Zi.hexDump(e.keyId||[])}`);const n=r.createSession(),s={decryptdata:e,keySystem:t,mediaKeys:r,mediaKeysSession:n,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const r=this.createMediaKeySessionContext(e),n=this.getKeyIdString(t),s="cenc";this.keyIdToKeySessionPromise[n]=this.generateRequestWithPreferredKeySession(r,s,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return Zi.hexDump(e.keyId)}updateKeySession(e,t){var r;const n=e.mediaKeysSession;return this.log(`Updating key-session "${n.sessionId}" for keyID ${Zi.hexDump(((r=e.decryptdata)==null?void 0:r.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),n.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>zu(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:r})=>this.attemptSetMediaKeys(t,r))}selectKeySystem(e){return new Promise((t,r)=>this.getKeySystemSelectionPromise(e).then(({keySystem:n})=>{const s=zu(n);s?t(s):r(new Error(`Unable to find format for key-system "${n}"`))}).catch(r))}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=rl(this.config),r=e.map(Yu).filter(n=>!!n&&t.indexOf(n)!==-1);return this.selectKeySystem(r)}loadKey(e){const t=e.keyInfo.decryptdata,r=this.getKeyIdString(t),n=`(keyId: ${r} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${n}`);let s=this.keyIdToKeySessionPromise[r];return s||(s=this.getKeySystemForKeyPromise(t).then(({keySystem:o,mediaKeys:u})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${n}`),this.attemptSetMediaKeys(o,u).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:o,mediaKeys:u,decryptdata:t}))))),(this.keyIdToKeySessionPromise[r]=s.then(o=>{const u="cenc",l=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(o,u,l,"playlist-key")})).catch(o=>this.handleError(o))),s}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof gi?this.hls.trigger(b.ERROR,e.data):this.hls.trigger(b.ERROR,{type:ke.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),r=this.keyIdToKeySessionPromise[t];if(!r){const n=Yu(e.keyFormat),s=n?[n]:rl(this.config);return this.attemptKeySystemAccess(s)}return r}getKeySystemSelectionPromise(e){if(e.length||(e=rl(this.config)),e.length===0)throw new gi({type:ke.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${Bt({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaKeys===t)return Promise.resolve();const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const n=Promise.all(r).then(()=>{if(!this.media)throw this.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.mediaKeys=t,this.setMediaKeysQueue.push(n),n.then(()=>{this.log(`Media-keys set for "${e}"`),r.push(n),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(s=>r.indexOf(s)===-1)})}generateRequestWithPreferredKeySession(e,t,r,n){var s,a;const o=(s=this.config.drmSystems)==null||(a=s[e.keySystem])==null?void 0:a.generateRequest;if(o)try{const m=o.call(this.hls,t,r,e);if(!m)throw new Error("Invalid response from configured generateRequest filter");t=m.initDataType,r=m.initData?m.initData:null,e.decryptdata.pssh=r?new Uint8Array(r):null}catch(m){var u;if(this.warn(m.message),(u=this.hls)!=null&&u.config.debug)throw m}if(r===null)return this.log(`Skipping key-session request for "${n}" (no initData)`),Promise.resolve(e);const l=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${n}": ${l} (init data type: ${t} length: ${r?r.byteLength:null})`);const h=new bg,d=e._onmessage=m=>{const v=e.mediaKeysSession;if(!v){h.emit("error",new Error("invalid state"));return}const{messageType:E,message:x}=m;this.log(`"${E}" message event for session "${v.sessionId}" message size: ${x.byteLength}`),E==="license-request"||E==="license-renewal"?this.renewLicense(e,x).catch(T=>{h.eventNames().length?h.emit("error",T):this.handleError(T)}):E==="license-release"?e.keySystem===xt.FAIRPLAY&&(this.updateKeySession(e,pg("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${E}"`)},p=e._onkeystatuseschange=m=>{if(!e.mediaKeysSession){h.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const E=e.keyStatus;h.emit("keyStatus",E),E==="expired"&&(this.warn(`${e.keySystem} expired for key ${l}`),this.renewKeySession(e))};ei(e.mediaKeysSession,"message",d),ei(e.mediaKeysSession,"keystatuseschange",p);const g=new Promise((m,v)=>{h.on("error",v),h.on("keyStatus",E=>{E.startsWith("usable")?m():E==="output-restricted"?v(new gi({type:ke.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):E==="internal-error"?v(new gi({type:ke.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${E}"`)):E==="expired"?v(new Error("key expired while generating request")):this.warn(`unhandled key status change "${E}"`)})});return e.mediaKeysSession.generateRequest(t,r).then(()=>{var m;this.log(`Request generated for key-session "${(m=e.mediaKeysSession)==null?void 0:m.sessionId}" keyId: ${l}`)}).catch(m=>{throw new gi({type:ke.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_SESSION,error:m,fatal:!1},`Error generating key-session request: ${m}`)}).then(()=>g).catch(m=>{throw h.removeAllListeners(),this.removeSession(e),m}).then(()=>(h.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,r)=>{if(typeof r=="string"&&typeof t=="object"){const n=r;r=t,t=n}this.log(`key status change "${t}" for keyStatuses keyId: ${Zi.hexDump("buffer"in r?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r))} session keyId: ${Zi.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,r=t.loader,n=new r(t),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching server certificate for "${e}"`),new Promise((a,o)=>{const u={responseType:"arraybuffer",url:s},l=t.certLoadPolicy.default,h={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(p,g,m,v)=>{a(p.data)},onError:(p,g,m,v)=>{o(new gi({type:ke.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:At({url:u.url,data:void 0},p)},`"${e}" certificate request failed (${s}). Status: ${p.code} (${p.text})`))},onTimeout:(p,g,m)=>{o(new gi({type:ke.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:{url:u.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(p,g,m)=>{o(new Error("aborted"))}};n.load(u,h,d)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,r){return new Promise((n,s)=>{e.setServerCertificate(r).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${r==null?void 0:r.byteLength}) on "${t}"`),n(e)}).catch(a=>{s(new gi({type:ke.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(r=>this.updateKeySession(e,new Uint8Array(r)).catch(n=>{throw new gi({type:ke.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:n,fatal:!0},n.message)}))}unpackPlayReadyKeyMessage(e,t){const r=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const n=new DOMParser().parseFromString(r,"application/xml"),s=n.querySelectorAll("HttpHeader");if(s.length>0){let h;for(let d=0,p=s.length;d<p;d++){var a,o;h=s[d];const g=(a=h.querySelector("name"))==null?void 0:a.textContent,m=(o=h.querySelector("value"))==null?void 0:o.textContent;g&&m&&e.setRequestHeader(g,m)}}const u=n.querySelector("Challenge"),l=u==null?void 0:u.textContent;if(!l)throw new Error("Cannot find <Challenge> in key message");return pg(atob(l))}setupLicenseXHR(e,t,r,n){const s=this.config.licenseXhrSetup;return s?Promise.resolve().then(()=>{if(!r.decryptdata)throw new Error("Key removed");return s.call(this.hls,e,t,r,n)}).catch(a=>{if(!r.decryptdata)throw a;return e.open("POST",t,!0),s.call(this.hls,e,t,r,n)}).then(a=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:a||n})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:n}))}requestLicense(e,t){const r=this.config.keyLoadPolicy.default;return new Promise((n,s)=>{const a=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${a}`);const o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return s(new Error("invalid state"));if(o.readyState===4)if(o.status===200){this._requestLicenseFailureCount=0;let u=o.response;this.log(`License received ${u instanceof ArrayBuffer?u.byteLength:u}`);const l=this.config.licenseResponseCallback;if(l)try{u=l.call(this.hls,o,a,e)}catch(h){this.error(h)}n(u)}else{const u=r.errorRetry,l=u?u.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>l||o.status>=400&&o.status<500)s(new gi({type:ke.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:o,response:{url:a,data:void 0,code:o.status,text:o.statusText}},`License Request XHR failed (${a}). Status: ${o.status} (${o.statusText})`));else{const h=l-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${h} attempts left`),this.requestLicense(e,t).then(n,s)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,this.setupLicenseXHR(o,a,e,t).then(({xhr:u,licenseChallenge:l})=>{e.keySystem==xt.PLAYREADY&&(l=this.unpackPlayReadyKeyMessage(u,l)),u.send(l)})})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const r=t.media;this.media=r,ei(r,"encrypted",this.onMediaEncrypted),ei(r,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(fi(e,"encrypted",this.onMediaEncrypted),fi(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},!this.mediaKeys&&!this.mediaKeySessions.length)return;const t=this.media,r=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,il.clearKeyUriToKeyIdMap();const n=r.length;Ja.CDMCleanupPromise=Promise.all(r.map(s=>this.removeSession(s)).concat(t==null||(e=t.setMediaKeys(null))==null?void 0:e.catch(s=>{var a;this.log(`Could not clear media keys: ${s}`),(a=this.hls)==null||a.trigger(b.ERROR,{type:ke.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${s}`)})}))).catch(s=>{var a;this.log(`Could not close sessions and clear media keys: ${s}`),(a=this.hls)==null||a.trigger(b.ERROR,{type:ke.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${s}`)})}).then(()=>{n&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const r=t.reduce((n,s)=>(n.indexOf(s.keyFormat)===-1&&n.push(s.keyFormat),n),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:r}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const n=this.mediaKeySessions.indexOf(e);n>-1&&this.mediaKeySessions.splice(n,1);const{drmSystemOptions:s}=this.config;return(bL(s)?new Promise((o,u)=>{self.setTimeout(()=>u(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(o)}):Promise.resolve()).catch(o=>{var u;this.log(`Could not remove session: ${o}`),(u=this.hls)==null||u.trigger(b.ERROR,{type:ke.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${o}`)})}).then(()=>t.close()).catch(o=>{var u;this.log(`Could not close session: ${o}`),(u=this.hls)==null||u.trigger(b.ERROR,{type:ke.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${o}`)})})}}}Ja.CDMCleanupPromise=void 0;class gi extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}class TM{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(b.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(b.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const r=this.hls.config;if(r.capLevelOnFPSDrop){const n=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=n,n&&typeof n.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,r){const n=performance.now();if(t){if(this.lastTime){const s=n-this.lastTime,a=r-this.lastDroppedFrames,o=t-this.lastDecodedFrames,u=1e3*a/s,l=this.hls;if(l.trigger(b.FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:r}),u>0&&a>l.config.fpsDroppedMonitoringThreshold*o){let h=l.currentLevel;l.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+h),h>0&&(l.autoLevelCapping===-1||l.autoLevelCapping>=h)&&(h=h-1,l.trigger(b.FPS_DROP_LEVEL_CAPPING,{level:h,droppedLevel:l.currentLevel}),l.autoLevelCapping=h,this.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function MA(i,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=i,e.dispatchEvent(t)}function OA(i,e){const t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues&&!i.cues.getCueById(e.id))try{if(i.addCue(e),!i.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(r){yt.debug(`[texttrack-utils]: ${r}`);try{const n=new self.TextTrackCue(e.startTime,e.endTime,e.text);n.id=e.id,i.addCue(n)}catch(n){yt.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${n}`)}}t==="disabled"&&(i.mode=t)}function Qa(i,e){const t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues)for(let r=i.cues.length;r--;)e&&i.cues[r].removeEventListener("enter",e),i.removeCue(i.cues[r]);t==="disabled"&&(i.mode=t)}function Hg(i,e,t,r){const n=i.mode;if(n==="disabled"&&(i.mode="hidden"),i.cues&&i.cues.length>0){const s=RM(i.cues,e,t);for(let a=0;a<s.length;a++)(!r||r(s[a]))&&i.removeCue(s[a])}n==="disabled"&&(i.mode=n)}function DM(i,e){if(e<=i[0].startTime)return 0;const t=i.length-1;if(e>i[t].endTime)return-1;let r=0,n=t,s;for(;r<=n;)if(s=Math.floor((n+r)/2),e<i[s].startTime)n=s-1;else if(e>i[s].startTime&&r<t)r=s+1;else return s;return i[r].startTime-e<e-i[n].startTime?r:n}function RM(i,e,t){const r=[],n=DM(i,e);if(n>-1)for(let s=n,a=i.length;s<a;s++){const o=i[s];if(o.startTime>=e&&o.endTime<=t)r.push(o);else if(o.startTime>t)return r}return r}function oc(i){const e=[];for(let t=0;t<i.length;t++){const r=i[t];(r.kind==="subtitles"||r.kind==="captions")&&r.label&&e.push(i[t])}return e}class IM extends kg{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const r=oc(this.media.textTracks);for(let s=0;s<r.length;s++)if(r[s].mode==="hidden")t=r[s];else if(r[s].mode==="showing"){t=r[s];break}const n=this.findTrackForTextTrack(t);this.subtitleTrack!==n&&this.setSubtitleTrack(n)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(b.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVEL_LOADING,this.onLevelLoading,this),e.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(b.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const r=this.media;if(!r)return;const n=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||r.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,n)return;oc(r.textTracks).forEach(a=>{Qa(a)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:r,groupId:n,details:s}=t,a=this.tracksInGroup[r];if(!a||a.groupId!==n){this.warn(`Subtitle track with id:${r} and group:${n} not found in active group ${a==null?void 0:a.groupId}`);return}const o=a.details;a.details=t.details,this.log(`Subtitle track ${r} "${a.name}" lang:${a.lang} group:${n} loaded [${s.startSN}-${s.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.subtitleGroups||null,n=this.groupIds;let s=this.currentTrack;if(!r||(n==null?void 0:n.length)!==(r==null?void 0:r.length)||r!=null&&r.some(a=>(n==null?void 0:n.indexOf(a))===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(h=>!r||r.indexOf(h.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(h=>h.default)&&(this.selectDefaultTrack=!1),a.forEach((h,d)=>{h.id=d});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const o=this.hls.config.subtitlePreference;if(!s&&o){this.selectDefaultTrack=!1;const h=rn(o,a);if(h>-1)s=a[h];else{const d=rn(o,this.tracks);s=this.tracks[d]}}let u=this.findTrackId(s);u===-1&&s&&(u=this.findTrackId(null));const l={subtitleTracks:a};this.log(`Updating subtitle tracks, ${a.length} track(s) found in "${r==null?void 0:r.join(",")}" group-id`),this.hls.trigger(b.SUBTITLE_TRACKS_UPDATED,l),u!==-1&&this.trackId===-1&&this.setSubtitleTrack(u)}}findTrackId(e){const t=this.tracksInGroup,r=this.selectDefaultTrack;for(let n=0;n<t.length;n++){const s=t[n];if(!(r&&!s.default||!r&&!e)&&(!e||Ks(s,e)))return n}if(e){for(let n=0;n<t.length;n++){const s=t[n];if(cl(e.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<t.length;n++){const s=t[n];if(cl(e.attrs,s.attrs,["LANGUAGE"]))return n}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const n=t[r];if(Fg(n,e))return r}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===ot.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const r=this.currentTrack;if(r&&Ks(e,r))return r;const n=rn(e,this.tracksInGroup);if(n>-1){const s=this.tracksInGroup[n];return this.setSubtitleTrack(n),s}else{if(r)return null;{const s=rn(e,t);if(s>-1)return t[s]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,n=e.groupId,s=this.getUrlWithDirectives(e.url,t),a=e.details,o=a==null?void 0:a.age;this.log(`Loading subtitle ${r} "${e.name}" lang:${e.lang} group:${n}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${s}`),this.hls.trigger(b.SUBTITLE_TRACK_LOADING,{url:s,id:r,groupId:n,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=oc(e.textTracks),r=this.currentTrack;let n;if(r&&(n=t.filter(s=>Fg(r,s))[0],n||this.warn(`Unable to find subtitle TextTrack with name "${r.name}" and language "${r.lang}"`)),[].slice.call(t).forEach(s=>{s.mode!=="disabled"&&s!==n&&(s.mode="disabled")}),n){const s=this.subtitleDisplay?"showing":"hidden";n.mode!==s&&(n.mode=s)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!Ce(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,n=t[e]||null;if(this.trackId=e,this.currentTrack=n,this.toggleTrackModes(),!n){this.hls.trigger(b.SUBTITLE_TRACK_SWITCH,{id:e});return}const s=!!n.details&&!n.details.live;if(e===this.trackId&&n===r&&s)return;this.log(`Switching to subtitle-track ${e}`+(n?` "${n.name}" lang:${n.lang} group:${n.groupId}`:""));const{id:a,groupId:o="",name:u,type:l,url:h}=n;this.hls.trigger(b.SUBTITLE_TRACK_SWITCH,{id:a,groupId:o,name:u,type:l,url:h});const d=this.switchParams(n.url,r==null?void 0:r.details,n.details);this.loadPlaylist(d)}}function wM(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const s=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(n=="x"?s:s&3|8).toString(16)})}}}function dl(i){let e=5381,t=i.length;for(;t;)e=e*33^i.charCodeAt(--t);return(e>>>0).toString()}const Za=.025;let lc=function(i){return i[i.Point=0]="Point",i[i.Range=1]="Range",i}({});function CM(i,e,t){return`${i.identifier}-${t+1}-${dl(e)}`}class NM{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const r=this.playoutLimit;return e<=0||isNaN(r)?!1:r===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>r}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return Vg(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,r=Vg(t,e);return t-r<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=Ce(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return Vg(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Za))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?lc.Range:lc.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return LM(this)}}function Vg(i,e){return i-e.start<e.duration/2&&!(Math.abs(i-(e.start+e.duration))<Za)?e.start:e.start+e.duration}function PA(i,e,t){const r=new self.URL(i,t);return r.protocol!=="data:"&&r.searchParams.set("_HLS_primary_id",e),r}function Kg(i,e){for(;(t=i.assetList[++e])!=null&&t.error;)var t;return e}function LM(i){return`["${i.identifier}" ${i.cue.pre?"<pre>":i.cue.post?"<post>":""}${i.timelineStart.toFixed(2)}-${i.resumeTime.toFixed(2)}]`}function eo(i){const e=i.timelineStart,t=i.duration||0;return`["${i.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class _M{constructor(e,t,r,n){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls.trigger(b.PLAYOUT_LIMIT_REACHED,{})};const s=this.hls=new e(t);this.interstitial=r,this.assetItem=n;let a=n.uri;try{a=PA(a,t.primarySessionId).href}catch{}s.loadSource(a);const o=()=>{this.hasDetails=!0};s.once(b.LEVEL_LOADED,o),s.once(b.AUDIO_TRACK_LOADED,o),s.once(b.SUBTITLE_TRACK_LOADED,o),s.on(b.MEDIA_ATTACHING,(u,{media:l})=>{this.removeMediaListeners(),this.mediaAttached=l,this.interstitial.playoutLimit&&(l.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&s.on(b.BUFFER_APPENDED,()=>{const d=this.bufferedEnd;this.reachedPlayout(d)&&(this._bufferedEosTime=d,s.trigger(b.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){var e;return((e=this.interstitial)==null?void 0:e.appendInPlace)||!1}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e||!this._bufferedEosTime)return!1;const r=this.timelineOffset,n=Xe.bufferInfo(e,r,0);return this.getAssetTime(n.end)>=this._bufferedEosTime-.02}reachedPlayout(e){const r=this.interstitial.playoutLimit;return this.startOffset+e>=r}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=Xe.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;return e||0}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const r=e-t;if(Math.abs(r)>11111111111111112e-21){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,r=this.duration;return Math.min(Math.max(0,e-t),r)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls.destroy(),this.hls=this.interstitial=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){this.hls.attachMedia(e)}detachMedia(){this.removeMediaListeners(),this.mediaAttached=null,this.hls.detachMedia()}resumeBuffering(){this.hls.resumeBuffering()}pauseBuffering(){this.hls.pauseBuffering()}transferMedia(){return this.bufferSnapShot(),this.hls.transferMedia()}resetDetails(){const e=this.hls;if(this.hasDetails){e.stopLoad();const t=r=>delete r.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,r){this.hls.on(e,t)}once(e,t,r){this.hls.once(e,t)}off(e,t,r){this.hls.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${eo(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const kA=.033;class MM extends In{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((r,n)=>e<=n.startOffset&&t>n.startOffset?(delete n.error,r+1):r,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let r=-1;e.nextEvent?r=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(r=this.findEventIndex(e.previousEvent.identifier)+1);const n=this.items;if(n)for(n[r]||(t===void 0&&(t=e.start),r=this.findItemIndexAtTime(t));r>=0&&(s=n[r])!=null&&s.event;){var s;r--}return r}findItemIndexAtTime(e,t){const r=this.items;if(r)for(let n=0;n<r.length;n++){let s=r[n];if(t&&t!=="primary"&&(s=s[t]),e===s.start||e>s.start&&e<s.end)return n}return-1}findJumpRestrictedIndex(e,t){const r=this.items;if(r)for(let n=e;n<=t&&r[n];n++){const s=r[n].event;if(s!=null&&s.restrictions.jump&&!s.appendInPlace)return n}return-1}findEventIndex(e){const t=this.items;if(t)for(let n=t.length;n--;){var r;if(((r=t[n].event)==null?void 0:r.identifier)===e)return n}return-1}findAssetIndex(e,t){const r=e.assetList,n=r.length;if(n>1)for(let s=0;s<n;s++){const a=r[s];if(!a.error){const o=a.timelineStart;if(t===o||t>o&&t<o+(a.duration||0))return s}}return 0}get assetIdAtEnd(){var e,t;const r=(e=this.items)==null||(t=e[this.length-1])==null?void 0:t.event;if(r){const n=r.assetList,s=n[n.length-1];if(s)return s.identifier}return null}parseInterstitialDateRanges(e,t){const r=e.main.details,{dateRanges:n}=r,s=this.events,a=this.parseDateRanges(n,{url:r.url},t),o=Object.keys(n),u=s?s.filter(l=>!o.includes(l.identifier)):[];a.length&&a.sort((l,h)=>{const d=l.cue.pre,p=l.cue.post,g=h.cue.pre,m=h.cue.post;if(d&&!g)return-1;if(g&&!d||p&&!m)return 1;if(m&&!p)return-1;if(!d&&!g&&!p&&!m){const v=l.startTime,E=h.startTime;if(v!==E)return v-E}return l.dateRange.tagOrder-h.dateRange.tagOrder}),this.events=a,u.forEach(l=>{this.removeEvent(l)}),this.updateSchedule(e,u)}updateSchedule(e,t=[]){const r=this.events||[];if(r.length||t.length||this.length<2){const n=this.items,s=this.parseSchedule(r,e);(t.length||(n==null?void 0:n.length)!==s.length||s.some((o,u)=>Math.abs(o.playout.start-n[u].playout.start)>.005||Math.abs(o.playout.end-n[u].playout.end)>.005))&&(this.items=s,this.onScheduleUpdate(t,n))}}parseDateRanges(e,t,r){const n=[],s=Object.keys(e);for(let a=0;a<s.length;a++){const o=s[a],u=e[o];if(u.isInterstitial){let l=this.eventMap[o];l?l.setDateRange(u):(l=new NM(u,t),this.eventMap[o]=l,r===!1&&(l.appendInPlace=r)),n.push(l)}}return n}parseSchedule(e,t){const r=[],n=t.main.details,s=n.live?1/0:n.edge;let a=0;if(e=e.filter(u=>!u.error&&!(u.cue.once&&u.hasPlayed)),e.length){this.resolveOffsets(e,t);let u=0,l=0;if(e.forEach((h,d)=>{const p=h.cue.pre,g=h.cue.post,m=e[d-1]||null,v=h.appendInPlace,E=g?s:h.startOffset,x=h.duration,T=h.timelineOccupancy===lc.Range?x:0,R=h.resumptionOffset,_=(m==null?void 0:m.startTime)===E,F=E+h.cumulativeDuration;let N=v?F+x:E+R;if(p||!g&&E<=0){const M=l;l+=T,h.timelineStart=F;const L=a;a+=x,r.push({event:h,start:F,end:N,playout:{start:L,end:a},integrated:{start:M,end:l}})}else if(E<=s){if(!_){const I=E-u;if(I>kA){const U=u,q=l;l+=I;const $=a;a+=I;const X={previousEvent:e[d-1]||null,nextEvent:h,start:U,end:U+I,playout:{start:$,end:a},integrated:{start:q,end:l}};r.push(X)}else I>0&&m&&(m.cumulativeDuration+=I,r[r.length-1].end=E)}g&&(N=F),h.timelineStart=F;const M=l;l+=T;const L=a;a+=x,r.push({event:h,start:F,end:N,playout:{start:L,end:a},integrated:{start:M,end:l}})}else return;const C=h.resumeTime;g||C>s?u=s:u=C}),u<s){var o;const h=u,d=l,p=s-u;l+=p;const g=a;a+=p,r.push({previousEvent:((o=r[r.length-1])==null?void 0:o.event)||null,nextEvent:null,start:u,end:h+p,playout:{start:g,end:a},integrated:{start:d,end:l}})}this.setDurations(s,a,l)}else r.push({previousEvent:null,nextEvent:null,start:0,end:s,playout:{start:0,end:s},integrated:{start:0,end:s}}),this.setDurations(s,s,s);return r}setDurations(e,t,r){this.durations={primary:e,playout:t,integrated:r}}resolveOffsets(e,t){const r=t.main.details,n=r.live?1/0:r.edge;let s=0,a=-1;e.forEach((o,u)=>{const l=o.cue.pre,h=o.cue.post,d=l?0:h?n:o.startTime;this.updateAssetDurations(o),a===d?o.cumulativeDuration=s:(s=0,a=d),!h&&o.snapOptions.in&&(o.resumeAnchor=Ys(null,r.fragments,o.startOffset+o.resumptionOffset,0,0)||void 0),o.appendInPlace&&!o.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(o,t)||(o.appendInPlace=!1)),!o.appendInPlace&&u+1<e.length&&e[u+1].startTime-e[u].resumeTime<kA&&(e[u+1].appendInPlace=!1,e[u+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${o}`));const g=Ce(o.resumeOffset)?o.resumeOffset:o.duration;s+=g})}primaryCanResumeInPlaceAt(e,t){const r=e.resumeTime,n=e.startTime+e.resumptionOffset;return Math.abs(r-n)>Za?(this.log(`"${e.identifier}" resumption ${r} not aligned with estimated timeline end ${n}`),!1):t?!Object.keys(t).some(a=>{const o=t[a].details,u=o.edge;if(r>=u)return this.log(`"${e.identifier}" resumption ${r} past ${a} playlist end ${u}`),!1;const l=Ys(null,o.fragments,r);if(!l)return this.log(`"${e.identifier}" resumption ${r} does not align with any fragments in ${a} playlist (${o.fragStart}-${o.fragmentEnd})`),!0;const h=a==="audio"?.175:0;return Math.abs(l.start-r)<Za+h||Math.abs(l.end-r)<Za+h?!1:(this.log(`"${e.identifier}" resumption ${r} not aligned with ${a} fragment bounds (${l.start}-${l.end} sn: ${l.sn} cc: ${l.cc})`),!0)}):(this.log(`"${e.identifier}" resumption ${r} can not be aligned with media (none selected)`),!1)}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let r=0,n=!1,s=!1;e.assetList.forEach((a,o)=>{const u=t+r;a.startOffset=r,a.timelineStart=u,n||(n=a.duration===null),s||(s=!!a.error);const l=a.error?0:a.duration||0;r+=l}),n&&!s?e.duration=Math.max(r,e.duration):e.duration=r}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function fs(i){return`[${i.event?'"'+i.event.identifier+'"':"primary"}: ${i.start.toFixed(2)}-${i.end.toFixed(2)}]`}class OM{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const r=e.assetListUrl;let n;try{n=PA(r,this.hls.sessionId,e.baseUrl)}catch(p){const g=this.assignAssetListError(e,Q.ASSET_LIST_LOAD_ERROR,p,r);this.hls.trigger(b.ERROR,g);return}t&&n.protocol!=="data:"&&n.searchParams.set("_HLS_start_offset",""+t);const s=this.hls.config,a=s.loader,o=new a(s),u={responseType:"json",url:n.href},l=s.interstitialAssetListLoadPolicy.default,h={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(p,g,m,v)=>{const E=p.data,x=E==null?void 0:E.ASSETS;if(!Array.isArray(x)){const T=this.assignAssetListError(e,Q.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),m.url,g,v);this.hls.trigger(b.ERROR,T);return}e.assetListResponse=E,this.hls.trigger(b.ASSET_LIST_LOADED,{event:e,assetListResponse:E,networkDetails:v})},onError:(p,g,m,v)=>{const E=this.assignAssetListError(e,Q.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${p.code} ${p.text} (${g.url})`),g.url,v,m);this.hls.trigger(b.ERROR,E)},onTimeout:(p,g,m)=>{const v=this.assignAssetListError(e,Q.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${g.url})`),g.url,p,m);this.hls.trigger(b.ERROR,v)}};return o.load(u,h,d),this.hls.trigger(b.ASSET_LIST_LOADING,{event:e}),o}assignAssetListError(e,t,r,n,s,a){return e.error=r,{type:ke.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:n,error:r,networkDetails:a,stats:s}}}function FA(i){i==null||i.play().catch(()=>{})}class PM extends In{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled)return;const n=r-this.timelinePos;if(Math.abs(n)<1/7056e5)return;const a=n<=-.01;this.timelinePos=r,this.bufferedPos=r;const o=this.playingItem;if(!o){this.checkBuffer();return}if(a&&this.schedule.resetErrorsInRange(r,r-n)&&this.updateSchedule(),this.checkBuffer(),a&&r<o.start||r>=o.end){var u;const p=this.schedule.findItemIndexAtTime(this.timelinePos);if(!this.isInterstitial(o)&&(u=this.media)!=null&&u.paused&&(this.shouldPlay=!1),!a){const g=this.findItemIndex(o);if(p>g){const m=this.schedule.findJumpRestrictedIndex(g+1,p);if(m>g){this.setSchedulePosition(m);return}}}this.setSchedulePosition(p);return}const l=this.playingAsset;if(!l){if(this.playingLastItem&&this.isInterstitial(o)){const p=o.event.assetList[0];p&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(r,p))}return}const h=l.timelineStart,d=l.duration||0;(a&&r<h||r>=h+d)&&this.setScheduleToAssetAtTime(r,l)},this.onTimeupdate=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled)return;if(r>this.timelinePos)this.timelinePos=r,r>this.bufferedPos&&this.checkBuffer();else return;const n=this.playingItem;if(!n||this.playingLastItem)return;if(r>=n.end){this.timelinePos=n.end;const o=this.findItemIndex(n);this.setSchedulePosition(o+1)}const s=this.playingAsset;if(!s)return;const a=s.timelineStart+(s.duration||0);r>=a&&this.setScheduleToAssetAtTime(r,s)},this.onScheduleUpdate=(r,n)=>{const s=this.schedule,a=this.playingItem,o=s.events||[],u=s.items||[],l=s.durations,h=r.map(m=>m.identifier),d=!!(o.length||h.length);(d||n)&&this.log(`INTERSTITIALS_UPDATED (${o.length}): ${o}
Schedule: ${u.map(m=>fs(m))} pos: ${this.timelinePos}`),h.length&&this.log(`Removed events ${h}`),this.playerQueue.forEach(m=>{if(m.interstitial.appendInPlace){const v=m.assetItem.timelineStart,E=m.timelineOffset-v;if(E)try{m.timelineOffset=v}catch(x){Math.abs(E)>Za&&this.warn(`${x} ("${m.assetId}" ${m.timelineOffset}->${v})`)}}});let p=null;if(a){const m=this.updateItem(a,this.timelinePos);this.itemsMatch(a,m)&&(this.playingItem=m,this.waitingItem=this.endedItem=null,p=()=>this.trimInPlace(m,a))}else this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const g=this.bufferingItem;if(g){const m=this.updateItem(g,this.bufferedPos);this.itemsMatch(g,m)?(this.bufferingItem=m,p||(p=()=>this.trimInPlace(m,g))):g.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(g.event,null))}if(r.forEach(m=>{m.assetList.forEach(v=>{this.clearAssetPlayer(v.identifier,null)})}),d||n){if(this.hls.trigger(b.INTERSTITIALS_UPDATED,{events:o.slice(0),schedule:u.slice(0),durations:l,removedIds:h}),this.isInterstitial(a)&&h.includes(a.event.identifier)){this.warn(`Interstitial "${a.event.identifier}" removed while playing`),this.primaryFallback(a.event);return}p&&p(),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new OM(e),this.schedule=new MM(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(b.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(b.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(b.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(b.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(b.BUFFER_APPENDED,this.onBufferAppended,this),e.on(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(b.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(b.MEDIA_ENDED,this.onMediaEnded,this),e.on(b.ERROR,this.onError,this),e.on(b.DESTROYING,this.onDestroying,this)}unregisterListeners(){const e=this.hls;e&&(e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(b.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(b.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(b.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(b.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(b.BUFFER_CODECS,this.onBufferCodecs,this),e.off(b.BUFFER_APPENDED,this.onBufferAppended,this),e.off(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(b.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(b.MEDIA_ENDED,this.onMediaEnded,this),e.off(b.ERROR,this.onError,this),e.off(b.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.manager=null,this.hls=this.HlsPlayerClass=this.schedule=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){fi(e,"play",this.onPlay),fi(e,"pause",this.onPause),fi(e,"seeking",this.onSeeking),fi(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const r=this.media=t.media;ei(r,"seeking",this.onSeeking),ei(r,"timeupdate",this.onTimeupdate),ei(r,"play",this.onPlay),ei(r,"pause",this.onPause)}onMediaAttached(e,t){const r=this.effectivePlayingItem,n=this.detachedData;if(this.detachedData=null,r===null)this.checkStart();else if(!n){this.clearScheduleState();const s=this.findItemIndex(r);this.setSchedulePosition(s)}}clearScheduleState(){this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const r=!!t.transferMedia,n=this.media;if(this.media=null,!r&&(n&&this.removeMediaListeners(n),this.detachedData)){const s=this.getBufferingPlayer();s&&(this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,s.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.manager){if(!this.hls)return null;const e=this,t=()=>e.bufferingItem||e.waitingItem,r=d=>d&&e.getAssetPlayer(d.identifier),n=(d,p,g,m,v)=>{if(d){let E=d[p].start;const x=d.event;if(x){if(p==="playout"||x.timelineOccupancy!==lc.Point){const T=r(g);(T==null?void 0:T.interstitial)===x&&(E+=T.assetItem.startOffset+T[v])}}else{const T=m==="bufferedPos"?a():e[m];E+=T-d.start}return E}return 0},s=(d,p)=>{if(d!==0&&p!=="primary"&&e.schedule.length){var g;const m=e.schedule.findItemIndexAtTime(d),v=(g=e.schedule.items)==null?void 0:g[m];if(v){const E=v[p].start-v.start;return d+E}}return d},a=()=>{const d=e.bufferedPos;return d===Number.MAX_VALUE?o("primary"):Math.max(d,0)},o=d=>{var p;return(p=e.primaryDetails)!=null&&p.live?e.primaryDetails.edge:e.schedule.durations[d]},u=(d,p)=>{var g,m;const v=e.effectivePlayingItem;if(v!=null&&(g=v.event)!=null&&g.restrictions.skip)return;e.log(`seek to ${d} "${p}"`);const E=e.effectivePlayingItem,x=e.schedule.findItemIndexAtTime(d,p),T=(m=e.schedule.items)==null?void 0:m[x],R=e.getBufferingPlayer(),_=R==null?void 0:R.interstitial,F=_==null?void 0:_.appendInPlace,N=E&&e.itemsMatch(E,T);if(E&&(F||N)){const M=r(e.playingAsset),L=(M==null?void 0:M.media)||e.primaryMedia;if(L){const I=p==="primary"?L.currentTime:n(E,p,e.playingAsset,"timelinePos","currentTime"),U=d-I,q=(F?I:L.currentTime)+U;if(q>=0&&(!M||F||q<=M.duration)){L.currentTime=q;return}}}if(T){let M=d;if(p!=="primary"){const I=T[p].start,U=d-I;M=T.start+U}const L=!e.isInterstitial(T);if((!e.isInterstitial(E)||E.event.appendInPlace)&&(L||T.event.appendInPlace)){const I=e.media||(F?R==null?void 0:R.media:null);I&&(I.currentTime=M)}else if(E){const I=e.findItemIndex(E);if(x>I){const q=e.schedule.findJumpRestrictedIndex(I+1,x);if(q>I){e.setSchedulePosition(q);return}}let U=0;if(L)e.timelinePos=M,e.checkBuffer();else{var C;const q=T==null||(C=T.event)==null?void 0:C.assetList;if(q){const $=d-(T[p]||T).start;for(let X=q.length;X--;){const ie=q[X];if(ie.duration&&$>=ie.startOffset&&$<ie.startOffset+ie.duration){U=X;break}}}}e.setSchedulePosition(x,U)}}},l=()=>{const d=e.effectivePlayingItem;if(e.isInterstitial(d))return d;const p=t();return e.isInterstitial(p)?p:null},h={get currentTime(){const d=l(),p=e.effectivePlayingItem;return p&&p===d?n(p,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-p.playout.start:0},set currentTime(d){const p=l(),g=e.effectivePlayingItem;g&&g===p&&u(d+g.playout.start,"playout")},get duration(){const d=l();return d?d.playout.end-d.playout.start:0},get assetPlayers(){var d;const p=(d=l())==null?void 0:d.event.assetList;return p?p.map(g=>e.getAssetPlayer(g.identifier)):[]},get playingIndex(){var d;const p=(d=l())==null?void 0:d.event;return p&&e.effectivePlayingAsset?p.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return l()}};this.manager={get events(){var d,p;return((d=e.schedule)==null||(p=d.events)==null?void 0:p.slice(0))||[]},get schedule(){var d,p;return((d=e.schedule)==null||(p=d.items)==null?void 0:p.slice(0))||[]},get interstitialPlayer(){return l()?h:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const d=t();return e.findItemIndex(d)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const d=e.effectivePlayingItem;return e.findItemIndex(d)},primary:{get bufferedEnd(){return a()},get currentTime(){const d=e.timelinePos;return d>0?d:0},set currentTime(d){u(d,"primary")},get duration(){return o("primary")},get seekableStart(){var d;return((d=e.primaryDetails)==null?void 0:d.fragmentStart)||0}},integrated:{get bufferedEnd(){return n(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return n(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(d){u(d,"integrated")},get duration(){return o("integrated")},get seekableStart(){var d;return s(((d=e.primaryDetails)==null?void 0:d.fragmentStart)||0,"integrated")}},skip:()=>{const d=e.effectivePlayingItem,p=d==null?void 0:d.event;if(p&&!p.restrictions.skip){const g=e.findItemIndex(d);if(p.appendInPlace){const m=d.playout.start+d.event.duration;u(m+.001,"playout")}else e.advanceAfterAssetEnded(p,g,1/0)}}}}return this.manager}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,r=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!r?!1:this.findItemIndex(t)===r.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t,r;if(this.mediaSelection===null)return;const n=this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&!n.event.appendInPlace)return;let s=this.media;!s&&(e=this.bufferingItem)!=null&&(t=e.event)!=null&&t.appendInPlace&&(s=this.primaryMedia);const a=(r=s)==null?void 0:r.currentTime;if(!(a===void 0||!Ce(a)))return a}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const r=this.getAssetPlayer(e);r&&this.transferMediaFromPlayer(r,t)}transferMediaFromPlayer(e,t){const r=e.interstitial.appendInPlace,n=e.media;if(r&&n===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&n){this.detachedData={media:n};return}const s=e.transferMedia();this.log(`transfer MediaSource from ${e} ${Bt(s)}`),this.detachedData=s}else t&&n&&(this.shouldPlay||(this.shouldPlay=!n.paused))}transferMediaTo(e,t){var r,n;if(e.media===t)return;let s=null;const a=this.hls,o=e!==a,u=o&&e.interstitial.appendInPlace,l=(r=this.detachedData)==null?void 0:r.mediaSource;let h;if(a.media)u&&(s=a.transferMedia(),this.detachedData=s),h="Primary";else if(l){const g=this.getBufferingPlayer();g?(s=g.transferMedia(),h=`${g}`):h="detached MediaSource"}else h="detached media";if(!s){if(l)s=this.detachedData,this.log(`using detachedData: MediaSource ${Bt(s)}`);else if(!this.detachedData||a.media===t){const g=this.playerQueue;g.length>1&&g.forEach(m=>{if(o&&m.interstitial.appendInPlace!==u){const v=m.interstitial;this.clearInterstitial(m.interstitial,null),v.appendInPlace=!1,v.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${v}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const d=s&&"mediaSource"in s&&((n=s.mediaSource)==null?void 0:n.readyState)!=="closed",p=d&&s?s:t;if(this.log(`${d?"transfering MediaSource":"attaching media"} to ${o?e:"Primary"} from ${h}`),p===s){const g=o&&e.assetId===this.schedule.assetIdAtEnd;p.overrides={duration:this.schedule.duration,endOfStream:!o||g,cueRemoval:!o}}e.attachMedia(p)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const r=this.timelinePos,n=this.effectivePlayingItem;if(r===-1){const s=this.hls.startPosition;if(this.timelinePos=s,t.length&&t[0].cue.pre){const a=e.findEventIndex(t[0].identifier);this.setSchedulePosition(a)}else if(s>=0||!this.primaryLive){const a=this.timelinePos=s>0?s:0,o=e.findItemIndexAtTime(a);this.setSchedulePosition(o)}}else if(n&&!this.playingItem){const s=e.findItemIndex(n);this.setSchedulePosition(s)}}advanceAfterAssetEnded(e,t,r){const n=Kg(e,r);if(!e.isAssetPastPlayoutLimit(n))this.setSchedulePosition(t,n);else{const s=this.schedule.items;if(s){const a=t+1,o=s.length;if(a>=o){this.setSchedulePosition(-1);return}const u=e.resumeTime;this.timelinePos<u&&(this.timelinePos=u,this.checkBuffer()),this.setSchedulePosition(a)}}}setScheduleToAssetAtTime(e,t){const r=this.schedule,n=t.parentIdentifier,s=r.getEvent(n);if(s){const a=r.findEventIndex(n),o=r.findAssetIndex(s,e);this.advanceAfterAssetEnded(s,a,o-1)}}setSchedulePosition(e,t){const r=this.schedule.items;if(!r||this.playbackDisabled)return;this.log(`setSchedulePosition ${e}, ${t}`);const n=e>=0?r[e]:null,s=this.playingItem,a=this.playingLastItem;if(this.isInterstitial(s)){var o;const l=s.event,h=this.playingAsset,d=h==null?void 0:h.identifier,p=d?this.getAssetPlayer(d):null;if(p&&d&&(!this.eventItemsMatch(s,n)||t!==void 0&&d!==((o=l.assetList)==null?void 0:o[t].identifier))){var u;const g=l.findAssetIndex(h);this.log(`INTERSTITIAL_ASSET_ENDED ${g+1}/${l.assetList.length} ${eo(h)}`),this.endedAsset=h,this.playingAsset=null,this.hls.trigger(b.INTERSTITIAL_ASSET_ENDED,{asset:h,assetListIndex:g,event:l,schedule:r.slice(0),scheduleIndex:e,player:p}),this.retreiveMediaSource(d,n),p.media&&!((u=this.detachedData)!=null&&u.mediaSource)&&p.detachMedia()}if(!this.eventItemsMatch(s,n)&&(this.endedItem=s,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${l} ${fs(s)}`),l.hasPlayed=!0,this.hls.trigger(b.INTERSTITIAL_ENDED,{event:l,schedule:r.slice(0),scheduleIndex:e}),l.cue.once)){this.updateSchedule();const g=this.schedule.items;if(n&&g){const m=this.schedule.findItemIndex(n);this.advanceSchedule(m,g,t,s,a)}return}}this.advanceSchedule(e,r,t,s,a)}advanceSchedule(e,t,r,n,s){const a=e>=0?t[e]:null,o=this.primaryMedia,u=this.playerQueue;if(u.length&&u.forEach(l=>{const h=l.interstitial,d=this.schedule.findEventIndex(h.identifier);(d<e||d>e+1)&&this.clearInterstitial(h,a)}),this.isInterstitial(a)){this.timelinePos=Math.min(Math.max(this.timelinePos,a.start),a.end);const l=a.event;if(r===void 0){r=this.schedule.findAssetIndex(l,this.timelinePos);const g=Kg(l,r-1);if(l.isAssetPastPlayoutLimit(g)){this.advanceAfterAssetEnded(l,e,r);return}r=g}const h=this.waitingItem;this.assetsBuffered(a,o)||this.setBufferingItem(a);let d=this.preloadAssets(l,r);if(this.eventItemsMatch(a,h||n)||(this.waitingItem=a,this.log(`INTERSTITIAL_STARTED ${fs(a)} ${l.appendInPlace?"append in place":""}`),this.hls.trigger(b.INTERSTITIAL_STARTED,{event:l,schedule:t.slice(0),scheduleIndex:e})),!l.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${l}`);return}if(l.assetListLoader&&(l.assetListLoader.destroy(),l.assetListLoader=void 0),!o){this.log(`Waiting for attachMedia to start Interstitial ${l}`);return}this.waitingItem=this.endedItem=null,this.playingItem=a;const p=l.assetList[r];if(!p){const g=t[e+1],m=this.media;g&&m&&!this.isInterstitial(g)&&m.currentTime<g.start&&(m.currentTime=this.timelinePos=g.start),this.advanceAfterAssetEnded(l,e,r||0);return}if(d||(d=this.getAssetPlayer(p.identifier)),d===null||d.destroyed){const g=l.assetList.length;this.warn(`asset ${r+1}/${g} player destroyed ${l}`),d=this.createAssetPlayer(l,p,r)}if(!this.eventItemsMatch(a,this.bufferingItem)&&l.appendInPlace&&this.isAssetBuffered(p))return;this.startAssetPlayer(d,r,t,e,o),this.shouldPlay&&FA(d.media)}else a!==null?(this.resumePrimary(a,e,n),this.shouldPlay&&FA(this.hls.media)):s&&this.isInterstitial(n)&&(this.endedItem=null,this.playingItem=n,n.event.appendInPlace||this.attachPrimary(this.schedule.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e,t;return(e=this.mediaSelection)==null||(t=e.main)==null?void 0:t.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,r){var n;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${fs(e)}`),!((n=this.detachedData)!=null&&n.mediaSource)){let a=this.timelinePos;(a<e.start||a>=e.end)&&(a=this.getPrimaryResumption(e,t),this.timelinePos=a),this.attachPrimary(a,e)}if(!r)return;const s=this.schedule.items;s&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${fs(e)}`),this.hls.trigger(b.INTERSTITIALS_PRIMARY_RESUMED,{schedule:s.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const r=e.start;if(this.primaryLive){const n=this.primaryDetails;if(t===0)return this.hls.startPosition;if(n&&(r<n.fragmentStart||r>n.edge))return this.hls.liveSyncPosition||-1}return r}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:Xe.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,r){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const n=this.primaryMedia;if(!n)return;const s=this.hls;s.media?this.checkBuffer():(this.transferMediaTo(s,n),r&&this.startLoadingPrimaryAt(e,r)),r||(this.timelinePos=e,this.startLoadingPrimaryAt(e,r))}startLoadingPrimaryAt(e,t){var r;const n=this.hls;!n.loadingEnabled||!n.media||Math.abs((((r=n.mainForwardBufferInfo)==null?void 0:r.start)||n.media.currentTime)-e)>.5?n.startLoad(e,t):n.bufferingEnabled||n.resumeBuffering()}onManifestLoading(){this.stopLoad(),this.schedule.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(b.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(b.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1)return;const r=this.hls.levels[t.level],n=At(At({},this.mediaSelection||this.altSelection),{},{main:r});this.mediaSelection=n,this.schedule.parseInterstitialDateRanges(n,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const r=this.hls.audioTracks[t.id],n=this.mediaSelection;if(!n){this.altSelection=At(At({},this.altSelection),{},{audio:r});return}const s=At(At({},n),{},{audio:r});this.mediaSelection=s}onSubtitleTrackUpdated(e,t){const r=this.hls.subtitleTracks[t.id],n=this.mediaSelection;if(!n){this.altSelection=At(At({},this.altSelection),{},{subtitles:r});return}const s=At(At({},n),{},{subtitles:r});this.mediaSelection=s}onAudioTrackSwitching(e,t){const r=r2(t);this.playerQueue.forEach(n=>n.hls.setAudioOption(t)||n.hls.setAudioOption(r))}onSubtitleTrackSwitch(e,t){const r=r2(t);this.playerQueue.forEach(n=>n.hls.setSubtitleOption(t)||t.id!==-1&&n.hls.setSubtitleOption(r))}onBufferCodecs(e,t){const r=t.tracks;r&&(this.requiredTracks=r)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const r=this.playingItem;if(r&&!this.itemsMatch(r,this.bufferingItem)&&!this.isInterstitial(r)){const n=this.timelinePos;this.bufferedPos=n,this.checkBuffer()}}onBufferedToEnd(e){const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let n=0;n<t.length;n++){const s=t[n];if(s.cue.post){var r;const a=this.schedule.findEventIndex(s.identifier),o=(r=this.schedule.items)==null?void 0:r[a];this.isInterstitial(o)&&this.eventItemsMatch(o,this.bufferingItem)&&this.bufferedToItem(o,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const r=this.findItemIndex(t);this.setSchedulePosition(r+1)}else this.shouldPlay=!1}updateItem(e,t){const r=this.schedule.items;if(e&&r){const n=this.findItemIndex(e,t);return r[n]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((s,a)=>{e.event.isAssetPastPlayoutLimit(a)&&this.clearAssetPlayer(s.identifier,null)});const r=e.end+.25,n=Xe.bufferInfo(this.primaryMedia,r,0);(n.end>r||(n.nextStart||0)>r)&&(this.attachPrimary(r,null),this.flushFrontBuffer(r))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var r;return!!t&&(e===t||e.event.identifier===((r=t.event)==null?void 0:r.identifier))}findItemIndex(e,t){return e?this.schedule.findItemIndex(e,t):-1}updateSchedule(){const e=this.mediaSelection;e&&this.schedule.updateSchedule(e,[])}checkBuffer(e){const t=this.schedule.items;if(!t)return;const r=Xe.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=r.len<1),this.updateBufferedPos(r.end,t,e)}updateBufferedPos(e,t,r){const n=this.schedule,s=this.bufferingItem;if(this.bufferedPos>e)return;if(t.length===1&&this.itemsMatch(t[0],s)){this.bufferedPos=e;return}const a=this.playingItem,o=this.findItemIndex(a);let u=n.findItemIndexAtTime(e);if(this.bufferedPos<e){var l,h;const d=this.findItemIndex(s),p=Math.min(d+1,t.length-1),g=t[p];if((u===-1&&s&&e>=s.end||(l=g.event)!=null&&l.appendInPlace&&e+.01>=g.start)&&(u=p),p-o>1&&(s==null||(h=s.event)==null?void 0:h.appendInPlace)===!1)return;if(this.bufferedPos=e,u>d&&u>o)this.bufferedToItem(g);else{const m=this.primaryDetails;this.primaryLive&&m&&e>m.edge-m.targetduration&&g.start<m.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(g)&&this.preloadAssets(g.event,0)}}else r&&a&&!this.itemsMatch(a,s)&&(u===o?this.bufferedToItem(a):u===o+1&&this.bufferedToItem(t[u]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(n=>{const s=this.getAssetPlayer(n.identifier);return!(s!=null&&s.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,r=this.schedule;if(this.itemsMatch(e,t))this.bufferingItem!==e&&(this.bufferingItem=e);else{const{items:n,events:s}=r;if(!n||!s)return t;const a=this.isInterstitial(e),o=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const u=o?o.remaining:t?t.end-this.timelinePos:0;this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${fs(e)}`+(t?` (${u.toFixed(2)} remaining)`:"")),this.playbackDisabled||(a?e.event.assetList.forEach(l=>{const h=this.getAssetPlayer(l.identifier);h&&h.resumeBuffering()}):(this.hls.resumeBuffering(),this.playerQueue.forEach(l=>l.pauseBuffering()))),this.hls.trigger(b.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:s.slice(0),schedule:n.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}return t}bufferedToItem(e,t=0){const r=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(r!==null){this.bufferingAsset=null;const n=this.detachedData;n?n.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),r=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(r)}bufferedToEvent(e,t){const r=e.event,n=r.assetList.length===0&&!r.assetListLoader,s=r.cue.once;if(n||!s){const a=this.preloadAssets(r,t);if(a!=null&&a.interstitial.appendInPlace){const o=r.assetList[t],u=this.primaryMedia;o&&u&&this.bufferAssetPlayer(a,u)}}}preloadAssets(e,t){const r=e.assetUrl,n=e.assetList.length,s=n===0&&!e.assetListLoader,a=e.cue.once;if(s){const u=e.timelineStart;if(e.appendInPlace){var o;const p=this.playingItem;!this.isInterstitial(p)&&(p==null||(o=p.nextEvent)==null?void 0:o.identifier)===e.identifier&&this.flushFrontBuffer(u+.25)}let l,h=0;if(!this.playingItem&&this.primaryLive&&(h=this.hls.startPosition,h===-1&&(h=this.hls.liveSyncPosition||0)),h&&!(e.cue.pre||e.cue.post)){const p=h-u;p>0&&(l=Math.round(p*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${r?1:n} ${e}${l?` live-start: ${h} start-offset: ${l}`:""}`),r)return this.createAsset(e,0,0,u,e.duration,r);const d=this.assetListLoader.loadAssetList(e,l);d&&(e.assetListLoader=d)}else if(!a&&n){for(let u=t;u<n;u++){const l=e.assetList[u],h=this.getAssetPlayerQueueIndex(l.identifier);(h===-1||this.playerQueue[h].destroyed)&&!l.error&&this.createAssetPlayer(e,l,u)}return this.getAssetPlayer(e.assetList[t].identifier)}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(n=>{this.hls.trigger(b.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:n})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let r=0;r<t.length;r++)if(e===t[r].assetId)return r;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let r=0;r<e.length;r++)if(e[r].media===t)return e[r]}return null}createAsset(e,t,r,n,s,a){const o={parentIdentifier:e.identifier,identifier:CM(e,a,t),duration:s,startOffset:r,timelineStart:n,uri:a};return this.createAssetPlayer(e,o,t)}createAssetPlayer(e,t,r){const n=this.hls,s=n.userConfig;let a=s.videoPreference;const o=n.loadLevelObj||n.levels[n.currentLevel];(a||o)&&(a=Tt({},a),o.videoCodec&&(a.videoCodec=o.videoCodec),o.videoRange&&(a.allowedVideoRanges=[o.videoRange]));const u=n.audioTracks[n.audioTrack],l=n.subtitleTracks[n.subtitleTrack];let h=0;if(this.primaryLive||e.appendInPlace){const R=this.timelinePos-t.timelineStart;if(R>1){const _=t.duration;_&&R<_&&(h=R)}}const d=t.identifier,p=At(At({},s),{},{autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:n.sessionId,assetPlayerId:d,abrEwmaDefaultEstimate:n.bandwidthEstimate,interstitialsController:void 0,startPosition:h,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:a,audioPreference:u||s.audioPreference,subtitlePreference:l||s.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(p.timelineOffset=t.timelineStart));const g=p.cmcd;g!=null&&g.sessionId&&g.contentId&&(p.cmcd=Tt({},g,{contentId:dl(t.uri)})),this.getAssetPlayer(d)&&this.warn(`Duplicate date range identifier ${e} and asset ${d}`);const m=new _M(this.HlsPlayerClass,p,e,t);this.playerQueue.push(m),e.assetList[r]=t;const v=R=>{if(R.live){const N=new Error(`Interstitials MUST be VOD assets ${e}`),C={fatal:!0,type:ke.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:N};this.handleAssetItemError(C,e,this.schedule.findEventIndex(e.identifier),r,N.message);return}const _=R.edge-R.fragmentStart,F=t.duration;(F===null||_>F)&&(this.log(`Interstitial asset "${d}" duration change ${F} > ${_}`),t.duration=_,this.updateSchedule())};m.on(b.LEVEL_UPDATED,(R,{details:_})=>v(_)),m.on(b.LEVEL_PTS_UPDATED,(R,{details:_})=>v(_));const E=(R,_)=>{const F=this.getAssetPlayer(d);if(F&&_.tracks){F.off(b.BUFFER_CODECS,E),F.tracks=_.tracks;const N=this.primaryMedia;this.bufferingAsset===F.assetItem&&N&&!F.media&&this.bufferAssetPlayer(F,N)}};m.on(b.BUFFER_CODECS,E);const x=()=>{var R;const _=this.getAssetPlayer(d);if(this.log(`buffered to end of asset ${_}`),!_)return;const F=this.schedule.findEventIndex(e.identifier),N=(R=this.schedule.items)==null?void 0:R[F];if(this.isInterstitial(N)){const M=e.findAssetIndex(t),L=Kg(e,M);if(!e.isAssetPastPlayoutLimit(L))this.bufferedToItem(N,L);else{var C;const I=(C=this.schedule.items)==null?void 0:C[F+1];I&&this.bufferedToItem(I)}}};m.on(b.BUFFERED_TO_END,x);const T=R=>()=>{if(!this.getAssetPlayer(d))return;this.shouldPlay=!0;const F=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,F,R)};return m.once(b.MEDIA_ENDED,T(r)),m.once(b.PLAYOUT_LIMIT_REACHED,T(1/0)),m.on(b.ERROR,(R,_)=>{const F=this.getAssetPlayer(d);if(_.details===Q.BUFFER_STALLED_ERROR){if(F!=null&&F.media){const N=F.currentTime,C=F.duration-N;N&&e.appendInPlace&&C/F.media.playbackRate<.5?(this.log(`Advancing buffer past end of asset ${d} ${e} at ${F.media.currentTime}`),x()):(this.warn(`Stalled at ${N} of ${N+C} in asset ${d} ${e}`),this.onTimeupdate(),this.checkBuffer(!0))}return}this.handleAssetItemError(_,e,this.schedule.findEventIndex(e.identifier),r,`Asset player error ${_.error} ${e}`)}),m.on(b.DESTROYING,()=>{if(!this.getAssetPlayer(d))return;const _=new Error(`Asset player destroyed unexpectedly ${d}`),F={fatal:!0,type:ke.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:_};this.handleAssetItemError(F,e,this.schedule.findEventIndex(e.identifier),r,_.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${eo(t)}`),this.hls.trigger(b.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:r,event:e,player:m}),m}clearInterstitial(e,t){e.assetList.forEach(r=>{this.clearAssetPlayer(r.identifier,t)}),e.reset()}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const r=this.playerQueue[t];this.transferMediaFromPlayer(r,null),r.resetDetails()}}clearAssetPlayer(e,t){const r=this.getAssetPlayerQueueIndex(e);if(r!==-1){this.log(`clear asset player "${e}" toSegment: ${t&&fs(t)}`);const n=this.playerQueue[r];this.transferMediaFromPlayer(n,t),this.playerQueue.splice(r,1),n.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,r,n,s){const{interstitial:a,assetItem:o,assetId:u}=e,l=a.assetList.length,h=this.playingAsset;this.endedAsset=null,this.playingAsset=o,(!h||h.identifier!==u)&&(h&&(this.clearAssetPlayer(h.identifier,r[n]),delete h.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${l} ${eo(o)}`),this.hls.trigger(b.INTERSTITIAL_ASSET_STARTED,{asset:o,assetListIndex:t,event:a,schedule:r.slice(0),scheduleIndex:n,player:e})),this.bufferAssetPlayer(e,s)}bufferAssetPlayer(e,t){var r,n;const{interstitial:s,assetItem:a}=e,o=this.schedule.findEventIndex(s.identifier),u=(r=this.schedule.items)==null?void 0:r[o];if(!u)return;this.setBufferingItem(u),this.bufferingAsset=a;const l=this.getBufferingPlayer();if(l===e)return;const h=s.appendInPlace;if(h&&(l==null?void 0:l.interstitial.appendInPlace)===!1)return;const d=(l==null?void 0:l.tracks)||((n=this.detachedData)==null?void 0:n.tracks)||this.requiredTracks;if(h&&a!==this.playingAsset){if(!e.tracks)return;if(d&&!NE(d,e.tracks)){const p=new Error(`Asset ${eo(a)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(d)}')`),g={fatal:!0,type:ke.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:p},m=s.findAssetIndex(a);this.handleAssetItemError(g,s,o,m,p.message);return}}this.transferMediaTo(e,t)}handleAssetItemError(e,t,r,n,s){if(e.details===Q.BUFFER_STALLED_ERROR)return;const a=t.assetList[n];this.warn(`INTERSTITIAL_ASSET_ERROR ${a&&eo(a)} ${e.error}`);const o=a==null?void 0:a.identifier,u=this.getAssetPlayerQueueIndex(o),l=this.playerQueue[u]||null,h=this.schedule.items,d=Tt({},e,{fatal:!1,errorAction:tl(!0),asset:a,assetListIndex:n,event:t,schedule:h,scheduleIndex:r,player:l});if(this.hls.trigger(b.INTERSTITIAL_ASSET_ERROR,d),!e.fatal)return;const p=this.playingAsset,g=new Error(s);if(a&&(this.clearAssetPlayer(o,null),a.error=g),!t.assetList.some(m=>!m.error))t.error=g;else if(t.appendInPlace){for(let m=n;m<t.assetList.length;m++)this.resetAssetPlayer(t.assetList[m].identifier);this.updateSchedule()}t.error?this.primaryFallback(t):p&&p.identifier===o&&this.advanceAfterAssetEnded(t,r,n)}primaryFallback(e){const t=e.timelineStart,r=this.effectivePlayingItem;if(this.updateSchedule(),r){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${r?fs(r):"<none>"} error: ${e.error}`);let n=this.timelinePos;n===-1&&(n=this.hls.startPosition);const s=this.updateItem(r,n);this.itemsMatch(r,s)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t));const a=this.schedule.findItemIndexAtTime(n);this.setSchedulePosition(a)}else this.checkStart()}onAssetListLoaded(e,t){var r;const n=t.event,s=n.identifier,a=t.assetListResponse.ASSETS;if(!this.schedule.hasEvent(s))return;const o=n.timelineStart,u=n.duration;let l=0;a.forEach((m,v)=>{const E=parseFloat(m.DURATION);this.createAsset(n,v,l,o+l,E,m.URI),l+=E}),n.duration=l,this.log(`Loaded asset-list with duration: ${l} (was: ${u}) ${n}`);const h=this.waitingItem,d=(h==null?void 0:h.event.identifier)===s;this.updateSchedule();const p=(r=this.bufferingItem)==null?void 0:r.event;if(d){var g;const m=this.schedule.findEventIndex(s),v=(g=this.schedule.items)==null?void 0:g[m];if(v){if(!this.playingItem&&this.timelinePos>v.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==m){n.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${n}`),this.primaryFallback(n);return}this.setBufferingItem(v)}this.setSchedulePosition(m)}else if((p==null?void 0:p.identifier)===s&&p.appendInPlace){const m=n.assetList[0],v=this.getAssetPlayer(m.identifier),E=this.primaryMedia;m&&v&&E&&this.bufferAssetPlayer(v,E)}}onError(e,t){switch(t.details){case Q.ASSET_LIST_PARSING_ERROR:case Q.ASSET_LIST_LOAD_ERROR:case Q.ASSET_LIST_LOAD_TIMEOUT:{const r=t.interstitial;r&&this.primaryFallback(r);break}case Q.BUFFER_STALLED_ERROR:{this.onTimeupdate(),this.checkBuffer(!0);break}}}}const BA=500;class kM extends xg{constructor(e,t,r){super(e,t,r,"subtitle-stream-controller",Oe.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(b.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(b.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=oe.IDLE,this.setInterval(BA),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:r,success:n}=t;if(lr(r)&&(this.fragPrevious=r),this.state=oe.IDLE,!n)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let a;const o=r.start;for(let l=0;l<s.length;l++)if(o>=s[l].start&&o<=s[l].end){a=s[l];break}const u=r.start+r.duration;a?a.end=u:(a={start:o,end:u},s.push(a)),this.fragmentTracker.fragBuffered(r),this.fragBufferedComplete(r,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:r,endOffset:n}=t;if(r===0&&n!==Number.POSITIVE_INFINITY){const s=n-1;if(s<=0)return;t.endOffsetSubtitles=Math.max(0,s),this.tracksBuffered.forEach(a=>{for(let o=0;o<a.length;){if(a[o].end<=s){a.shift();continue}else if(a[o].start<s)a[o].start=s;else break;o++}}),this.fragmentTracker.removeFragmentsInRange(r,s,Oe.SUBTITLE)}}onError(e,t){const r=t.frag;(r==null?void 0:r.type)===Oe.SUBTITLE&&(t.details===Q.FRAG_GAP&&this.fragmentTracker.fragBuffered(r,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==oe.STOPPED&&(this.state=oe.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&EA(this.levels,t)){this.levels=t.map(r=>new el(r));return}this.tracksBuffered=[],this.levels=t.map(r=>{const n=new el(r);return this.tracksBuffered[n.id]=[],n}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Oe.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var r;if(this.currentTrackId=t.id,!((r=this.levels)!=null&&r.length)||this.currentTrackId===-1){this.clearInterval();return}const n=this.levels[this.currentTrackId];n!=null&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.state!==oe.STOPPED&&this.setInterval(BA)}onSubtitleTrackLoaded(e,t){var r;const{currentTrackId:n,levels:s}=this,{details:a,id:o}=t;if(!s){this.warn(`Subtitle tracks were reset while loading level ${o}`);return}const u=s[o];if(o>=s.length||!u)return;this.log(`Subtitle track ${o} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(a.live||(r=u.details)!=null&&r.live){const d=this.mainDetails;if(a.deltaUpdateFailed||!d)return;const p=d.fragments[0];if(!u.details)a.hasProgramDateTime&&d.hasProgramDateTime?(Ju(a,d),l=a.fragmentStart):p&&(l=p.start,Ag(a,l));else{var h;l=this.alignPlaylists(a,u.details,(h=this.levelLastLoaded)==null?void 0:h.details),l===0&&p&&(l=p.start,Ag(a,l))}}u.details=a,this.levelLastLoaded=u,o===n&&(this.hls.trigger(b.SUBTITLE_TRACK_UPDATED,{details:a,id:o,groupId:t.groupId}),this.tick(),a.live&&!this.fragCurrent&&this.media&&this.state===oe.IDLE&&(Ys(null,a.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),u.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:r}=e,n=t.decryptdata,s=this.hls;if(!this.fragContextChanged(t)&&r&&r.byteLength>0&&n!=null&&n.key&&n.iv&&Wa(n.method)){const a=performance.now();this.decrypter.decrypt(new Uint8Array(r),n.key.buffer,n.iv.buffer,fg(n.method)).catch(o=>{throw s.trigger(b.ERROR,{type:ke.MEDIA_ERROR,details:Q.FRAG_DECRYPT_ERROR,fatal:!1,error:o,reason:o.message,frag:t}),o}).then(o=>{const u=performance.now();s.trigger(b.FRAG_DECRYPTED,{frag:t,payload:o,stats:{tstart:a,tdecrypt:u}})}).catch(o=>{this.warn(`${o.name}: ${o.message}`),this.state=oe.IDLE})}}doTick(){if(!this.media){this.state=oe.IDLE;return}if(this.state===oe.IDLE){const{currentTrackId:e,levels:t}=this,r=t==null?void 0:t[e];if(!r||!t.length||!r.details||this.waitForLive(r))return;const{config:n}=this,s=this.getLoadPosition(),a=Xe.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],s,n.maxBufferHole),{end:o,len:u}=a,l=r.details,h=this.hls.maxBufferLength+l.levelTargetDuration;if(u>h)return;const d=l.fragments,p=d.length,g=l.edge;let m=null;const v=this.fragPrevious;if(o<g){const T=n.maxFragLookUpTolerance,R=o>g-T?0:T;m=Ys(v,d,Math.max(d[0].start,o),R),!m&&v&&v.start<d[0].start&&(m=d[0])}else m=d[p-1];if(m=this.filterReplacedPrimary(m,r.details),!m)return;const E=m.sn-l.startSN,x=d[E-1];if(x&&x.cc===m.cc&&this.fragmentTracker.getState(x)===tr.NOT_LOADED&&(m=x),this.fragmentTracker.getState(m)===tr.NOT_LOADED){const T=this.mapToInitFragWhenRequired(m);T&&this.loadFragment(T,r,o)}}}loadFragment(e,t,r){lr(e)?super.loadFragment(e,t,r):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new FM(this.tracksBuffered[this.currentTrackId]||[])}}class FM{constructor(e){this.buffered=void 0;const t=(r,n,s)=>{if(n=n>>>0,n>s-1)throw new DOMException(`Failed to execute '${r}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${s})`);return e[n][r]};this.buffered={get length(){return e.length},end(r){return t("end",r,e.length)},start(r){return t("start",r,e.length)}}}}const BM={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},UA=i=>String.fromCharCode(BM[i]||i),Li=15,Ln=100,UM={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},$M={17:2,18:4,21:6,22:8,23:10,19:13,20:15},GM={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},qM={25:2,26:4,29:6,30:8,31:10,27:13,28:15},HM=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class VM{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const r=typeof t=="function"?t():t;yt.log(`${this.time} [${e}] ${r}`)}}}const Xs=function(e){const t=[];for(let r=0;r<e.length;r++)t.push(e[r].toString(16));return t};class $A{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let r=0;r<t.length;r++){const n=t[r];e.hasOwnProperty(n)&&(this[n]=e[n])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class KM{constructor(){this.uchar=" ",this.penState=new $A}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class WM{constructor(e){this.chars=[],this.pos=0,this.currPenState=new $A,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Ln;t++)this.chars.push(new KM);this.logger=e}equals(e){for(let t=0;t<Ln;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Ln;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Ln;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Ln&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Ln)}moveCursor(e){const t=this.pos+e;if(e>1)for(let r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=UA(e);if(this.pos>=Ln){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<Ln;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let r=0;r<Ln;r++){const n=this.chars[r].uchar;n!==" "&&(t=!1),e.push(n)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class Wg{constructor(e){this.rows=[],this.currRow=Li-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Li;t++)this.rows.push(new WM(e));this.logger=e}reset(){for(let e=0;e<Li;e++)this.rows[e].clear();this.currRow=Li-1}equals(e){let t=!0;for(let r=0;r<Li;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t}copy(e){for(let t=0;t<Li;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Li;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+Bt(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let o=0;o<Li;o++)this.rows[o].clear();const s=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){const o=a.rows[s].cueStartTime,u=this.logger.time;if(o!==null&&u!==null&&o<u)for(let l=0;l<this.nrRollUpRows;l++)this.rows[t-this.nrRollUpRows+l+1].copy(a.rows[s+l])}}this.currRow=t;const r=this.rows[this.currRow];if(e.indent!==null){const s=e.indent,a=Math.max(s-1,0);r.setCursor(e.indent),e.color=r.chars[a].penState.foreground}const n={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(n)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+Bt(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let r="",n=-1;for(let s=0;s<Li;s++){const a=this.rows[s].getTextString();a&&(n=s+1,e?t.push("Row "+n+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(e?r="["+t.join(" | ")+"]":r=t.join(`
`)),r}getTextAndFormat(){return this.rows}}class GA{constructor(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Wg(r),this.nonDisplayedMemory=new Wg(r),this.lastOutputScreen=new Wg(r),this.currRollUpRow=this.displayedMemory.rows[Li-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Li-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const r=Math.floor(e/2)-16,n=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=n[r]}this.logger.log(2,"MIDROW: "+Bt(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class qA{constructor(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=XM(),this.logger=void 0;const n=this.logger=new VM;this.channels=[null,new GA(e,t,n),new GA(e+1,r,n)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let r=0;r<t.length;r+=2){const n=t[r]&127,s=t[r+1]&127;let a=!1,o=null;if(n===0&&s===0)continue;this.logger.log(3,()=>"["+Xs([t[r],t[r+1]])+"] -> ("+Xs([n,s])+")");const u=this.cmdHistory;if(n>=16&&n<=31){if(YM(n,s,u)){uc(null,null,u),this.logger.log(3,()=>"Repeated command ("+Xs([n,s])+") is dropped");continue}uc(n,s,this.cmdHistory),a=this.parseCmd(n,s),a||(a=this.parseMidrow(n,s)),a||(a=this.parsePAC(n,s)),a||(a=this.parseBackgroundAttributes(n,s))}else uc(null,null,u);if(!a&&(o=this.parseChars(n,s),o)){const h=this.currentChannel;h&&h>0?this.channels[h].insertChars(o):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!a&&!o&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Xs([n,s])+" orig: "+Xs([t[r],t[r+1]]))}}parseCmd(e,t){const r=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,n=(e===23||e===31)&&t>=33&&t<=35;if(!(r||n))return!1;const s=e===20||e===21||e===23?1:2,a=this.channels[s];return e===20||e===21||e===28||e===29?t===32?a.ccRCL():t===33?a.ccBS():t===34?a.ccAOF():t===35?a.ccAON():t===36?a.ccDER():t===37?a.ccRU(2):t===38?a.ccRU(3):t===39?a.ccRU(4):t===40?a.ccFON():t===41?a.ccRDC():t===42?a.ccTR():t===43?a.ccRTD():t===44?a.ccEDM():t===45?a.ccCR():t===46?a.ccENM():t===47&&a.ccEOC():a.ccTO(t-32),this.currentChannel=s,!0}parseMidrow(e,t){let r=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?r=1:r=2,r!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const n=this.channels[r];return n?(n.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+Xs([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let r;const n=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,s=(e===16||e===24)&&t>=64&&t<=95;if(!(n||s))return!1;const a=e<=23?1:2;t>=64&&t<=95?r=a===1?UM[e]:GM[e]:r=a===1?$M[e]:qM[e];const o=this.channels[a];return o?(o.setPAC(this.interpretPAC(r,t)),this.currentChannel=a,!0):!1}interpretPAC(e,t){let r;const n={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?r=t-96:r=t-64,n.underline=(r&1)===1,r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=Math.floor((r-16)/2)*4,n}parseChars(e,t){let r,n=null,s=null;if(e>=25?(r=2,s=e-8):(r=1,s=e),s>=17&&s<=19){let a;s===17?a=t+80:s===18?a=t+112:a=t+144,this.logger.log(2,()=>"Special char '"+UA(a)+"' in channel "+r),n=[a]}else e>=32&&e<=127&&(n=t===0?[e]:[e,t]);return n&&this.logger.log(3,()=>"Char codes =  "+Xs(n).join(",")),n}parseBackgroundAttributes(e,t){const r=(e===16||e===24)&&t>=32&&t<=47,n=(e===23||e===31)&&t>=45&&t<=47;if(!(r||n))return!1;let s;const a={};e===16||e===24?(s=Math.floor((t-32)/2),a.background=HM[s],t%2===1&&(a.background=a.background+"_semi")):t===45?a.background="transparent":(a.foreground="black",t===47&&(a.underline=!0));const o=e<=23?1:2;return this.channels[o].setBkgData(a),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}uc(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const r=this.channels[t];r&&r.cueSplitAtTime(e)}}}function uc(i,e,t){t.a=i,t.b=e}function YM(i,e,t){return t.a===i&&t.b===e}function XM(){return{a:null,b:null}}var Yg=function(){if(Wu!=null&&Wu.VTTCue)return self.VTTCue;const i=["","lr","rl"],e=["start","middle","end","left","right"];function t(o,u){if(typeof u!="string"||!Array.isArray(o))return!1;const l=u.toLowerCase();return~o.indexOf(l)?l:!1}function r(o){return t(i,o)}function n(o){return t(e,o)}function s(o,...u){let l=1;for(;l<arguments.length;l++){const h=arguments[l];for(const d in h)o[d]=h[d]}return o}function a(o,u,l){const h=this,d={enumerable:!0};h.hasBeenReset=!1;let p="",g=!1,m=o,v=u,E=l,x=null,T="",R=!0,_="auto",F="start",N=50,C="middle",M=50,L="middle";Object.defineProperty(h,"id",s({},d,{get:function(){return p},set:function(I){p=""+I}})),Object.defineProperty(h,"pauseOnExit",s({},d,{get:function(){return g},set:function(I){g=!!I}})),Object.defineProperty(h,"startTime",s({},d,{get:function(){return m},set:function(I){if(typeof I!="number")throw new TypeError("Start time must be set to a number.");m=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"endTime",s({},d,{get:function(){return v},set:function(I){if(typeof I!="number")throw new TypeError("End time must be set to a number.");v=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"text",s({},d,{get:function(){return E},set:function(I){E=""+I,this.hasBeenReset=!0}})),Object.defineProperty(h,"region",s({},d,{get:function(){return x},set:function(I){x=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"vertical",s({},d,{get:function(){return T},set:function(I){const U=r(I);if(U===!1)throw new SyntaxError("An invalid or illegal string was specified.");T=U,this.hasBeenReset=!0}})),Object.defineProperty(h,"snapToLines",s({},d,{get:function(){return R},set:function(I){R=!!I,this.hasBeenReset=!0}})),Object.defineProperty(h,"line",s({},d,{get:function(){return _},set:function(I){if(typeof I!="number"&&I!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");_=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"lineAlign",s({},d,{get:function(){return F},set:function(I){const U=n(I);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");F=U,this.hasBeenReset=!0}})),Object.defineProperty(h,"position",s({},d,{get:function(){return N},set:function(I){if(I<0||I>100)throw new Error("Position must be between 0 and 100.");N=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"positionAlign",s({},d,{get:function(){return C},set:function(I){const U=n(I);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");C=U,this.hasBeenReset=!0}})),Object.defineProperty(h,"size",s({},d,{get:function(){return M},set:function(I){if(I<0||I>100)throw new Error("Size must be between 0 and 100.");M=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"align",s({},d,{get:function(){return L},set:function(I){const U=n(I);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");L=U,this.hasBeenReset=!0}})),h.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a}();class zM{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function HA(i){function e(r,n,s,a){return(r|0)*3600+(n|0)*60+(s|0)+parseFloat(a||0)}const t=i.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class jM{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,r){for(let n=0;n<r.length;++n)if(t===r[n]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1}}function VA(i,e,t,r){const n=r?i.split(r):[i];for(const s in n){if(typeof n[s]!="string")continue;const a=n[s].split(t);if(a.length!==2)continue;const o=a[0],u=a[1];e(o,u)}}const Xg=new Yg(0,0,""),cc=Xg.align==="middle"?"middle":"center";function JM(i,e,t){const r=i;function n(){const o=HA(i);if(o===null)throw new Error("Malformed timestamp: "+r);return i=i.replace(/^[^\sa-zA-Z-]+/,""),o}function s(o,u){const l=new jM;VA(o,function(p,g){let m;switch(p){case"region":for(let v=t.length-1;v>=0;v--)if(t[v].id===g){l.set(p,t[v].region);break}break;case"vertical":l.alt(p,g,["rl","lr"]);break;case"line":m=g.split(","),l.integer(p,m[0]),l.percent(p,m[0])&&l.set("snapToLines",!1),l.alt(p,m[0],["auto"]),m.length===2&&l.alt("lineAlign",m[1],["start",cc,"end"]);break;case"position":m=g.split(","),l.percent(p,m[0]),m.length===2&&l.alt("positionAlign",m[1],["start",cc,"end","line-left","line-right","auto"]);break;case"size":l.percent(p,g);break;case"align":l.alt(p,g,["start",cc,"end","left","right"]);break}},/:/,/\s/),u.region=l.get("region",null),u.vertical=l.get("vertical","");let h=l.get("line","auto");h==="auto"&&Xg.line===-1&&(h=-1),u.line=h,u.lineAlign=l.get("lineAlign","start"),u.snapToLines=l.get("snapToLines",!0),u.size=l.get("size",100),u.align=l.get("align",cc);let d=l.get("position","auto");d==="auto"&&Xg.position===50&&(d=u.align==="start"||u.align==="left"?0:u.align==="end"||u.align==="right"?100:50),u.position=d}function a(){i=i.replace(/^\s+/,"")}if(a(),e.startTime=n(),a(),i.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);i=i.slice(3),a(),e.endTime=n(),a(),s(i,e)}function KA(i){return i.replace(/<br(?: \/)?>/gi,`
`)}let QM=class{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new zM,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function r(){let s=t.buffer,a=0;for(s=KA(s);a<s.length&&s[a]!=="\r"&&s[a]!==`
`;)++a;const o=s.slice(0,a);return s[a]==="\r"&&++a,s[a]===`
`&&++a,t.buffer=s.slice(a),o}function n(s){VA(s,function(a,o){},/:/)}try{let s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=r();const o=s.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(o!=null&&o[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let a=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:s=r(),t.state){case"HEADER":/:/.test(s)?n(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new Yg(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{JM(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const o=s.indexOf("-->")!==-1;if(!s||o&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}};const ZM=/\r\n|\n\r|\n|\r/g,zg=function(e,t,r=0){return e.slice(r,r+t.length)===t},eO=function(e){let t=parseInt(e.slice(-3));const r=parseInt(e.slice(-6,-4)),n=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!Ce(t)||!Ce(r)||!Ce(n)||!Ce(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*r,t+=60*1e3*n,t+=60*60*1e3*s,t};function jg(i,e,t){return dl(i.toString())+dl(e.toString())+dl(t)}const tO=function(e,t,r){let n=e[t],s=e[n.prevCC];if(!s||!s.new&&n.new){e.ccOffset=e.presentationOffset=n.start,n.new=!1;return}for(;(a=s)!=null&&a.new;){var a;e.ccOffset+=n.start-s.start,n.new=!1,n=s,s=e[n.prevCC]}e.presentationOffset=r};function rO(i,e,t,r,n,s,a){const o=new QM,u=Qr(new Uint8Array(i)).trim().replace(ZM,`
`).split(`
`),l=[],h=e?b_(e.baseTime,e.timescale):0;let d="00:00.000",p=0,g=0,m,v=!0;o.oncue=function(E){const x=t[r];let T=t.ccOffset;const R=(p-h)/9e4;if(x!=null&&x.new&&(g!==void 0?T=t.ccOffset=x.start:tO(t,r,R)),R){if(!e){m=new Error("Missing initPTS for VTT MPEGTS");return}T=R-t.presentationOffset}const _=E.endTime-E.startTime,F=di((E.startTime+T-g)*9e4,n*9e4)/9e4;E.startTime=Math.max(F,0),E.endTime=Math.max(F+_,0);const N=E.text.trim();E.text=decodeURIComponent(encodeURIComponent(N)),E.id||(E.id=jg(E.startTime,E.endTime,N)),E.endTime>0&&l.push(E)},o.onparsingerror=function(E){m=E},o.onflush=function(){if(m){a(m);return}s(l)},u.forEach(E=>{if(v)if(zg(E,"X-TIMESTAMP-MAP=")){v=!1,E.slice(16).split(",").forEach(x=>{zg(x,"LOCAL:")?d=x.slice(6):zg(x,"MPEGTS:")&&(p=parseInt(x.slice(7)))});try{g=eO(d)/1e3}catch(x){m=x}return}else E===""&&(v=!1);o.parse(E+`
`)}),o.flush()}const Jg="stpp.ttml.im1t",WA=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,YA=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,iO={left:"start",center:"center",right:"end",start:"start",end:"end"};function XA(i,e,t,r){const n=Qe(new Uint8Array(i),["mdat"]);if(n.length===0){r(new Error("Could not parse IMSC1 mdat"));return}const s=n.map(o=>Qr(o)),a=S_(e.baseTime,1,e.timescale);try{s.forEach(o=>t(nO(o,a)))}catch(o){r(o)}}function nO(i,e){const n=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("tt")[0];if(!n)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(s).reduce((d,p)=>(d[p]=n.getAttribute(`ttp:${p}`)||s[p],d),{}),o=n.getAttribute("xml:space")!=="preserve",u=zA(Qg(n,"styling","style")),l=zA(Qg(n,"layout","region")),h=Qg(n,"body","[begin]");return[].map.call(h,d=>{const p=jA(d,o);if(!p||!d.hasAttribute("begin"))return null;const g=ep(d.getAttribute("begin"),a),m=ep(d.getAttribute("dur"),a);let v=ep(d.getAttribute("end"),a);if(g===null)throw JA(d);if(v===null){if(m===null)throw JA(d);v=g+m}const E=new Yg(g-e,v-e,p);E.id=jg(E.startTime,E.endTime,E.text);const x=l[d.getAttribute("region")],T=u[d.getAttribute("style")],R=sO(x,T,u),{textAlign:_}=R;if(_){const F=iO[_];F&&(E.lineAlign=F),E.align=_}return Tt(E,R),E}).filter(d=>d!==null)}function Qg(i,e,t){const r=i.getElementsByTagName(e)[0];return r?[].slice.call(r.querySelectorAll(t)):[]}function zA(i){return i.reduce((e,t)=>{const r=t.getAttribute("xml:id");return r&&(e[r]=t),e},{})}function jA(i,e){return[].slice.call(i.childNodes).reduce((t,r,n)=>{var s;return r.nodeName==="br"&&n?t+`
`:(s=r.childNodes)!=null&&s.length?jA(r,e):e?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent},"")}function sO(i,e,t){const r="http://www.w3.org/ns/ttml#styling";let n=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=i!=null&&i.hasAttribute("style")?i.getAttribute("style"):null;return a&&t.hasOwnProperty(a)&&(n=t[a]),s.reduce((o,u)=>{const l=Zg(e,r,u)||Zg(i,r,u)||Zg(n,r,u);return l&&(o[u]=l),o},{})}function Zg(i,e,t){return i&&i.hasAttributeNS(e,t)?i.getAttributeNS(e,t):null}function JA(i){return new Error(`Could not parse ttml timestamp ${i}`)}function ep(i,e){if(!i)return null;let t=HA(i);return t===null&&(WA.test(i)?t=aO(i,e):YA.test(i)&&(t=oO(i,e))),t}function aO(i,e){const t=WA.exec(i),r=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+r/e.frameRate}function oO(i,e){const t=YA.exec(i),r=Number(t[1]);switch(t[2]){case"h":return r*3600;case"m":return r*60;case"ms":return r*1e3;case"f":return r/e.frameRate;case"t":return r/e.tickRate}return r}class hc{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,r){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class lO{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=ex(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(b.FRAG_LOADING,this.onFragLoading,this),e.on(b.FRAG_LOADED,this.onFragLoaded,this),e.on(b.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(b.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(b.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(b.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(b.FRAG_LOADING,this.onFragLoading,this),e.off(b.FRAG_LOADED,this.onFragLoaded,this),e.off(b.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(b.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(b.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(b.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new hc(this,"textTrack1"),t=new hc(this,"textTrack2"),r=new hc(this,"textTrack3"),n=new hc(this,"textTrack4");this.cea608Parser1=new qA(1,e,t),this.cea608Parser2=new qA(3,r,n)}addCues(e,t,r,n,s){let a=!1;for(let o=s.length;o--;){const u=s[o],l=uO(u[0],u[1],t,r);if(l>=0&&(u[0]=Math.min(u[0],t),u[1]=Math.max(u[1],r),a=!0,l/(r-t)>.5))return}if(a||s.push([t,r]),this.config.renderTextTracksNatively){const o=this.captionsTracks[e];this.Cues.newCue(o,t,r,n)}else{const o=this.Cues.newCue(null,t,r,n);this.hls.trigger(b.CUES_PARSED,{type:"captions",cues:o,track:e})}}onInitPtsFound(e,{frag:t,id:r,initPTS:n,timescale:s}){const{unparsedVttFrags:a}=this;r===Oe.MAIN&&(this.initPTS[t.cc]={baseTime:n,timescale:s}),a.length&&(this.unparsedVttFrags=[],a.forEach(o=>{this.onFragLoaded(b.FRAG_LOADED,o)}))}getExistingTrack(e,t){const{media:r}=this;if(r)for(let n=0;n<r.textTracks.length;n++){const s=r.textTracks[n];if(ZA(s,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return s}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:r,media:n}=this,{label:s,languageCode:a}=t[e],o=this.getExistingTrack(s,a);if(o)r[e]=o,Qa(r[e]),MA(r[e],n);else{const u=this.createTextTrack("captions",s,a);u&&(u[e]=!0,r[e]=u)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const r=t.label,n={_id:e,label:r,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=n,this.hls.trigger(b.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}createTextTrack(e,t,r){const n=this.media;if(n)return n.addTextTrack(e,t,r)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const r=!!t.transferMedia;if(this.media=null,r)return;const{captionsTracks:n}=this;Object.keys(n).forEach(s=>{Qa(n[s]),delete n[s]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=ex(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let r=0;r<t.length;r++)Qa(t[r])}onSubtitleTracksUpdated(e,t){const r=t.subtitleTracks||[],n=r.some(s=>s.textCodec===Jg);if(this.config.enableWebVTT||n&&this.config.enableIMSC1){if(EA(this.tracks,r)){this.tracks=r;return}if(this.textTracks=[],this.tracks=r,this.config.renderTextTracksNatively){const a=this.media,o=a?oc(a.textTracks):null;if(this.tracks.forEach((u,l)=>{let h;if(o){let d=null;for(let p=0;p<o.length;p++)if(o[p]&&ZA(o[p],u)){d=o[p],o[p]=null;break}d&&(h=d)}if(h)Qa(h);else{const d=QA(u);h=this.createTextTrack(d,u.name,u.lang),h&&(h.mode="disabled")}h&&this.textTracks.push(h)}),o!=null&&o.length){const u=o.filter(l=>l!==null).map(l=>l.label);u.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${u.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const a=this.tracks.map(o=>({label:o.name,kind:o.type.toLowerCase(),default:o.default,subtitleTrack:o}));this.hls.trigger(b.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(r=>{const n=/(?:CC|SERVICE)([1-4])/.exec(r.instreamId);if(!n)return;const s=`textTrack${n[1]}`,a=this.captionsProperties[s];a&&(a.label=r.name,r.lang&&(a.languageCode=r.lang),a.media=r)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===Oe.MAIN){var r,n;const{cea608Parser1:s,cea608Parser2:a,lastSn:o}=this,{cc:u,sn:l}=t.frag,h=(r=(n=t.part)==null?void 0:n.index)!=null?r:-1;s&&a&&(l!==o+1||l===o&&h!==this.lastPartIndex+1||u!==this.lastCc)&&(s.reset(),a.reset()),this.lastCc=u,this.lastSn=l,this.lastPartIndex=h}}onFragLoaded(e,t){const{frag:r,payload:n}=t;if(r.type===Oe.SUBTITLE)if(n.byteLength){const s=r.decryptdata,a="stats"in t;if(s==null||!s.encrypted||a){const o=this.tracks[r.level],u=this.vttCCs;u[r.cc]||(u[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),o&&o.textCodec===Jg?this._parseIMSC1(r,n):this._parseVTTs(t)}}else this.hls.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const r=this.hls;XA(t,this.initPTS[e.cc],n=>{this._appendCues(n,e.level),r.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},n=>{r.logger.log(`Failed to parse IMSC1: ${n}`),r.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:n})})}_parseVTTs(e){var t;const{frag:r,payload:n}=e,{initPTS:s,unparsedVttFrags:a}=this,o=s.length-1;if(!s[r.cc]&&o===-1){a.push(e);return}const u=this.hls,l=(t=r.initSegment)!=null&&t.data?hi(r.initSegment.data,new Uint8Array(n)).buffer:n;rO(l,this.initPTS[r.cc],this.vttCCs,r.cc,r.start,h=>{this._appendCues(h,r.level),u.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:r})},h=>{const d=h.message==="Missing initPTS for VTT MPEGTS";d?a.push(e):this._fallbackToIMSC1(r,n),u.logger.log(`Failed to parse VTT cue: ${h}`),!(d&&o>r.cc)&&u.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:h})})}_fallbackToIMSC1(e,t){const r=this.tracks[e.level];r.textCodec||XA(t,this.initPTS[e.cc],()=>{r.textCodec=Jg,this._parseIMSC1(e,t)},()=>{r.textCodec="wvtt"})}_appendCues(e,t){const r=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[t];if(!n||n.mode==="disabled")return;e.forEach(s=>OA(n,s))}else{const n=this.tracks[t];if(!n)return;const s=n.default?"default":"subtitles"+t;r.trigger(b.CUES_PARSED,{type:"subtitles",cues:e,track:s})}}onFragDecrypted(e,t){const{frag:r}=t;r.type===Oe.SUBTITLE&&this.onFragLoaded(b.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:r,samples:n}=t;if(!(r.type===Oe.MAIN&&this.closedCaptionsForLevel(r)==="NONE"))for(let s=0;s<n.length;s++){const a=n[s].bytes;if(a){this.cea608Parser1||this.initCea608Parsers();const o=this.extractCea608Data(a);this.cea608Parser1.addData(n[s].pts,o[0]),this.cea608Parser2.addData(n[s].pts,o[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:r,endOffsetSubtitles:n,type:s}){const{media:a}=this;if(!(!a||a.currentTime<r)){if(!s||s==="video"){const{captionsTracks:o}=this;Object.keys(o).forEach(u=>Hg(o[u],t,r))}if(this.config.renderTextTracksNatively&&t===0&&n!==void 0){const{textTracks:o}=this;Object.keys(o).forEach(u=>Hg(o[u],t,n))}}}extractCea608Data(e){const t=[[],[]],r=e[0]&31;let n=2;for(let s=0;s<r;s++){const a=e[n++],o=127&e[n++],u=127&e[n++];if(o===0&&u===0)continue;if((4&a)!==0){const h=3&a;(h===0||h===1)&&(t[h].push(o),t[h].push(u))}}return t}}function QA(i){return i.characteristics&&/transcribes-spoken-dialog/gi.test(i.characteristics)&&/describes-music-and-sound/gi.test(i.characteristics)?"captions":"subtitles"}function ZA(i,e){return!!i&&i.kind===QA(e)&&Fg(e,i)}function uO(i,e,t,r){return Math.min(e,r)-Math.max(i,t)}function ex(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const cO=/\s/,hO={newCue(i,e,t,r){const n=[];let s,a,o,u,l;const h=self.VTTCue||self.TextTrackCue;for(let p=0;p<r.rows.length;p++)if(s=r.rows[p],o=!0,u=0,l="",!s.isEmpty()){var d;for(let v=0;v<s.chars.length;v++)cO.test(s.chars[v].uchar)&&o?u++:(l+=s.chars[v].uchar,o=!1);s.cueStartTime=e,e===t&&(t+=1e-4),u>=16?u--:u++;const g=KA(l.trim()),m=jg(e,t,g);i!=null&&(d=i.cues)!=null&&d.getCueById(m)||(a=new h(e,t,g),a.id=m,a.line=p+1,a.align="left",a.position=10+Math.min(80,Math.floor(u*8/32)*10),n.push(a))}return i&&n.length&&(n.sort((p,g)=>p.line==="auto"||g.line==="auto"?0:p.line>8&&g.line>8?g.line-p.line:p.line-g.line),n.forEach(p=>OA(i,p))),n}};function dO(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const fO=/(\d+)-(\d+)\/(\d+)/;class tx{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||yO,this.controller=new self.AbortController,this.stats=new tg}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,r){const n=this.stats;if(n.loading.start)throw new Error("Loader can only be used once.");n.loading.start=self.performance.now();const s=gO(e,this.controller.signal),a=e.responseType==="arraybuffer",o=a?"byteLength":"length",{maxTimeToFirstByteMs:u,maxLoadTimeMs:l}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=u&&Ce(u)?u:l,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(n,e,this.response))},t.timeout),(ul(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(d=>{var p;this.response=this.loader=d;const g=Math.max(self.performance.now(),n.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=l,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(n,e,this.response))},l-(g-n.loading.start)),!d.ok){const{status:v,statusText:E}=d;throw new vO(E||"fetch, bad network response",v,d)}n.loading.first=g,n.total=mO(d.headers)||n.total;const m=(p=this.callbacks)==null?void 0:p.onProgress;return m&&Ce(t.highWaterMark)?this.loadProgressively(d,n,e,t.highWaterMark,m):a?d.arrayBuffer():e.responseType==="json"?d.json():d.text()}).then(d=>{var p,g;const m=this.response;if(!m)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),n.loading.end=Math.max(self.performance.now(),n.loading.first);const v=d[o];v&&(n.loaded=n.total=v);const E={url:m.url,data:d,code:m.status},x=(p=this.callbacks)==null?void 0:p.onProgress;x&&!Ce(t.highWaterMark)&&x(n,e,d,m),(g=this.callbacks)==null||g.onSuccess(E,n,e,m)}).catch(d=>{var p;if(self.clearTimeout(this.requestTimeout),n.aborted)return;const g=d&&d.code||0,m=d?d.message:null;(p=this.callbacks)==null||p.onError({code:g,text:m},e,d?d.details:null,n)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,r,n=0,s){const a=new V2,o=e.body.getReader(),u=()=>o.read().then(l=>{if(l.done)return a.dataLength&&s(t,r,a.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const h=l.value,d=h.length;return t.loaded+=d,d<n||a.dataLength?(a.push(h),a.dataLength>=n&&s(t,r,a.flush().buffer,e)):s(t,r,h.buffer,e),u()}).catch(()=>Promise.reject());return u()}}function gO(i,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Tt({},i.headers))};return i.rangeEnd&&t.headers.set("Range","bytes="+i.rangeStart+"-"+String(i.rangeEnd-1)),t}function pO(i){const e=fO.exec(i);if(e)return parseInt(e[2])-parseInt(e[1])+1}function mO(i){const e=i.get("Content-Range");if(e){const r=pO(e);if(Ce(r))return r}const t=i.get("Content-Length");if(t)return parseInt(t)}function yO(i,e){return new self.Request(i.url,e)}class vO extends Error{constructor(e,t,r){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=r}}const EO=/^age:\s*[\d.]+\s*$/im;class rx{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new tg,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const r=this.loader=new self.XMLHttpRequest,n=this.stats;n.loading.first=0,n.loaded=0,n.aborted=!1;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!(this.loader!==r||this.stats.aborted))return s(r,t.url)}).catch(a=>{if(!(this.loader!==r||this.stats.aborted))return r.open("GET",t.url,!0),s(r,t.url)}).then(()=>{this.loader!==r||this.stats.aborted||this.openAndSendXhr(r,t,e)}).catch(a=>{var o;(o=this.callbacks)==null||o.onError({code:r.status,text:a.message},t,r,n)}):this.openAndSendXhr(r,t,e)}openAndSendXhr(e,t,r){e.readyState||e.open("GET",t.url,!0);const n=t.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:a}=r.loadPolicy;if(n)for(const o in n)e.setRequestHeader(o,n[o]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=s&&Ce(s)?s:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:r}=this;if(!e||!t)return;const n=t.readyState,s=this.config;if(!r.aborted&&n>=2&&(r.loading.first===0&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),n===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const l=t.status,h=t.responseType==="text"?t.responseText:null;if(l>=200&&l<300){const m=h??t.response;if(m!=null){var a,o;r.loading.end=Math.max(self.performance.now(),r.loading.first);const v=t.responseType==="arraybuffer"?m.byteLength:m.length;r.loaded=r.total=v,r.bwEstimate=r.total*8e3/(r.loading.end-r.loading.first);const E=(a=this.callbacks)==null?void 0:a.onProgress;E&&E(r,e,m,t);const x={url:t.responseURL,data:m,code:l};(o=this.callbacks)==null||o.onSuccess(x,r,e,t);return}}const d=s.loadPolicy.errorRetry,p=r.retry,g={url:e.url,data:void 0,code:l};if(Hu(d,p,!1,g))this.retry(d);else{var u;yt.error(`${l} while loading ${e.url}`),(u=this.callbacks)==null||u.onError({code:l,text:t.statusText},e,t,r)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(Hu(e,t,!0))this.retry(e);else{var r;yt.warn(`timeout while loading ${(r=this.context)==null?void 0:r.url}`);const n=this.callbacks;n&&(this.abortInternal(),n.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:r}=this;this.retryDelay=ug(e,r.retry),r.retry++,yt.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${r.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&EO.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const AO={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},xO=At(At({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:rx,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:jN,bufferController:B_,capLevelController:Ug,errorController:tL,fpsController:TM,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:A2,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:AO},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},SO()),{},{subtitleStreamController:kM,subtitleTrackController:IM,timelineController:lO,audioStreamController:O_,audioTrackController:P_,emeController:Ja,cmcdController:xM,contentSteeringController:bM,interstitialsController:PM});function SO(){return{cueHandler:hO,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function bO(i,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const r=tp(i),n=["manifest","level","frag"],s=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(a=>{const o=`${a==="level"?"playlist":a}LoadPolicy`,u=e[o]===void 0,l=[];s.forEach(h=>{const d=`${a}Loading${h}`,p=e[d];if(p!==void 0&&u){l.push(d);const g=r[o].default;switch(e[o]={default:g},h){case"TimeOut":g.maxLoadTimeMs=p,g.maxTimeToFirstByteMs=p;break;case"MaxRetry":g.errorRetry.maxNumRetry=p,g.timeoutRetry.maxNumRetry=p;break;case"RetryDelay":g.errorRetry.retryDelayMs=p,g.timeoutRetry.retryDelayMs=p;break;case"MaxRetryTimeout":g.errorRetry.maxRetryDelayMs=p,g.timeoutRetry.maxRetryDelayMs=p;break}}}),l.length&&t.warn(`hls.js config: "${l.join('", "')}" setting(s) are deprecated, use "${o}": ${Bt(e[o])}`)}),At(At({},r),e)}function tp(i){return i&&typeof i=="object"?Array.isArray(i)?i.map(tp):Object.keys(i).reduce((e,t)=>(e[t]=tp(i[t]),e),{}):i}function TO(i,e){const t=i.loader;t!==tx&&t!==rx?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),i.progressive=!1):dO()&&(i.loader=tx,i.progressive=!0,i.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const dc=2,DO=.1,RO=.05,IO=100;class wO extends f2{constructor(e,t){super("gap-controller",e.logger),this.hls=null,this.fragmentTracker=null,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var r;(r=this.media)!=null&&r.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var r;this.ended=((r=this.media)==null?void 0:r.currentTime)||1,this.hls.trigger(b.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(IO),this.mediaSource=t.mediaSource;const r=this.media=t.media;ei(r,"playing",this.onMediaPlaying),ei(r,"waiting",this.onMediaWaiting),ei(r,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:r}=this;r&&(fi(r,"playing",this.onMediaPlaying),fi(r,"waiting",this.onMediaWaiting),fi(r,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var r,n;const s=(r=this.hls)==null?void 0:r.config;if(!s)return;const a=this.media;if(!a)return;const{seeking:o}=a,u=this.seeking&&!o,l=!this.seeking&&o,h=a.paused&&!o||a.ended||a.playbackRate===0;if(this.seeking=o,e!==t){t&&(this.ended=0),this.moved=!0,o||(this.nudgeRetry=0,s.nudgeOnVideoHole&&!h&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(l||u){u&&this.stallResolved(e);return}if(h){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&a.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(b.MEDIA_ENDED,{stalled:!1}));return}if(!Xe.getBuffered(a).length){this.nudgeRetry=0;return}const d=Xe.bufferInfo(a,e,0),p=d.nextStart||0,g=this.fragmentTracker;if(o&&g&&this.hls){const N=ix(this.hls.inFlightFragments,e),C=d.len>dc,M=!p||N||p-e>dc&&!g.getPartialFragment(e);if(C||M)return;this.moved=!1}const m=(n=this.hls)==null?void 0:n.latestLevelDetails;if(!this.moved&&this.stalled!==null&&g){if(!(d.len>0)&&!p)return;const C=Math.max(p,d.start||0)-e,L=!!(m!=null&&m.live)?m.targetduration*2:dc,I=g.getPartialFragment(e);if(C>0&&(C<=L||I)){a.paused||this._trySkipBufferHole(I);return}}const v=s.detectStallWithCurrentTimeMs,E=self.performance.now(),x=this.waiting;let T=this.stalled;if(T===null)if(x>0&&E-x<v)T=this.stalled=x;else{this.stalled=E;return}const R=E-T;if(!o&&(R>=v||x)&&this.hls){var _;if(((_=this.mediaSource)==null?void 0:_.readyState)==="ended"&&!(m!=null&&m.live)&&Math.abs(e-((m==null?void 0:m.edge)||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(b.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(d),!this.media||!this.hls)return}const F=Xe.bufferInfo(a,e,s.maxBufferHole);this._tryFixBufferStall(F,R,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const r=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(r)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(b.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var r;const n=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(r=this.buffered.audio)!=null&&r.length&&n&&n.length>1&&e>n.end(0)){const s=Xe.bufferedInfo(Xe.timeRangesToArray(this.buffered.audio),e,0);if(s.len>1&&t>=s.start){const a=Xe.timeRangesToArray(n),o=Xe.bufferedInfo(a,t,0).bufferedIndex;if(o>-1&&o<a.length-1){const u=Xe.bufferedInfo(a,e,0).bufferedIndex,l=a[o].end,h=a[o+1].start;if((u===-1||u>o)&&h-l<1&&e-l<2){const d=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${l} -> ${h} buffered index: ${u}`);this.warn(d.message),this.media.currentTime+=1e-6;const p=this.fragmentTracker.getPartialFragment(e)||void 0,g=Xe.bufferInfo(this.media,e,0);this.hls.trigger(b.ERROR,{type:ke.MEDIA_ERROR,details:Q.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:d,reason:d.message,frag:p,buffer:g.len,bufferInfo:g})}}}}}_tryFixBufferStall(e,t,r){var n,s;const{fragmentTracker:a,media:o}=this,u=(n=this.hls)==null?void 0:n.config;if(!o||!a||!u)return;const l=(s=this.hls)==null?void 0:s.latestLevelDetails,h=a.getPartialFragment(r);if((h||l!=null&&l.live&&r<l.fragmentStart)&&(this._trySkipBufferHole(h)||!this.media))return;const d=e.buffered,p=this.adjacentTraversal(e,r);(d&&d.length>1&&e.len>u.maxBufferHole||e.nextStart&&(e.nextStart-r<u.maxBufferHole||p))&&(t>u.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const r=this.fragmentTracker,n=e.nextStart;if(r&&n){const s=r.getFragAtPos(t,Oe.MAIN),a=r.getFragAtPos(n,Oe.MAIN);if(s&&a)return a.sn-s.sn<2}return!1}_reportStall(e){const{hls:t,media:r,stallReported:n,stalled:s}=this;if(!n&&s!==null&&r&&t){this.stallReported=!0;const a=new Error(`Playback stalling at @${r.currentTime} due to low buffer (${Bt(e)})`);this.warn(a.message),t.trigger(b.ERROR,{type:ke.MEDIA_ERROR,details:Q.BUFFER_STALLED_ERROR,fatal:!1,error:a,buffer:e.len,bufferInfo:e,stalled:{start:s}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:r,media:n}=this,s=(t=this.hls)==null?void 0:t.config;if(!n||!r||!s)return 0;const a=n.currentTime,o=Xe.bufferInfo(n,a,0),u=a<o.start?o.start:o.nextStart;if(u&&this.hls){const h=o.len<=s.maxBufferHole,d=o.len>0&&o.len<1&&n.readyState<3,p=u-a;if(p>0&&(h||d)){if(p>s.maxBufferHole){let m=!1;if(a===0){const v=r.getAppendedFrag(0,Oe.MAIN);v&&u<v.end&&(m=!0)}if(!m){const v=e||r.getAppendedFrag(a,Oe.MAIN);if(v){var l;if(!((l=this.hls.loadLevelObj)!=null&&l.details)||ix(this.hls.inFlightFragments,u))return 0;let x=!1,T=v.end;for(;T<u;){const R=r.getPartialFragment(T);if(R)T+=R.duration;else{x=!0;break}}if(x)return 0}}}const g=Math.max(u+RO,a+DO);if(this.warn(`skipping hole, adjusting currentTime from ${a} to ${g}`),this.moved=!0,n.currentTime=g,!(e!=null&&e.gap)){const m=new Error(`fragment loaded with buffer holes, seeking from ${a} to ${g}`);this.hls.trigger(b.ERROR,{type:ke.MEDIA_ERROR,details:Q.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:m,reason:m.message,frag:e||void 0,buffer:o.len,bufferInfo:o})}return g}}return 0}_tryNudgeBuffer(e){const{hls:t,media:r,nudgeRetry:n}=this,s=t==null?void 0:t.config;if(!r||!s)return 0;const a=r.currentTime;if(this.nudgeRetry++,n<s.nudgeMaxRetry){const o=a+(n+1)*s.nudgeOffset,u=new Error(`Nudging 'currentTime' from ${a} to ${o}`);this.warn(u.message),r.currentTime=o,t.trigger(b.ERROR,{type:ke.MEDIA_ERROR,details:Q.BUFFER_NUDGE_ON_STALL,error:u,fatal:!1,buffer:e.len,bufferInfo:e})}else{const o=new Error(`Playhead still not moving while enough data buffered @${a} after ${s.nudgeMaxRetry} nudges`);this.error(o.message),t.trigger(b.ERROR,{type:ke.MEDIA_ERROR,details:Q.BUFFER_STALLED_ERROR,error:o,fatal:!0,buffer:e.len,bufferInfo:e})}}}function ix(i,e){const t=nx(i.main);if(t&&t.start<=e)return t;const r=nx(i.audio);return r&&r.start<=e?r:null}function nx(i){if(!i)return null;switch(i.state){case oe.IDLE:case oe.STOPPED:case oe.ENDED:case oe.ERROR:return null}return i.frag}const CO=.25;function rp(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function sx(i,e,t,r,n){let s=new i(e,t,"");try{s.value=r,n&&(s.type=n)}catch{s=new i(e,t,Bt(n?At({type:n},r):r))}return s}const fc=(()=>{const i=rp();try{i&&new i(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function NO(i){return Uint8Array.from(i.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class LO{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(b.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(b.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(b.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}onMediaAttaching(e,t){var r;this.media=t.media,((r=t.overrides)==null?void 0:r.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){const e=this.hls.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&Qa(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const r=e[t];if(r.kind==="metadata"&&r.label==="id3")return MA(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:r,enableID3MetadataCues:n}}}=this;if(!r&&!n)return;const{samples:s}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const a=rp();if(a)for(let o=0;o<s.length;o++){const u=s[o].type;if(u===Zr.emsg&&!r||!n)continue;const l=Q2(s[o].data);if(l){const h=s[o].pts;let d=h+s[o].duration;d>fc&&(d=fc),d-h<=0&&(d=h+CO);for(let g=0;g<l.length;g++){const m=l[g];if(!Z2(m)){this.updateId3CueEnds(h,u);const v=sx(a,h,d,m,u);v&&this.id3Track.addCue(v)}}}}}updateId3CueEnds(e,t){var r;const n=(r=this.id3Track)==null?void 0:r.cues;if(n)for(let s=n.length;s--;){const a=n[s];a.type===t&&a.startTime<e&&a.endTime===fc&&(a.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:r,type:n}){const{id3Track:s,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:u}}=a;if(s&&(o||u)){let l;n==="audio"?l=h=>h.type===Zr.audioId3&&u:n==="video"?l=h=>h.type===Zr.emsg&&o:l=h=>h.type===Zr.audioId3&&u||h.type===Zr.emsg&&o,Hg(s,t,r,l)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.media||!e.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{id3Track:r}=this,{dateRanges:n}=e,s=Object.keys(n);let a=this.dateRangeCuesAppended;if(r&&t){var o;if((o=r.cues)!=null&&o.length){const h=Object.keys(a).filter(d=>!s.includes(d));for(let d=h.length;d--;){const p=h[d],g=a[p].cues;delete a[p],Object.keys(g).forEach(m=>{try{const v=g[m];v.removeEventListener("enter",this.onEventCueEnter),r.removeCue(v)}catch{}})}}else a=this.dateRangeCuesAppended={}}const u=e.fragments[e.fragments.length-1];if(s.length===0||!Ce(u==null?void 0:u.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=rp();for(let h=0;h<s.length;h++){const d=s[h],p=n[d],g=p.startTime,m=a[d],v=(m==null?void 0:m.cues)||{};let E=(m==null?void 0:m.durationKnown)||!1,x=fc;const{duration:T,endDate:R}=p;if(R&&T!==null)x=g+T,E=!0;else if(p.endOnNext&&!E){const F=s.reduce((N,C)=>{if(C!==p.id){const M=n[C];if(M.class===p.class&&M.startDate>p.startDate&&(!N||p.startDate<N.startDate))return M}return N},null);F&&(x=F.startTime,E=!0)}const _=Object.keys(p.attr);for(let F=0;F<_.length;F++){const N=_[F];if(!gL(N))continue;const C=v[N];if(C)E&&!m.durationKnown?C.endTime=x:Math.abs(C.startTime-g)>.01&&(C.startTime=g,C.endTime=x);else if(l){let M=p.attr[N];pL(N)&&(M=NO(M));const I=sx(l,g,x,{key:N,data:M},Zr.dateRange);I&&(I.id=d,this.id3Track.addCue(I),v[N]=I,this.hls.config.interstitialsController&&(N==="X-ASSET-LIST"||N==="X-ASSET-URL")&&I.addEventListener("enter",this.onEventCueEnter))}}a[d]={cues:v,dateRange:p,durationKnown:E}}}}class _O{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,r=this.levelDetails;if(!t||!r)return;this.currentTime=t.currentTime;const n=this.computeLatency();if(n===null)return;this._latency=n;const{lowLatencyMode:s,maxLiveSyncPlaybackRate:a}=this.config;if(!s||a===1||!r.live)return;const o=this.targetLatency;if(o===null)return;const u=n-o,l=Math.min(this.maxLatency,o+r.targetduration);if(u<l&&u>.05&&this.forwardBufferLength>1){const d=Math.min(2,Math.max(1,a)),p=Math.round(2/(1+Math.exp(-.75*u-this.edgeStalled))*20)/20,g=Math.min(d,Math.max(1,p));this.changeMediaPlaybackRate(t,g)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:r,targetduration:n}=e,{liveSyncDuration:s,liveSyncDurationCount:a,lowLatencyMode:o}=this.config,u=this.hls.userConfig;let l=o&&r||t;(this._targetLatencyUpdated||u.liveSyncDuration||u.liveSyncDurationCount||l===0)&&(l=s!==void 0?s:a*n);const h=n;return l+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,h)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const r=this.levelDetails;if(r===null)return null;const n=r.edge,s=e-t-this.edgeStalled,a=n-r.totalduration,o=n-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(a,s),o)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(b.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(b.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var r;t.details===Q.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(r=this.levelDetails)!=null&&r.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var r,n;e.playbackRate!==t&&((r=this.hls)==null||r.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(n=this.targetLatency)==null?void 0:n.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class MO extends kg{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this),e.on(b.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this),e.off(b.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const r=this.hls.config.preferManagedMediaSource,n=[],s={},a={};let o=!1,u=!1,l=!1;t.levels.forEach(h=>{const d=h.attrs;let{audioCodec:p,videoCodec:g}=h;p&&(h.audioCodec=p=Fu(p,r)||void 0),g&&(g=h.videoCodec=kN(g));const{width:m,height:v,unknownCodecs:E}=h;let x=E?E.length:0;if(E)for(let I=x;I--;){const U=E[I];this.isAudioSupported(U)?(h.audioCodec=p=p?`${p},${U}`:U,x--,Va.audio[p.substring(0,4)]=2):this.isVideoSupported(U)&&(h.videoCodec=g=g?`${g},${U}`:U,x--,Va.video[g.substring(0,4)]=2)}if(o||(o=!!(m&&v)),u||(u=!!g),l||(l=!!p),x||p&&!this.isAudioSupported(p)||g&&!this.isVideoSupported(g)){this.log(`Some or all CODECS not supported "${d.CODECS}"`);return}const{CODECS:T,"FRAME-RATE":R,"HDCP-LEVEL":_,"PATHWAY-ID":F,RESOLUTION:N,"VIDEO-RANGE":C}=d,L=`${`${F||"."}-`}${h.bitrate}-${N}-${R}-${T}-${C}-${_}`;if(s[L])if(s[L].uri!==h.url&&!h.attrs["PATHWAY-ID"]){const I=a[L]+=1;h.attrs["PATHWAY-ID"]=new Array(I+1).join(".");const U=this.createLevel(h);s[L]=U,n.push(U)}else s[L].addGroupId("audio",d.AUDIO),s[L].addGroupId("text",d.SUBTITLES);else{const I=this.createLevel(h);s[L]=I,a[L]=1,n.push(I)}}),this.filterAndSortMediaOptions(n,t,o,u,l)}createLevel(e){const t=new el(e),r=e.supplemental;if(r!=null&&r.videoCodec&&!this.isVideoSupported(r.videoCodec)){const n=new Error(`SUPPLEMENTAL-CODECS not supported "${r.videoCodec}"`);this.log(n.message),t.supportedResult=zE(n,[])}return t}isAudioSupported(e){return ag(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return ag(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,r,n,s){let a=[],o=[],u=e;if((r||n)&&s&&(u=u.filter(({videoCodec:E,videoRange:x,width:T,height:R})=>(!!E||!!(T&&R))&&GN(x))),u.length===0){Promise.resolve().then(()=>{if(this.hls){let E="no level with compatible codecs found in manifest",x=E;t.levels.length&&(x=`one or more CODECS in variant not supported: ${Bt(t.levels.map(R=>R.attrs.CODECS).filter((R,_,F)=>F.indexOf(R)===_))}`,this.warn(x),E+=` (${x})`);const T=new Error(E);this.hls.trigger(b.ERROR,{type:ke.MEDIA_ERROR,details:Q.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:T,reason:x})}});return}t.audioTracks&&(a=t.audioTracks.filter(E=>!E.audioCodec||this.isAudioSupported(E.audioCodec)),ax(a)),t.subtitles&&(o=t.subtitles,ax(o));const l=u.slice(0);u.sort((E,x)=>{if(E.attrs["HDCP-LEVEL"]!==x.attrs["HDCP-LEVEL"])return(E.attrs["HDCP-LEVEL"]||"")>(x.attrs["HDCP-LEVEL"]||"")?1:-1;if(r&&E.height!==x.height)return E.height-x.height;if(E.frameRate!==x.frameRate)return E.frameRate-x.frameRate;if(E.videoRange!==x.videoRange)return Uu.indexOf(E.videoRange)-Uu.indexOf(x.videoRange);if(E.videoCodec!==x.videoCodec){const T=KE(E.videoCodec),R=KE(x.videoCodec);if(T!==R)return R-T}if(E.uri===x.uri&&E.codecSet!==x.codecSet){const T=ku(E.codecSet),R=ku(x.codecSet);if(T!==R)return R-T}return E.averageBitrate!==x.averageBitrate?E.averageBitrate-x.averageBitrate:0});let h=l[0];if(this.steering&&(u=this.steering.filterParsedLevels(u),u.length!==l.length)){for(let E=0;E<l.length;E++)if(l[E].pathwayId===u[0].pathwayId){h=l[E];break}}this._levels=u;for(let E=0;E<u.length;E++)if(u[E]===h){var d;this._firstLevel=E;const x=h.bitrate,T=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${u.length} level(s) found, first bitrate: ${x}`),((d=this.hls.userConfig)==null?void 0:d.abrEwmaDefaultEstimate)===void 0){const R=Math.min(x,this.hls.config.abrEwmaDefaultEstimateMax);R>T&&T===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=R)}break}const p=s&&!n,g=this.hls.config,m=!!(g.audioStreamController&&g.audioTrackController),v={levels:u,audioTracks:a,subtitleTracks:o,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:s,video:n,altAudio:m&&!p&&a.some(E=>!!E.url)};this.hls.trigger(b.MANIFEST_PARSED,v)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const h=new Error("invalid level idx"),d=e<0;if(this.hls.trigger(b.ERROR,{type:ke.OTHER_ERROR,details:Q.LEVEL_SWITCH_ERROR,level:e,fatal:d,error:h,reason:h.message}),d)return;e=Math.min(e,t.length-1)}const r=this.currentLevelIndex,n=this.currentLevel,s=n?n.attrs["PATHWAY-ID"]:void 0,a=t[e],o=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=a,r===e&&n&&s===o)return;this.log(`Switching to level ${e} (${a.height?a.height+"p ":""}${a.videoRange?a.videoRange+" ":""}${a.codecSet?a.codecSet+" ":""}@${a.bitrate})${o?" with Pathway "+o:""} from level ${r}${s?" with Pathway "+s:""}`);const u={level:e,attrs:a.attrs,details:a.details,bitrate:a.bitrate,averageBitrate:a.averageBitrate,maxBitrate:a.maxBitrate,realBitrate:a.realBitrate,width:a.width,height:a.height,codecSet:a.codecSet,audioCodec:a.audioCodec,videoCodec:a.videoCodec,audioGroups:a.audioGroups,subtitleGroups:a.subtitleGroups,loaded:a.loaded,loadError:a.loadError,fragmentError:a.fragmentError,name:a.name,id:a.id,uri:a.uri,url:a.url,urlId:0,audioGroupIds:a.audioGroupIds,textGroupIds:a.textGroupIds};this.hls.trigger(b.LEVEL_SWITCHING,u);const l=a.details;if(!l||l.live){const h=this.switchParams(a.uri,n==null?void 0:n.details,l);this.loadPlaylist(h)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),r=e.filter(n=>t.indexOf(n)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=r}}onError(e,t){t.fatal||!t.context||t.context.type===ot.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===Oe.MAIN){const r=t.elementaryStreams;if(!Object.keys(r).some(s=>!!r[s]))return;const n=this._levels[t.level];n!=null&&n.loadError&&(this.log(`Resetting level error count of ${n.loadError} on frag buffered`),n.loadError=0)}}onLevelLoaded(e,t){var r;const{level:n,details:s}=t,a=t.levelInfo;if(!a){var o;this.warn(`Invalid level index ${n}`),(o=t.deliveryDirectives)!=null&&o.skip&&(s.deltaUpdateFailed=!0);return}if(a===this.currentLevel||t.withoutMultiVariant){a.fragmentError===0&&(a.loadError=0);let u=a.details;u===t.details&&u.advanced&&(u=void 0),this.playlistLoaded(n,t,u)}else(r=t.deliveryDirectives)!=null&&r.skip&&(s.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=this.getUrlWithDirectives(e.uri,t),n=this.currentLevelIndex,s=e.attrs["PATHWAY-ID"],a=e.details,o=a==null?void 0:a.age;this.log(`Loading level index ${n}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${s?" Pathway "+s:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${r}`),this.hls.trigger(b.LEVEL_LOADING,{url:r,level:n,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const r=this._levels.filter((s,a)=>a!==e?!0:(this.steering&&this.steering.removeLevel(s),s===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,s.details&&s.details.fragments.forEach(o=>o.level=-1)),!1));U2(r),this._levels=r,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const n=r.length-1;this._firstLevel=Math.min(this._firstLevel,n),this._startLevel&&(this._startLevel=Math.min(this._startLevel,n)),this.hls.trigger(b.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:r}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(b.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:r}))}}function ax(i){const e={};i.forEach(t=>{const r=t.groupId||"";t.id=e[r]=e[r]||0,e[r]++})}function ox(){return self.SourceBuffer||self.WebKitSourceBuffer}function lx(){if(!us())return!1;const e=ox();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function OO(){if(!lx())return!1;const i=us();return typeof(i==null?void 0:i.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>i.isTypeSupported(Zo(e,"video")))||["mp4a.40.2","fLaC"].some(e=>i.isTypeSupported(Zo(e,"audio"))))}function PO(){var i;const e=ox();return typeof(e==null||(i=e.prototype)==null?void 0:i.changeType)=="function"}const kO=100;class FO extends xg{constructor(e,t,r){super(e,t,r,"stream-controller",Oe.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const n=this.media,s=n?n.currentTime:null;if(s===null||!Ce(s)||(this.log(`Media seeked to ${s.toFixed(3)}`),!this.getBufferedFrag(s)))return;const a=this.getFwdBufferInfoAtPos(n,s,Oe.MAIN,0);if(a===null||a.len===0){this.warn(`Main forward buffer length at ${s} on "seeked" event ${a?a.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(b.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(b.BUFFER_CREATED,this.onBufferCreated,this),e.on(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(b.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(b.BUFFER_CREATED,this.onBufferCreated,this),e.off(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:r,hls:n}=this;if(this.stopLoad(),this.setInterval(kO),this.level=-1,!this.startFragRequested){let s=n.startLevel;s===-1&&(n.config.testBandwidth&&this.levels.length>1?(s=0,this.bitrateTest=!0):s=n.firstAutoLevel),n.nextLoadLevel=s,this.level=n.loadLevel,this._hasEnoughToStart=!!t}r>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r),this.state=oe.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=oe.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case oe.WAITING_LEVEL:{const{levels:t,level:r}=this,n=t==null?void 0:t[r],s=n==null?void 0:n.details;if(s&&(!s.live||this.levelLastLoaded===n&&!this.waitForLive(n))){if(this.waitForCdnTuneIn(s))break;this.state=oe.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=oe.IDLE;break}break}case oe.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),r=this.retryDate;if(!r||t>=r||(e=this.media)!=null&&e.seeking){const{levels:n,level:s}=this,a=n==null?void 0:n[s];this.resetStartWhenNotLoaded(a||null),this.state=oe.IDLE}}break}this.state===oe.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:r,media:n}=this;if(t===null||!n&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const s=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(r!=null&&r[s]))return;const a=r[s],o=this.getMainFwdBufferInfo();if(o===null)return;const u=this.getLevelDetails();if(u&&this._streamEnded(o,u)){const v={};this.altAudio===2&&(v.type="video"),this.hls.trigger(b.BUFFER_EOS,v),this.state=oe.ENDED;return}if(!this.buffering)return;e.loadLevel!==s&&e.manualLevel===-1&&this.log(`Adapting to level ${s} from level ${this.level}`),this.level=e.nextLoadLevel=s;const l=a.details;if(!l||this.state===oe.WAITING_LEVEL||this.waitForLive(a)){this.level=s,this.state=oe.WAITING_LEVEL,this.startFragRequested=!1;return}const h=o.len,d=this.getMaxBufferLength(a.maxBitrate);if(h>=d)return;this.backtrackFragment&&this.backtrackFragment.start>o.end&&(this.backtrackFragment=null);const p=this.backtrackFragment?this.backtrackFragment.start:o.end;let g=this.getNextFragment(p,l);if(this.couldBacktrack&&!this.fragPrevious&&g&&lr(g)&&this.fragmentTracker.getState(g)!==tr.OK){var m;const E=((m=this.backtrackFragment)!=null?m:g).sn-l.startSN,x=l.fragments[E-1];x&&g.cc===x.cc&&(g=x,this.fragmentTracker.removeFragment(x))}else this.backtrackFragment&&o.len&&(this.backtrackFragment=null);if(g&&this.isLoopLoading(g,p)){if(!g.gap){const E=this.audioOnly&&!this.altAudio?wt.AUDIO:wt.VIDEO,x=(E===wt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;x&&this.afterBufferFlushed(x,E,Oe.MAIN)}g=this.getNextFragmentLoopLoading(g,l,o,Oe.MAIN,d)}g&&(g.initSegment&&!g.initSegment.data&&!this.bitrateTest&&(g=g.initSegment),this.loadFragment(g,a,p))}loadFragment(e,t,r){const n=this.fragmentTracker.getState(e);n===tr.NOT_LOADED||n===tr.PARTIAL?lr(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,r):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Oe.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let r;const n=this.getAppendedFrag(t.currentTime);n&&n.start>1&&this.flushMainBuffer(0,n.start-1);const s=this.getLevelDetails();if(s!=null&&s.live){const o=this.getMainFwdBufferInfo();if(!o||o.len<s.targetduration*2)return}if(!t.paused&&e){const o=this.hls.nextLoadLevel,u=e[o],l=this.fragLastKbps;l&&this.fragCurrent?r=this.fragCurrent.duration*u.maxBitrate/(1e3*l)+1:r=0}else r=0;const a=this.getBufferedFrag(t.currentTime+r);if(a){const o=this.followingBufferedFrag(a);if(o){this.abortCurrentFrag();const u=o.maxStartPTS?o.maxStartPTS:o.start,l=o.duration,h=Math.max(a.end,u+Math.min(Math.max(l-this.config.maxFragLookUpTolerance,l*(this.couldBacktrack?.5:.125)),l*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(h,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case oe.KEY_LOADING:case oe.FRAG_LOADING:case oe.FRAG_LOADING_WAITING_RETRY:case oe.PARSING:case oe.PARSED:this.state=oe.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const r=t.media;ei(r,"playing",this.onMediaPlaying),ei(r,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:r}=this;r&&(fi(r,"playing",this.onMediaPlaying),fi(r,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(b.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let r=!1,n=!1;t.levels.forEach(s=>{const a=s.audioCodec;a&&(r=r||a.indexOf("mp4a.40.2")!==-1,n=n||a.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=r&&n&&!PO(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:r}=this;if(!r||this.state!==oe.IDLE)return;const n=t.levelInfo;(!n.details||n.details.live&&(this.levelLastLoaded!==n||n.details.expired)||this.waitForCdnTuneIn(n.details))&&(this.state=oe.WAITING_LEVEL)}onLevelLoaded(e,t){var r;const{levels:n,startFragRequested:s}=this,a=t.level,o=t.details,u=o.totalduration;if(!n){this.warn(`Levels were reset while loading level ${a}`);return}this.log(`Level ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${u}`);const l=t.levelInfo,h=this.fragCurrent;h&&(this.state===oe.FRAG_LOADING||this.state===oe.FRAG_LOADING_WAITING_RETRY)&&h.level!==t.level&&h.loader&&this.abortCurrentFrag();let d=0;if(o.live||(r=l.details)!=null&&r.live){var p;if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;d=this.alignPlaylists(o,l.details,(p=this.levelLastLoaded)==null?void 0:p.details)}if(l.details=o,this.levelLastLoaded=l,s||this.setStartPosition(o,d),this.hls.trigger(b.LEVEL_UPDATED,{details:o,level:a}),this.state===oe.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=oe.IDLE}s&&o.live&&this.synchronizeToLiveEdge(o),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:r}=this;if(!r)return;const n=this.hls.liveSyncPosition,s=this.getLoadPosition(),a=e.fragmentStart,o=e.edge,u=s>=a-t.maxFragLookUpTolerance&&s<=o;if(n!==null&&r.duration>n&&(s<n||!u)){const h=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!u&&r.readyState<4||s<o-h)&&(this._hasEnoughToStart||(this.nextLoadPosition=n),r.readyState))if(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${o}, reset currentTime to : ${n.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var l;const d=Xe.bufferInfo(r,n,0);if(!(d!=null&&(l=d.buffered)!=null&&l.length)){r.currentTime=n;return}if(d.start<=s){r.currentTime=n;return}const{nextStart:g}=Xe.bufferedInfo(d.buffered,s,0);g&&(r.currentTime=g)}else r.currentTime=n}}_handleFragmentLoadProgress(e){var t;const r=e.frag,{part:n,payload:s}=e,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const o=a[r.level];if(!o){this.warn(`Level ${r.level} not found on progress`);return}const u=o.details;if(!u){this.warn(`Dropping fragment ${r.sn} of level ${r.level} after level details were reset`),this.fragmentTracker.removeFragment(r);return}const l=o.videoCodec,h=u.PTSKnown||!u.live,d=(t=r.initSegment)==null?void 0:t.data,p=this._getAudioCodec(o),g=this.transmuxer=this.transmuxer||new yA(this.hls,Oe.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),m=n?n.index:-1,v=m!==-1,E=new hg(r.level,r.sn,r.stats.chunkCount,s.byteLength,m,v),x=this.initPTS[r.cc];g.push(s,d,p,l,r,n,u.totalduration,h,E,x)}onAudioTrackSwitching(e,t){const r=this.hls,n=this.altAudio===2;if(Gu(t.url,r))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(n){this.fragmentTracker.removeAllFragments(),r.once(b.BUFFER_FLUSHED,()=>{var a;(a=this.hls)==null||a.trigger(b.AUDIO_TRACK_SWITCHED,t)}),r.trigger(b.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}r.trigger(b.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const r=Gu(t.url,this.hls);if(r){const n=this.videoBuffer;n&&this.mediaBuffer!==n&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=r?2:0,this.tick()}onBufferCreated(e,t){const r=t.tracks;let n,s,a=!1;for(const o in r){const u=r[o];if(u.id==="main"){if(s=o,n=u,o==="video"){const l=r[o];l&&(this.videoBuffer=l.buffer)}}else a=!0}a&&n?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:r,part:n}=t,s=r.type===Oe.MAIN;if(s){if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${n?" p: "+n.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}`),this.state===oe.PARSED&&(this.state=oe.IDLE);return}const o=n?n.stats:r.stats;this.fragLastKbps=Math.round(8*o.total/(o.buffering.end-o.loading.first)),lr(r)&&(this.fragPrevious=r),this.fragBufferedComplete(r,n)}const a=this.media;a&&(!this._hasEnoughToStart&&Xe.getBuffered(a).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),s&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var r;if(t.fatal){this.state=oe.ERROR;return}switch(t.details){case Q.FRAG_GAP:case Q.FRAG_PARSING_ERROR:case Q.FRAG_DECRYPT_ERROR:case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Oe.MAIN,t);break;case Q.LEVEL_LOAD_ERROR:case Q.LEVEL_LOAD_TIMEOUT:case Q.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===oe.WAITING_LEVEL&&((r=t.context)==null?void 0:r.type)===ot.LEVEL&&(this.state=oe.IDLE);break;case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.resetLoadingState();break;case Q.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case Q.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=oe.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==wt.AUDIO||!this.altAudio){const r=(t===wt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;r&&(this.afterBufferFlushed(r,t,Oe.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let r=this.startPosition;if(r>=0&&t<r){if(e.seeking){this.log(`could not seek to ${r}, already seeking at ${t}`);return}const n=this.timelineOffset;n&&r&&(r+=n);const s=this.getLevelDetails(),a=Xe.getBuffered(e),o=a.length?a.start(0):0,u=o-r,l=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||u>0&&(u<l||this.loadingParts&&u<2*((s==null?void 0:s.partTarget)||0)))&&(this.log(`adjusting start position by ${u} to match buffer start`),r+=u,this.startPosition=r),t<r&&(this.log(`seek to target start position ${r} from current time ${t} buffer start ${o}`),e.currentTime=r)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(r=>{const{hls:n}=this,s=r==null?void 0:r.frag;if(!s||this.fragContextChanged(s))return;t.fragmentError=0,this.state=oe.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const a=s.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),n.trigger(b.FRAG_LOADED,r),s.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const r=this.playlistType,{hls:n}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:u,part:l,level:h}=o,{video:d,text:p,id3:g,initSegment:m}=s,{details:v}=h,E=this.altAudio?void 0:s.audio;if(this.fragContextChanged(u)){this.fragmentTracker.removeFragment(u);return}if(this.state=oe.PARSING,m){if(m!=null&&m.tracks){const R=u.initSegment||u;this._bufferInitSegment(h,m.tracks,R,a),n.trigger(b.FRAG_PARSING_INIT_SEGMENT,{frag:R,id:r,tracks:m.tracks})}const x=m.initPTS,T=m.timescale;Ce(x)&&(this.initPTS[u.cc]={baseTime:x,timescale:T},n.trigger(b.INIT_PTS_FOUND,{frag:u,id:r,initPTS:x,timescale:T}))}if(d&&v){E&&d.type==="audiovideo"&&this.logMuxedErr(u);const x=v.fragments[u.sn-1-v.startSN],T=u.sn===v.startSN,R=!x||u.cc>x.cc;if(s.independent!==!1){const{startPTS:_,endPTS:F,startDTS:N,endDTS:C}=d;if(l)l.elementaryStreams[d.type]={startPTS:_,endPTS:F,startDTS:N,endDTS:C};else if(d.firstKeyFrame&&d.independent&&a.id===1&&!R&&(this.couldBacktrack=!0),d.dropped&&d.independent){const M=this.getMainFwdBufferInfo(),L=(M?M.end:this.getLoadPosition())+this.config.maxBufferHole,I=d.firstKeyFramePTS?d.firstKeyFramePTS:_;if(!T&&L<I-this.config.maxBufferHole&&!R){this.backtrack(u);return}else R&&(u.gap=!0);u.setElementaryStreamInfo(d.type,u.start,F,u.start,C,!0)}else T&&_-(v.appliedTimelineOffset||0)>dc&&(u.gap=!0);u.setElementaryStreamInfo(d.type,_,F,N,C),this.backtrackFragment&&(this.backtrackFragment=u),this.bufferFragmentData(d,u,l,a,T||R)}else if(T||R)u.gap=!0;else{this.backtrack(u);return}}if(E){const{startPTS:x,endPTS:T,startDTS:R,endDTS:_}=E;l&&(l.elementaryStreams[wt.AUDIO]={startPTS:x,endPTS:T,startDTS:R,endDTS:_}),u.setElementaryStreamInfo(wt.AUDIO,x,T,R,_),this.bufferFragmentData(E,u,l,a)}if(v&&g!=null&&(t=g.samples)!=null&&t.length){const x={id:r,frag:u,details:v,samples:g.samples};n.trigger(b.FRAG_PARSING_METADATA,x)}if(v&&p){const x={id:r,frag:u,details:v,samples:p.samples};n.trigger(b.FRAG_PARSING_USERDATA,x)}}logMuxedErr(e){this.warn(`${lr(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,r,n){if(this.state!==oe.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(r));const{audio:s,video:a,audiovideo:o}=t;if(s){let l=Bu(s.codec,e.audioCodec);l==="mp4a"&&(l="mp4a.40.5");const h=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){l&&(l.indexOf("mp4a.40.5")!==-1?l="mp4a.40.2":l="mp4a.40.5");const d=s.metadata;d&&"channelCount"in d&&(d.channelCount||1)!==1&&h.indexOf("firefox")===-1&&(l="mp4a.40.5")}l&&l.indexOf("mp4a.40.5")!==-1&&h.indexOf("android")!==-1&&s.container!=="audio/mpeg"&&(l="mp4a.40.2",this.log(`Android: force audio codec to ${l}`)),e.audioCodec&&e.audioCodec!==l&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${l}"`),s.levelCodec=l,s.id=Oe.MAIN,this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${l||""}/${e.audioCodec||""}/${s.codec}]`),delete t.audiovideo}if(a){a.levelCodec=e.videoCodec,a.id=Oe.MAIN;const l=a.codec;if((l==null?void 0:l.length)===4)switch(l){case"hvc1":case"hev1":a.codec="hvc1.1.6.L120.90";break;case"av01":a.codec="av01.0.04M.08";break;case"avc1":a.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||""}/${l}]${a.codec!==l?" parsed-corrected="+a.codec:""}${a.supplemental?" supplemental="+a.supplemental:""}`),delete t.audiovideo}o&&(this.log(`Init audiovideo buffer, container:${o.container}, codecs[level/parsed]=[${e.codecs}/${o.codec}]`),delete t.video,delete t.audio);const u=Object.keys(t);if(u.length){if(this.hls.trigger(b.BUFFER_CODECS,t),!this.hls)return;u.forEach(l=>{const d=t[l].initSegment;d!=null&&d.byteLength&&this.hls.trigger(b.BUFFER_APPENDING,{type:l,data:d,frag:r,part:null,chunkMeta:n,parent:r.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,Oe.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,r=e==null?void 0:e[t];return r?this.getMaxBufferLength(r.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=oe.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const r=e.currentTime;if(Xe.isBuffered(e,r)?t=this.getAppendedFrag(r):Xe.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;const n=this.fragPlaying,s=t.level;(!n||t.sn!==n.sn||n.level!==s)&&(this.fragPlaying=t,this.hls.trigger(b.FRAG_CHANGED,{frag:t}),(!n||n.level!==s)&&this.hls.trigger(b.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return Ce(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(Ce(t)){const r=this.getLevelDetails(),n=this.currentFrag||(r?Ys(null,r.fragments,t):null);if(n){const s=n.programDateTime;if(s!==null){const a=s+(t-n.start)*1e3;return new Date(a)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class BO{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const r in this.keyUriToKeyInfo){const n=this.keyUriToKeyInfo[r].loader;if(n){var t;if(e&&e!==((t=n.context)==null?void 0:t.frag.type))return;n.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=Q.KEY_LOAD_ERROR,r,n,s){return new wn({type:ke.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:s,error:r,networkDetails:n})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length){const{sn:r,cc:n}=e;for(let s=0;s<t.length;s++){const a=t[s];if(n<=a.cc&&(r==="initSegment"||a.sn==="initSegment"||r<a.sn))return this.emeController.selectKeySystemFormat(a).then(o=>{if(a.setKeyFormat(o),this.emeController&&this.config.requireKeySystemAccessOnStart){const u=Yu(o);if(u)return this.emeController.getKeySystemAccess([u])}})}}else if(this.config.requireKeySystemAccessOnStart){const r=rl(this.config);if(r.length)return this.emeController.getKeySystemAccess(r)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var r,n;t&&e.setKeyFormat(t);const s=e.decryptdata;if(!s){const l=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,Q.KEY_LOAD_ERROR,l))}const a=s.uri;if(!a)return Promise.reject(this.createKeyLoadError(e,Q.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${a}"`)));let o=this.keyUriToKeyInfo[a];if((r=o)!=null&&r.decryptdata.key)return s.key=o.decryptdata.key,Promise.resolve({frag:e,keyInfo:o});if((n=o)!=null&&n.keyLoadPromise){var u;switch((u=o.mediaKeySessionContext)==null?void 0:u.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return o.keyLoadPromise.then(l=>(s.key=l.keyInfo.decryptdata.key,{frag:e,keyInfo:o}))}}switch(o=this.keyUriToKeyInfo[a]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(o,e):this.loadKeyEME(o,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(o,e);default:return Promise.reject(this.createKeyLoadError(e,Q.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,t){const r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const n=this.emeController.loadKey(r);if(n)return(e.keyLoadPromise=n.then(s=>(e.mediaKeySessionContext=s,r))).catch(s=>{throw e.keyLoadPromise=null,s})}return Promise.resolve(r)}loadKeyHTTP(e,t){const r=this.config,n=r.loader,s=new n(r);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((a,o)=>{const u={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},l=r.keyLoadPolicy.default,h={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(p,g,m,v)=>{const{frag:E,keyInfo:x,url:T}=m;if(!E.decryptdata||x!==this.keyUriToKeyInfo[T])return o(this.createKeyLoadError(E,Q.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),v));x.decryptdata.key=E.decryptdata.key=new Uint8Array(p.data),E.keyLoader=null,x.loader=null,a({frag:E,keyInfo:x})},onError:(p,g,m,v)=>{this.resetLoader(g),o(this.createKeyLoadError(t,Q.KEY_LOAD_ERROR,new Error(`HTTP Error ${p.code} loading key ${p.text}`),m,At({url:u.url,data:void 0},p)))},onTimeout:(p,g,m)=>{this.resetLoader(g),o(this.createKeyLoadError(t,Q.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),m))},onAbort:(p,g,m)=>{this.resetLoader(g),o(this.createKeyLoadError(t,Q.INTERNAL_ABORTED,new Error("key loading aborted"),m))}};s.load(u,h,d)})}resetLoader(e){const{frag:t,keyInfo:r,url:n}=e,s=r.loader;t.keyLoader===s&&(t.keyLoader=null,r.loader=null),delete this.keyUriToKeyInfo[n],s&&s.destroy()}}function ux(i){const{type:e}=i;switch(e){case ot.AUDIO_TRACK:return Oe.AUDIO;case ot.SUBTITLE_TRACK:return Oe.SUBTITLE;default:return Oe.MAIN}}function ip(i,e){let t=i.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class UO{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(b.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_LOADING,this.onLevelLoading,this),e.off(b.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(b.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,r=t.pLoader,n=t.loader,s=r||n,a=new s(t);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:r}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:ot.MANIFEST,url:r,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:r,level:n,pathwayId:s,url:a,deliveryDirectives:o,levelInfo:u}=t;this.load({id:r,level:n,pathwayId:s,responseType:"text",type:ot.LEVEL,url:a,deliveryDirectives:o,levelOrTrack:u})}onAudioTrackLoading(e,t){const{id:r,groupId:n,url:s,deliveryDirectives:a,track:o}=t;this.load({id:r,groupId:n,level:null,responseType:"text",type:ot.AUDIO_TRACK,url:s,deliveryDirectives:a,levelOrTrack:o})}onSubtitleTrackLoading(e,t){const{id:r,groupId:n,url:s,deliveryDirectives:a,track:o}=t;this.load({id:r,groupId:n,level:null,responseType:"text",type:ot.SUBTITLE_TRACK,url:s,deliveryDirectives:a,levelOrTrack:o})}onLevelsUpdated(e,t){const r=this.loaders[ot.LEVEL];if(r){const n=r.context;n&&!t.levels.some(s=>s===n.levelOrTrack)&&(r.abort(),delete this.loaders[ot.LEVEL])}}load(e){var t;const r=this.hls.config;let n=this.getInternalLoader(e);if(n){const l=this.hls.logger,h=n.context;if(h&&h.levelOrTrack===e.levelOrTrack&&(h.url===e.url||h.deliveryDirectives&&!e.deliveryDirectives)){h.url===e.url?l.log(`[playlist-loader]: ignore ${e.url} ongoing request`):l.log(`[playlist-loader]: ignore ${e.url} in favor of ${h.url}`);return}l.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),n.abort()}let s;if(e.type===ot.MANIFEST?s=r.manifestLoadPolicy.default:s=Tt({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),n=this.createInternalLoader(e),Ce((t=e.deliveryDirectives)==null?void 0:t.part)){let l;if(e.type===ot.LEVEL&&e.level!==null?l=this.hls.levels[e.level].details:e.type===ot.AUDIO_TRACK&&e.id!==null?l=this.hls.audioTracks[e.id].details:e.type===ot.SUBTITLE_TRACK&&e.id!==null&&(l=this.hls.subtitleTracks[e.id].details),l){const h=l.partTarget,d=l.targetduration;if(h&&d){const p=Math.max(h*3,d*.8)*1e3;s=Tt({},s,{maxTimeToFirstByteMs:Math.min(p,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(p,s.maxTimeToFirstByteMs)})}}}const a=s.errorRetry||s.timeoutRetry||{},o={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},u={onSuccess:(l,h,d,p)=>{const g=this.getInternalLoader(d);this.resetInternalLoader(d.type);const m=l.data;if(m.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(l,d,new Error("no EXTM3U delimiter"),p||null,h);return}h.parsing.start=performance.now(),nn.isMediaPlaylist(m)||d.type!==ot.MANIFEST?this.handleTrackOrLevelPlaylist(l,h,d,p||null,g):this.handleMasterPlaylist(l,h,d,p)},onError:(l,h,d,p)=>{this.handleNetworkError(h,d,!1,l,p)},onTimeout:(l,h,d)=>{this.handleNetworkError(h,d,!0,void 0,l)}};n.load(e,o,u)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:r}=this.hls;(e||r)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,r,n){const s=this.hls,a=e.data,o=ip(e,r),u=nn.parseMasterPlaylist(a,o);if(u.playlistParsingError){this.handleManifestParsingError(e,r,u.playlistParsingError,n,t);return}const{contentSteering:l,levels:h,sessionData:d,sessionKeys:p,startTimeOffset:g,variableList:m}=u;this.variableList=m;const{AUDIO:v=[],SUBTITLES:E,"CLOSED-CAPTIONS":x}=nn.parseMasterPlaylistMedia(a,o,u);v.length&&!v.some(R=>!R.url)&&h[0].audioCodec&&!h[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),v.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Gt({}),bitrate:0,url:""})),s.trigger(b.MANIFEST_LOADED,{levels:h,audioTracks:v,subtitles:E,captions:x,contentSteering:l,url:o,stats:t,networkDetails:n,sessionData:d,sessionKeys:p,startTimeOffset:g,variableList:m})}handleTrackOrLevelPlaylist(e,t,r,n,s){const a=this.hls,{id:o,level:u,type:l}=r,h=ip(e,r),d=Ce(u)?u:Ce(o)?o:0,p=ux(r),g=nn.parseLevelPlaylist(e.data,h,d,p,0,this.variableList);if(l===ot.MANIFEST){const m={attrs:new Gt({}),bitrate:0,details:g,name:"",url:h};g.requestScheduled=t.loading.start+P2(g,0),a.trigger(b.MANIFEST_LOADED,{levels:[m],audioTracks:[],url:h,stats:t,networkDetails:n,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=g,this.handlePlaylistLoaded(g,e,t,r,n,s)}handleManifestParsingError(e,t,r,n,s){this.hls.trigger(b.ERROR,{type:ke.NETWORK_ERROR,details:Q.MANIFEST_PARSING_ERROR,fatal:t.type===ot.MANIFEST,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:n,stats:s})}handleNetworkError(e,t,r=!1,n,s){let a=`A network ${r?"timeout":"error"+(n?" (status "+n.code+")":"")} occurred while loading ${e.type}`;e.type===ot.LEVEL?a+=`: ${e.level} id: ${e.id}`:(e.type===ot.AUDIO_TRACK||e.type===ot.SUBTITLE_TRACK)&&(a+=` id: ${e.id} group-id: "${e.groupId}"`);const o=new Error(a);this.hls.logger.warn(`[playlist-loader]: ${a}`);let u=Q.UNKNOWN,l=!1;const h=this.getInternalLoader(e);switch(e.type){case ot.MANIFEST:u=r?Q.MANIFEST_LOAD_TIMEOUT:Q.MANIFEST_LOAD_ERROR,l=!0;break;case ot.LEVEL:u=r?Q.LEVEL_LOAD_TIMEOUT:Q.LEVEL_LOAD_ERROR,l=!1;break;case ot.AUDIO_TRACK:u=r?Q.AUDIO_TRACK_LOAD_TIMEOUT:Q.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case ot.SUBTITLE_TRACK:u=r?Q.SUBTITLE_TRACK_LOAD_TIMEOUT:Q.SUBTITLE_LOAD_ERROR,l=!1;break}h&&this.resetInternalLoader(e.type);const d={type:ke.NETWORK_ERROR,details:u,fatal:l,url:e.url,loader:h,context:e,error:o,networkDetails:t,stats:s};if(n){const p=(t==null?void 0:t.url)||e.url;d.response=At({url:p,data:void 0},n)}this.hls.trigger(b.ERROR,d)}handlePlaylistLoaded(e,t,r,n,s,a){const o=this.hls,{type:u,level:l,id:h,groupId:d,deliveryDirectives:p}=n,g=ip(t,n),m=ux(n),v=typeof n.level=="number"&&m===Oe.MAIN?l:void 0;if(!e.fragments.length){const x=e.playlistParsingError=new Error("No Segments found in Playlist");o.trigger(b.ERROR,{type:ke.NETWORK_ERROR,details:Q.LEVEL_EMPTY_ERROR,fatal:!1,url:g,error:x,reason:x.message,response:t,context:n,level:v,parent:m,networkDetails:s,stats:r});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const E=e.playlistParsingError;if(E){if(this.hls.logger.warn(E),!o.config.ignorePlaylistParsingErrors){o.trigger(b.ERROR,{type:ke.NETWORK_ERROR,details:Q.LEVEL_PARSING_ERROR,fatal:!1,url:g,error:E,reason:E.message,response:t,context:n,level:v,parent:m,networkDetails:s,stats:r});return}e.playlistParsingError=null}switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),u){case ot.MANIFEST:case ot.LEVEL:o.trigger(b.LEVEL_LOADED,{details:e,levelInfo:n.levelOrTrack||o.levels[0],level:v||0,id:h||0,stats:r,networkDetails:s,deliveryDirectives:p,withoutMultiVariant:u===ot.MANIFEST});break;case ot.AUDIO_TRACK:o.trigger(b.AUDIO_TRACK_LOADED,{details:e,track:n.levelOrTrack,id:h||0,groupId:d||"",stats:r,networkDetails:s,deliveryDirectives:p});break;case ot.SUBTITLE_TRACK:o.trigger(b.SUBTITLE_TRACK_LOADED,{details:e,track:n.levelOrTrack,id:h||0,groupId:d||"",stats:r,networkDetails:s,deliveryDirectives:p});break}}}class _i{static get version(){return sl}static isMSESupported(){return lx()}static isSupported(){return OO()}static getMediaSource(){return us()}static get Events(){return b}static get MetadataSchema(){return Zr}static get ErrorTypes(){return ke}static get ErrorDetails(){return Q}static get DefaultConfig(){return _i.defaultConfig?_i.defaultConfig:xO}static set DefaultConfig(e){_i.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new bg,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=dN(e.debug||!1,"Hls instance",e.assetPlayerId),r=this.config=bO(_i.DefaultConfig,e,t);this.userConfig=e,r.progressive&&TO(r,t);const{abrController:n,bufferController:s,capLevelController:a,errorController:o,fpsController:u}=r,l=new o(this),h=this.abrController=new n(this),d=new rL(this),p=r.interstitialsController,g=p?this.interstitialsController=new p(this,_i):null,m=this.bufferController=new s(this,d),v=this.capLevelController=new a(this),E=new u(this),x=new UO(this),T=r.contentSteeringController,R=T?new T(this):null,_=this.levelController=new MO(this,R),F=new LO(this),N=new BO(this.config),C=this.streamController=new FO(this,d,N),M=this.gapController=new wO(this,d);v.setStreamController(C),E.setStreamController(C);const L=[x,_,C];g&&L.splice(1,0,g),R&&L.splice(1,0,R),this.networkControllers=L;const I=[h,m,M,v,E,F,d];this.audioTrackController=this.createController(r.audioTrackController,L);const U=r.audioStreamController;U&&L.push(this.audioStreamController=new U(this,d,N)),this.subtitleTrackController=this.createController(r.subtitleTrackController,L);const q=r.subtitleStreamController;q&&L.push(this.subtititleStreamController=new q(this,d,N)),this.createController(r.timelineController,I),N.emeController=this.emeController=this.createController(r.emeController,I),this.cmcdController=this.createController(r.cmcdController,I),this.latencyController=this.createController(_O,I),this.coreComponents=I,L.push(l);const $=l.onErrorOut;typeof $=="function"&&this.on(b.ERROR,$,l),this.on(b.MANIFEST_LOADED,x.onManifestLoaded,x)}createController(e,t){if(e){const r=new e(this);return t&&t.push(r),r}return null}on(e,t,r=this){this._emitter.on(e,t,r)}once(e,t,r=this){this._emitter.once(e,t,r)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,r=this,n){this._emitter.off(e,t,r,n)}listeners(e){return this._emitter.listeners(e)}emit(e,t,r){return this._emitter.emit(e,t,r)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(r){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),!this.triggeringException){this.triggeringException=!0;const n=e===b.ERROR;this.trigger(b.ERROR,{type:ke.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,fatal:n,event:e,error:r}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(b.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const s=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(b.ERROR,{type:ke.OTHER_ERROR,details:Q.ATTACH_MEDIA_ERROR,fatal:!0,error:s});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,r=t?e.media:e,n=t?e:{media:r};this._media=r,this.trigger(b.MEDIA_ATTACHING,n)}detachMedia(){this.logger.log("detachMedia"),this.trigger(b.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(b.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,r=this._url,n=this._url=eg.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${n}`),t&&r&&(r!==n||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(b.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let r=0;r<this.networkControllers.length&&(this.networkControllers[r].startLoad(e,t),!(!this.started||!this.networkControllers));r++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[Oe.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[Oe.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[Oe.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e==null?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=wM()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){$N(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const r=e.length;for(let n=0;n<r;n++)if(e[n].maxBitrate>=t)return n;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:r}=this;let n;if(t===-1&&e!=null&&e.length?n=e.length-1:n=t,r)for(let s=n;s--;){const a=e[s].attrs["HDCP-LEVEL"];if(a&&a<=r)return s}return n}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const r=t2(t);return JE(e,r,navigator.mediaCapabilities)}}_i.defaultConfig=void 0;class cx{async getIsLive(e,t){const r=t.media;return r.duration===1/0?!0:r.readyState<2&&Number.isNaN(r.duration)?this.waitForMediaMetadataLoad(r).then(n=>this.processLoadedDurationForLiveDetection(n,r)):!1}async processLoadedDurationForLiveDetection(e,t){return Number.isNaN(e)?(console.warn("Setting video as non-live due to metadata loading timeout"),!1):this.detectDurationIncreaseAsLive(t)}async waitForMediaMetadataLoad(e){return new Promise(t=>{Ue(e).one("loadedmetadata",()=>t(e.duration)),setTimeout(()=>{t(NaN)},3e3)})}async detectDurationIncreaseAsLive(e){const t=e.duration,r=ya(100).pipe(fr(()=>e.duration),Jt(n=>n>t),Ps(1),fr(()=>!0),km({each:3e3,with:()=>(console.warn("Duration remained unchanged after 3 seconds, determined as non-live video"),Rr(!1))}),Gh(()=>(console.warn("Exception occurred during duration-based live detection, fallback to non-live video"),Rr(!1))));return Bh(r)}}class hx{async getIsLive(e,t){if(!_i.isSupported())return console.warn("HLS is not supported, falling back to duration-based live detection"),new cx().getIsLive(e,t);const r=t.getParam("m3u8Url");if(!r)throw console.error("M3U8 URL is required for M3U8-based live detection"),new Error("M3U8 URL parameter is missing");const n=new _i;return n.loadSource(r),new Promise((s,a)=>{n.on(_i.Events.LEVEL_LOADED,(o,u)=>{s(u.details.live)}),n.on(_i.Events.ERROR,function(o,u){a(u)})}).catch(s=>new cx().getIsLive(e,t))}}class $O{getIsPrivate(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract private video status using JSONPath"),Error("Context vo object is missing, unable to extract private video status using JSONPath");if(mt.isEmpty(e.values))throw console.error("Private video extraction configuration is missing JSONPath values property",e),new Error("Private video extraction configuration is missing JSONPath values property");return Or.extractBooleanByJsonPath(e.values,e.computeType,t.data)}}class GO{getChannelId(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract channelId using JSONPath",t),Error("Context vo object is missing, unable to extract channelId using JSONPath");return wi(t.data,e.value)}}class qO{extractDuration(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract duration using JSONPath",t),Error("Context vo object is missing, unable to extract duration using JSONPath");return Number(wi(t.data,e.value))}}class HO{extractSupportLanguage(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract support language using JSONPath",t),Error("Context vo object is missing, unable to extract support language using JSONPath");return wi(t.data,e.value)}}const Zs=class Zs{static isWeakPunctuation(e){return this.WEAK_PUNCTUATION.has(e)}static isPunctuation(e){return this.SENTENCE_ENDING_PUNCTUATION.has(e)}static endsWithPunctuation(e){if(!e||e.trim().length===0)return!1;const t=e.trim(),r=t.charAt(t.length-1);return Zs.isPunctuation(r)}static containsOnlyPunctuationAndSpaces(e){if(!e)return!1;let t=!1;for(let r=0;r<e.length;r++){const n=e.charAt(r);if(n.trim().length!==0){if(Zs.isPunctuation(n)||Zs.isWeakPunctuation(n)){t=!0;continue}return!1}}return t}};fe(Zs,"SENTENCE_ENDING_PUNCTUATION",new Set([".","!","?",";",":","。","！","？","；","：","…","‥","⋯","⋮","⋰","⋱","؟","؍","؎","؏","¿","¡","·","։","՜","՞","՟","׃","׆","ฯ","๚","๛","।","॥","‽","‼","⁇","⁈","⁉","⁏"])),fe(Zs,"WEAK_PUNCTUATION",new Set([",","，",";","；",":","："]));let cr=Zs;var np,dx;function VO(){if(dx)return np;dx=1,np=e;function i(r){return r instanceof Buffer?Buffer.from(r):new r.constructor(r.buffer.slice(),r.byteOffset,r.length)}function e(r){if(r=r||{},r.circles)return t(r);const n=new Map;if(n.set(Date,l=>new Date(l)),n.set(Map,(l,h)=>new Map(a(Array.from(l),h))),n.set(Set,(l,h)=>new Set(a(Array.from(l),h))),r.constructorHandlers)for(const l of r.constructorHandlers)n.set(l[0],l[1]);let s=null;return r.proto?u:o;function a(l,h){const d=Object.keys(l),p=new Array(d.length);for(let g=0;g<d.length;g++){const m=d[g],v=l[m];typeof v!="object"||v===null?p[m]=v:v.constructor!==Object&&(s=n.get(v.constructor))?p[m]=s(v,h):ArrayBuffer.isView(v)?p[m]=i(v):p[m]=h(v)}return p}function o(l){if(typeof l!="object"||l===null)return l;if(Array.isArray(l))return a(l,o);if(l.constructor!==Object&&(s=n.get(l.constructor)))return s(l,o);const h={};for(const d in l){if(Object.hasOwnProperty.call(l,d)===!1)continue;const p=l[d];typeof p!="object"||p===null?h[d]=p:p.constructor!==Object&&(s=n.get(p.constructor))?h[d]=s(p,o):ArrayBuffer.isView(p)?h[d]=i(p):h[d]=o(p)}return h}function u(l){if(typeof l!="object"||l===null)return l;if(Array.isArray(l))return a(l,u);if(l.constructor!==Object&&(s=n.get(l.constructor)))return s(l,u);const h={};for(const d in l){const p=l[d];typeof p!="object"||p===null?h[d]=p:p.constructor!==Object&&(s=n.get(p.constructor))?h[d]=s(p,u):ArrayBuffer.isView(p)?h[d]=i(p):h[d]=u(p)}return h}}function t(r){const n=[],s=[],a=new Map;if(a.set(Date,d=>new Date(d)),a.set(Map,(d,p)=>new Map(u(Array.from(d),p))),a.set(Set,(d,p)=>new Set(u(Array.from(d),p))),r.constructorHandlers)for(const d of r.constructorHandlers)a.set(d[0],d[1]);let o=null;return r.proto?h:l;function u(d,p){const g=Object.keys(d),m=new Array(g.length);for(let v=0;v<g.length;v++){const E=g[v],x=d[E];if(typeof x!="object"||x===null)m[E]=x;else if(x.constructor!==Object&&(o=a.get(x.constructor)))m[E]=o(x,p);else if(ArrayBuffer.isView(x))m[E]=i(x);else{const T=n.indexOf(x);T!==-1?m[E]=s[T]:m[E]=p(x)}}return m}function l(d){if(typeof d!="object"||d===null)return d;if(Array.isArray(d))return u(d,l);if(d.constructor!==Object&&(o=a.get(d.constructor)))return o(d,l);const p={};n.push(d),s.push(p);for(const g in d){if(Object.hasOwnProperty.call(d,g)===!1)continue;const m=d[g];if(typeof m!="object"||m===null)p[g]=m;else if(m.constructor!==Object&&(o=a.get(m.constructor)))p[g]=o(m,l);else if(ArrayBuffer.isView(m))p[g]=i(m);else{const v=n.indexOf(m);v!==-1?p[g]=s[v]:p[g]=l(m)}}return n.pop(),s.pop(),p}function h(d){if(typeof d!="object"||d===null)return d;if(Array.isArray(d))return u(d,h);if(d.constructor!==Object&&(o=a.get(d.constructor)))return o(d,h);const p={};n.push(d),s.push(p);for(const g in d){const m=d[g];if(typeof m!="object"||m===null)p[g]=m;else if(m.constructor!==Object&&(o=a.get(m.constructor)))p[g]=o(m,h);else if(ArrayBuffer.isView(m))p[g]=i(m);else{const v=n.indexOf(m);v!==-1?p[g]=s[v]:p[g]=h(m)}}return n.pop(),s.pop(),p}}return np}var KO=VO();const fx=Fa(KO);/**
 * @name codsen-utils
 * @fileoverview Various utility functions
 * @version 1.6.7
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/codsen-utils/}
 */fx();function sp(i){if(i==null||typeof i!="object")return!1;let e=Object.getPrototypeOf(i);return e!==null&&e!==Object.prototype&&Object.getPrototypeOf(e)!==null?!1:!(Symbol.iterator in i)&&!(Symbol.toStringTag in i)}function to(i){return typeof i=="string"}function gs(i){return Number.isSafeInteger(i)&&i>=0}function ps(i){return i!=null}function WO(i,e){return sp(i)&&to(e)&&e in i}var YO=typeof global=="object"&&global&&global.Object===Object&&global,XO=typeof self=="object"&&self&&self.Object===Object&&self,ap=YO||XO||Function("return this")(),ro=ap.Symbol,gx=Object.prototype,zO=gx.hasOwnProperty,jO=gx.toString,fl=ro?ro.toStringTag:void 0;function JO(i){var e=zO.call(i,fl),t=i[fl];try{i[fl]=void 0;var r=!0}catch{}var n=jO.call(i);return r&&(e?i[fl]=t:delete i[fl]),n}var QO=Object.prototype,ZO=QO.toString;function eP(i){return ZO.call(i)}var tP="[object Null]",rP="[object Undefined]",px=ro?ro.toStringTag:void 0;function mx(i){return i==null?i===void 0?rP:tP:px&&px in Object(i)?JO(i):eP(i)}function yx(i){return i!=null&&typeof i=="object"}var iP="[object Symbol]";function nP(i){return typeof i=="symbol"||yx(i)&&mx(i)==iP}function sP(i,e){for(var t=-1,r=i==null?0:i.length,n=Array(r);++t<r;)n[t]=e(i[t],t,i);return n}var aP=Array.isArray,vx=ro?ro.prototype:void 0,Ex=vx?vx.toString:void 0;function op(i){if(typeof i=="string")return i;if(aP(i))return sP(i,op)+"";if(nP(i))return Ex?Ex.call(i):"";var e=i+"";return e=="0"&&1/i==-1/0?"-0":e}var oP=/\s/;function lP(i){for(var e=i.length;e--&&oP.test(i.charAt(e)););return e}var uP=/^\s+/;function cP(i){return i&&i.slice(0,lP(i)+1).replace(uP,"")}function Ax(i){var e=typeof i;return i!=null&&(e=="object"||e=="function")}function xx(i){return i}var hP="[object AsyncFunction]",dP="[object Function]",fP="[object GeneratorFunction]",gP="[object Proxy]";function Sx(i){if(!Ax(i))return!1;var e=mx(i);return e==dP||e==fP||e==hP||e==gP}var lp=ap["__core-js_shared__"],bx=function(){var i=/[^.]+$/.exec(lp&&lp.keys&&lp.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}();function pP(i){return!!bx&&bx in i}var mP=Function.prototype,yP=mP.toString;function vP(i){if(i!=null){try{return yP.call(i)}catch{}try{return i+""}catch{}}return""}var EP=/[\\^$.*+?()[\]{}|]/g,AP=/^\[object .+?Constructor\]$/,xP=Function.prototype,SP=Object.prototype,bP=xP.toString,TP=SP.hasOwnProperty,DP=RegExp("^"+bP.call(TP).replace(EP,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function RP(i){if(!Ax(i)||pP(i))return!1;var e=Sx(i)?DP:AP;return e.test(vP(i))}function IP(i,e){return i==null?void 0:i[e]}function up(i,e){var t=IP(i,e);return RP(t)?t:void 0}function wP(i,e,t){switch(t.length){case 0:return i.call(e);case 1:return i.call(e,t[0]);case 2:return i.call(e,t[0],t[1]);case 3:return i.call(e,t[0],t[1],t[2])}return i.apply(e,t)}var CP=800,NP=16,LP=Date.now;function _P(i){var e=0,t=0;return function(){var r=LP(),n=NP-(r-t);if(t=r,n>0){if(++e>=CP)return arguments[0]}else e=0;return i.apply(void 0,arguments)}}function MP(i){return function(){return i}}var Tx=function(){try{var i=up(Object,"defineProperty");return i({},"",{}),i}catch{}}(),OP=Tx?function(i,e){return Tx(i,"toString",{configurable:!0,enumerable:!1,value:MP(e),writable:!0})}:xx,PP=_P(OP);function kP(i,e,t,r){for(var n=i.length,s=t+-1;++s<n;)if(e(i[s],s,i))return s;return-1}function FP(i){return i!==i}function BP(i,e,t){for(var r=t-1,n=i.length;++r<n;)if(i[r]===e)return r;return-1}function cp(i,e,t){return e===e?BP(i,e,t):kP(i,FP,t)}function UP(i,e){var t=i==null?0:i.length;return!!t&&cp(i,e,0)>-1}function $P(i,e){return i===e||i!==i&&e!==e}var Dx=Math.max;function GP(i,e,t){return e=Dx(e===void 0?i.length-1:e,0),function(){for(var r=arguments,n=-1,s=Dx(r.length-e,0),a=Array(s);++n<s;)a[n]=r[e+n];n=-1;for(var o=Array(e+1);++n<e;)o[n]=r[n];return o[e]=t(a),wP(i,this,o)}}function qP(i,e){return PP(GP(i,e,xx),i+"")}var HP=9007199254740991;function VP(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=HP}function KP(i){return i!=null&&VP(i.length)&&!Sx(i)}var gl=up(Object,"create");function WP(){this.__data__=gl?gl(null):{},this.size=0}function YP(i){var e=this.has(i)&&delete this.__data__[i];return this.size-=e?1:0,e}var XP="__lodash_hash_undefined__",zP=Object.prototype,jP=zP.hasOwnProperty;function JP(i){var e=this.__data__;if(gl){var t=e[i];return t===XP?void 0:t}return jP.call(e,i)?e[i]:void 0}var QP=Object.prototype,ZP=QP.hasOwnProperty;function ek(i){var e=this.__data__;return gl?e[i]!==void 0:ZP.call(e,i)}var tk="__lodash_hash_undefined__";function rk(i,e){var t=this.__data__;return this.size+=this.has(i)?0:1,t[i]=gl&&e===void 0?tk:e,this}function zs(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var r=i[e];this.set(r[0],r[1])}}zs.prototype.clear=WP,zs.prototype.delete=YP,zs.prototype.get=JP,zs.prototype.has=ek,zs.prototype.set=rk;function ik(){this.__data__=[],this.size=0}function gc(i,e){for(var t=i.length;t--;)if($P(i[t][0],e))return t;return-1}var nk=Array.prototype,sk=nk.splice;function ak(i){var e=this.__data__,t=gc(e,i);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():sk.call(e,t,1),--this.size,!0}function ok(i){var e=this.__data__,t=gc(e,i);return t<0?void 0:e[t][1]}function lk(i){return gc(this.__data__,i)>-1}function uk(i,e){var t=this.__data__,r=gc(t,i);return r<0?(++this.size,t.push([i,e])):t[r][1]=e,this}function io(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var r=i[e];this.set(r[0],r[1])}}io.prototype.clear=ik,io.prototype.delete=ak,io.prototype.get=ok,io.prototype.has=lk,io.prototype.set=uk;var ck=up(ap,"Map");function hk(){this.size=0,this.__data__={hash:new zs,map:new(ck||io),string:new zs}}function dk(i){var e=typeof i;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?i!=="__proto__":i===null}function pc(i,e){var t=i.__data__;return dk(e)?t[typeof e=="string"?"string":"hash"]:t.map}function fk(i){var e=pc(this,i).delete(i);return this.size-=e?1:0,e}function gk(i){return pc(this,i).get(i)}function pk(i){return pc(this,i).has(i)}function mk(i,e){var t=pc(this,i),r=t.size;return t.set(i,e),this.size+=t.size==r?0:1,this}function no(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var r=i[e];this.set(r[0],r[1])}}no.prototype.clear=hk,no.prototype.delete=fk,no.prototype.get=gk,no.prototype.has=pk,no.prototype.set=mk;function yk(i){return i==null?"":op(i)}function vk(i,e,t){var r=-1,n=i.length;e<0&&(e=-e>n?0:n+e),t=t>n?n:t,t<0&&(t+=n),n=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(n);++r<n;)s[r]=i[r+e];return s}function Ek(i,e,t){var r=i.length;return t=t===void 0?r:t,!e&&t>=r?i:vk(i,e,t)}var Ak="\\ud800-\\udfff",xk="\\u0300-\\u036f",Sk="\\ufe20-\\ufe2f",bk="\\u20d0-\\u20ff",Tk=xk+Sk+bk,Dk="\\ufe0e\\ufe0f",Rk="\\u200d",Ik=RegExp("["+Rk+Ak+Tk+Dk+"]");function wk(i){return Ik.test(i)}function Ck(i){return i.split("")}var Rx="\\ud800-\\udfff",Nk="\\u0300-\\u036f",Lk="\\ufe20-\\ufe2f",_k="\\u20d0-\\u20ff",Mk=Nk+Lk+_k,Ok="\\ufe0e\\ufe0f",Pk="["+Rx+"]",hp="["+Mk+"]",dp="\\ud83c[\\udffb-\\udfff]",kk="(?:"+hp+"|"+dp+")",Ix="[^"+Rx+"]",wx="(?:\\ud83c[\\udde6-\\uddff]){2}",Cx="[\\ud800-\\udbff][\\udc00-\\udfff]",Fk="\\u200d",Nx=kk+"?",Lx="["+Ok+"]?",Bk="(?:"+Fk+"(?:"+[Ix,wx,Cx].join("|")+")"+Lx+Nx+")*",Uk=Lx+Nx+Bk,$k="(?:"+[Ix+hp+"?",hp,wx,Cx,Pk].join("|")+")",Gk=RegExp(dp+"(?="+dp+")|"+$k+Uk,"g");function qk(i){return i.match(Gk)||[]}function _x(i){return wk(i)?qk(i):Ck(i)}var Hk="__lodash_hash_undefined__";function Vk(i){return this.__data__.set(i,Hk),this}function Kk(i){return this.__data__.has(i)}function mc(i){var e=-1,t=i==null?0:i.length;for(this.__data__=new no;++e<t;)this.add(i[e])}mc.prototype.add=mc.prototype.push=Vk,mc.prototype.has=Kk;function Wk(i,e){return i.has(e)}function Yk(i){return yx(i)&&KP(i)}var Xk=200;function zk(i,e,t,r){var n=-1,s=UP,a=!0,o=i.length,u=[],l=e.length;if(!o)return u;e.length>=Xk&&(s=Wk,a=!1,e=new mc(e));e:for(;++n<o;){var h=i[n],d=h;if(h=h!==0?h:0,a&&d===d){for(var p=l;p--;)if(e[p]===d)continue e;u.push(h)}else s(e,d,r)||u.push(h)}return u}function jk(i,e){for(var t=i.length;t--&&cp(e,i[t],0)>-1;);return t}function Jk(i,e){for(var t=-1,r=i.length;++t<r&&cp(e,i[t],0)>-1;);return t}function Mx(i,e,t){if(i=yk(i),i&&e===void 0)return cP(i);if(!i||!(e=op(e)))return i;var r=_x(i),n=_x(e),s=Jk(r,n),a=jk(r,n)+1;return Ek(r,s,a).join("")}var Qk=qP(function(i,e){return Yk(i)?zk(i,e):[]}),so=function(){return so=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},so.apply(this,arguments)},Zk="~",e3="~~";function fp(i,e){for(var t={},r={},n=i.split(e3),s=!1,a=0;n.length>a;a++){for(var o=n[a].split(Zk),u=0;u<o.length;u+=2){var l=o[u],h=o[u+1],d="&"+l+";";t[d]=h,s&&(t["&"+l]=h),r[h]=d}s=!0}return e?{entities:so(so({},t),e.entities),characters:so(so({},r),e.characters)}:{entities:t,characters:r}}var gp={xml:/&(?:#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);?/g,html4:/&notin;|&(?:nbsp|iexcl|cent|pound|curren|yen|brvbar|sect|uml|copy|ordf|laquo|not|shy|reg|macr|deg|plusmn|sup2|sup3|acute|micro|para|middot|cedil|sup1|ordm|raquo|frac14|frac12|frac34|iquest|Agrave|Aacute|Acirc|Atilde|Auml|Aring|AElig|Ccedil|Egrave|Eacute|Ecirc|Euml|Igrave|Iacute|Icirc|Iuml|ETH|Ntilde|Ograve|Oacute|Ocirc|Otilde|Ouml|times|Oslash|Ugrave|Uacute|Ucirc|Uuml|Yacute|THORN|szlig|agrave|aacute|acirc|atilde|auml|aring|aelig|ccedil|egrave|eacute|ecirc|euml|igrave|iacute|icirc|iuml|eth|ntilde|ograve|oacute|ocirc|otilde|ouml|divide|oslash|ugrave|uacute|ucirc|uuml|yacute|thorn|yuml|quot|amp|lt|gt|#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);?/g,html5:/&centerdot;|&copysr;|&divideontimes;|&gtcc;|&gtcir;|&gtdot;|&gtlPar;|&gtquest;|&gtrapprox;|&gtrarr;|&gtrdot;|&gtreqless;|&gtreqqless;|&gtrless;|&gtrsim;|&ltcc;|&ltcir;|&ltdot;|&lthree;|&ltimes;|&ltlarr;|&ltquest;|&ltrPar;|&ltri;|&ltrie;|&ltrif;|&notin;|&notinE;|&notindot;|&notinva;|&notinvb;|&notinvc;|&notni;|&notniva;|&notnivb;|&notnivc;|&parallel;|&timesb;|&timesbar;|&timesd;|&(?:AElig|AMP|Aacute|Acirc|Agrave|Aring|Atilde|Auml|COPY|Ccedil|ETH|Eacute|Ecirc|Egrave|Euml|GT|Iacute|Icirc|Igrave|Iuml|LT|Ntilde|Oacute|Ocirc|Ograve|Oslash|Otilde|Ouml|QUOT|REG|THORN|Uacute|Ucirc|Ugrave|Uuml|Yacute|aacute|acirc|acute|aelig|agrave|amp|aring|atilde|auml|brvbar|ccedil|cedil|cent|copy|curren|deg|divide|eacute|ecirc|egrave|eth|euml|frac12|frac14|frac34|gt|iacute|icirc|iexcl|igrave|iquest|iuml|laquo|lt|macr|micro|middot|nbsp|not|ntilde|oacute|ocirc|ograve|ordf|ordm|oslash|otilde|ouml|para|plusmn|pound|quot|raquo|reg|sect|shy|sup1|sup2|sup3|szlig|thorn|times|uacute|ucirc|ugrave|uml|uuml|yacute|yen|yuml|#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);?/g},ao={};ao.xml=fp(`lt~<~gt~>~quot~"~apos~'~amp~&`),ao.html4=fp(`apos~'~OElig~Œ~oelig~œ~Scaron~Š~scaron~š~Yuml~Ÿ~circ~ˆ~tilde~˜~ensp~ ~emsp~ ~thinsp~ ~zwnj~‌~zwj~‍~lrm~‎~rlm~‏~ndash~–~mdash~—~lsquo~‘~rsquo~’~sbquo~‚~ldquo~“~rdquo~”~bdquo~„~dagger~†~Dagger~‡~permil~‰~lsaquo~‹~rsaquo~›~euro~€~fnof~ƒ~Alpha~Α~Beta~Β~Gamma~Γ~Delta~Δ~Epsilon~Ε~Zeta~Ζ~Eta~Η~Theta~Θ~Iota~Ι~Kappa~Κ~Lambda~Λ~Mu~Μ~Nu~Ν~Xi~Ξ~Omicron~Ο~Pi~Π~Rho~Ρ~Sigma~Σ~Tau~Τ~Upsilon~Υ~Phi~Φ~Chi~Χ~Psi~Ψ~Omega~Ω~alpha~α~beta~β~gamma~γ~delta~δ~epsilon~ε~zeta~ζ~eta~η~theta~θ~iota~ι~kappa~κ~lambda~λ~mu~μ~nu~ν~xi~ξ~omicron~ο~pi~π~rho~ρ~sigmaf~ς~sigma~σ~tau~τ~upsilon~υ~phi~φ~chi~χ~psi~ψ~omega~ω~thetasym~ϑ~upsih~ϒ~piv~ϖ~bull~•~hellip~…~prime~′~Prime~″~oline~‾~frasl~⁄~weierp~℘~image~ℑ~real~ℜ~trade~™~alefsym~ℵ~larr~←~uarr~↑~rarr~→~darr~↓~harr~↔~crarr~↵~lArr~⇐~uArr~⇑~rArr~⇒~dArr~⇓~hArr~⇔~forall~∀~part~∂~exist~∃~empty~∅~nabla~∇~isin~∈~notin~∉~ni~∋~prod~∏~sum~∑~minus~−~lowast~∗~radic~√~prop~∝~infin~∞~ang~∠~and~∧~or~∨~cap~∩~cup~∪~int~∫~there4~∴~sim~∼~cong~≅~asymp~≈~ne~≠~equiv~≡~le~≤~ge~≥~sub~⊂~sup~⊃~nsub~⊄~sube~⊆~supe~⊇~oplus~⊕~otimes~⊗~perp~⊥~sdot~⋅~lceil~⌈~rceil~⌉~lfloor~⌊~rfloor~⌋~lang~〈~rang~〉~loz~◊~spades~♠~clubs~♣~hearts~♥~diams~♦~~nbsp~ ~iexcl~¡~cent~¢~pound~£~curren~¤~yen~¥~brvbar~¦~sect~§~uml~¨~copy~©~ordf~ª~laquo~«~not~¬~shy~­~reg~®~macr~¯~deg~°~plusmn~±~sup2~²~sup3~³~acute~´~micro~µ~para~¶~middot~·~cedil~¸~sup1~¹~ordm~º~raquo~»~frac14~¼~frac12~½~frac34~¾~iquest~¿~Agrave~À~Aacute~Á~Acirc~Â~Atilde~Ã~Auml~Ä~Aring~Å~AElig~Æ~Ccedil~Ç~Egrave~È~Eacute~É~Ecirc~Ê~Euml~Ë~Igrave~Ì~Iacute~Í~Icirc~Î~Iuml~Ï~ETH~Ð~Ntilde~Ñ~Ograve~Ò~Oacute~Ó~Ocirc~Ô~Otilde~Õ~Ouml~Ö~times~×~Oslash~Ø~Ugrave~Ù~Uacute~Ú~Ucirc~Û~Uuml~Ü~Yacute~Ý~THORN~Þ~szlig~ß~agrave~à~aacute~á~acirc~â~atilde~ã~auml~ä~aring~å~aelig~æ~ccedil~ç~egrave~è~eacute~é~ecirc~ê~euml~ë~igrave~ì~iacute~í~icirc~î~iuml~ï~eth~ð~ntilde~ñ~ograve~ò~oacute~ó~ocirc~ô~otilde~õ~ouml~ö~divide~÷~oslash~ø~ugrave~ù~uacute~ú~ucirc~û~uuml~ü~yacute~ý~thorn~þ~yuml~ÿ~quot~"~amp~&~lt~<~gt~>`),ao.html5=fp('Abreve~Ă~Acy~А~Afr~𝔄~Amacr~Ā~And~⩓~Aogon~Ą~Aopf~𝔸~ApplyFunction~⁡~Ascr~𝒜~Assign~≔~Backslash~∖~Barv~⫧~Barwed~⌆~Bcy~Б~Because~∵~Bernoullis~ℬ~Bfr~𝔅~Bopf~𝔹~Breve~˘~Bscr~ℬ~Bumpeq~≎~CHcy~Ч~Cacute~Ć~Cap~⋒~CapitalDifferentialD~ⅅ~Cayleys~ℭ~Ccaron~Č~Ccirc~Ĉ~Cconint~∰~Cdot~Ċ~Cedilla~¸~CenterDot~·~Cfr~ℭ~CircleDot~⊙~CircleMinus~⊖~CirclePlus~⊕~CircleTimes~⊗~ClockwiseContourIntegral~∲~CloseCurlyDoubleQuote~”~CloseCurlyQuote~’~Colon~∷~Colone~⩴~Congruent~≡~Conint~∯~ContourIntegral~∮~Copf~ℂ~Coproduct~∐~CounterClockwiseContourIntegral~∳~Cross~⨯~Cscr~𝒞~Cup~⋓~CupCap~≍~DD~ⅅ~DDotrahd~⤑~DJcy~Ђ~DScy~Ѕ~DZcy~Џ~Darr~↡~Dashv~⫤~Dcaron~Ď~Dcy~Д~Del~∇~Dfr~𝔇~DiacriticalAcute~´~DiacriticalDot~˙~DiacriticalDoubleAcute~˝~DiacriticalGrave~`~DiacriticalTilde~˜~Diamond~⋄~DifferentialD~ⅆ~Dopf~𝔻~Dot~¨~DotDot~⃜~DotEqual~≐~DoubleContourIntegral~∯~DoubleDot~¨~DoubleDownArrow~⇓~DoubleLeftArrow~⇐~DoubleLeftRightArrow~⇔~DoubleLeftTee~⫤~DoubleLongLeftArrow~⟸~DoubleLongLeftRightArrow~⟺~DoubleLongRightArrow~⟹~DoubleRightArrow~⇒~DoubleRightTee~⊨~DoubleUpArrow~⇑~DoubleUpDownArrow~⇕~DoubleVerticalBar~∥~DownArrow~↓~DownArrowBar~⤓~DownArrowUpArrow~⇵~DownBreve~̑~DownLeftRightVector~⥐~DownLeftTeeVector~⥞~DownLeftVector~↽~DownLeftVectorBar~⥖~DownRightTeeVector~⥟~DownRightVector~⇁~DownRightVectorBar~⥗~DownTee~⊤~DownTeeArrow~↧~Downarrow~⇓~Dscr~𝒟~Dstrok~Đ~ENG~Ŋ~Ecaron~Ě~Ecy~Э~Edot~Ė~Efr~𝔈~Element~∈~Emacr~Ē~EmptySmallSquare~◻~EmptyVerySmallSquare~▫~Eogon~Ę~Eopf~𝔼~Equal~⩵~EqualTilde~≂~Equilibrium~⇌~Escr~ℰ~Esim~⩳~Exists~∃~ExponentialE~ⅇ~Fcy~Ф~Ffr~𝔉~FilledSmallSquare~◼~FilledVerySmallSquare~▪~Fopf~𝔽~ForAll~∀~Fouriertrf~ℱ~Fscr~ℱ~GJcy~Ѓ~Gammad~Ϝ~Gbreve~Ğ~Gcedil~Ģ~Gcirc~Ĝ~Gcy~Г~Gdot~Ġ~Gfr~𝔊~Gg~⋙~Gopf~𝔾~GreaterEqual~≥~GreaterEqualLess~⋛~GreaterFullEqual~≧~GreaterGreater~⪢~GreaterLess~≷~GreaterSlantEqual~⩾~GreaterTilde~≳~Gscr~𝒢~Gt~≫~HARDcy~Ъ~Hacek~ˇ~Hat~^~Hcirc~Ĥ~Hfr~ℌ~HilbertSpace~ℋ~Hopf~ℍ~HorizontalLine~─~Hscr~ℋ~Hstrok~Ħ~HumpDownHump~≎~HumpEqual~≏~IEcy~Е~IJlig~Ĳ~IOcy~Ё~Icy~И~Idot~İ~Ifr~ℑ~Im~ℑ~Imacr~Ī~ImaginaryI~ⅈ~Implies~⇒~Int~∬~Integral~∫~Intersection~⋂~InvisibleComma~⁣~InvisibleTimes~⁢~Iogon~Į~Iopf~𝕀~Iscr~ℐ~Itilde~Ĩ~Iukcy~І~Jcirc~Ĵ~Jcy~Й~Jfr~𝔍~Jopf~𝕁~Jscr~𝒥~Jsercy~Ј~Jukcy~Є~KHcy~Х~KJcy~Ќ~Kcedil~Ķ~Kcy~К~Kfr~𝔎~Kopf~𝕂~Kscr~𝒦~LJcy~Љ~Lacute~Ĺ~Lang~⟪~Laplacetrf~ℒ~Larr~↞~Lcaron~Ľ~Lcedil~Ļ~Lcy~Л~LeftAngleBracket~⟨~LeftArrow~←~LeftArrowBar~⇤~LeftArrowRightArrow~⇆~LeftCeiling~⌈~LeftDoubleBracket~⟦~LeftDownTeeVector~⥡~LeftDownVector~⇃~LeftDownVectorBar~⥙~LeftFloor~⌊~LeftRightArrow~↔~LeftRightVector~⥎~LeftTee~⊣~LeftTeeArrow~↤~LeftTeeVector~⥚~LeftTriangle~⊲~LeftTriangleBar~⧏~LeftTriangleEqual~⊴~LeftUpDownVector~⥑~LeftUpTeeVector~⥠~LeftUpVector~↿~LeftUpVectorBar~⥘~LeftVector~↼~LeftVectorBar~⥒~Leftarrow~⇐~Leftrightarrow~⇔~LessEqualGreater~⋚~LessFullEqual~≦~LessGreater~≶~LessLess~⪡~LessSlantEqual~⩽~LessTilde~≲~Lfr~𝔏~Ll~⋘~Lleftarrow~⇚~Lmidot~Ŀ~LongLeftArrow~⟵~LongLeftRightArrow~⟷~LongRightArrow~⟶~Longleftarrow~⟸~Longleftrightarrow~⟺~Longrightarrow~⟹~Lopf~𝕃~LowerLeftArrow~↙~LowerRightArrow~↘~Lscr~ℒ~Lsh~↰~Lstrok~Ł~Lt~≪~Map~⤅~Mcy~М~MediumSpace~ ~Mellintrf~ℳ~Mfr~𝔐~MinusPlus~∓~Mopf~𝕄~Mscr~ℳ~NJcy~Њ~Nacute~Ń~Ncaron~Ň~Ncedil~Ņ~Ncy~Н~NegativeMediumSpace~​~NegativeThickSpace~​~NegativeThinSpace~​~NegativeVeryThinSpace~​~NestedGreaterGreater~≫~NestedLessLess~≪~NewLine~\n~Nfr~𝔑~NoBreak~⁠~NonBreakingSpace~ ~Nopf~ℕ~Not~⫬~NotCongruent~≢~NotCupCap~≭~NotDoubleVerticalBar~∦~NotElement~∉~NotEqual~≠~NotEqualTilde~≂̸~NotExists~∄~NotGreater~≯~NotGreaterEqual~≱~NotGreaterFullEqual~≧̸~NotGreaterGreater~≫̸~NotGreaterLess~≹~NotGreaterSlantEqual~⩾̸~NotGreaterTilde~≵~NotHumpDownHump~≎̸~NotHumpEqual~≏̸~NotLeftTriangle~⋪~NotLeftTriangleBar~⧏̸~NotLeftTriangleEqual~⋬~NotLess~≮~NotLessEqual~≰~NotLessGreater~≸~NotLessLess~≪̸~NotLessSlantEqual~⩽̸~NotLessTilde~≴~NotNestedGreaterGreater~⪢̸~NotNestedLessLess~⪡̸~NotPrecedes~⊀~NotPrecedesEqual~⪯̸~NotPrecedesSlantEqual~⋠~NotReverseElement~∌~NotRightTriangle~⋫~NotRightTriangleBar~⧐̸~NotRightTriangleEqual~⋭~NotSquareSubset~⊏̸~NotSquareSubsetEqual~⋢~NotSquareSuperset~⊐̸~NotSquareSupersetEqual~⋣~NotSubset~⊂⃒~NotSubsetEqual~⊈~NotSucceeds~⊁~NotSucceedsEqual~⪰̸~NotSucceedsSlantEqual~⋡~NotSucceedsTilde~≿̸~NotSuperset~⊃⃒~NotSupersetEqual~⊉~NotTilde~≁~NotTildeEqual~≄~NotTildeFullEqual~≇~NotTildeTilde~≉~NotVerticalBar~∤~Nscr~𝒩~Ocy~О~Odblac~Ő~Ofr~𝔒~Omacr~Ō~Oopf~𝕆~OpenCurlyDoubleQuote~“~OpenCurlyQuote~‘~Or~⩔~Oscr~𝒪~Otimes~⨷~OverBar~‾~OverBrace~⏞~OverBracket~⎴~OverParenthesis~⏜~PartialD~∂~Pcy~П~Pfr~𝔓~PlusMinus~±~Poincareplane~ℌ~Popf~ℙ~Pr~⪻~Precedes~≺~PrecedesEqual~⪯~PrecedesSlantEqual~≼~PrecedesTilde~≾~Product~∏~Proportion~∷~Proportional~∝~Pscr~𝒫~Qfr~𝔔~Qopf~ℚ~Qscr~𝒬~RBarr~⤐~Racute~Ŕ~Rang~⟫~Rarr~↠~Rarrtl~⤖~Rcaron~Ř~Rcedil~Ŗ~Rcy~Р~Re~ℜ~ReverseElement~∋~ReverseEquilibrium~⇋~ReverseUpEquilibrium~⥯~Rfr~ℜ~RightAngleBracket~⟩~RightArrow~→~RightArrowBar~⇥~RightArrowLeftArrow~⇄~RightCeiling~⌉~RightDoubleBracket~⟧~RightDownTeeVector~⥝~RightDownVector~⇂~RightDownVectorBar~⥕~RightFloor~⌋~RightTee~⊢~RightTeeArrow~↦~RightTeeVector~⥛~RightTriangle~⊳~RightTriangleBar~⧐~RightTriangleEqual~⊵~RightUpDownVector~⥏~RightUpTeeVector~⥜~RightUpVector~↾~RightUpVectorBar~⥔~RightVector~⇀~RightVectorBar~⥓~Rightarrow~⇒~Ropf~ℝ~RoundImplies~⥰~Rrightarrow~⇛~Rscr~ℛ~Rsh~↱~RuleDelayed~⧴~SHCHcy~Щ~SHcy~Ш~SOFTcy~Ь~Sacute~Ś~Sc~⪼~Scedil~Ş~Scirc~Ŝ~Scy~С~Sfr~𝔖~ShortDownArrow~↓~ShortLeftArrow~←~ShortRightArrow~→~ShortUpArrow~↑~SmallCircle~∘~Sopf~𝕊~Sqrt~√~Square~□~SquareIntersection~⊓~SquareSubset~⊏~SquareSubsetEqual~⊑~SquareSuperset~⊐~SquareSupersetEqual~⊒~SquareUnion~⊔~Sscr~𝒮~Star~⋆~Sub~⋐~Subset~⋐~SubsetEqual~⊆~Succeeds~≻~SucceedsEqual~⪰~SucceedsSlantEqual~≽~SucceedsTilde~≿~SuchThat~∋~Sum~∑~Sup~⋑~Superset~⊃~SupersetEqual~⊇~Supset~⋑~TRADE~™~TSHcy~Ћ~TScy~Ц~Tab~	~Tcaron~Ť~Tcedil~Ţ~Tcy~Т~Tfr~𝔗~Therefore~∴~ThickSpace~  ~ThinSpace~ ~Tilde~∼~TildeEqual~≃~TildeFullEqual~≅~TildeTilde~≈~Topf~𝕋~TripleDot~⃛~Tscr~𝒯~Tstrok~Ŧ~Uarr~↟~Uarrocir~⥉~Ubrcy~Ў~Ubreve~Ŭ~Ucy~У~Udblac~Ű~Ufr~𝔘~Umacr~Ū~UnderBar~_~UnderBrace~⏟~UnderBracket~⎵~UnderParenthesis~⏝~Union~⋃~UnionPlus~⊎~Uogon~Ų~Uopf~𝕌~UpArrow~↑~UpArrowBar~⤒~UpArrowDownArrow~⇅~UpDownArrow~↕~UpEquilibrium~⥮~UpTee~⊥~UpTeeArrow~↥~Uparrow~⇑~Updownarrow~⇕~UpperLeftArrow~↖~UpperRightArrow~↗~Upsi~ϒ~Uring~Ů~Uscr~𝒰~Utilde~Ũ~VDash~⊫~Vbar~⫫~Vcy~В~Vdash~⊩~Vdashl~⫦~Vee~⋁~Verbar~‖~Vert~‖~VerticalBar~∣~VerticalLine~|~VerticalSeparator~❘~VerticalTilde~≀~VeryThinSpace~ ~Vfr~𝔙~Vopf~𝕍~Vscr~𝒱~Vvdash~⊪~Wcirc~Ŵ~Wedge~⋀~Wfr~𝔚~Wopf~𝕎~Wscr~𝒲~Xfr~𝔛~Xopf~𝕏~Xscr~𝒳~YAcy~Я~YIcy~Ї~YUcy~Ю~Ycirc~Ŷ~Ycy~Ы~Yfr~𝔜~Yopf~𝕐~Yscr~𝒴~ZHcy~Ж~Zacute~Ź~Zcaron~Ž~Zcy~З~Zdot~Ż~ZeroWidthSpace~​~Zfr~ℨ~Zopf~ℤ~Zscr~𝒵~abreve~ă~ac~∾~acE~∾̳~acd~∿~acy~а~af~⁡~afr~𝔞~aleph~ℵ~amacr~ā~amalg~⨿~andand~⩕~andd~⩜~andslope~⩘~andv~⩚~ange~⦤~angle~∠~angmsd~∡~angmsdaa~⦨~angmsdab~⦩~angmsdac~⦪~angmsdad~⦫~angmsdae~⦬~angmsdaf~⦭~angmsdag~⦮~angmsdah~⦯~angrt~∟~angrtvb~⊾~angrtvbd~⦝~angsph~∢~angst~Å~angzarr~⍼~aogon~ą~aopf~𝕒~ap~≈~apE~⩰~apacir~⩯~ape~≊~apid~≋~approx~≈~approxeq~≊~ascr~𝒶~ast~*~asympeq~≍~awconint~∳~awint~⨑~bNot~⫭~backcong~≌~backepsilon~϶~backprime~‵~backsim~∽~backsimeq~⋍~barvee~⊽~barwed~⌅~barwedge~⌅~bbrk~⎵~bbrktbrk~⎶~bcong~≌~bcy~б~becaus~∵~because~∵~bemptyv~⦰~bepsi~϶~bernou~ℬ~beth~ℶ~between~≬~bfr~𝔟~bigcap~⋂~bigcirc~◯~bigcup~⋃~bigodot~⨀~bigoplus~⨁~bigotimes~⨂~bigsqcup~⨆~bigstar~★~bigtriangledown~▽~bigtriangleup~△~biguplus~⨄~bigvee~⋁~bigwedge~⋀~bkarow~⤍~blacklozenge~⧫~blacksquare~▪~blacktriangle~▴~blacktriangledown~▾~blacktriangleleft~◂~blacktriangleright~▸~blank~␣~blk12~▒~blk14~░~blk34~▓~block~█~bne~=⃥~bnequiv~≡⃥~bnot~⌐~bopf~𝕓~bot~⊥~bottom~⊥~bowtie~⋈~boxDL~╗~boxDR~╔~boxDl~╖~boxDr~╓~boxH~═~boxHD~╦~boxHU~╩~boxHd~╤~boxHu~╧~boxUL~╝~boxUR~╚~boxUl~╜~boxUr~╙~boxV~║~boxVH~╬~boxVL~╣~boxVR~╠~boxVh~╫~boxVl~╢~boxVr~╟~boxbox~⧉~boxdL~╕~boxdR~╒~boxdl~┐~boxdr~┌~boxh~─~boxhD~╥~boxhU~╨~boxhd~┬~boxhu~┴~boxminus~⊟~boxplus~⊞~boxtimes~⊠~boxuL~╛~boxuR~╘~boxul~┘~boxur~└~boxv~│~boxvH~╪~boxvL~╡~boxvR~╞~boxvh~┼~boxvl~┤~boxvr~├~bprime~‵~breve~˘~bscr~𝒷~bsemi~⁏~bsim~∽~bsime~⋍~bsol~\\~bsolb~⧅~bsolhsub~⟈~bullet~•~bump~≎~bumpE~⪮~bumpe~≏~bumpeq~≏~cacute~ć~capand~⩄~capbrcup~⩉~capcap~⩋~capcup~⩇~capdot~⩀~caps~∩︀~caret~⁁~caron~ˇ~ccaps~⩍~ccaron~č~ccirc~ĉ~ccups~⩌~ccupssm~⩐~cdot~ċ~cemptyv~⦲~centerdot~·~cfr~𝔠~chcy~ч~check~✓~checkmark~✓~cir~○~cirE~⧃~circeq~≗~circlearrowleft~↺~circlearrowright~↻~circledR~®~circledS~Ⓢ~circledast~⊛~circledcirc~⊚~circleddash~⊝~cire~≗~cirfnint~⨐~cirmid~⫯~cirscir~⧂~clubsuit~♣~colon~:~colone~≔~coloneq~≔~comma~,~commat~@~comp~∁~compfn~∘~complement~∁~complexes~ℂ~congdot~⩭~conint~∮~copf~𝕔~coprod~∐~copysr~℗~cross~✗~cscr~𝒸~csub~⫏~csube~⫑~csup~⫐~csupe~⫒~ctdot~⋯~cudarrl~⤸~cudarrr~⤵~cuepr~⋞~cuesc~⋟~cularr~↶~cularrp~⤽~cupbrcap~⩈~cupcap~⩆~cupcup~⩊~cupdot~⊍~cupor~⩅~cups~∪︀~curarr~↷~curarrm~⤼~curlyeqprec~⋞~curlyeqsucc~⋟~curlyvee~⋎~curlywedge~⋏~curvearrowleft~↶~curvearrowright~↷~cuvee~⋎~cuwed~⋏~cwconint~∲~cwint~∱~cylcty~⌭~dHar~⥥~daleth~ℸ~dash~‐~dashv~⊣~dbkarow~⤏~dblac~˝~dcaron~ď~dcy~д~dd~ⅆ~ddagger~‡~ddarr~⇊~ddotseq~⩷~demptyv~⦱~dfisht~⥿~dfr~𝔡~dharl~⇃~dharr~⇂~diam~⋄~diamond~⋄~diamondsuit~♦~die~¨~digamma~ϝ~disin~⋲~div~÷~divideontimes~⋇~divonx~⋇~djcy~ђ~dlcorn~⌞~dlcrop~⌍~dollar~$~dopf~𝕕~dot~˙~doteq~≐~doteqdot~≑~dotminus~∸~dotplus~∔~dotsquare~⊡~doublebarwedge~⌆~downarrow~↓~downdownarrows~⇊~downharpoonleft~⇃~downharpoonright~⇂~drbkarow~⤐~drcorn~⌟~drcrop~⌌~dscr~𝒹~dscy~ѕ~dsol~⧶~dstrok~đ~dtdot~⋱~dtri~▿~dtrif~▾~duarr~⇵~duhar~⥯~dwangle~⦦~dzcy~џ~dzigrarr~⟿~eDDot~⩷~eDot~≑~easter~⩮~ecaron~ě~ecir~≖~ecolon~≕~ecy~э~edot~ė~ee~ⅇ~efDot~≒~efr~𝔢~eg~⪚~egs~⪖~egsdot~⪘~el~⪙~elinters~⏧~ell~ℓ~els~⪕~elsdot~⪗~emacr~ē~emptyset~∅~emptyv~∅~emsp13~ ~emsp14~ ~eng~ŋ~eogon~ę~eopf~𝕖~epar~⋕~eparsl~⧣~eplus~⩱~epsi~ε~epsiv~ϵ~eqcirc~≖~eqcolon~≕~eqsim~≂~eqslantgtr~⪖~eqslantless~⪕~equals~=~equest~≟~equivDD~⩸~eqvparsl~⧥~erDot~≓~erarr~⥱~escr~ℯ~esdot~≐~esim~≂~excl~!~expectation~ℰ~exponentiale~ⅇ~fallingdotseq~≒~fcy~ф~female~♀~ffilig~ﬃ~fflig~ﬀ~ffllig~ﬄ~ffr~𝔣~filig~ﬁ~fjlig~fj~flat~♭~fllig~ﬂ~fltns~▱~fopf~𝕗~fork~⋔~forkv~⫙~fpartint~⨍~frac13~⅓~frac15~⅕~frac16~⅙~frac18~⅛~frac23~⅔~frac25~⅖~frac35~⅗~frac38~⅜~frac45~⅘~frac56~⅚~frac58~⅝~frac78~⅞~frown~⌢~fscr~𝒻~gE~≧~gEl~⪌~gacute~ǵ~gammad~ϝ~gap~⪆~gbreve~ğ~gcirc~ĝ~gcy~г~gdot~ġ~gel~⋛~geq~≥~geqq~≧~geqslant~⩾~ges~⩾~gescc~⪩~gesdot~⪀~gesdoto~⪂~gesdotol~⪄~gesl~⋛︀~gesles~⪔~gfr~𝔤~gg~≫~ggg~⋙~gimel~ℷ~gjcy~ѓ~gl~≷~glE~⪒~gla~⪥~glj~⪤~gnE~≩~gnap~⪊~gnapprox~⪊~gne~⪈~gneq~⪈~gneqq~≩~gnsim~⋧~gopf~𝕘~grave~`~gscr~ℊ~gsim~≳~gsime~⪎~gsiml~⪐~gtcc~⪧~gtcir~⩺~gtdot~⋗~gtlPar~⦕~gtquest~⩼~gtrapprox~⪆~gtrarr~⥸~gtrdot~⋗~gtreqless~⋛~gtreqqless~⪌~gtrless~≷~gtrsim~≳~gvertneqq~≩︀~gvnE~≩︀~hairsp~ ~half~½~hamilt~ℋ~hardcy~ъ~harrcir~⥈~harrw~↭~hbar~ℏ~hcirc~ĥ~heartsuit~♥~hercon~⊹~hfr~𝔥~hksearow~⤥~hkswarow~⤦~hoarr~⇿~homtht~∻~hookleftarrow~↩~hookrightarrow~↪~hopf~𝕙~horbar~―~hscr~𝒽~hslash~ℏ~hstrok~ħ~hybull~⁃~hyphen~‐~ic~⁣~icy~и~iecy~е~iff~⇔~ifr~𝔦~ii~ⅈ~iiiint~⨌~iiint~∭~iinfin~⧜~iiota~℩~ijlig~ĳ~imacr~ī~imagline~ℐ~imagpart~ℑ~imath~ı~imof~⊷~imped~Ƶ~in~∈~incare~℅~infintie~⧝~inodot~ı~intcal~⊺~integers~ℤ~intercal~⊺~intlarhk~⨗~intprod~⨼~iocy~ё~iogon~į~iopf~𝕚~iprod~⨼~iscr~𝒾~isinE~⋹~isindot~⋵~isins~⋴~isinsv~⋳~isinv~∈~it~⁢~itilde~ĩ~iukcy~і~jcirc~ĵ~jcy~й~jfr~𝔧~jmath~ȷ~jopf~𝕛~jscr~𝒿~jsercy~ј~jukcy~є~kappav~ϰ~kcedil~ķ~kcy~к~kfr~𝔨~kgreen~ĸ~khcy~х~kjcy~ќ~kopf~𝕜~kscr~𝓀~lAarr~⇚~lAtail~⤛~lBarr~⤎~lE~≦~lEg~⪋~lHar~⥢~lacute~ĺ~laemptyv~⦴~lagran~ℒ~langd~⦑~langle~⟨~lap~⪅~larrb~⇤~larrbfs~⤟~larrfs~⤝~larrhk~↩~larrlp~↫~larrpl~⤹~larrsim~⥳~larrtl~↢~lat~⪫~latail~⤙~late~⪭~lates~⪭︀~lbarr~⤌~lbbrk~❲~lbrace~{~lbrack~[~lbrke~⦋~lbrksld~⦏~lbrkslu~⦍~lcaron~ľ~lcedil~ļ~lcub~{~lcy~л~ldca~⤶~ldquor~„~ldrdhar~⥧~ldrushar~⥋~ldsh~↲~leftarrow~←~leftarrowtail~↢~leftharpoondown~↽~leftharpoonup~↼~leftleftarrows~⇇~leftrightarrow~↔~leftrightarrows~⇆~leftrightharpoons~⇋~leftrightsquigarrow~↭~leftthreetimes~⋋~leg~⋚~leq~≤~leqq~≦~leqslant~⩽~les~⩽~lescc~⪨~lesdot~⩿~lesdoto~⪁~lesdotor~⪃~lesg~⋚︀~lesges~⪓~lessapprox~⪅~lessdot~⋖~lesseqgtr~⋚~lesseqqgtr~⪋~lessgtr~≶~lesssim~≲~lfisht~⥼~lfr~𝔩~lg~≶~lgE~⪑~lhard~↽~lharu~↼~lharul~⥪~lhblk~▄~ljcy~љ~ll~≪~llarr~⇇~llcorner~⌞~llhard~⥫~lltri~◺~lmidot~ŀ~lmoust~⎰~lmoustache~⎰~lnE~≨~lnap~⪉~lnapprox~⪉~lne~⪇~lneq~⪇~lneqq~≨~lnsim~⋦~loang~⟬~loarr~⇽~lobrk~⟦~longleftarrow~⟵~longleftrightarrow~⟷~longmapsto~⟼~longrightarrow~⟶~looparrowleft~↫~looparrowright~↬~lopar~⦅~lopf~𝕝~loplus~⨭~lotimes~⨴~lowbar~_~lozenge~◊~lozf~⧫~lpar~(~lparlt~⦓~lrarr~⇆~lrcorner~⌟~lrhar~⇋~lrhard~⥭~lrtri~⊿~lscr~𝓁~lsh~↰~lsim~≲~lsime~⪍~lsimg~⪏~lsqb~[~lsquor~‚~lstrok~ł~ltcc~⪦~ltcir~⩹~ltdot~⋖~lthree~⋋~ltimes~⋉~ltlarr~⥶~ltquest~⩻~ltrPar~⦖~ltri~◃~ltrie~⊴~ltrif~◂~lurdshar~⥊~luruhar~⥦~lvertneqq~≨︀~lvnE~≨︀~mDDot~∺~male~♂~malt~✠~maltese~✠~map~↦~mapsto~↦~mapstodown~↧~mapstoleft~↤~mapstoup~↥~marker~▮~mcomma~⨩~mcy~м~measuredangle~∡~mfr~𝔪~mho~℧~mid~∣~midast~*~midcir~⫰~minusb~⊟~minusd~∸~minusdu~⨪~mlcp~⫛~mldr~…~mnplus~∓~models~⊧~mopf~𝕞~mp~∓~mscr~𝓂~mstpos~∾~multimap~⊸~mumap~⊸~nGg~⋙̸~nGt~≫⃒~nGtv~≫̸~nLeftarrow~⇍~nLeftrightarrow~⇎~nLl~⋘̸~nLt~≪⃒~nLtv~≪̸~nRightarrow~⇏~nVDash~⊯~nVdash~⊮~nacute~ń~nang~∠⃒~nap~≉~napE~⩰̸~napid~≋̸~napos~ŉ~napprox~≉~natur~♮~natural~♮~naturals~ℕ~nbump~≎̸~nbumpe~≏̸~ncap~⩃~ncaron~ň~ncedil~ņ~ncong~≇~ncongdot~⩭̸~ncup~⩂~ncy~н~neArr~⇗~nearhk~⤤~nearr~↗~nearrow~↗~nedot~≐̸~nequiv~≢~nesear~⤨~nesim~≂̸~nexist~∄~nexists~∄~nfr~𝔫~ngE~≧̸~nge~≱~ngeq~≱~ngeqq~≧̸~ngeqslant~⩾̸~nges~⩾̸~ngsim~≵~ngt~≯~ngtr~≯~nhArr~⇎~nharr~↮~nhpar~⫲~nis~⋼~nisd~⋺~niv~∋~njcy~њ~nlArr~⇍~nlE~≦̸~nlarr~↚~nldr~‥~nle~≰~nleftarrow~↚~nleftrightarrow~↮~nleq~≰~nleqq~≦̸~nleqslant~⩽̸~nles~⩽̸~nless~≮~nlsim~≴~nlt~≮~nltri~⋪~nltrie~⋬~nmid~∤~nopf~𝕟~notinE~⋹̸~notindot~⋵̸~notinva~∉~notinvb~⋷~notinvc~⋶~notni~∌~notniva~∌~notnivb~⋾~notnivc~⋽~npar~∦~nparallel~∦~nparsl~⫽⃥~npart~∂̸~npolint~⨔~npr~⊀~nprcue~⋠~npre~⪯̸~nprec~⊀~npreceq~⪯̸~nrArr~⇏~nrarr~↛~nrarrc~⤳̸~nrarrw~↝̸~nrightarrow~↛~nrtri~⋫~nrtrie~⋭~nsc~⊁~nsccue~⋡~nsce~⪰̸~nscr~𝓃~nshortmid~∤~nshortparallel~∦~nsim~≁~nsime~≄~nsimeq~≄~nsmid~∤~nspar~∦~nsqsube~⋢~nsqsupe~⋣~nsubE~⫅̸~nsube~⊈~nsubset~⊂⃒~nsubseteq~⊈~nsubseteqq~⫅̸~nsucc~⊁~nsucceq~⪰̸~nsup~⊅~nsupE~⫆̸~nsupe~⊉~nsupset~⊃⃒~nsupseteq~⊉~nsupseteqq~⫆̸~ntgl~≹~ntlg~≸~ntriangleleft~⋪~ntrianglelefteq~⋬~ntriangleright~⋫~ntrianglerighteq~⋭~num~#~numero~№~numsp~ ~nvDash~⊭~nvHarr~⤄~nvap~≍⃒~nvdash~⊬~nvge~≥⃒~nvgt~>⃒~nvinfin~⧞~nvlArr~⤂~nvle~≤⃒~nvlt~<⃒~nvltrie~⊴⃒~nvrArr~⤃~nvrtrie~⊵⃒~nvsim~∼⃒~nwArr~⇖~nwarhk~⤣~nwarr~↖~nwarrow~↖~nwnear~⤧~oS~Ⓢ~oast~⊛~ocir~⊚~ocy~о~odash~⊝~odblac~ő~odiv~⨸~odot~⊙~odsold~⦼~ofcir~⦿~ofr~𝔬~ogon~˛~ogt~⧁~ohbar~⦵~ohm~Ω~oint~∮~olarr~↺~olcir~⦾~olcross~⦻~olt~⧀~omacr~ō~omid~⦶~ominus~⊖~oopf~𝕠~opar~⦷~operp~⦹~orarr~↻~ord~⩝~order~ℴ~orderof~ℴ~origof~⊶~oror~⩖~orslope~⩗~orv~⩛~oscr~ℴ~osol~⊘~otimesas~⨶~ovbar~⌽~par~∥~parallel~∥~parsim~⫳~parsl~⫽~pcy~п~percnt~%~period~.~pertenk~‱~pfr~𝔭~phiv~ϕ~phmmat~ℳ~phone~☎~pitchfork~⋔~planck~ℏ~planckh~ℎ~plankv~ℏ~plus~+~plusacir~⨣~plusb~⊞~pluscir~⨢~plusdo~∔~plusdu~⨥~pluse~⩲~plussim~⨦~plustwo~⨧~pm~±~pointint~⨕~popf~𝕡~pr~≺~prE~⪳~prap~⪷~prcue~≼~pre~⪯~prec~≺~precapprox~⪷~preccurlyeq~≼~preceq~⪯~precnapprox~⪹~precneqq~⪵~precnsim~⋨~precsim~≾~primes~ℙ~prnE~⪵~prnap~⪹~prnsim~⋨~profalar~⌮~profline~⌒~profsurf~⌓~propto~∝~prsim~≾~prurel~⊰~pscr~𝓅~puncsp~ ~qfr~𝔮~qint~⨌~qopf~𝕢~qprime~⁗~qscr~𝓆~quaternions~ℍ~quatint~⨖~quest~?~questeq~≟~rAarr~⇛~rAtail~⤜~rBarr~⤏~rHar~⥤~race~∽̱~racute~ŕ~raemptyv~⦳~rangd~⦒~range~⦥~rangle~⟩~rarrap~⥵~rarrb~⇥~rarrbfs~⤠~rarrc~⤳~rarrfs~⤞~rarrhk~↪~rarrlp~↬~rarrpl~⥅~rarrsim~⥴~rarrtl~↣~rarrw~↝~ratail~⤚~ratio~∶~rationals~ℚ~rbarr~⤍~rbbrk~❳~rbrace~}~rbrack~]~rbrke~⦌~rbrksld~⦎~rbrkslu~⦐~rcaron~ř~rcedil~ŗ~rcub~}~rcy~р~rdca~⤷~rdldhar~⥩~rdquor~”~rdsh~↳~realine~ℛ~realpart~ℜ~reals~ℝ~rect~▭~rfisht~⥽~rfr~𝔯~rhard~⇁~rharu~⇀~rharul~⥬~rhov~ϱ~rightarrow~→~rightarrowtail~↣~rightharpoondown~⇁~rightharpoonup~⇀~rightleftarrows~⇄~rightleftharpoons~⇌~rightrightarrows~⇉~rightsquigarrow~↝~rightthreetimes~⋌~ring~˚~risingdotseq~≓~rlarr~⇄~rlhar~⇌~rmoust~⎱~rmoustache~⎱~rnmid~⫮~roang~⟭~roarr~⇾~robrk~⟧~ropar~⦆~ropf~𝕣~roplus~⨮~rotimes~⨵~rpar~)~rpargt~⦔~rppolint~⨒~rrarr~⇉~rscr~𝓇~rsh~↱~rsqb~]~rsquor~’~rthree~⋌~rtimes~⋊~rtri~▹~rtrie~⊵~rtrif~▸~rtriltri~⧎~ruluhar~⥨~rx~℞~sacute~ś~sc~≻~scE~⪴~scap~⪸~sccue~≽~sce~⪰~scedil~ş~scirc~ŝ~scnE~⪶~scnap~⪺~scnsim~⋩~scpolint~⨓~scsim~≿~scy~с~sdotb~⊡~sdote~⩦~seArr~⇘~searhk~⤥~searr~↘~searrow~↘~semi~;~seswar~⤩~setminus~∖~setmn~∖~sext~✶~sfr~𝔰~sfrown~⌢~sharp~♯~shchcy~щ~shcy~ш~shortmid~∣~shortparallel~∥~sigmav~ς~simdot~⩪~sime~≃~simeq~≃~simg~⪞~simgE~⪠~siml~⪝~simlE~⪟~simne~≆~simplus~⨤~simrarr~⥲~slarr~←~smallsetminus~∖~smashp~⨳~smeparsl~⧤~smid~∣~smile~⌣~smt~⪪~smte~⪬~smtes~⪬︀~softcy~ь~sol~/~solb~⧄~solbar~⌿~sopf~𝕤~spadesuit~♠~spar~∥~sqcap~⊓~sqcaps~⊓︀~sqcup~⊔~sqcups~⊔︀~sqsub~⊏~sqsube~⊑~sqsubset~⊏~sqsubseteq~⊑~sqsup~⊐~sqsupe~⊒~sqsupset~⊐~sqsupseteq~⊒~squ~□~square~□~squarf~▪~squf~▪~srarr~→~sscr~𝓈~ssetmn~∖~ssmile~⌣~sstarf~⋆~star~☆~starf~★~straightepsilon~ϵ~straightphi~ϕ~strns~¯~subE~⫅~subdot~⪽~subedot~⫃~submult~⫁~subnE~⫋~subne~⊊~subplus~⪿~subrarr~⥹~subset~⊂~subseteq~⊆~subseteqq~⫅~subsetneq~⊊~subsetneqq~⫋~subsim~⫇~subsub~⫕~subsup~⫓~succ~≻~succapprox~⪸~succcurlyeq~≽~succeq~⪰~succnapprox~⪺~succneqq~⪶~succnsim~⋩~succsim~≿~sung~♪~supE~⫆~supdot~⪾~supdsub~⫘~supedot~⫄~suphsol~⟉~suphsub~⫗~suplarr~⥻~supmult~⫂~supnE~⫌~supne~⊋~supplus~⫀~supset~⊃~supseteq~⊇~supseteqq~⫆~supsetneq~⊋~supsetneqq~⫌~supsim~⫈~supsub~⫔~supsup~⫖~swArr~⇙~swarhk~⤦~swarr~↙~swarrow~↙~swnwar~⤪~target~⌖~tbrk~⎴~tcaron~ť~tcedil~ţ~tcy~т~tdot~⃛~telrec~⌕~tfr~𝔱~therefore~∴~thetav~ϑ~thickapprox~≈~thicksim~∼~thkap~≈~thksim~∼~timesb~⊠~timesbar~⨱~timesd~⨰~tint~∭~toea~⤨~top~⊤~topbot~⌶~topcir~⫱~topf~𝕥~topfork~⫚~tosa~⤩~tprime~‴~triangle~▵~triangledown~▿~triangleleft~◃~trianglelefteq~⊴~triangleq~≜~triangleright~▹~trianglerighteq~⊵~tridot~◬~trie~≜~triminus~⨺~triplus~⨹~trisb~⧍~tritime~⨻~trpezium~⏢~tscr~𝓉~tscy~ц~tshcy~ћ~tstrok~ŧ~twixt~≬~twoheadleftarrow~↞~twoheadrightarrow~↠~uHar~⥣~ubrcy~ў~ubreve~ŭ~ucy~у~udarr~⇅~udblac~ű~udhar~⥮~ufisht~⥾~ufr~𝔲~uharl~↿~uharr~↾~uhblk~▀~ulcorn~⌜~ulcorner~⌜~ulcrop~⌏~ultri~◸~umacr~ū~uogon~ų~uopf~𝕦~uparrow~↑~updownarrow~↕~upharpoonleft~↿~upharpoonright~↾~uplus~⊎~upsi~υ~upuparrows~⇈~urcorn~⌝~urcorner~⌝~urcrop~⌎~uring~ů~urtri~◹~uscr~𝓊~utdot~⋰~utilde~ũ~utri~▵~utrif~▴~uuarr~⇈~uwangle~⦧~vArr~⇕~vBar~⫨~vBarv~⫩~vDash~⊨~vangrt~⦜~varepsilon~ϵ~varkappa~ϰ~varnothing~∅~varphi~ϕ~varpi~ϖ~varpropto~∝~varr~↕~varrho~ϱ~varsigma~ς~varsubsetneq~⊊︀~varsubsetneqq~⫋︀~varsupsetneq~⊋︀~varsupsetneqq~⫌︀~vartheta~ϑ~vartriangleleft~⊲~vartriangleright~⊳~vcy~в~vdash~⊢~vee~∨~veebar~⊻~veeeq~≚~vellip~⋮~verbar~|~vert~|~vfr~𝔳~vltri~⊲~vnsub~⊂⃒~vnsup~⊃⃒~vopf~𝕧~vprop~∝~vrtri~⊳~vscr~𝓋~vsubnE~⫋︀~vsubne~⊊︀~vsupnE~⫌︀~vsupne~⊋︀~vzigzag~⦚~wcirc~ŵ~wedbar~⩟~wedge~∧~wedgeq~≙~wfr~𝔴~wopf~𝕨~wp~℘~wr~≀~wreath~≀~wscr~𝓌~xcap~⋂~xcirc~◯~xcup~⋃~xdtri~▽~xfr~𝔵~xhArr~⟺~xharr~⟷~xlArr~⟸~xlarr~⟵~xmap~⟼~xnis~⋻~xodot~⨀~xopf~𝕩~xoplus~⨁~xotime~⨂~xrArr~⟹~xrarr~⟶~xscr~𝓍~xsqcup~⨆~xuplus~⨄~xutri~△~xvee~⋁~xwedge~⋀~yacy~я~ycirc~ŷ~ycy~ы~yfr~𝔶~yicy~ї~yopf~𝕪~yscr~𝓎~yucy~ю~zacute~ź~zcaron~ž~zcy~з~zdot~ż~zeetrf~ℨ~zfr~𝔷~zhcy~ж~zigrarr~⇝~zopf~𝕫~zscr~𝓏~~AMP~&~COPY~©~GT~>~LT~<~QUOT~"~REG~®',ao.html4);var t3={0:65533,128:8364,130:8218,131:402,132:8222,133:8230,134:8224,135:8225,136:710,137:8240,138:352,139:8249,140:338,142:381,145:8216,146:8217,147:8220,148:8221,149:8226,150:8211,151:8212,152:732,153:8482,154:353,155:8250,156:339,158:382,159:376},r3=String.fromCodePoint||function(i){return String.fromCharCode(Math.floor((i-65536)/1024)+55296,(i-65536)%1024+56320)},oo=function(){return oo=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},oo.apply(this,arguments)},i3=oo(oo({},ao),{all:ao.html5}),n3={scope:"body",level:"all"},pp=/&(?:#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);/g,mp=/&(?:#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+)[;=]?/g,Ox={xml:{strict:pp,attribute:mp,body:gp.xml},html4:{strict:pp,attribute:mp,body:gp.html4},html5:{strict:pp,attribute:mp,body:gp.html5}},s3=oo(oo({},Ox),{all:Ox.html5}),Px=String.fromCharCode,a3=Px(65533);function o3(i,e,t,r){var n=i,s=i[i.length-1];if(t&&s==="=")n=i;else if(r&&s!==";")n=i;else{var a=e[i];if(a)n=a;else if(i[0]==="&"&&i[1]==="#"){var o=i[2],u=o=="x"||o=="X"?parseInt(i.substr(3),16):parseInt(i.substr(2));n=u>=1114111?a3:u>65535?r3(u):Px(t3[u]||u)}}return n}function kx(i,e){var t=e===void 0?n3:e,r=t.level,n=r===void 0?"all":r,s=t.scope,a=s===void 0?n==="xml"?"strict":"body":s;if(!i)return"";var o=s3[n][a],u=i3[n].entities,l=a==="attribute",h=a==="strict";return i.replace(o,function(d){return o3(d,u,l,h)})}/**
 * @name ranges-sort
 * @fileoverview Sort string index ranges
 * @version 6.0.13
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-sort/}
 */var l3={strictlyTwoElementsInRangeArrays:!1,progressFn:null};function yc(i,e){if(!Array.isArray(i)||!i.length)return i;let t={...l3,...e},r,n;if(t.strictlyTwoElementsInRangeArrays&&!i.every((o,u)=>!Array.isArray(o)||o.length!==2?(r=u,n=o.length,!1):!0))throw new TypeError(`ranges-sort: [THROW_ID_03] The first argument should be an array and must consist of arrays which are natural number indexes representing TWO string index ranges. However, ${r}th range (${JSON.stringify(i[r],null,4)}) has not two but ${n} elements!`);if(!i.every((o,u)=>!Array.isArray(o)||!Number.isInteger(o[0])||o[0]<0||!Number.isInteger(o[1])||o[1]<0?(r=u,!1):!0))throw new TypeError(`ranges-sort: [THROW_ID_04] The first argument should be an array and must consist of arrays which are natural number indexes representing string index ranges. However, ${r}th range (${JSON.stringify(i[r],null,4)}) does not consist of only natural numbers!`);let s=i.length**2,a=0;return Array.from(i).sort((o,u)=>(t.progressFn&&(a+=1,t.progressFn(Math.floor(a*100/s))),o[0]===u[0]?o[1]<u[1]?-1:o[1]>u[1]?1:0:o[0]<u[0]?-1:1))}/**
 * @name ranges-merge
 * @fileoverview Merge and sort string index ranges
 * @version 9.0.18
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-merge/}
 */var Fx={mergeType:1,progressFn:null,joinRangesThatTouchEdges:!0};function u3(i,e){function t(l){return!!l&&typeof l=="object"&&!Array.isArray(l)}if(!Array.isArray(i)||!i.length)return null;let r;if(e)if(t(e)){if(r={...Fx,...e},r.progressFn&&t(r.progressFn)&&!Object.keys(r.progressFn).length)r.progressFn=null;else if(r.progressFn&&typeof r.progressFn!="function")throw new Error(`ranges-merge: [THROW_ID_01] opts.progressFn must be a function! It was given of a type: "${typeof r.progressFn}", equal to ${JSON.stringify(r.progressFn,null,4)}`);if(![1,2,"1","2"].includes(r.mergeType))throw new Error(`ranges-merge: [THROW_ID_02] opts.mergeType was customised to a wrong thing! It was given of a type: "${typeof r.mergeType}", equal to ${JSON.stringify(r.mergeType,null,4)}`);if(typeof r.joinRangesThatTouchEdges!="boolean")throw new Error(`ranges-merge: [THROW_ID_04] opts.joinRangesThatTouchEdges was customised to a wrong thing! It was given of a type: "${typeof r.joinRangesThatTouchEdges}", equal to ${JSON.stringify(r.joinRangesThatTouchEdges,null,4)}`)}else throw new Error(`emlint: [THROW_ID_03] the second input argument must be a plain object. It was given as:
${JSON.stringify(e,null,4)} (type ${typeof e})`);else r={...Fx};let n=i.filter(l=>Array.isArray(l)).map(l=>[...l]).filter(l=>l[2]!==void 0||l[0]!==l[1]),s,a,o;r.progressFn?s=yc(n,{progressFn:l=>{o=Math.floor(l/5),o!==a&&(a=o,r.progressFn(o))}}):s=yc(n);let u=s.length-1;for(let l=u;l>0;l--)r.progressFn&&(o=Math.floor((1-l/u)*78)+21,o!==a&&o>a&&(a=o,r.progressFn(o))),(s[l][0]<=s[l-1][0]||!r.joinRangesThatTouchEdges&&s[l][0]<s[l-1][1]||r.joinRangesThatTouchEdges&&s[l][0]<=s[l-1][1])&&(s[l-1][0]=Math.min(s[l][0],s[l-1][0]),s[l-1][1]=Math.max(s[l][1],s[l-1][1]),s[l][2]!==void 0&&(s[l-1][0]>=s[l][0]||s[l-1][1]<=s[l][1])&&s[l-1][2]!==null&&(s[l][2]===null&&s[l-1][2]!==null?s[l-1][2]=null:s[l-1][2]!=null?+r.mergeType==2&&s[l-1][0]===s[l][0]?s[l-1][2]=s[l][2]:s[l-1][2]+=s[l][2]:s[l-1][2]=s[l][2]),s.splice(l,1),l=s.length);return s.length?s:null}var c3="Invariant failed";function h3(i,e){if(!i)throw new Error(c3)}/**
 * @name ranges-apply
 * @fileoverview Take an array of string index ranges, delete/replace the string according to them
 * @version 7.0.19
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-apply/}
 */function d3(i,e,t){if(arguments.length===0)throw new Error("ranges-apply: [THROW_ID_01] inputs missing!");if(typeof i!="string")throw new TypeError(`ranges-apply: [THROW_ID_02] first input argument must be a string! Currently it's: ${typeof i}, equal to: ${JSON.stringify(i,null,4)}`);if(e&&!Array.isArray(e))throw new TypeError(`ranges-apply: [THROW_ID_03] second input argument must be an array (or null)! Currently it's: ${typeof e}, equal to: ${JSON.stringify(e,null,4)}`);if(!(e!=null&&e.filter(a=>a).length))return i;let r;Array.isArray(e)&&Number.isInteger(e[0])&&Number.isInteger(e[1])?r=[Array.from(e)]:r=Array.from(e),r.length,r.filter(a=>a).forEach((a,o)=>{if(!Array.isArray(a))throw new TypeError(`ranges-apply: [THROW_ID_05] ranges array, second input arg., has ${o}th element not an array: ${JSON.stringify(a,null,4)}, which is ${typeof a}`);if(!Number.isInteger(a[0])){if(!Number.isInteger(+a[0])||+a[0]<0)throw new TypeError(`ranges-apply: [THROW_ID_06] ranges array, second input arg. has ${o}th element, array ${JSON.stringify(a,null,0)}. Its first element is not an integer, string index, but ${typeof a[0]}, equal to: ${JSON.stringify(a[0],null,4)}.`);r[o][0]=+r[o][0]}if(!Number.isInteger(a[1])){if(!Number.isInteger(+a[1])||+a[1]<0)throw new TypeError(`ranges-apply: [THROW_ID_07] ranges array, second input arg. has ${o}th element, array ${JSON.stringify(a,null,0)}. Its second element is not an integer, string index, but ${typeof a[1]}, equal to: ${JSON.stringify(a[1],null,4)}.`);r[o][1]=+r[o][1]}});let n=u3(r,{progressFn:a=>{}});h3(n);let s=n.length;if(s>0){let a=i.slice(n[s-1][1]);i=n.reduce((o,u,l,h)=>{let d=l===0?0:h[l-1][1],p=h[l][0];return`${o}${i.slice(d,p)}${h[l][2]||""}`},""),i+=a}return i}/**
 * @name string-collapse-leading-whitespace
 * @fileoverview Collapse the leading and trailing whitespace of a string
 * @version 7.0.9
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/string-collapse-leading-whitespace/}
 */function yp(i,e=1){let t=" ";function r(s){return Array.from(s).reverse().join("")}function n(s,a,o){let u=o?`
`:"\r",l=o?"\r":`
`;if(!s)return s;let h=0,d="";for(let p=0,g=s.length;p<g;p++)(s[p]===u||s[p]===l&&s[p-1]!==u)&&h++,`\r
`.includes(s[p])||s[p]===t?s[p]===t?d+=s[p]:s[p]===u?h<=a&&(d+=s[p],s[p+1]===l&&(d+=s[p+1],p++)):s[p]===l&&(s==null?void 0:s[p-1])!==u&&h<=a&&(d+=s[p]):!s[p+1]&&!h&&(d+=" ");return d}if(typeof i=="string"&&i.length){let s=1;typeof+e=="number"&&Number.isInteger(+e)&&+e>=0&&(s=+e);let a="",o="";if(!i.trim())a=i;else if(!i[0].trim()){for(let u=0,l=i.length;u<l;u++)if(i[u].trim()){a=i.slice(0,u);break}}if(i.trim()&&(i.slice(-1).trim()===""||i.slice(-1)===t)){for(let u=i.length;u--;)if(i[u].trim()){o=i.slice(u+1);break}}return`${n(a,s,!1)}${i.trim()}${r(n(r(o),s,!0))}`}return i}/**
 * @name ranges-push
 * @fileoverview Gather string index ranges
 * @version 7.0.18
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-push/}
 */var Bx={mergeType:1,progressFn:null,joinRangesThatTouchEdges:!0};function f3(i,e){var l;function t(h){return!!h&&typeof h=="object"&&!Array.isArray(h)}if(!Array.isArray(i)||!i.length)return null;let r;if(e)if(t(e)){if(r={...Bx,...e},r.progressFn&&t(r.progressFn)&&!Object.keys(r.progressFn).length)r.progressFn=null;else if(r.progressFn&&typeof r.progressFn!="function")throw new Error(`ranges-merge: [THROW_ID_01] resolvedOpts.progressFn must be a function! It was given of a type: "${typeof r.progressFn}", equal to ${JSON.stringify(r.progressFn,null,4)}`);if(![1,2,"1","2"].includes(r.mergeType))throw new Error(`ranges-merge: [THROW_ID_02] resolvedOpts.mergeType was customised to a wrong thing! It was given of a type: "${typeof r.mergeType}", equal to ${JSON.stringify(r.mergeType,null,4)}`);if(typeof r.joinRangesThatTouchEdges!="boolean")throw new Error(`ranges-merge: [THROW_ID_04] resolvedOpts.joinRangesThatTouchEdges was customised to a wrong thing! It was given of a type: "${typeof r.joinRangesThatTouchEdges}", equal to ${JSON.stringify(r.joinRangesThatTouchEdges,null,4)}`)}else throw new Error(`ranges-merge: [THROW_ID_03] the second input argument must be a plain object. It was given as:
${JSON.stringify(e,null,4)} (type ${typeof e})`);else r={...Bx};let n=i.filter(h=>Array.isArray(h)).map(h=>[...h]).filter(h=>h[2]!==void 0||h[0]!==h[1]),s,a,o;r.progressFn?s=yc(n,{progressFn:h=>{o=Math.floor(h/5),o!==a&&(a=o,r.progressFn!=null&&r.progressFn(o))}}):s=yc(n);let u=s.length-1;for(let h=u;h>0;h--)r.progressFn&&(o=Math.floor((1-h/u)*78)+21,o!==a&&o>a&&(a=o,r.progressFn(o))),(s[h][0]<=s[h-1][0]||!r.joinRangesThatTouchEdges&&s[h][0]<s[h-1][1]||r.joinRangesThatTouchEdges&&s[h][0]<=s[h-1][1])&&(s[h-1][0]=Math.min(s[h][0],s[h-1][0]),s[h-1][1]=Math.max(s[h][1],s[h-1][1]),s[h][2]!==void 0&&(s[h-1][0]>=s[h][0]||s[h-1][1]<=s[h][1])&&s[h-1][2]!==null&&(s[h][2]===null&&s[h-1][2]!==null?s[h-1][2]=null:s[h-1][2]!=null?+((l=r||{})==null?void 0:l.mergeType)==2&&s[h-1][0]===s[h][0]?s[h-1][2]=s[h][2]:s[h-1][2]+=s[h][2]:s[h-1][2]=s[h][2]),s.splice(h,1),h=s.length);return s.length?s:null}var g3={limitToBeAddedWhitespace:!1,limitLinebreaksCount:1,mergeType:1},p3=class{constructor(i){fe(this,"ranges");fe(this,"opts");let e={...g3,...i};if(e.mergeType&&e.mergeType!==1&&e.mergeType!==2)if(to(e.mergeType)&&e.mergeType.trim()==="1")e.mergeType=1;else if(to(e.mergeType)&&e.mergeType.trim()==="2")e.mergeType=2;else throw new Error(`ranges-push: [THROW_ID_02] opts.mergeType was customised to a wrong thing! It was given of a type: "${typeof e.mergeType}", equal to ${JSON.stringify(e.mergeType,null,4)}`);this.opts=e,this.ranges=[]}add(i,e,t){var s;if(i==null&&e==null)return;if(ps(i)&&!ps(e)){if(Array.isArray(i)){if(i.length){if(i.some(a=>Array.isArray(a))){i.forEach(a=>{Array.isArray(a)&&this.add(...a)});return}i.length&&gs(+i[0])&&gs(+i[1])&&this.add(...i)}return}throw new TypeError(`ranges-push/Ranges/add(): [THROW_ID_12] the first input argument, "from" is set (${JSON.stringify(i,null,0)}) but second-one, "to" is not (${JSON.stringify(e,null,0)})`)}else if(!ps(i)&&ps(e))throw new TypeError(`ranges-push/Ranges/add(): [THROW_ID_13] the second input argument, "to" is set (${JSON.stringify(e,null,0)}) but first-one, "from" is not (${JSON.stringify(i,null,0)})`);let r=+i,n=+e;if(gs(t)&&(t=String(t)),gs(r)&&gs(n)){if(ps(t)&&!to(t)&&!gs(t))throw new TypeError(`ranges-push/Ranges/add(): [THROW_ID_08] The third argument, the value to add, was given not as string but ${typeof t}, equal to:
${JSON.stringify(t,null,4)}`);if(ps(this.ranges)&&Array.isArray(this.last())&&r===this.last()[1]){if(this.last()[1]=n,this.last()[2],this.last()[2]!==null&&ps(t)){let a=this.last()[2]&&this.last()[2].length&&(!((s=this.opts)!=null&&s.mergeType)||this.opts.mergeType===1)?`${this.last()[2]}${t}`:t;this.opts.limitToBeAddedWhitespace&&(a=yp(a,this.opts.limitLinebreaksCount)),to(a)&&!a.length||(this.last()[2]=a)}}else{this.ranges||(this.ranges=[]);let a=t!==void 0&&!(to(t)&&!t.length)?[r,n,t&&this.opts.limitToBeAddedWhitespace?yp(t,this.opts.limitLinebreaksCount):t]:[r,n];this.ranges.push(a)}}else throw gs(r)&&r>=0?new TypeError(`ranges-push/Ranges/add(): [THROW_ID_10] "to" value, the second input argument, must be a natural number or zero! Currently it's of a type "${typeof n}" equal to: ${JSON.stringify(n,null,4)}`):new TypeError(`ranges-push/Ranges/add(): [THROW_ID_09] "from" value, the first input argument, must be a natural number or zero! Currently it's of a type "${typeof r}" equal to: ${JSON.stringify(r,null,4)}`)}push(i,e,t){this.add(i,e,t)}current(){return Array.isArray(this.ranges)&&this.ranges.length?(this.ranges=f3(this.ranges,{mergeType:this.opts.mergeType}),this.ranges&&this.opts.limitToBeAddedWhitespace?this.ranges.map(i=>ps(i[2])?[i[0],i[1],yp(i[2],this.opts.limitLinebreaksCount)]:i):this.ranges):null}wipe(){this.ranges=[]}replace(i){if(Array.isArray(i)&&i.length)if(Array.isArray(i[0])&&gs(i[0][0]))this.ranges=Array.from(i);else throw new Error(`ranges-push/Ranges/replace(): [THROW_ID_11] Single range was given but we expected array of arrays! The first element, ${JSON.stringify(i[0],null,4)} should be an array and its first element should be an integer, a string index.`);else this.ranges=[]}last(){return Array.isArray(this.ranges)&&this.ranges.length?this.ranges[this.ranges.length-1]:null}};/**
 * @name string-left-right
 * @fileoverview Looks up the first non-whitespace character to the left/right of a given index
 * @version 6.0.20
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/string-left-right/}
 */fx();var vp=" ";function m3({str:i,idx:e=0,stopAtNewlines:t=!1,stopAtRawNbsp:r=!1}){if(typeof i!="string"||!i.length||((!e||typeof e!="number")&&(e=0),!i[e+1]))return null;if(i[e+1]&&(i[e+1].trim()||t&&`
\r`.includes(i[e+1])||r&&i[e+1]===vp))return e+1;if(i[e+2]&&(i[e+2].trim()||t&&`
\r`.includes(i[e+2])||r&&i[e+2]===vp))return e+2;for(let n=e+1,s=i.length;n<s;n++)if(i[n].trim()||t&&`
\r`.includes(i[n])||r&&i[n]===vp)return n;return null}function on(i,e=0){return m3({str:i,idx:e,stopAtNewlines:!1,stopAtRawNbsp:!1})}/**
 * @name string-strip-html
 * @fileoverview Strip HTML tags from strings. No parser, accepts mixed sources.
 * @version 13.4.12
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/string-strip-html/}
 */function y3(i){return/[-_A-Za-z0-9]/.test(i)}function Ux(i,e){if(!i)return[];if(Array.isArray(i))return i.filter(t=>typeof t=="string"&&t.trim());if(typeof i=="string")return i.trim()?[i]:[];throw new TypeError(`string-strip-html/stripHtml(): [THROW_ID_05] ${e} must be array containing zero or more strings or something falsey. Currently it's equal to: ${i}, that a type of ${typeof i}.`)}function vc(i,e,t,r){for(let n=e,s=i.length;n<s;n++){if(i.startsWith(t,n))return!0;if(i.startsWith(r,n))return!1}return!1}function $x(i,e,t){var r,n,s,a,o,u,l;return i!=null&&i.quotes,(r=i==null?void 0:i.quotes)!=null&&r.value&&vc(e,t+1,i.quotes.value,">"),(n=i==null?void 0:i.quotes)==null||n.next,vc(e,((s=i==null?void 0:i.quotes)==null?void 0:s.next)-1,(a=i==null?void 0:i.quotes)==null?void 0:a.value,">"),!(i!=null&&i.quotes)||!vc(e,t+1,i.quotes.value,">")&&((o=i==null?void 0:i.quotes)==null?void 0:o.next)!==-1&&vc(e,((u=i==null?void 0:i.quotes)==null?void 0:u.next)-1,(l=i==null?void 0:i.quotes)==null?void 0:l.value,">")}function v3(i,e){return(e.match(new RegExp(i,"g"))||[]).length}var pl=new Set(["!doctype","abbr","address","area","article","aside","audio","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","doctype","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","param","picture","pre","progress","rb","rp","rt","rtc","ruby","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","ul","var","video","wbr","xml"]),Ep=new Set(["a","b","i","p","q","s","u"]),Ap=new Set([".",",",";","!","?"]),Gx=new Set([".",",","?",";",")","…",'"',"»"]),E3=new Set(["a","abbr","acronym","audio","b","bdi","bdo","big","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","select","slot","small","span","strong","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"]),qx={ignoreTags:[],ignoreTagsWithTheirContents:[],onlyStripTags:[],stripTogetherWithTheirContents:["script","style","xml"],skipHtmlDecoding:!1,trimOnlySpaces:!1,stripRecognisedHTMLOnly:!1,dumpLinkHrefsNearby:{enabled:!1,putOnNewLine:!1,wrapHeads:"",wrapTails:""},ignoreIndentations:!1,cb:null,reportProgressFunc:null,reportProgressFuncFrom:0,reportProgressFuncTo:100};function Hx(i,e){var ve,de,De,Ie,Ne,Be,$e,et,rt,Ge,nt;let t=Date.now(),r=[],n=[],s=[],a=[],o={};function u(){o={attributes:[]}}u();let l=null,h=null,d=null,p=!1,g={},m={tagName:"",hrefValue:"",openingTagEnds:void 0},v="",E=!1,x=null,T=!0;function R(B,se,xe){if(Array.isArray(se.stripTogetherWithTheirContents)&&(se.stripTogetherWithTheirContents.includes(o.name)||se.stripTogetherWithTheirContents.includes("*")))if(o.slashPresent&&Array.isArray(r)&&r.some(Ae=>Ae.name===o.name)){for(let Ae=r.length;Ae--;)if(r[Ae].name===o.name){a=a.filter(([we,Me])=>(we<r[Ae].lastOpeningBracketAt||we>=B+1)&&(Me<=r[Ae].lastOpeningBracketAt||Me>B+1));let ge=B+1;o.lastClosingBracketAt&&(ge=o.lastClosingBracketAt+1),a.push([r[Ae].lastOpeningBracketAt,ge]),Gx.has(i[B])&&se.cb?se.cb({tag:o,deleteFrom:r[Ae].lastOpeningBracketAt,deleteTo:B+1,insert:null,rangesArr:xe,proposedReturn:[r[Ae].lastOpeningBracketAt,B,null]}):se.cb&&se.cb({tag:o,deleteFrom:r[Ae].lastOpeningBracketAt,deleteTo:B,insert:"",rangesArr:xe,proposedReturn:[r[Ae].lastOpeningBracketAt,B,""]}),r.splice(Ae,1);break}}else o.slashPresent||r.push(o);else Array.isArray(se.ignoreTagsWithTheirContents)&&M(B,se,o)&&(T=!1)}function _(B,se,xe,Ae,ge,we){var P;if(Array.isArray($.current())&&typeof xe=="number"&&$.current()[0][0]===0&&$.current()[0][1]>=xe)return"";if(i.length===Ae&&we&&!((P=I==null?void 0:I.dumpLinkHrefsNearby)!=null&&P.enabled))return null;let Me="";if(Number.isInteger(xe)&&xe<ge&&(Me+=B.slice(xe,ge)),Number.isInteger(Ae)&&Ae>we+1){let z=B.slice(we+1,Ae);Ae&&!on(i,Ae-1)&&(z=z.trimEnd()),z.includes(`
`)&&N(Ae,B)?Me+=" ":Me+=z}let le=!Gx.has(B[se]),K=B[Ae-1]!==">"||!B[xe].trim(),D=!['"',"("].includes(B[ge-1]),S=![";",".",":","!"].includes(B[se]);if((le||K&&D&&S)&&(K||D)&&B[se]!=="!"&&(!E3.has(o.name)||typeof xe=="number"&&xe<ge||typeof Ae=="number"&&Ae>we+1)){let z=Me.match(/\n/g);return Array.isArray(z)&&z.length?z.length===1?`
`:z.length===2?`

`:`


`:" "}return""}function F(B,se){var xe,Ae;if((xe=B.dumpLinkHrefsNearby)!=null&&xe.enabled&&m.tagName&&m.tagName===o.name&&o.lastOpeningBracketAt&&(m.openingTagEnds&&o.lastOpeningBracketAt>m.openingTagEnds||!m.openingTagEnds)&&(E=!0),E){let ge=(Ae=B.dumpLinkHrefsNearby)!=null&&Ae.putOnNewLine?`

`:"";v=`${ge}${m.hrefValue}`,(typeof se!="number"||on(i,se-1))&&(v+=ge)}}function N(B,se){return se?se[B]==="<"&&se[B+1]!=="%":i[B]==="<"&&i[B+1]!=="%"}function C(B){return i[B]===">"&&i[B-1]!=="%"}function M(B,se,xe){if(se.ignoreTagsWithTheirContents.includes("*"))return!0;let Ae=i.indexOf(`<${xe.name}`,B),ge=i.indexOf(`</${xe.name}`,B);return!xe.slashPresent&&ge===-1||xe.slashPresent&&!n.some(we=>we.name===xe.name)||ge>-1&&Ae>-1&&Ae<ge?!1:se.ignoreTagsWithTheirContents.includes(xe.name)}if(typeof i!="string")throw new TypeError(`string-strip-html/stripHtml(): [THROW_ID_01] Input must be string! Currently it's: ${(typeof i).toLowerCase()}, equal to:
${JSON.stringify(i,null,4)}`);if(e)if(sp(e)){if(e.reportProgressFunc&&typeof e.reportProgressFunc!="function")throw new Error(`string-strip-html/stripHtml(): [THROW_ID_03] The Optional Options Object's key reportProgressFunc, callback function, should be a function but it was given as type ${typeof e.reportProgressFunc}, equal to ${JSON.stringify(e.reportProgressFunc,null,4)}`);if(typeof e.dumpLinkHrefsNearby=="boolean"&&e.dumpLinkHrefsNearby!=null)throw new Error(`string-strip-html/stripHtml(): [THROW_ID_04] The Optional Options Object's key should be a plain object but it was given as type ${typeof e.dumpLinkHrefsNearby}, equal to ${JSON.stringify(e.dumpLinkHrefsNearby,null,4)}`)}else throw new TypeError(`string-strip-html/stripHtml(): [THROW_ID_02] Optional Options Object must be a plain object! Currently it's: ${(typeof e).toLowerCase()}, equal to:
${JSON.stringify(e,null,4)}`);function L(){E&&(m={tagName:"",hrefValue:"",openingTagEnds:void 0},E=!1)}let I={...qx,...e,dumpLinkHrefsNearby:Object.assign({},qx.dumpLinkHrefsNearby,e==null?void 0:e.dumpLinkHrefsNearby)};if(WO(I,"returnRangesOnly"))throw new TypeError("string-strip-html/stripHtml(): [THROW_ID_05] The Optional Options Object's key returnRangesOnly has been removed from the API since v.5 release.");if(I.reportProgressFunc){if(typeof I.reportProgressFuncFrom!="number")throw new Error(`string-strip-html/stripHtml(): [THROW_ID_06] The Optional Options Object's key reportProgressFuncFrom, callback function's "from" range, should be a number but it was given as type ${typeof I.reportProgressFuncFrom}, equal to ${JSON.stringify(I.reportProgressFuncFrom,null,4)}`);if(typeof I.reportProgressFuncTo!="number")throw new Error(`string-strip-html/stripHtml(): [THROW_ID_07] The Optional Options Object's key reportProgressFuncTo, callback function's "to" range, should be a number but it was given as type ${typeof I.reportProgressFuncTo}, equal to ${JSON.stringify(I.reportProgressFuncTo,null,4)}`)}I.ignoreTags=Ux(I.ignoreTags,"resolvedOpts.ignoreTags"),I.onlyStripTags=Ux(I.onlyStripTags,"resolvedOpts.onlyStripTags");let U=!!I.onlyStripTags.length;I.onlyStripTags.length&&I.ignoreTags.length&&(I.onlyStripTags=Qk(I.onlyStripTags,...I.ignoreTags)),I.stripTogetherWithTheirContents?typeof I.stripTogetherWithTheirContents=="string"&&I.stripTogetherWithTheirContents.length&&(I.stripTogetherWithTheirContents=[I.stripTogetherWithTheirContents]):I.stripTogetherWithTheirContents=[];let q={};if(I.stripTogetherWithTheirContents&&Array.isArray(I.stripTogetherWithTheirContents)&&I.stripTogetherWithTheirContents.length&&!I.stripTogetherWithTheirContents.every((B,se)=>typeof B!="string"?(q.el=B,q.i=se,!1):!0))throw new TypeError(`string-strip-html/stripHtml(): [THROW_ID_08] Optional Options Object's key stripTogetherWithTheirContents was set to contain not just string elements! For example, element at index ${q.i} has a value ${q.el} which is not string but ${(typeof q.el).toLowerCase()}.`);I.cb||(I.cb=({rangesArr:B,proposedReturn:se})=>{se&&B.push(...se)});let $=new p3({limitToBeAddedWhitespace:!0,limitLinebreaksCount:2});if(!I.skipHtmlDecoding)for(;i!==kx(i,{scope:"strict"});)i=kx(i,{scope:"strict"});let X=!1,ie=!1,ne=0,ue=0,re=i.length,V=Math.floor(re/2);for(let B=0;B<re;B++){if(I.reportProgressFunc&&(re>1e3&&re<2e3?B===V&&I.reportProgressFunc(Math.floor((I.reportProgressFuncTo-I.reportProgressFuncFrom)/2)):re>=2e3&&(ne=I.reportProgressFuncFrom+Math.floor(B/re*(I.reportProgressFuncTo-I.reportProgressFuncFrom)),ne!==ue&&(ue=ne,I.reportProgressFunc(ne)))),Object.keys(o).length>1&&o.lastClosingBracketAt&&o.lastClosingBracketAt<B&&i[B]!==" "&&x===null&&(x=B),!X&&i[B]==="%"&&i[B-1]==="{"&&i.includes("%}",B+1)){d=null;let se=i.indexOf("%}",B)-1;if(se>B){B=se;continue}}if(!X&&C(B)&&(!o||Object.keys(o).length<2)&&B>1){for(let se=B;se--;)if(i[se-1]===void 0||C(se)){let xe=i[se-1]===void 0?se:se+1,Ae=i.slice(xe,B+1)||"";if((Ae.includes("/>")||Ae.includes("/ >")||Ae.includes('="')||Ae.includes("='"))&&i!==`<${Mx(Ae.trim(),"/>")}>`&&[...pl].some(ge=>Mx(Ae.trim().split(/\s+/).filter(we=>we.trim()).filter((we,Me)=>Me===0),"/>").toLowerCase()===ge)&&Hx(`<${Ae.trim()}>`,I).result===""){(!s.length||s[s.length-1][0]!==o.lastOpeningBracketAt)&&s.push([xe,B+1]),(!a.length||a[a.length-1][0]!==o.lastOpeningBracketAt)&&a.push([xe,B+1]);let ge=_(i,B,xe,B+1,xe,B+1),we=B+1;if(i[we]&&!i[we].trim()){for(let Me=we;Me<re;Me++)if(i[Me].trim()){we=Me;break}}I.cb({tag:o,deleteFrom:xe,deleteTo:we,insert:ge,rangesArr:$,proposedReturn:[xe,we,ge]})}break}}if(!ie&&i[B]==="/"&&!((ve=o.quotes)!=null&&ve.value)&&Number.isInteger(o.lastOpeningBracketAt)&&!Number.isInteger(o.lastClosingBracketAt)&&(o.slashPresent=B),i[B]==='"'||i[B]==="'")if(!ie&&o.nameStarts&&((de=o==null?void 0:o.quotes)==null?void 0:de.value)===i[B])if(g.valueStarts===void 0)g={},delete o.quotes;else{g.valueEnds=B,g.value=i.slice(g.valueStarts,B),o.attributes.push(g),g={},delete o.quotes;let se;(De=I.dumpLinkHrefsNearby)!=null&&De.enabled&&!r.length&&o.attributes.some(xe=>{var Ae,ge;if(typeof xe.name=="string"&&xe.name.toLowerCase()==="href")return se=`${((Ae=I.dumpLinkHrefsNearby)==null?void 0:Ae.wrapHeads)||""}${xe.value}${((ge=I.dumpLinkHrefsNearby)==null?void 0:ge.wrapTails)||""}`,!0})&&(m={tagName:o.name,hrefValue:se,openingTagEnds:void 0})}else!ie&&!o.quotes&&o.nameStarts&&(o.quotes={},o.quotes.value=i[B],o.quotes.start=B,o.quotes.next=i.indexOf(i[B],B+1),g.nameStarts&&g.nameEnds&&g.nameEnds<B&&g.nameStarts<B&&!g.valueStarts&&(g.name=i.slice(g.nameStarts,g.nameEnds)));if(o.nameStarts!==void 0&&o.nameEnds===void 0&&(!i[B].trim()||!y3(i[B]))){if(o.nameEnds=B,o.name=i.slice(o.nameStarts,o.nameEnds+(!C(B)&&i[B]!=="/"&&i[B+1]===void 0?1:0)),i[o.nameStarts-1]!=="!"&&!o.name.replace(/-/g,"").length||/^\d+$/.test(o.name[0])){o={};continue}if(typeof o.name=="string"&&o.name.toLowerCase()==="doctype"&&(ie=!0),N(B)){F(I);let se=_(i,B,o.leftOuterWhitespace,B,o.lastOpeningBracketAt,B);(I.stripTogetherWithTheirContents.includes(o.name)||I.stripTogetherWithTheirContents.includes("*"))&&(a=a.filter(([xe,Ae])=>!(xe===o.leftOuterWhitespace&&Ae===B))),I.cb({tag:o,deleteFrom:o.leftOuterWhitespace,deleteTo:B,insert:`${se}${v}${se}`,rangesArr:$,proposedReturn:[o.leftOuterWhitespace,B,`${se}${v}${se}`]}),L(),R(B,I,$)}}if((Ie=o.quotes)!=null&&Ie.start&&o.quotes.start<B&&!o.quotes.end&&g.nameEnds&&g.equalsAt&&!g.valueStarts&&(g.valueStarts=B),!o.quotes&&g.nameEnds&&i[B]==="="&&!g.valueStarts&&!g.equalsAt&&(g.equalsAt=B),!o.quotes&&g.nameStarts&&g.nameEnds&&!g.valueStarts&&i[B].trim()&&i[B]!=="="&&(o.attributes.push(g),g={}),!o.quotes&&g.nameStarts&&!g.nameEnds&&(ie&&`'"`.includes(i[g.nameStarts])?g.nameStarts<B&&i[B]===i[g.nameStarts]&&(g.nameEnds=B+1,g.name=i.slice(g.nameStarts,g.nameEnds)):i[B].trim()?i[B]==="="?g.equalsAt||(g.nameEnds=B,g.equalsAt=B,g.name=i.slice(g.nameStarts,g.nameEnds)):i[B]==="/"||C(B)?(g.nameEnds=B,g.name=i.slice(g.nameStarts,g.nameEnds),o.attributes.push(g),g={}):N(B)&&(g.nameEnds=B,g.name=i.slice(g.nameStarts,g.nameEnds),o.attributes.push(g),g={}):(g.nameEnds=B,g.name=i.slice(g.nameStarts,g.nameEnds))),!o.quotes&&o.nameEnds<B&&!i[B-1].trim()&&i[B].trim()&&!"<>/!".includes(i[B])&&!g.nameStarts&&!o.lastClosingBracketAt&&(g.nameStarts=B),o.lastOpeningBracketAt!==null&&o.lastOpeningBracketAt<B&&i[B]==="/"&&o.onlyPlausible&&(o.onlyPlausible=!1),o.lastOpeningBracketAt!==null&&o.lastOpeningBracketAt<B&&i[B]!=="/"&&(o.onlyPlausible===void 0&&((!i[B].trim()||N(B))&&!o.slashPresent?o.onlyPlausible=!0:o.onlyPlausible=!1),i[B].trim()&&o.nameStarts===void 0&&!N(B)&&i[B]!=="/"&&!C(B)&&i[B]!=="!"&&(o.nameStarts=B,o.nameContainsLetters=!1)),o.nameStarts&&!o.quotes&&typeof i[B]=="string"&&i[B].toLowerCase()!==i[B].toUpperCase()&&(o.nameContainsLetters=!0),C(B)&&($x(o,i,B)||o.quotes.value&&typeof o.lastOpeningBracketAt=="number"&&v3(o.quotes.value,i.slice(o.lastOpeningBracketAt,B))%2===1&&!i.slice(o.lastOpeningBracketAt+1,B).includes("<")&&!i.slice(o.lastOpeningBracketAt+1,B).includes(">"))&&o.lastOpeningBracketAt!==void 0&&(o.lastClosingBracketAt=B,x=null,Object.keys(g).length&&(o.attributes.push(g),g={}),(Ne=I.dumpLinkHrefsNearby)!=null&&Ne.enabled&&m.tagName&&!m.openingTagEnds&&(m.openingTagEnds=B)),(!ie||i[B]===">")&&o.lastOpeningBracketAt!==void 0){if(o.lastClosingBracketAt===void 0){if(o.lastOpeningBracketAt<B&&!N(B)&&(i[B+1]===void 0||N(B+1)&&!((Be=o==null?void 0:o.quotes)!=null&&Be.value))&&o.nameContainsLetters&&typeof o.nameStarts=="number"){if(o.name=i.slice(o.nameStarts,o.nameEnds||B+1).toLowerCase(),(!s.length||s[s.length-1][0]!==o.lastOpeningBracketAt)&&s.push([o.lastOpeningBracketAt,B+1]),I.ignoreTags.includes(o.name)||M(B,I,o)||!pl.has(o.name)&&(o.onlyPlausible||I.stripRecognisedHTMLOnly)){o={},g={};continue}if((pl.has(o.name)||Ep.has(o.name))&&(o.onlyPlausible===!1||o.onlyPlausible===!0&&o.attributes.length)||i[B+1]===void 0){F(I);let se=_(i,B,o.leftOuterWhitespace,B+1,o.lastOpeningBracketAt,o.lastClosingBracketAt);X&&o.name==="script"&&o.slashPresent&&(X=!1);let xe;se===null||v===null?xe=null:xe=`${se}${v}${se}`,I.cb({tag:o,deleteFrom:o.leftOuterWhitespace,deleteTo:B+1,insert:xe,rangesArr:$,proposedReturn:[o.leftOuterWhitespace,B+1,xe]}),L(),R(B,I,$)}if(!a.length||a[a.length-1][0]!==o.lastOpeningBracketAt&&a[a.length-1][1]!==B+1)if(I.stripTogetherWithTheirContents.includes(o.name)||I.stripTogetherWithTheirContents.includes("*")){let se;for(let xe=r.length;xe--;)r[xe].name===o.name&&(se=r[xe]);se?(a=a.filter(([xe])=>xe!==se.lastOpeningBracketAt),a.push([se.lastOpeningBracketAt,B+1])):a.push([o.lastOpeningBracketAt,B+1])}else a.push([o.lastOpeningBracketAt,B+1])}}else if(B>o.lastClosingBracketAt&&i[B].trim()||i[B+1]===void 0||I.ignoreIndentations&&`\r
`.includes(i[B])){let se=o.lastClosingBracketAt===B?B+1:B;I.trimOnlySpaces&&se===re-1&&x!==null&&x<B&&(se=x),(!s.length||s[s.length-1][0]!==o.lastOpeningBracketAt)&&s.push([o.lastOpeningBracketAt,o.lastClosingBracketAt+1]);let xe=I.ignoreTags.includes(o.name),Ae=M(B,I,o);if(!T||I.stripRecognisedHTMLOnly&&typeof o.name=="string"&&!pl.has(o.name.toLowerCase())&&!Ep.has(o.name.toLowerCase())||!U&&(xe||Ae)||U&&!I.onlyStripTags.includes(o.name)||I.ignoreTagsWithTheirContents.includes(o.name)){if(Ae)if(o.slashPresent){for(let ge=n.length;ge--;)if(n[ge].name===o.name){n.splice(ge,1);break}n.length||(T=!0)}else T&&(T=!1),n.push(o);I.cb({tag:o,deleteFrom:null,deleteTo:null,insert:null,rangesArr:$,proposedReturn:null}),o={},g={}}else if(!o.onlyPlausible||o.attributes.length===0&&o.name&&(pl.has(o.name.toLowerCase())||Ep.has(o.name.toLowerCase()))||($e=o.attributes)!=null&&$e.some(ge=>ge.equalsAt)){(!a.length||a[a.length-1][0]!==o.lastOpeningBracketAt)&&a.push([o.lastOpeningBracketAt,o.lastClosingBracketAt+1]);let ge=_(i,B,o.leftOuterWhitespace,se,o.lastOpeningBracketAt,o.lastClosingBracketAt);v="",E=!1,F(I,se);let we;typeof v=="string"&&v.length?(we=`${ge}${v}${ge===`

`?`
`:ge}`,se===o.lastClosingBracketAt+1&&(!i[se]||!Ap.has(i[se]))&&(we+=" "),o.leftOuterWhitespace===o.lastOpeningBracketAt&&$.last()&&$.last()[1]<o.lastOpeningBracketAt&&(!((et=I==null?void 0:I.dumpLinkHrefsNearby)!=null&&et.putOnNewLine)||!Ap.has(i[se]))&&(we=" "+we)):we=ge,we!==null&&(o.leftOuterWhitespace===0||!on(i,se-1))&&(!((rt=I.dumpLinkHrefsNearby)!=null&&rt.enabled)||o.name!=="a")&&(we=void 0);let Me=0;if(E&&Ap.has(i[se])){(Ge=I.dumpLinkHrefsNearby)!=null&&Ge.putOnNewLine&&(we=`${i[se]}${we||""}`);let le=on(i,se);le&&(we!=null&&we.endsWith(`
`))?Me+=le-B:(!le||le>B)&&Me++}I.cb({tag:o,deleteFrom:o.leftOuterWhitespace,deleteTo:se+Me,insert:we,rangesArr:$,proposedReturn:[o.leftOuterWhitespace,se+Me,we]}),L(),R(B,I,$)}else o={};C(B)||(o={})}ie&&(ie=!1)}if((!X||i[B]==="<"&&on(i,on(i,B))&&i[on(i,B)]==="/"&&i.startsWith("script",on(i,on(i,B))))&&N(B)&&!N(B-1)&&!`'"`.includes(i[B+1])&&(!`'"`.includes(i[B+2])||/\w/.test(i[B+1]))&&!(i[B+1]==="c"&&i[B+2]===":")&&!(i[B+1]==="f"&&i[B+2]==="m"&&i[B+3]==="t"&&i[B+4]===":")&&!(i[B+1]==="s"&&i[B+2]==="q"&&i[B+3]==="l"&&i[B+4]===":")&&!(i[B+1]==="x"&&i[B+2]===":")&&!(i[B+1]==="f"&&i[B+2]==="n"&&i[B+3]===":")&&$x(o,i,B)){if(C(on(i,B)))continue;if(o.nameEnds&&o.nameEnds<B&&!o.lastClosingBracketAt&&(o.onlyPlausible===!0&&((nt=o.attributes)!=null&&nt.length)||o.onlyPlausible===!1)){let se=_(i,B,o.leftOuterWhitespace,B,o.lastOpeningBracketAt,B);I.cb({tag:o,deleteFrom:o.leftOuterWhitespace,deleteTo:B,insert:se,rangesArr:$,proposedReturn:[o.leftOuterWhitespace,B,se]}),R(B,I,$),o={},g={}}if(o.lastOpeningBracketAt!==void 0&&o.onlyPlausible&&o.name&&!o.quotes&&(o.lastOpeningBracketAt=void 0,o.name=void 0,o.onlyPlausible=!1),(o.lastOpeningBracketAt===void 0||!o.onlyPlausible)&&!o.quotes&&(o.lastOpeningBracketAt=B,o.slashPresent=!1,o.attributes=[],l===null?o.leftOuterWhitespace=B:I.trimOnlySpaces&&l===0?o.leftOuterWhitespace=h||B:o.leftOuterWhitespace=l,`${i[B+1]}${i[B+2]}${i[B+3]}`=="!--"||`${i[B+1]}${i[B+2]}${i[B+3]}${i[B+4]}${i[B+5]}${i[B+6]}${i[B+7]}${i[B+8]}`=="![CDATA[")){let se=!0;i[B+2]==="-"&&(se=!1);let xe;for(let Ae=B;Ae<re;Ae++)if((!xe&&se&&`${i[Ae-2]}${i[Ae-1]}${i[Ae]}`=="]]>"||!se&&`${i[Ae-2]}${i[Ae-1]}${i[Ae]}`=="-->")&&(xe=Ae),xe&&(xe<Ae&&i[Ae].trim()||i[Ae+1]===void 0)){let ge=Ae;(i[Ae+1]===void 0&&!i[Ae].trim()||i[Ae]===">")&&(ge+=1),(!s.length||s[s.length-1][0]!==o.lastOpeningBracketAt)&&s.push([o.lastOpeningBracketAt,xe+1]),(!a.length||a[a.length-1][0]!==o.lastOpeningBracketAt)&&a.push([o.lastOpeningBracketAt,xe+1]);let we=_(i,Ae,o.leftOuterWhitespace,ge,o.lastOpeningBracketAt,xe);I.cb({tag:o,deleteFrom:o.leftOuterWhitespace,deleteTo:ge,insert:we,rangesArr:$,proposedReturn:[o.leftOuterWhitespace,ge,we]}),B=Ae-1,i[Ae]===">"&&(B=Ae),o={},g={};break}}}!i[B].trim()||i[B].charCodeAt(0)===847?(l===null&&(l=B,o.lastOpeningBracketAt!==void 0&&o.lastOpeningBracketAt<B&&o.nameStarts&&o.nameStarts<o.lastOpeningBracketAt&&B===o.lastOpeningBracketAt+1&&!r.some(se=>se.name===o.name)&&(o.onlyPlausible=!0,o.name=void 0,o.nameStarts=void 0)),(i[B]===`
`||i[B]==="\r")&&(d=B,p&&(p=!1))):(l!==null&&(!o.quotes&&g.equalsAt>l-1&&g.nameEnds&&g.equalsAt>g.nameEnds&&i[B]!=='"'&&i[B]!=="'"&&(sp(g)&&o.attributes.push(g),g={},o.equalsSpottedAt=void 0),l=null),p||(p=!0,T&&!X&&typeof d=="number"&&B&&d<B-1&&(i.slice(d+1,B).trim()?d=null:I.ignoreIndentations||$.push([d+1,B])))),i[B]===" "?h===null&&(h=B):h!==null&&(h=null),o.name==="script"&&(X=!o.slashPresent)}if(i&&!I.ignoreIndentations&&(I.trimOnlySpaces&&i[0]===" "||!I.trimOnlySpaces&&!i[0].trim()))for(let B=0;B<re;B++)if(I.trimOnlySpaces&&i[B]!==" "||!I.trimOnlySpaces&&i[B].trim()){$.push([0,B]);break}else i[B+1]||$.push([0,B+1]);if(i&&(I.trimOnlySpaces&&i[~-i.length]===" "||!I.trimOnlySpaces&&!i[~-i.length].trim())){for(let B=i.length;B--;)if(I.trimOnlySpaces&&i[B]!==" "||!I.trimOnlySpaces&&i[B].trim()){$.push([B+1,re]);break}}let J=$.current();if(!(e!=null&&e.cb)&&J&&(J[0]&&!J[0][0]&&(J[0][1],$.ranges[0]=[$.ranges[0][0],$.ranges[0][1]]),J[J.length-1]&&J[J.length-1][1]===i.length&&(J[J.length-1][0],$.ranges))){let B=$.ranges[$.ranges.length-1][0];i[B-1]&&(I.trimOnlySpaces&&i[B-1]===" "||!I.trimOnlySpaces&&!i[B-1].trim())&&(B-=1);let se=$.ranges[$.ranges.length-1][2];$.ranges[$.ranges.length-1]=[B,$.ranges[$.ranges.length-1][1]],se!=null&&se.trim()&&$.ranges[$.ranges.length-1].push(se.trimEnd())}return{log:{timeTakenInMilliseconds:Date.now()-t},result:d3(i,$.current()),ranges:$.current(),allTagLocations:s,filteredTagLocations:a}}var ml={exports:{}};/*! https://mths.be/he v1.2.0 by @mathias | MIT license */var A3=ml.exports,Vx;function x3(){return Vx||(Vx=1,function(i,e){(function(t){var r=e,n=i&&i.exports==r&&i,s=typeof Ci=="object"&&Ci;(s.global===s||s.window===s)&&(t=s);var a=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,o=/[\x01-\x7F]/g,u=/[\x01-\t\x0B\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,l=/<\u20D2|=\u20E5|>\u20D2|\u205F\u200A|\u219D\u0338|\u2202\u0338|\u2220\u20D2|\u2229\uFE00|\u222A\uFE00|\u223C\u20D2|\u223D\u0331|\u223E\u0333|\u2242\u0338|\u224B\u0338|\u224D\u20D2|\u224E\u0338|\u224F\u0338|\u2250\u0338|\u2261\u20E5|\u2264\u20D2|\u2265\u20D2|\u2266\u0338|\u2267\u0338|\u2268\uFE00|\u2269\uFE00|\u226A\u0338|\u226A\u20D2|\u226B\u0338|\u226B\u20D2|\u227F\u0338|\u2282\u20D2|\u2283\u20D2|\u228A\uFE00|\u228B\uFE00|\u228F\u0338|\u2290\u0338|\u2293\uFE00|\u2294\uFE00|\u22B4\u20D2|\u22B5\u20D2|\u22D8\u0338|\u22D9\u0338|\u22DA\uFE00|\u22DB\uFE00|\u22F5\u0338|\u22F9\u0338|\u2933\u0338|\u29CF\u0338|\u29D0\u0338|\u2A6D\u0338|\u2A70\u0338|\u2A7D\u0338|\u2A7E\u0338|\u2AA1\u0338|\u2AA2\u0338|\u2AAC\uFE00|\u2AAD\uFE00|\u2AAF\u0338|\u2AB0\u0338|\u2AC5\u0338|\u2AC6\u0338|\u2ACB\uFE00|\u2ACC\uFE00|\u2AFD\u20E5|[\xA0-\u0113\u0116-\u0122\u0124-\u012B\u012E-\u014D\u0150-\u017E\u0192\u01B5\u01F5\u0237\u02C6\u02C7\u02D8-\u02DD\u0311\u0391-\u03A1\u03A3-\u03A9\u03B1-\u03C9\u03D1\u03D2\u03D5\u03D6\u03DC\u03DD\u03F0\u03F1\u03F5\u03F6\u0401-\u040C\u040E-\u044F\u0451-\u045C\u045E\u045F\u2002-\u2005\u2007-\u2010\u2013-\u2016\u2018-\u201A\u201C-\u201E\u2020-\u2022\u2025\u2026\u2030-\u2035\u2039\u203A\u203E\u2041\u2043\u2044\u204F\u2057\u205F-\u2063\u20AC\u20DB\u20DC\u2102\u2105\u210A-\u2113\u2115-\u211E\u2122\u2124\u2127-\u2129\u212C\u212D\u212F-\u2131\u2133-\u2138\u2145-\u2148\u2153-\u215E\u2190-\u219B\u219D-\u21A7\u21A9-\u21AE\u21B0-\u21B3\u21B5-\u21B7\u21BA-\u21DB\u21DD\u21E4\u21E5\u21F5\u21FD-\u2205\u2207-\u2209\u220B\u220C\u220F-\u2214\u2216-\u2218\u221A\u221D-\u2238\u223A-\u2257\u2259\u225A\u225C\u225F-\u2262\u2264-\u228B\u228D-\u229B\u229D-\u22A5\u22A7-\u22B0\u22B2-\u22BB\u22BD-\u22DB\u22DE-\u22E3\u22E6-\u22F7\u22F9-\u22FE\u2305\u2306\u2308-\u2310\u2312\u2313\u2315\u2316\u231C-\u231F\u2322\u2323\u232D\u232E\u2336\u233D\u233F\u237C\u23B0\u23B1\u23B4-\u23B6\u23DC-\u23DF\u23E2\u23E7\u2423\u24C8\u2500\u2502\u250C\u2510\u2514\u2518\u251C\u2524\u252C\u2534\u253C\u2550-\u256C\u2580\u2584\u2588\u2591-\u2593\u25A1\u25AA\u25AB\u25AD\u25AE\u25B1\u25B3-\u25B5\u25B8\u25B9\u25BD-\u25BF\u25C2\u25C3\u25CA\u25CB\u25EC\u25EF\u25F8-\u25FC\u2605\u2606\u260E\u2640\u2642\u2660\u2663\u2665\u2666\u266A\u266D-\u266F\u2713\u2717\u2720\u2736\u2758\u2772\u2773\u27C8\u27C9\u27E6-\u27ED\u27F5-\u27FA\u27FC\u27FF\u2902-\u2905\u290C-\u2913\u2916\u2919-\u2920\u2923-\u292A\u2933\u2935-\u2939\u293C\u293D\u2945\u2948-\u294B\u294E-\u2976\u2978\u2979\u297B-\u297F\u2985\u2986\u298B-\u2996\u299A\u299C\u299D\u29A4-\u29B7\u29B9\u29BB\u29BC\u29BE-\u29C5\u29C9\u29CD-\u29D0\u29DC-\u29DE\u29E3-\u29E5\u29EB\u29F4\u29F6\u2A00-\u2A02\u2A04\u2A06\u2A0C\u2A0D\u2A10-\u2A17\u2A22-\u2A27\u2A29\u2A2A\u2A2D-\u2A31\u2A33-\u2A3C\u2A3F\u2A40\u2A42-\u2A4D\u2A50\u2A53-\u2A58\u2A5A-\u2A5D\u2A5F\u2A66\u2A6A\u2A6D-\u2A75\u2A77-\u2A9A\u2A9D-\u2AA2\u2AA4-\u2AB0\u2AB3-\u2AC8\u2ACB\u2ACC\u2ACF-\u2ADB\u2AE4\u2AE6-\u2AE9\u2AEB-\u2AF3\u2AFD\uFB00-\uFB04]|\uD835[\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDD6B]/g,h={"­":"shy","‌":"zwnj","‍":"zwj","‎":"lrm","⁣":"ic","⁢":"it","⁡":"af","‏":"rlm","​":"ZeroWidthSpace","⁠":"NoBreak","̑":"DownBreve","⃛":"tdot","⃜":"DotDot","	":"Tab","\n":"NewLine"," ":"puncsp"," ":"MediumSpace"," ":"thinsp"," ":"hairsp"," ":"emsp13"," ":"ensp"," ":"emsp14"," ":"emsp"," ":"numsp"," ":"nbsp","  ":"ThickSpace","‾":"oline",_:"lowbar","‐":"dash","–":"ndash","—":"mdash","―":"horbar",",":"comma",";":"semi","⁏":"bsemi",":":"colon","⩴":"Colone","!":"excl","¡":"iexcl","?":"quest","¿":"iquest",".":"period","‥":"nldr","…":"mldr","·":"middot","'":"apos","‘":"lsquo","’":"rsquo","‚":"sbquo","‹":"lsaquo","›":"rsaquo",'"':"quot","“":"ldquo","”":"rdquo","„":"bdquo","«":"laquo","»":"raquo","(":"lpar",")":"rpar","[":"lsqb","]":"rsqb","{":"lcub","}":"rcub","⌈":"lceil","⌉":"rceil","⌊":"lfloor","⌋":"rfloor","⦅":"lopar","⦆":"ropar","⦋":"lbrke","⦌":"rbrke","⦍":"lbrkslu","⦎":"rbrksld","⦏":"lbrksld","⦐":"rbrkslu","⦑":"langd","⦒":"rangd","⦓":"lparlt","⦔":"rpargt","⦕":"gtlPar","⦖":"ltrPar","⟦":"lobrk","⟧":"robrk","⟨":"lang","⟩":"rang","⟪":"Lang","⟫":"Rang","⟬":"loang","⟭":"roang","❲":"lbbrk","❳":"rbbrk","‖":"Vert","§":"sect","¶":"para","@":"commat","*":"ast","/":"sol",undefined:null,"&":"amp","#":"num","%":"percnt","‰":"permil","‱":"pertenk","†":"dagger","‡":"Dagger","•":"bull","⁃":"hybull","′":"prime","″":"Prime","‴":"tprime","⁗":"qprime","‵":"bprime","⁁":"caret","`":"grave","´":"acute","˜":"tilde","^":"Hat","¯":"macr","˘":"breve","˙":"dot","¨":"die","˚":"ring","˝":"dblac","¸":"cedil","˛":"ogon","ˆ":"circ","ˇ":"caron","°":"deg","©":"copy","®":"reg","℗":"copysr","℘":"wp","℞":"rx","℧":"mho","℩":"iiota","←":"larr","↚":"nlarr","→":"rarr","↛":"nrarr","↑":"uarr","↓":"darr","↔":"harr","↮":"nharr","↕":"varr","↖":"nwarr","↗":"nearr","↘":"searr","↙":"swarr","↝":"rarrw","↝̸":"nrarrw","↞":"Larr","↟":"Uarr","↠":"Rarr","↡":"Darr","↢":"larrtl","↣":"rarrtl","↤":"mapstoleft","↥":"mapstoup","↦":"map","↧":"mapstodown","↩":"larrhk","↪":"rarrhk","↫":"larrlp","↬":"rarrlp","↭":"harrw","↰":"lsh","↱":"rsh","↲":"ldsh","↳":"rdsh","↵":"crarr","↶":"cularr","↷":"curarr","↺":"olarr","↻":"orarr","↼":"lharu","↽":"lhard","↾":"uharr","↿":"uharl","⇀":"rharu","⇁":"rhard","⇂":"dharr","⇃":"dharl","⇄":"rlarr","⇅":"udarr","⇆":"lrarr","⇇":"llarr","⇈":"uuarr","⇉":"rrarr","⇊":"ddarr","⇋":"lrhar","⇌":"rlhar","⇐":"lArr","⇍":"nlArr","⇑":"uArr","⇒":"rArr","⇏":"nrArr","⇓":"dArr","⇔":"iff","⇎":"nhArr","⇕":"vArr","⇖":"nwArr","⇗":"neArr","⇘":"seArr","⇙":"swArr","⇚":"lAarr","⇛":"rAarr","⇝":"zigrarr","⇤":"larrb","⇥":"rarrb","⇵":"duarr","⇽":"loarr","⇾":"roarr","⇿":"hoarr","∀":"forall","∁":"comp","∂":"part","∂̸":"npart","∃":"exist","∄":"nexist","∅":"empty","∇":"Del","∈":"in","∉":"notin","∋":"ni","∌":"notni","϶":"bepsi","∏":"prod","∐":"coprod","∑":"sum","+":"plus","±":"pm","÷":"div","×":"times","<":"lt","≮":"nlt","<⃒":"nvlt","=":"equals","≠":"ne","=⃥":"bne","⩵":"Equal",">":"gt","≯":"ngt",">⃒":"nvgt","¬":"not","|":"vert","¦":"brvbar","−":"minus","∓":"mp","∔":"plusdo","⁄":"frasl","∖":"setmn","∗":"lowast","∘":"compfn","√":"Sqrt","∝":"prop","∞":"infin","∟":"angrt","∠":"ang","∠⃒":"nang","∡":"angmsd","∢":"angsph","∣":"mid","∤":"nmid","∥":"par","∦":"npar","∧":"and","∨":"or","∩":"cap","∩︀":"caps","∪":"cup","∪︀":"cups","∫":"int","∬":"Int","∭":"tint","⨌":"qint","∮":"oint","∯":"Conint","∰":"Cconint","∱":"cwint","∲":"cwconint","∳":"awconint","∴":"there4","∵":"becaus","∶":"ratio","∷":"Colon","∸":"minusd","∺":"mDDot","∻":"homtht","∼":"sim","≁":"nsim","∼⃒":"nvsim","∽":"bsim","∽̱":"race","∾":"ac","∾̳":"acE","∿":"acd","≀":"wr","≂":"esim","≂̸":"nesim","≃":"sime","≄":"nsime","≅":"cong","≇":"ncong","≆":"simne","≈":"ap","≉":"nap","≊":"ape","≋":"apid","≋̸":"napid","≌":"bcong","≍":"CupCap","≭":"NotCupCap","≍⃒":"nvap","≎":"bump","≎̸":"nbump","≏":"bumpe","≏̸":"nbumpe","≐":"doteq","≐̸":"nedot","≑":"eDot","≒":"efDot","≓":"erDot","≔":"colone","≕":"ecolon","≖":"ecir","≗":"cire","≙":"wedgeq","≚":"veeeq","≜":"trie","≟":"equest","≡":"equiv","≢":"nequiv","≡⃥":"bnequiv","≤":"le","≰":"nle","≤⃒":"nvle","≥":"ge","≱":"nge","≥⃒":"nvge","≦":"lE","≦̸":"nlE","≧":"gE","≧̸":"ngE","≨︀":"lvnE","≨":"lnE","≩":"gnE","≩︀":"gvnE","≪":"ll","≪̸":"nLtv","≪⃒":"nLt","≫":"gg","≫̸":"nGtv","≫⃒":"nGt","≬":"twixt","≲":"lsim","≴":"nlsim","≳":"gsim","≵":"ngsim","≶":"lg","≸":"ntlg","≷":"gl","≹":"ntgl","≺":"pr","⊀":"npr","≻":"sc","⊁":"nsc","≼":"prcue","⋠":"nprcue","≽":"sccue","⋡":"nsccue","≾":"prsim","≿":"scsim","≿̸":"NotSucceedsTilde","⊂":"sub","⊄":"nsub","⊂⃒":"vnsub","⊃":"sup","⊅":"nsup","⊃⃒":"vnsup","⊆":"sube","⊈":"nsube","⊇":"supe","⊉":"nsupe","⊊︀":"vsubne","⊊":"subne","⊋︀":"vsupne","⊋":"supne","⊍":"cupdot","⊎":"uplus","⊏":"sqsub","⊏̸":"NotSquareSubset","⊐":"sqsup","⊐̸":"NotSquareSuperset","⊑":"sqsube","⋢":"nsqsube","⊒":"sqsupe","⋣":"nsqsupe","⊓":"sqcap","⊓︀":"sqcaps","⊔":"sqcup","⊔︀":"sqcups","⊕":"oplus","⊖":"ominus","⊗":"otimes","⊘":"osol","⊙":"odot","⊚":"ocir","⊛":"oast","⊝":"odash","⊞":"plusb","⊟":"minusb","⊠":"timesb","⊡":"sdotb","⊢":"vdash","⊬":"nvdash","⊣":"dashv","⊤":"top","⊥":"bot","⊧":"models","⊨":"vDash","⊭":"nvDash","⊩":"Vdash","⊮":"nVdash","⊪":"Vvdash","⊫":"VDash","⊯":"nVDash","⊰":"prurel","⊲":"vltri","⋪":"nltri","⊳":"vrtri","⋫":"nrtri","⊴":"ltrie","⋬":"nltrie","⊴⃒":"nvltrie","⊵":"rtrie","⋭":"nrtrie","⊵⃒":"nvrtrie","⊶":"origof","⊷":"imof","⊸":"mumap","⊹":"hercon","⊺":"intcal","⊻":"veebar","⊽":"barvee","⊾":"angrtvb","⊿":"lrtri","⋀":"Wedge","⋁":"Vee","⋂":"xcap","⋃":"xcup","⋄":"diam","⋅":"sdot","⋆":"Star","⋇":"divonx","⋈":"bowtie","⋉":"ltimes","⋊":"rtimes","⋋":"lthree","⋌":"rthree","⋍":"bsime","⋎":"cuvee","⋏":"cuwed","⋐":"Sub","⋑":"Sup","⋒":"Cap","⋓":"Cup","⋔":"fork","⋕":"epar","⋖":"ltdot","⋗":"gtdot","⋘":"Ll","⋘̸":"nLl","⋙":"Gg","⋙̸":"nGg","⋚︀":"lesg","⋚":"leg","⋛":"gel","⋛︀":"gesl","⋞":"cuepr","⋟":"cuesc","⋦":"lnsim","⋧":"gnsim","⋨":"prnsim","⋩":"scnsim","⋮":"vellip","⋯":"ctdot","⋰":"utdot","⋱":"dtdot","⋲":"disin","⋳":"isinsv","⋴":"isins","⋵":"isindot","⋵̸":"notindot","⋶":"notinvc","⋷":"notinvb","⋹":"isinE","⋹̸":"notinE","⋺":"nisd","⋻":"xnis","⋼":"nis","⋽":"notnivc","⋾":"notnivb","⌅":"barwed","⌆":"Barwed","⌌":"drcrop","⌍":"dlcrop","⌎":"urcrop","⌏":"ulcrop","⌐":"bnot","⌒":"profline","⌓":"profsurf","⌕":"telrec","⌖":"target","⌜":"ulcorn","⌝":"urcorn","⌞":"dlcorn","⌟":"drcorn","⌢":"frown","⌣":"smile","⌭":"cylcty","⌮":"profalar","⌶":"topbot","⌽":"ovbar","⌿":"solbar","⍼":"angzarr","⎰":"lmoust","⎱":"rmoust","⎴":"tbrk","⎵":"bbrk","⎶":"bbrktbrk","⏜":"OverParenthesis","⏝":"UnderParenthesis","⏞":"OverBrace","⏟":"UnderBrace","⏢":"trpezium","⏧":"elinters","␣":"blank","─":"boxh","│":"boxv","┌":"boxdr","┐":"boxdl","└":"boxur","┘":"boxul","├":"boxvr","┤":"boxvl","┬":"boxhd","┴":"boxhu","┼":"boxvh","═":"boxH","║":"boxV","╒":"boxdR","╓":"boxDr","╔":"boxDR","╕":"boxdL","╖":"boxDl","╗":"boxDL","╘":"boxuR","╙":"boxUr","╚":"boxUR","╛":"boxuL","╜":"boxUl","╝":"boxUL","╞":"boxvR","╟":"boxVr","╠":"boxVR","╡":"boxvL","╢":"boxVl","╣":"boxVL","╤":"boxHd","╥":"boxhD","╦":"boxHD","╧":"boxHu","╨":"boxhU","╩":"boxHU","╪":"boxvH","╫":"boxVh","╬":"boxVH","▀":"uhblk","▄":"lhblk","█":"block","░":"blk14","▒":"blk12","▓":"blk34","□":"squ","▪":"squf","▫":"EmptyVerySmallSquare","▭":"rect","▮":"marker","▱":"fltns","△":"xutri","▴":"utrif","▵":"utri","▸":"rtrif","▹":"rtri","▽":"xdtri","▾":"dtrif","▿":"dtri","◂":"ltrif","◃":"ltri","◊":"loz","○":"cir","◬":"tridot","◯":"xcirc","◸":"ultri","◹":"urtri","◺":"lltri","◻":"EmptySmallSquare","◼":"FilledSmallSquare","★":"starf","☆":"star","☎":"phone","♀":"female","♂":"male","♠":"spades","♣":"clubs","♥":"hearts","♦":"diams","♪":"sung","✓":"check","✗":"cross","✠":"malt","✶":"sext","❘":"VerticalSeparator","⟈":"bsolhsub","⟉":"suphsol","⟵":"xlarr","⟶":"xrarr","⟷":"xharr","⟸":"xlArr","⟹":"xrArr","⟺":"xhArr","⟼":"xmap","⟿":"dzigrarr","⤂":"nvlArr","⤃":"nvrArr","⤄":"nvHarr","⤅":"Map","⤌":"lbarr","⤍":"rbarr","⤎":"lBarr","⤏":"rBarr","⤐":"RBarr","⤑":"DDotrahd","⤒":"UpArrowBar","⤓":"DownArrowBar","⤖":"Rarrtl","⤙":"latail","⤚":"ratail","⤛":"lAtail","⤜":"rAtail","⤝":"larrfs","⤞":"rarrfs","⤟":"larrbfs","⤠":"rarrbfs","⤣":"nwarhk","⤤":"nearhk","⤥":"searhk","⤦":"swarhk","⤧":"nwnear","⤨":"toea","⤩":"tosa","⤪":"swnwar","⤳":"rarrc","⤳̸":"nrarrc","⤵":"cudarrr","⤶":"ldca","⤷":"rdca","⤸":"cudarrl","⤹":"larrpl","⤼":"curarrm","⤽":"cularrp","⥅":"rarrpl","⥈":"harrcir","⥉":"Uarrocir","⥊":"lurdshar","⥋":"ldrushar","⥎":"LeftRightVector","⥏":"RightUpDownVector","⥐":"DownLeftRightVector","⥑":"LeftUpDownVector","⥒":"LeftVectorBar","⥓":"RightVectorBar","⥔":"RightUpVectorBar","⥕":"RightDownVectorBar","⥖":"DownLeftVectorBar","⥗":"DownRightVectorBar","⥘":"LeftUpVectorBar","⥙":"LeftDownVectorBar","⥚":"LeftTeeVector","⥛":"RightTeeVector","⥜":"RightUpTeeVector","⥝":"RightDownTeeVector","⥞":"DownLeftTeeVector","⥟":"DownRightTeeVector","⥠":"LeftUpTeeVector","⥡":"LeftDownTeeVector","⥢":"lHar","⥣":"uHar","⥤":"rHar","⥥":"dHar","⥦":"luruhar","⥧":"ldrdhar","⥨":"ruluhar","⥩":"rdldhar","⥪":"lharul","⥫":"llhard","⥬":"rharul","⥭":"lrhard","⥮":"udhar","⥯":"duhar","⥰":"RoundImplies","⥱":"erarr","⥲":"simrarr","⥳":"larrsim","⥴":"rarrsim","⥵":"rarrap","⥶":"ltlarr","⥸":"gtrarr","⥹":"subrarr","⥻":"suplarr","⥼":"lfisht","⥽":"rfisht","⥾":"ufisht","⥿":"dfisht","⦚":"vzigzag","⦜":"vangrt","⦝":"angrtvbd","⦤":"ange","⦥":"range","⦦":"dwangle","⦧":"uwangle","⦨":"angmsdaa","⦩":"angmsdab","⦪":"angmsdac","⦫":"angmsdad","⦬":"angmsdae","⦭":"angmsdaf","⦮":"angmsdag","⦯":"angmsdah","⦰":"bemptyv","⦱":"demptyv","⦲":"cemptyv","⦳":"raemptyv","⦴":"laemptyv","⦵":"ohbar","⦶":"omid","⦷":"opar","⦹":"operp","⦻":"olcross","⦼":"odsold","⦾":"olcir","⦿":"ofcir","⧀":"olt","⧁":"ogt","⧂":"cirscir","⧃":"cirE","⧄":"solb","⧅":"bsolb","⧉":"boxbox","⧍":"trisb","⧎":"rtriltri","⧏":"LeftTriangleBar","⧏̸":"NotLeftTriangleBar","⧐":"RightTriangleBar","⧐̸":"NotRightTriangleBar","⧜":"iinfin","⧝":"infintie","⧞":"nvinfin","⧣":"eparsl","⧤":"smeparsl","⧥":"eqvparsl","⧫":"lozf","⧴":"RuleDelayed","⧶":"dsol","⨀":"xodot","⨁":"xoplus","⨂":"xotime","⨄":"xuplus","⨆":"xsqcup","⨍":"fpartint","⨐":"cirfnint","⨑":"awint","⨒":"rppolint","⨓":"scpolint","⨔":"npolint","⨕":"pointint","⨖":"quatint","⨗":"intlarhk","⨢":"pluscir","⨣":"plusacir","⨤":"simplus","⨥":"plusdu","⨦":"plussim","⨧":"plustwo","⨩":"mcomma","⨪":"minusdu","⨭":"loplus","⨮":"roplus","⨯":"Cross","⨰":"timesd","⨱":"timesbar","⨳":"smashp","⨴":"lotimes","⨵":"rotimes","⨶":"otimesas","⨷":"Otimes","⨸":"odiv","⨹":"triplus","⨺":"triminus","⨻":"tritime","⨼":"iprod","⨿":"amalg","⩀":"capdot","⩂":"ncup","⩃":"ncap","⩄":"capand","⩅":"cupor","⩆":"cupcap","⩇":"capcup","⩈":"cupbrcap","⩉":"capbrcup","⩊":"cupcup","⩋":"capcap","⩌":"ccups","⩍":"ccaps","⩐":"ccupssm","⩓":"And","⩔":"Or","⩕":"andand","⩖":"oror","⩗":"orslope","⩘":"andslope","⩚":"andv","⩛":"orv","⩜":"andd","⩝":"ord","⩟":"wedbar","⩦":"sdote","⩪":"simdot","⩭":"congdot","⩭̸":"ncongdot","⩮":"easter","⩯":"apacir","⩰":"apE","⩰̸":"napE","⩱":"eplus","⩲":"pluse","⩳":"Esim","⩷":"eDDot","⩸":"equivDD","⩹":"ltcir","⩺":"gtcir","⩻":"ltquest","⩼":"gtquest","⩽":"les","⩽̸":"nles","⩾":"ges","⩾̸":"nges","⩿":"lesdot","⪀":"gesdot","⪁":"lesdoto","⪂":"gesdoto","⪃":"lesdotor","⪄":"gesdotol","⪅":"lap","⪆":"gap","⪇":"lne","⪈":"gne","⪉":"lnap","⪊":"gnap","⪋":"lEg","⪌":"gEl","⪍":"lsime","⪎":"gsime","⪏":"lsimg","⪐":"gsiml","⪑":"lgE","⪒":"glE","⪓":"lesges","⪔":"gesles","⪕":"els","⪖":"egs","⪗":"elsdot","⪘":"egsdot","⪙":"el","⪚":"eg","⪝":"siml","⪞":"simg","⪟":"simlE","⪠":"simgE","⪡":"LessLess","⪡̸":"NotNestedLessLess","⪢":"GreaterGreater","⪢̸":"NotNestedGreaterGreater","⪤":"glj","⪥":"gla","⪦":"ltcc","⪧":"gtcc","⪨":"lescc","⪩":"gescc","⪪":"smt","⪫":"lat","⪬":"smte","⪬︀":"smtes","⪭":"late","⪭︀":"lates","⪮":"bumpE","⪯":"pre","⪯̸":"npre","⪰":"sce","⪰̸":"nsce","⪳":"prE","⪴":"scE","⪵":"prnE","⪶":"scnE","⪷":"prap","⪸":"scap","⪹":"prnap","⪺":"scnap","⪻":"Pr","⪼":"Sc","⪽":"subdot","⪾":"supdot","⪿":"subplus","⫀":"supplus","⫁":"submult","⫂":"supmult","⫃":"subedot","⫄":"supedot","⫅":"subE","⫅̸":"nsubE","⫆":"supE","⫆̸":"nsupE","⫇":"subsim","⫈":"supsim","⫋︀":"vsubnE","⫋":"subnE","⫌︀":"vsupnE","⫌":"supnE","⫏":"csub","⫐":"csup","⫑":"csube","⫒":"csupe","⫓":"subsup","⫔":"supsub","⫕":"subsub","⫖":"supsup","⫗":"suphsub","⫘":"supdsub","⫙":"forkv","⫚":"topfork","⫛":"mlcp","⫤":"Dashv","⫦":"Vdashl","⫧":"Barv","⫨":"vBar","⫩":"vBarv","⫫":"Vbar","⫬":"Not","⫭":"bNot","⫮":"rnmid","⫯":"cirmid","⫰":"midcir","⫱":"topcir","⫲":"nhpar","⫳":"parsim","⫽":"parsl","⫽⃥":"nparsl","♭":"flat","♮":"natur","♯":"sharp","¤":"curren","¢":"cent",$:"dollar","£":"pound","¥":"yen","€":"euro","¹":"sup1","½":"half","⅓":"frac13","¼":"frac14","⅕":"frac15","⅙":"frac16","⅛":"frac18","²":"sup2","⅔":"frac23","⅖":"frac25","³":"sup3","¾":"frac34","⅗":"frac35","⅜":"frac38","⅘":"frac45","⅚":"frac56","⅝":"frac58","⅞":"frac78","𝒶":"ascr","𝕒":"aopf","𝔞":"afr","𝔸":"Aopf","𝔄":"Afr","𝒜":"Ascr",ª:"ordf",á:"aacute",Á:"Aacute",à:"agrave",À:"Agrave",ă:"abreve",Ă:"Abreve",â:"acirc",Â:"Acirc",å:"aring",Å:"angst",ä:"auml",Ä:"Auml",ã:"atilde",Ã:"Atilde",ą:"aogon",Ą:"Aogon",ā:"amacr",Ā:"Amacr",æ:"aelig",Æ:"AElig","𝒷":"bscr","𝕓":"bopf","𝔟":"bfr","𝔹":"Bopf",ℬ:"Bscr","𝔅":"Bfr","𝔠":"cfr","𝒸":"cscr","𝕔":"copf",ℭ:"Cfr","𝒞":"Cscr",ℂ:"Copf",ć:"cacute",Ć:"Cacute",ĉ:"ccirc",Ĉ:"Ccirc",č:"ccaron",Č:"Ccaron",ċ:"cdot",Ċ:"Cdot",ç:"ccedil",Ç:"Ccedil","℅":"incare","𝔡":"dfr","ⅆ":"dd","𝕕":"dopf","𝒹":"dscr","𝒟":"Dscr","𝔇":"Dfr","ⅅ":"DD","𝔻":"Dopf",ď:"dcaron",Ď:"Dcaron",đ:"dstrok",Đ:"Dstrok",ð:"eth",Ð:"ETH","ⅇ":"ee",ℯ:"escr","𝔢":"efr","𝕖":"eopf",ℰ:"Escr","𝔈":"Efr","𝔼":"Eopf",é:"eacute",É:"Eacute",è:"egrave",È:"Egrave",ê:"ecirc",Ê:"Ecirc",ě:"ecaron",Ě:"Ecaron",ë:"euml",Ë:"Euml",ė:"edot",Ė:"Edot",ę:"eogon",Ę:"Eogon",ē:"emacr",Ē:"Emacr","𝔣":"ffr","𝕗":"fopf","𝒻":"fscr","𝔉":"Ffr","𝔽":"Fopf",ℱ:"Fscr",ﬀ:"fflig",ﬃ:"ffilig",ﬄ:"ffllig",ﬁ:"filig",fj:"fjlig",ﬂ:"fllig",ƒ:"fnof",ℊ:"gscr","𝕘":"gopf","𝔤":"gfr","𝒢":"Gscr","𝔾":"Gopf","𝔊":"Gfr",ǵ:"gacute",ğ:"gbreve",Ğ:"Gbreve",ĝ:"gcirc",Ĝ:"Gcirc",ġ:"gdot",Ġ:"Gdot",Ģ:"Gcedil","𝔥":"hfr",ℎ:"planckh","𝒽":"hscr","𝕙":"hopf",ℋ:"Hscr",ℌ:"Hfr",ℍ:"Hopf",ĥ:"hcirc",Ĥ:"Hcirc",ℏ:"hbar",ħ:"hstrok",Ħ:"Hstrok","𝕚":"iopf","𝔦":"ifr","𝒾":"iscr","ⅈ":"ii","𝕀":"Iopf",ℐ:"Iscr",ℑ:"Im",í:"iacute",Í:"Iacute",ì:"igrave",Ì:"Igrave",î:"icirc",Î:"Icirc",ï:"iuml",Ï:"Iuml",ĩ:"itilde",Ĩ:"Itilde",İ:"Idot",į:"iogon",Į:"Iogon",ī:"imacr",Ī:"Imacr",ĳ:"ijlig",Ĳ:"IJlig",ı:"imath","𝒿":"jscr","𝕛":"jopf","𝔧":"jfr","𝒥":"Jscr","𝔍":"Jfr","𝕁":"Jopf",ĵ:"jcirc",Ĵ:"Jcirc","ȷ":"jmath","𝕜":"kopf","𝓀":"kscr","𝔨":"kfr","𝒦":"Kscr","𝕂":"Kopf","𝔎":"Kfr",ķ:"kcedil",Ķ:"Kcedil","𝔩":"lfr","𝓁":"lscr",ℓ:"ell","𝕝":"lopf",ℒ:"Lscr","𝔏":"Lfr","𝕃":"Lopf",ĺ:"lacute",Ĺ:"Lacute",ľ:"lcaron",Ľ:"Lcaron",ļ:"lcedil",Ļ:"Lcedil",ł:"lstrok",Ł:"Lstrok",ŀ:"lmidot",Ŀ:"Lmidot","𝔪":"mfr","𝕞":"mopf","𝓂":"mscr","𝔐":"Mfr","𝕄":"Mopf",ℳ:"Mscr","𝔫":"nfr","𝕟":"nopf","𝓃":"nscr",ℕ:"Nopf","𝒩":"Nscr","𝔑":"Nfr",ń:"nacute",Ń:"Nacute",ň:"ncaron",Ň:"Ncaron",ñ:"ntilde",Ñ:"Ntilde",ņ:"ncedil",Ņ:"Ncedil","№":"numero",ŋ:"eng",Ŋ:"ENG","𝕠":"oopf","𝔬":"ofr",ℴ:"oscr","𝒪":"Oscr","𝔒":"Ofr","𝕆":"Oopf",º:"ordm",ó:"oacute",Ó:"Oacute",ò:"ograve",Ò:"Ograve",ô:"ocirc",Ô:"Ocirc",ö:"ouml",Ö:"Ouml",ő:"odblac",Ő:"Odblac",õ:"otilde",Õ:"Otilde",ø:"oslash",Ø:"Oslash",ō:"omacr",Ō:"Omacr",œ:"oelig",Œ:"OElig","𝔭":"pfr","𝓅":"pscr","𝕡":"popf",ℙ:"Popf","𝔓":"Pfr","𝒫":"Pscr","𝕢":"qopf","𝔮":"qfr","𝓆":"qscr","𝒬":"Qscr","𝔔":"Qfr",ℚ:"Qopf",ĸ:"kgreen","𝔯":"rfr","𝕣":"ropf","𝓇":"rscr",ℛ:"Rscr",ℜ:"Re",ℝ:"Ropf",ŕ:"racute",Ŕ:"Racute",ř:"rcaron",Ř:"Rcaron",ŗ:"rcedil",Ŗ:"Rcedil","𝕤":"sopf","𝓈":"sscr","𝔰":"sfr","𝕊":"Sopf","𝔖":"Sfr","𝒮":"Sscr","Ⓢ":"oS",ś:"sacute",Ś:"Sacute",ŝ:"scirc",Ŝ:"Scirc",š:"scaron",Š:"Scaron",ş:"scedil",Ş:"Scedil",ß:"szlig","𝔱":"tfr","𝓉":"tscr","𝕥":"topf","𝒯":"Tscr","𝔗":"Tfr","𝕋":"Topf",ť:"tcaron",Ť:"Tcaron",ţ:"tcedil",Ţ:"Tcedil","™":"trade",ŧ:"tstrok",Ŧ:"Tstrok","𝓊":"uscr","𝕦":"uopf","𝔲":"ufr","𝕌":"Uopf","𝔘":"Ufr","𝒰":"Uscr",ú:"uacute",Ú:"Uacute",ù:"ugrave",Ù:"Ugrave",ŭ:"ubreve",Ŭ:"Ubreve",û:"ucirc",Û:"Ucirc",ů:"uring",Ů:"Uring",ü:"uuml",Ü:"Uuml",ű:"udblac",Ű:"Udblac",ũ:"utilde",Ũ:"Utilde",ų:"uogon",Ų:"Uogon",ū:"umacr",Ū:"Umacr","𝔳":"vfr","𝕧":"vopf","𝓋":"vscr","𝔙":"Vfr","𝕍":"Vopf","𝒱":"Vscr","𝕨":"wopf","𝓌":"wscr","𝔴":"wfr","𝒲":"Wscr","𝕎":"Wopf","𝔚":"Wfr",ŵ:"wcirc",Ŵ:"Wcirc","𝔵":"xfr","𝓍":"xscr","𝕩":"xopf","𝕏":"Xopf","𝔛":"Xfr","𝒳":"Xscr","𝔶":"yfr","𝓎":"yscr","𝕪":"yopf","𝒴":"Yscr","𝔜":"Yfr","𝕐":"Yopf",ý:"yacute",Ý:"Yacute",ŷ:"ycirc",Ŷ:"Ycirc",ÿ:"yuml",Ÿ:"Yuml","𝓏":"zscr","𝔷":"zfr","𝕫":"zopf",ℨ:"Zfr",ℤ:"Zopf","𝒵":"Zscr",ź:"zacute",Ź:"Zacute",ž:"zcaron",Ž:"Zcaron",ż:"zdot",Ż:"Zdot",Ƶ:"imped",þ:"thorn",Þ:"THORN",ŉ:"napos",α:"alpha",Α:"Alpha",β:"beta",Β:"Beta",γ:"gamma",Γ:"Gamma",δ:"delta",Δ:"Delta",ε:"epsi","ϵ":"epsiv",Ε:"Epsilon",ϝ:"gammad",Ϝ:"Gammad",ζ:"zeta",Ζ:"Zeta",η:"eta",Η:"Eta",θ:"theta",ϑ:"thetav",Θ:"Theta",ι:"iota",Ι:"Iota",κ:"kappa",ϰ:"kappav",Κ:"Kappa",λ:"lambda",Λ:"Lambda",μ:"mu",µ:"micro",Μ:"Mu",ν:"nu",Ν:"Nu",ξ:"xi",Ξ:"Xi",ο:"omicron",Ο:"Omicron",π:"pi",ϖ:"piv",Π:"Pi",ρ:"rho",ϱ:"rhov",Ρ:"Rho",σ:"sigma",Σ:"Sigma",ς:"sigmaf",τ:"tau",Τ:"Tau",υ:"upsi",Υ:"Upsilon",ϒ:"Upsi",φ:"phi",ϕ:"phiv",Φ:"Phi",χ:"chi",Χ:"Chi",ψ:"psi",Ψ:"Psi",ω:"omega",Ω:"ohm",а:"acy",А:"Acy",б:"bcy",Б:"Bcy",в:"vcy",В:"Vcy",г:"gcy",Г:"Gcy",ѓ:"gjcy",Ѓ:"GJcy",д:"dcy",Д:"Dcy",ђ:"djcy",Ђ:"DJcy",е:"iecy",Е:"IEcy",ё:"iocy",Ё:"IOcy",є:"jukcy",Є:"Jukcy",ж:"zhcy",Ж:"ZHcy",з:"zcy",З:"Zcy",ѕ:"dscy",Ѕ:"DScy",и:"icy",И:"Icy",і:"iukcy",І:"Iukcy",ї:"yicy",Ї:"YIcy",й:"jcy",Й:"Jcy",ј:"jsercy",Ј:"Jsercy",к:"kcy",К:"Kcy",ќ:"kjcy",Ќ:"KJcy",л:"lcy",Л:"Lcy",љ:"ljcy",Љ:"LJcy",м:"mcy",М:"Mcy",н:"ncy",Н:"Ncy",њ:"njcy",Њ:"NJcy",о:"ocy",О:"Ocy",п:"pcy",П:"Pcy",р:"rcy",Р:"Rcy",с:"scy",С:"Scy",т:"tcy",Т:"Tcy",ћ:"tshcy",Ћ:"TSHcy",у:"ucy",У:"Ucy",ў:"ubrcy",Ў:"Ubrcy",ф:"fcy",Ф:"Fcy",х:"khcy",Х:"KHcy",ц:"tscy",Ц:"TScy",ч:"chcy",Ч:"CHcy",џ:"dzcy",Џ:"DZcy",ш:"shcy",Ш:"SHcy",щ:"shchcy",Щ:"SHCHcy",ъ:"hardcy",Ъ:"HARDcy",ы:"ycy",Ы:"Ycy",ь:"softcy",Ь:"SOFTcy",э:"ecy",Э:"Ecy",ю:"yucy",Ю:"YUcy",я:"yacy",Я:"YAcy",ℵ:"aleph",ℶ:"beth",ℷ:"gimel",ℸ:"daleth"},d=/["&'<>`]/g,p={'"':"&quot;","&":"&amp;","'":"&#x27;","<":"&lt;",">":"&gt;","`":"&#x60;"},g=/&#(?:[xX][^a-fA-F0-9]|[^0-9xX])/,m=/[\0-\x08\x0B\x0E-\x1F\x7F-\x9F\uFDD0-\uFDEF\uFFFE\uFFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDFFE\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,v=/&(CounterClockwiseContourIntegral|DoubleLongLeftRightArrow|ClockwiseContourIntegral|NotNestedGreaterGreater|NotSquareSupersetEqual|DiacriticalDoubleAcute|NotRightTriangleEqual|NotSucceedsSlantEqual|NotPrecedesSlantEqual|CloseCurlyDoubleQuote|NegativeVeryThinSpace|DoubleContourIntegral|FilledVerySmallSquare|CapitalDifferentialD|OpenCurlyDoubleQuote|EmptyVerySmallSquare|NestedGreaterGreater|DoubleLongRightArrow|NotLeftTriangleEqual|NotGreaterSlantEqual|ReverseUpEquilibrium|DoubleLeftRightArrow|NotSquareSubsetEqual|NotDoubleVerticalBar|RightArrowLeftArrow|NotGreaterFullEqual|NotRightTriangleBar|SquareSupersetEqual|DownLeftRightVector|DoubleLongLeftArrow|leftrightsquigarrow|LeftArrowRightArrow|NegativeMediumSpace|blacktriangleright|RightDownVectorBar|PrecedesSlantEqual|RightDoubleBracket|SucceedsSlantEqual|NotLeftTriangleBar|RightTriangleEqual|SquareIntersection|RightDownTeeVector|ReverseEquilibrium|NegativeThickSpace|longleftrightarrow|Longleftrightarrow|LongLeftRightArrow|DownRightTeeVector|DownRightVectorBar|GreaterSlantEqual|SquareSubsetEqual|LeftDownVectorBar|LeftDoubleBracket|VerticalSeparator|rightleftharpoons|NotGreaterGreater|NotSquareSuperset|blacktriangleleft|blacktriangledown|NegativeThinSpace|LeftDownTeeVector|NotLessSlantEqual|leftrightharpoons|DoubleUpDownArrow|DoubleVerticalBar|LeftTriangleEqual|FilledSmallSquare|twoheadrightarrow|NotNestedLessLess|DownLeftTeeVector|DownLeftVectorBar|RightAngleBracket|NotTildeFullEqual|NotReverseElement|RightUpDownVector|DiacriticalTilde|NotSucceedsTilde|circlearrowright|NotPrecedesEqual|rightharpoondown|DoubleRightArrow|NotSucceedsEqual|NonBreakingSpace|NotRightTriangle|LessEqualGreater|RightUpTeeVector|LeftAngleBracket|GreaterFullEqual|DownArrowUpArrow|RightUpVectorBar|twoheadleftarrow|GreaterEqualLess|downharpoonright|RightTriangleBar|ntrianglerighteq|NotSupersetEqual|LeftUpDownVector|DiacriticalAcute|rightrightarrows|vartriangleright|UpArrowDownArrow|DiacriticalGrave|UnderParenthesis|EmptySmallSquare|LeftUpVectorBar|leftrightarrows|DownRightVector|downharpoonleft|trianglerighteq|ShortRightArrow|OverParenthesis|DoubleLeftArrow|DoubleDownArrow|NotSquareSubset|bigtriangledown|ntrianglelefteq|UpperRightArrow|curvearrowright|vartriangleleft|NotLeftTriangle|nleftrightarrow|LowerRightArrow|NotHumpDownHump|NotGreaterTilde|rightthreetimes|LeftUpTeeVector|NotGreaterEqual|straightepsilon|LeftTriangleBar|rightsquigarrow|ContourIntegral|rightleftarrows|CloseCurlyQuote|RightDownVector|LeftRightVector|nLeftrightarrow|leftharpoondown|circlearrowleft|SquareSuperset|OpenCurlyQuote|hookrightarrow|HorizontalLine|DiacriticalDot|NotLessGreater|ntriangleright|DoubleRightTee|InvisibleComma|InvisibleTimes|LowerLeftArrow|DownLeftVector|NotSubsetEqual|curvearrowleft|trianglelefteq|NotVerticalBar|TildeFullEqual|downdownarrows|NotGreaterLess|RightTeeVector|ZeroWidthSpace|looparrowright|LongRightArrow|doublebarwedge|ShortLeftArrow|ShortDownArrow|RightVectorBar|GreaterGreater|ReverseElement|rightharpoonup|LessSlantEqual|leftthreetimes|upharpoonright|rightarrowtail|LeftDownVector|Longrightarrow|NestedLessLess|UpperLeftArrow|nshortparallel|leftleftarrows|leftrightarrow|Leftrightarrow|LeftRightArrow|longrightarrow|upharpoonleft|RightArrowBar|ApplyFunction|LeftTeeVector|leftarrowtail|NotEqualTilde|varsubsetneqq|varsupsetneqq|RightTeeArrow|SucceedsEqual|SucceedsTilde|LeftVectorBar|SupersetEqual|hookleftarrow|DifferentialD|VerticalTilde|VeryThinSpace|blacktriangle|bigtriangleup|LessFullEqual|divideontimes|leftharpoonup|UpEquilibrium|ntriangleleft|RightTriangle|measuredangle|shortparallel|longleftarrow|Longleftarrow|LongLeftArrow|DoubleLeftTee|Poincareplane|PrecedesEqual|triangleright|DoubleUpArrow|RightUpVector|fallingdotseq|looparrowleft|PrecedesTilde|NotTildeEqual|NotTildeTilde|smallsetminus|Proportional|triangleleft|triangledown|UnderBracket|NotHumpEqual|exponentiale|ExponentialE|NotLessTilde|HilbertSpace|RightCeiling|blacklozenge|varsupsetneq|HumpDownHump|GreaterEqual|VerticalLine|LeftTeeArrow|NotLessEqual|DownTeeArrow|LeftTriangle|varsubsetneq|Intersection|NotCongruent|DownArrowBar|LeftUpVector|LeftArrowBar|risingdotseq|GreaterTilde|RoundImplies|SquareSubset|ShortUpArrow|NotSuperset|quaternions|precnapprox|backepsilon|preccurlyeq|OverBracket|blacksquare|MediumSpace|VerticalBar|circledcirc|circleddash|CircleMinus|CircleTimes|LessGreater|curlyeqprec|curlyeqsucc|diamondsuit|UpDownArrow|Updownarrow|RuleDelayed|Rrightarrow|updownarrow|RightVector|nRightarrow|nrightarrow|eqslantless|LeftCeiling|Equilibrium|SmallCircle|expectation|NotSucceeds|thickapprox|GreaterLess|SquareUnion|NotPrecedes|NotLessLess|straightphi|succnapprox|succcurlyeq|SubsetEqual|sqsupseteq|Proportion|Laplacetrf|ImaginaryI|supsetneqq|NotGreater|gtreqqless|NotElement|ThickSpace|TildeEqual|TildeTilde|Fouriertrf|rmoustache|EqualTilde|eqslantgtr|UnderBrace|LeftVector|UpArrowBar|nLeftarrow|nsubseteqq|subsetneqq|nsupseteqq|nleftarrow|succapprox|lessapprox|UpTeeArrow|upuparrows|curlywedge|lesseqqgtr|varepsilon|varnothing|RightFloor|complement|CirclePlus|sqsubseteq|Lleftarrow|circledast|RightArrow|Rightarrow|rightarrow|lmoustache|Bernoullis|precapprox|mapstoleft|mapstodown|longmapsto|dotsquare|downarrow|DoubleDot|nsubseteq|supsetneq|leftarrow|nsupseteq|subsetneq|ThinSpace|ngeqslant|subseteqq|HumpEqual|NotSubset|triangleq|NotCupCap|lesseqgtr|heartsuit|TripleDot|Leftarrow|Coproduct|Congruent|varpropto|complexes|gvertneqq|LeftArrow|LessTilde|supseteqq|MinusPlus|CircleDot|nleqslant|NotExists|gtreqless|nparallel|UnionPlus|LeftFloor|checkmark|CenterDot|centerdot|Mellintrf|gtrapprox|bigotimes|OverBrace|spadesuit|therefore|pitchfork|rationals|PlusMinus|Backslash|Therefore|DownBreve|backsimeq|backprime|DownArrow|nshortmid|Downarrow|lvertneqq|eqvparsl|imagline|imagpart|infintie|integers|Integral|intercal|LessLess|Uarrocir|intlarhk|sqsupset|angmsdaf|sqsubset|llcorner|vartheta|cupbrcap|lnapprox|Superset|SuchThat|succnsim|succneqq|angmsdag|biguplus|curlyvee|trpezium|Succeeds|NotTilde|bigwedge|angmsdah|angrtvbd|triminus|cwconint|fpartint|lrcorner|smeparsl|subseteq|urcorner|lurdshar|laemptyv|DDotrahd|approxeq|ldrushar|awconint|mapstoup|backcong|shortmid|triangle|geqslant|gesdotol|timesbar|circledR|circledS|setminus|multimap|naturals|scpolint|ncongdot|RightTee|boxminus|gnapprox|boxtimes|andslope|thicksim|angmsdaa|varsigma|cirfnint|rtriltri|angmsdab|rppolint|angmsdac|barwedge|drbkarow|clubsuit|thetasym|bsolhsub|capbrcup|dzigrarr|doteqdot|DotEqual|dotminus|UnderBar|NotEqual|realpart|otimesas|ulcorner|hksearow|hkswarow|parallel|PartialD|elinters|emptyset|plusacir|bbrktbrk|angmsdad|pointint|bigoplus|angmsdae|Precedes|bigsqcup|varkappa|notindot|supseteq|precneqq|precnsim|profalar|profline|profsurf|leqslant|lesdotor|raemptyv|subplus|notnivb|notnivc|subrarr|zigrarr|vzigzag|submult|subedot|Element|between|cirscir|larrbfs|larrsim|lotimes|lbrksld|lbrkslu|lozenge|ldrdhar|dbkarow|bigcirc|epsilon|simrarr|simplus|ltquest|Epsilon|luruhar|gtquest|maltese|npolint|eqcolon|npreceq|bigodot|ddagger|gtrless|bnequiv|harrcir|ddotseq|equivDD|backsim|demptyv|nsqsube|nsqsupe|Upsilon|nsubset|upsilon|minusdu|nsucceq|swarrow|nsupset|coloneq|searrow|boxplus|napprox|natural|asympeq|alefsym|congdot|nearrow|bigstar|diamond|supplus|tritime|LeftTee|nvinfin|triplus|NewLine|nvltrie|nvrtrie|nwarrow|nexists|Diamond|ruluhar|Implies|supmult|angzarr|suplarr|suphsub|questeq|because|digamma|Because|olcross|bemptyv|omicron|Omicron|rotimes|NoBreak|intprod|angrtvb|orderof|uwangle|suphsol|lesdoto|orslope|DownTee|realine|cudarrl|rdldhar|OverBar|supedot|lessdot|supdsub|topfork|succsim|rbrkslu|rbrksld|pertenk|cudarrr|isindot|planckh|lessgtr|pluscir|gesdoto|plussim|plustwo|lesssim|cularrp|rarrsim|Cayleys|notinva|notinvb|notinvc|UpArrow|Uparrow|uparrow|NotLess|dwangle|precsim|Product|curarrm|Cconint|dotplus|rarrbfs|ccupssm|Cedilla|cemptyv|notniva|quatint|frac35|frac38|frac45|frac56|frac58|frac78|tridot|xoplus|gacute|gammad|Gammad|lfisht|lfloor|bigcup|sqsupe|gbreve|Gbreve|lharul|sqsube|sqcups|Gcedil|apacir|llhard|lmidot|Lmidot|lmoust|andand|sqcaps|approx|Abreve|spades|circeq|tprime|divide|topcir|Assign|topbot|gesdot|divonx|xuplus|timesd|gesles|atilde|solbar|SOFTcy|loplus|timesb|lowast|lowbar|dlcorn|dlcrop|softcy|dollar|lparlt|thksim|lrhard|Atilde|lsaquo|smashp|bigvee|thinsp|wreath|bkarow|lsquor|lstrok|Lstrok|lthree|ltimes|ltlarr|DotDot|simdot|ltrPar|weierp|xsqcup|angmsd|sigmav|sigmaf|zeetrf|Zcaron|zcaron|mapsto|vsupne|thetav|cirmid|marker|mcomma|Zacute|vsubnE|there4|gtlPar|vsubne|bottom|gtrarr|SHCHcy|shchcy|midast|midcir|middot|minusb|minusd|gtrdot|bowtie|sfrown|mnplus|models|colone|seswar|Colone|mstpos|searhk|gtrsim|nacute|Nacute|boxbox|telrec|hairsp|Tcedil|nbumpe|scnsim|ncaron|Ncaron|ncedil|Ncedil|hamilt|Scedil|nearhk|hardcy|HARDcy|tcedil|Tcaron|commat|nequiv|nesear|tcaron|target|hearts|nexist|varrho|scedil|Scaron|scaron|hellip|Sacute|sacute|hercon|swnwar|compfn|rtimes|rthree|rsquor|rsaquo|zacute|wedgeq|homtht|barvee|barwed|Barwed|rpargt|horbar|conint|swarhk|roplus|nltrie|hslash|hstrok|Hstrok|rmoust|Conint|bprime|hybull|hyphen|iacute|Iacute|supsup|supsub|supsim|varphi|coprod|brvbar|agrave|Supset|supset|igrave|Igrave|notinE|Agrave|iiiint|iinfin|copysr|wedbar|Verbar|vangrt|becaus|incare|verbar|inodot|bullet|drcorn|intcal|drcrop|cularr|vellip|Utilde|bumpeq|cupcap|dstrok|Dstrok|CupCap|cupcup|cupdot|eacute|Eacute|supdot|iquest|easter|ecaron|Ecaron|ecolon|isinsv|utilde|itilde|Itilde|curarr|succeq|Bumpeq|cacute|ulcrop|nparsl|Cacute|nprcue|egrave|Egrave|nrarrc|nrarrw|subsup|subsub|nrtrie|jsercy|nsccue|Jsercy|kappav|kcedil|Kcedil|subsim|ulcorn|nsimeq|egsdot|veebar|kgreen|capand|elsdot|Subset|subset|curren|aacute|lacute|Lacute|emptyv|ntilde|Ntilde|lagran|lambda|Lambda|capcap|Ugrave|langle|subdot|emsp13|numero|emsp14|nvdash|nvDash|nVdash|nVDash|ugrave|ufisht|nvHarr|larrfs|nvlArr|larrhk|larrlp|larrpl|nvrArr|Udblac|nwarhk|larrtl|nwnear|oacute|Oacute|latail|lAtail|sstarf|lbrace|odblac|Odblac|lbrack|udblac|odsold|eparsl|lcaron|Lcaron|ograve|Ograve|lcedil|Lcedil|Aacute|ssmile|ssetmn|squarf|ldquor|capcup|ominus|cylcty|rharul|eqcirc|dagger|rfloor|rfisht|Dagger|daleth|equals|origof|capdot|equest|dcaron|Dcaron|rdquor|oslash|Oslash|otilde|Otilde|otimes|Otimes|urcrop|Ubreve|ubreve|Yacute|Uacute|uacute|Rcedil|rcedil|urcorn|parsim|Rcaron|Vdashl|rcaron|Tstrok|percnt|period|permil|Exists|yacute|rbrack|rbrace|phmmat|ccaron|Ccaron|planck|ccedil|plankv|tstrok|female|plusdo|plusdu|ffilig|plusmn|ffllig|Ccedil|rAtail|dfisht|bernou|ratail|Rarrtl|rarrtl|angsph|rarrpl|rarrlp|rarrhk|xwedge|xotime|forall|ForAll|Vvdash|vsupnE|preceq|bigcap|frac12|frac13|frac14|primes|rarrfs|prnsim|frac15|Square|frac16|square|lesdot|frac18|frac23|propto|prurel|rarrap|rangle|puncsp|frac25|Racute|qprime|racute|lesges|frac34|abreve|AElig|eqsim|utdot|setmn|urtri|Equal|Uring|seArr|uring|searr|dashv|Dashv|mumap|nabla|iogon|Iogon|sdote|sdotb|scsim|napid|napos|equiv|natur|Acirc|dblac|erarr|nbump|iprod|erDot|ucirc|awint|esdot|angrt|ncong|isinE|scnap|Scirc|scirc|ndash|isins|Ubrcy|nearr|neArr|isinv|nedot|ubrcy|acute|Ycirc|iukcy|Iukcy|xutri|nesim|caret|jcirc|Jcirc|caron|twixt|ddarr|sccue|exist|jmath|sbquo|ngeqq|angst|ccaps|lceil|ngsim|UpTee|delta|Delta|rtrif|nharr|nhArr|nhpar|rtrie|jukcy|Jukcy|kappa|rsquo|Kappa|nlarr|nlArr|TSHcy|rrarr|aogon|Aogon|fflig|xrarr|tshcy|ccirc|nleqq|filig|upsih|nless|dharl|nlsim|fjlig|ropar|nltri|dharr|robrk|roarr|fllig|fltns|roang|rnmid|subnE|subne|lAarr|trisb|Ccirc|acirc|ccups|blank|VDash|forkv|Vdash|langd|cedil|blk12|blk14|laquo|strns|diams|notin|vDash|larrb|blk34|block|disin|uplus|vdash|vBarv|aelig|starf|Wedge|check|xrArr|lates|lbarr|lBarr|notni|lbbrk|bcong|frasl|lbrke|frown|vrtri|vprop|vnsup|gamma|Gamma|wedge|xodot|bdquo|srarr|doteq|ldquo|boxdl|boxdL|gcirc|Gcirc|boxDl|boxDL|boxdr|boxdR|boxDr|TRADE|trade|rlhar|boxDR|vnsub|npart|vltri|rlarr|boxhd|boxhD|nprec|gescc|nrarr|nrArr|boxHd|boxHD|boxhu|boxhU|nrtri|boxHu|clubs|boxHU|times|colon|Colon|gimel|xlArr|Tilde|nsime|tilde|nsmid|nspar|THORN|thorn|xlarr|nsube|nsubE|thkap|xhArr|comma|nsucc|boxul|boxuL|nsupe|nsupE|gneqq|gnsim|boxUl|boxUL|grave|boxur|boxuR|boxUr|boxUR|lescc|angle|bepsi|boxvh|varpi|boxvH|numsp|Theta|gsime|gsiml|theta|boxVh|boxVH|boxvl|gtcir|gtdot|boxvL|boxVl|boxVL|crarr|cross|Cross|nvsim|boxvr|nwarr|nwArr|sqsup|dtdot|Uogon|lhard|lharu|dtrif|ocirc|Ocirc|lhblk|duarr|odash|sqsub|Hacek|sqcup|llarr|duhar|oelig|OElig|ofcir|boxvR|uogon|lltri|boxVr|csube|uuarr|ohbar|csupe|ctdot|olarr|olcir|harrw|oline|sqcap|omacr|Omacr|omega|Omega|boxVR|aleph|lneqq|lnsim|loang|loarr|rharu|lobrk|hcirc|operp|oplus|rhard|Hcirc|orarr|Union|order|ecirc|Ecirc|cuepr|szlig|cuesc|breve|reals|eDDot|Breve|hoarr|lopar|utrif|rdquo|Umacr|umacr|efDot|swArr|ultri|alpha|rceil|ovbar|swarr|Wcirc|wcirc|smtes|smile|bsemi|lrarr|aring|parsl|lrhar|bsime|uhblk|lrtri|cupor|Aring|uharr|uharl|slarr|rbrke|bsolb|lsime|rbbrk|RBarr|lsimg|phone|rBarr|rbarr|icirc|lsquo|Icirc|emacr|Emacr|ratio|simne|plusb|simlE|simgE|simeq|pluse|ltcir|ltdot|empty|xharr|xdtri|iexcl|Alpha|ltrie|rarrw|pound|ltrif|xcirc|bumpe|prcue|bumpE|asymp|amacr|cuvee|Sigma|sigma|iiint|udhar|iiota|ijlig|IJlig|supnE|imacr|Imacr|prime|Prime|image|prnap|eogon|Eogon|rarrc|mdash|mDDot|cuwed|imath|supne|imped|Amacr|udarr|prsim|micro|rarrb|cwint|raquo|infin|eplus|range|rangd|Ucirc|radic|minus|amalg|veeeq|rAarr|epsiv|ycirc|quest|sharp|quot|zwnj|Qscr|race|qscr|Qopf|qopf|qint|rang|Rang|Zscr|zscr|Zopf|zopf|rarr|rArr|Rarr|Pscr|pscr|prop|prod|prnE|prec|ZHcy|zhcy|prap|Zeta|zeta|Popf|popf|Zdot|plus|zdot|Yuml|yuml|phiv|YUcy|yucy|Yscr|yscr|perp|Yopf|yopf|part|para|YIcy|Ouml|rcub|yicy|YAcy|rdca|ouml|osol|Oscr|rdsh|yacy|real|oscr|xvee|andd|rect|andv|Xscr|oror|ordm|ordf|xscr|ange|aopf|Aopf|rHar|Xopf|opar|Oopf|xopf|xnis|rhov|oopf|omid|xmap|oint|apid|apos|ogon|ascr|Ascr|odot|odiv|xcup|xcap|ocir|oast|nvlt|nvle|nvgt|nvge|nvap|Wscr|wscr|auml|ntlg|ntgl|nsup|nsub|nsim|Nscr|nscr|nsce|Wopf|ring|npre|wopf|npar|Auml|Barv|bbrk|Nopf|nopf|nmid|nLtv|beta|ropf|Ropf|Beta|beth|nles|rpar|nleq|bnot|bNot|nldr|NJcy|rscr|Rscr|Vscr|vscr|rsqb|njcy|bopf|nisd|Bopf|rtri|Vopf|nGtv|ngtr|vopf|boxh|boxH|boxv|nges|ngeq|boxV|bscr|scap|Bscr|bsim|Vert|vert|bsol|bull|bump|caps|cdot|ncup|scnE|ncap|nbsp|napE|Cdot|cent|sdot|Vbar|nang|vBar|chcy|Mscr|mscr|sect|semi|CHcy|Mopf|mopf|sext|circ|cire|mldr|mlcp|cirE|comp|shcy|SHcy|vArr|varr|cong|copf|Copf|copy|COPY|malt|male|macr|lvnE|cscr|ltri|sime|ltcc|simg|Cscr|siml|csub|Uuml|lsqb|lsim|uuml|csup|Lscr|lscr|utri|smid|lpar|cups|smte|lozf|darr|Lopf|Uscr|solb|lopf|sopf|Sopf|lneq|uscr|spar|dArr|lnap|Darr|dash|Sqrt|LJcy|ljcy|lHar|dHar|Upsi|upsi|diam|lesg|djcy|DJcy|leqq|dopf|Dopf|dscr|Dscr|dscy|ldsh|ldca|squf|DScy|sscr|Sscr|dsol|lcub|late|star|Star|Uopf|Larr|lArr|larr|uopf|dtri|dzcy|sube|subE|Lang|lang|Kscr|kscr|Kopf|kopf|KJcy|kjcy|KHcy|khcy|DZcy|ecir|edot|eDot|Jscr|jscr|succ|Jopf|jopf|Edot|uHar|emsp|ensp|Iuml|iuml|eopf|isin|Iscr|iscr|Eopf|epar|sung|epsi|escr|sup1|sup2|sup3|Iota|iota|supe|supE|Iopf|iopf|IOcy|iocy|Escr|esim|Esim|imof|Uarr|QUOT|uArr|uarr|euml|IEcy|iecy|Idot|Euml|euro|excl|Hscr|hscr|Hopf|hopf|TScy|tscy|Tscr|hbar|tscr|flat|tbrk|fnof|hArr|harr|half|fopf|Fopf|tdot|gvnE|fork|trie|gtcc|fscr|Fscr|gdot|gsim|Gscr|gscr|Gopf|gopf|gneq|Gdot|tosa|gnap|Topf|topf|geqq|toea|GJcy|gjcy|tint|gesl|mid|Sfr|ggg|top|ges|gla|glE|glj|geq|gne|gEl|gel|gnE|Gcy|gcy|gap|Tfr|tfr|Tcy|tcy|Hat|Tau|Ffr|tau|Tab|hfr|Hfr|ffr|Fcy|fcy|icy|Icy|iff|ETH|eth|ifr|Ifr|Eta|eta|int|Int|Sup|sup|ucy|Ucy|Sum|sum|jcy|ENG|ufr|Ufr|eng|Jcy|jfr|els|ell|egs|Efr|efr|Jfr|uml|kcy|Kcy|Ecy|ecy|kfr|Kfr|lap|Sub|sub|lat|lcy|Lcy|leg|Dot|dot|lEg|leq|les|squ|div|die|lfr|Lfr|lgE|Dfr|dfr|Del|deg|Dcy|dcy|lne|lnE|sol|loz|smt|Cup|lrm|cup|lsh|Lsh|sim|shy|map|Map|mcy|Mcy|mfr|Mfr|mho|gfr|Gfr|sfr|cir|Chi|chi|nap|Cfr|vcy|Vcy|cfr|Scy|scy|ncy|Ncy|vee|Vee|Cap|cap|nfr|scE|sce|Nfr|nge|ngE|nGg|vfr|Vfr|ngt|bot|nGt|nis|niv|Rsh|rsh|nle|nlE|bne|Bfr|bfr|nLl|nlt|nLt|Bcy|bcy|not|Not|rlm|wfr|Wfr|npr|nsc|num|ocy|ast|Ocy|ofr|xfr|Xfr|Ofr|ogt|ohm|apE|olt|Rho|ape|rho|Rfr|rfr|ord|REG|ang|reg|orv|And|and|AMP|Rcy|amp|Afr|ycy|Ycy|yen|yfr|Yfr|rcy|par|pcy|Pcy|pfr|Pfr|phi|Phi|afr|Acy|acy|zcy|Zcy|piv|acE|acd|zfr|Zfr|pre|prE|psi|Psi|qfr|Qfr|zwj|Or|ge|Gg|gt|gg|el|oS|lt|Lt|LT|Re|lg|gl|eg|ne|Im|it|le|DD|wp|wr|nu|Nu|dd|lE|Sc|sc|pi|Pi|ee|af|ll|Ll|rx|gE|xi|pm|Xi|ic|pr|Pr|in|ni|mp|mu|ac|Mu|or|ap|Gt|GT|ii);|&(Aacute|Agrave|Atilde|Ccedil|Eacute|Egrave|Iacute|Igrave|Ntilde|Oacute|Ograve|Oslash|Otilde|Uacute|Ugrave|Yacute|aacute|agrave|atilde|brvbar|ccedil|curren|divide|eacute|egrave|frac12|frac14|frac34|iacute|igrave|iquest|middot|ntilde|oacute|ograve|oslash|otilde|plusmn|uacute|ugrave|yacute|AElig|Acirc|Aring|Ecirc|Icirc|Ocirc|THORN|Ucirc|acirc|acute|aelig|aring|cedil|ecirc|icirc|iexcl|laquo|micro|ocirc|pound|raquo|szlig|thorn|times|ucirc|Auml|COPY|Euml|Iuml|Ouml|QUOT|Uuml|auml|cent|copy|euml|iuml|macr|nbsp|ordf|ordm|ouml|para|quot|sect|sup1|sup2|sup3|uuml|yuml|AMP|ETH|REG|amp|deg|eth|not|reg|shy|uml|yen|GT|LT|gt|lt)(?!;)([=a-zA-Z0-9]?)|&#([0-9]+)(;?)|&#[xX]([a-fA-F0-9]+)(;?)|&([0-9a-zA-Z]+)/g,E={aacute:"á",Aacute:"Á",abreve:"ă",Abreve:"Ă",ac:"∾",acd:"∿",acE:"∾̳",acirc:"â",Acirc:"Â",acute:"´",acy:"а",Acy:"А",aelig:"æ",AElig:"Æ",af:"⁡",afr:"𝔞",Afr:"𝔄",agrave:"à",Agrave:"À",alefsym:"ℵ",aleph:"ℵ",alpha:"α",Alpha:"Α",amacr:"ā",Amacr:"Ā",amalg:"⨿",amp:"&",AMP:"&",and:"∧",And:"⩓",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",aogon:"ą",Aogon:"Ą",aopf:"𝕒",Aopf:"𝔸",ap:"≈",apacir:"⩯",ape:"≊",apE:"⩰",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",aring:"å",Aring:"Å",ascr:"𝒶",Ascr:"𝒜",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",atilde:"ã",Atilde:"Ã",auml:"ä",Auml:"Ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",barwed:"⌅",Barwed:"⌆",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",bcy:"б",Bcy:"Б",bdquo:"„",becaus:"∵",because:"∵",Because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",beta:"β",Beta:"Β",beth:"ℶ",between:"≬",bfr:"𝔟",Bfr:"𝔅",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bnot:"⌐",bNot:"⫭",bopf:"𝕓",Bopf:"𝔹",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxdl:"┐",boxdL:"╕",boxDl:"╖",boxDL:"╗",boxdr:"┌",boxdR:"╒",boxDr:"╓",boxDR:"╔",boxh:"─",boxH:"═",boxhd:"┬",boxhD:"╥",boxHd:"╤",boxHD:"╦",boxhu:"┴",boxhU:"╨",boxHu:"╧",boxHU:"╩",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxul:"┘",boxuL:"╛",boxUl:"╜",boxUL:"╝",boxur:"└",boxuR:"╘",boxUr:"╙",boxUR:"╚",boxv:"│",boxV:"║",boxvh:"┼",boxvH:"╪",boxVh:"╫",boxVH:"╬",boxvl:"┤",boxvL:"╡",boxVl:"╢",boxVL:"╣",boxvr:"├",boxvR:"╞",boxVr:"╟",boxVR:"╠",bprime:"‵",breve:"˘",Breve:"˘",brvbar:"¦",bscr:"𝒷",Bscr:"ℬ",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpe:"≏",bumpE:"⪮",bumpeq:"≏",Bumpeq:"≎",cacute:"ć",Cacute:"Ć",cap:"∩",Cap:"⋒",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",ccaron:"č",Ccaron:"Č",ccedil:"ç",Ccedil:"Ç",ccirc:"ĉ",Ccirc:"Ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",cdot:"ċ",Cdot:"Ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",centerdot:"·",CenterDot:"·",cfr:"𝔠",Cfr:"ℭ",chcy:"ч",CHcy:"Ч",check:"✓",checkmark:"✓",chi:"χ",Chi:"Χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cire:"≗",cirE:"⧃",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",colon:":",Colon:"∷",colone:"≔",Colone:"⩴",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",conint:"∮",Conint:"∯",ContourIntegral:"∮",copf:"𝕔",Copf:"ℂ",coprod:"∐",Coproduct:"∐",copy:"©",COPY:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",cross:"✗",Cross:"⨯",cscr:"𝒸",Cscr:"𝒞",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",cup:"∪",Cup:"⋓",cupbrcap:"⩈",cupcap:"⩆",CupCap:"≍",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",dagger:"†",Dagger:"‡",daleth:"ℸ",darr:"↓",dArr:"⇓",Darr:"↡",dash:"‐",dashv:"⊣",Dashv:"⫤",dbkarow:"⤏",dblac:"˝",dcaron:"ď",Dcaron:"Ď",dcy:"д",Dcy:"Д",dd:"ⅆ",DD:"ⅅ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",delta:"δ",Delta:"Δ",demptyv:"⦱",dfisht:"⥿",dfr:"𝔡",Dfr:"𝔇",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",diamond:"⋄",Diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",djcy:"ђ",DJcy:"Ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",dopf:"𝕕",Dopf:"𝔻",dot:"˙",Dot:"¨",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",downarrow:"↓",Downarrow:"⇓",DownArrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",dscr:"𝒹",Dscr:"𝒟",dscy:"ѕ",DScy:"Ѕ",dsol:"⧶",dstrok:"đ",Dstrok:"Đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",dzcy:"џ",DZcy:"Џ",dzigrarr:"⟿",eacute:"é",Eacute:"É",easter:"⩮",ecaron:"ě",Ecaron:"Ě",ecir:"≖",ecirc:"ê",Ecirc:"Ê",ecolon:"≕",ecy:"э",Ecy:"Э",eDDot:"⩷",edot:"ė",eDot:"≑",Edot:"Ė",ee:"ⅇ",efDot:"≒",efr:"𝔢",Efr:"𝔈",eg:"⪚",egrave:"è",Egrave:"È",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",emacr:"ē",Emacr:"Ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",eng:"ŋ",ENG:"Ŋ",ensp:" ",eogon:"ę",Eogon:"Ę",eopf:"𝕖",Eopf:"𝔼",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",epsilon:"ε",Epsilon:"Ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",escr:"ℯ",Escr:"ℰ",esdot:"≐",esim:"≂",Esim:"⩳",eta:"η",Eta:"Η",eth:"ð",ETH:"Ð",euml:"ë",Euml:"Ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",exponentiale:"ⅇ",ExponentialE:"ⅇ",fallingdotseq:"≒",fcy:"ф",Fcy:"Ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",ffr:"𝔣",Ffr:"𝔉",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",fopf:"𝕗",Fopf:"𝔽",forall:"∀",ForAll:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",fscr:"𝒻",Fscr:"ℱ",gacute:"ǵ",gamma:"γ",Gamma:"Γ",gammad:"ϝ",Gammad:"Ϝ",gap:"⪆",gbreve:"ğ",Gbreve:"Ğ",Gcedil:"Ģ",gcirc:"ĝ",Gcirc:"Ĝ",gcy:"г",Gcy:"Г",gdot:"ġ",Gdot:"Ġ",ge:"≥",gE:"≧",gel:"⋛",gEl:"⪌",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",gfr:"𝔤",Gfr:"𝔊",gg:"≫",Gg:"⋙",ggg:"⋙",gimel:"ℷ",gjcy:"ѓ",GJcy:"Ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gne:"⪈",gnE:"≩",gneq:"⪈",gneqq:"≩",gnsim:"⋧",gopf:"𝕘",Gopf:"𝔾",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",gscr:"ℊ",Gscr:"𝒢",gsim:"≳",gsime:"⪎",gsiml:"⪐",gt:">",Gt:"≫",GT:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",hardcy:"ъ",HARDcy:"Ъ",harr:"↔",hArr:"⇔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",hcirc:"ĥ",Hcirc:"Ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",hfr:"𝔥",Hfr:"ℌ",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",hopf:"𝕙",Hopf:"ℍ",horbar:"―",HorizontalLine:"─",hscr:"𝒽",Hscr:"ℋ",hslash:"ℏ",hstrok:"ħ",Hstrok:"Ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",iacute:"í",Iacute:"Í",ic:"⁣",icirc:"î",Icirc:"Î",icy:"и",Icy:"И",Idot:"İ",iecy:"е",IEcy:"Е",iexcl:"¡",iff:"⇔",ifr:"𝔦",Ifr:"ℑ",igrave:"ì",Igrave:"Ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",ijlig:"ĳ",IJlig:"Ĳ",Im:"ℑ",imacr:"ī",Imacr:"Ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",int:"∫",Int:"∬",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",iocy:"ё",IOcy:"Ё",iogon:"į",Iogon:"Į",iopf:"𝕚",Iopf:"𝕀",iota:"ι",Iota:"Ι",iprod:"⨼",iquest:"¿",iscr:"𝒾",Iscr:"ℐ",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",itilde:"ĩ",Itilde:"Ĩ",iukcy:"і",Iukcy:"І",iuml:"ï",Iuml:"Ï",jcirc:"ĵ",Jcirc:"Ĵ",jcy:"й",Jcy:"Й",jfr:"𝔧",Jfr:"𝔍",jmath:"ȷ",jopf:"𝕛",Jopf:"𝕁",jscr:"𝒿",Jscr:"𝒥",jsercy:"ј",Jsercy:"Ј",jukcy:"є",Jukcy:"Є",kappa:"κ",Kappa:"Κ",kappav:"ϰ",kcedil:"ķ",Kcedil:"Ķ",kcy:"к",Kcy:"К",kfr:"𝔨",Kfr:"𝔎",kgreen:"ĸ",khcy:"х",KHcy:"Х",kjcy:"ќ",KJcy:"Ќ",kopf:"𝕜",Kopf:"𝕂",kscr:"𝓀",Kscr:"𝒦",lAarr:"⇚",lacute:"ĺ",Lacute:"Ĺ",laemptyv:"⦴",lagran:"ℒ",lambda:"λ",Lambda:"Λ",lang:"⟨",Lang:"⟪",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",larr:"←",lArr:"⇐",Larr:"↞",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",latail:"⤙",lAtail:"⤛",late:"⪭",lates:"⪭︀",lbarr:"⤌",lBarr:"⤎",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",lcaron:"ľ",Lcaron:"Ľ",lcedil:"ļ",Lcedil:"Ļ",lceil:"⌈",lcub:"{",lcy:"л",Lcy:"Л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",le:"≤",lE:"≦",LeftAngleBracket:"⟨",leftarrow:"←",Leftarrow:"⇐",LeftArrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",leftrightarrow:"↔",Leftrightarrow:"⇔",LeftRightArrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",leg:"⋚",lEg:"⪋",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",lfr:"𝔩",Lfr:"𝔏",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",ljcy:"љ",LJcy:"Љ",ll:"≪",Ll:"⋘",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",lmidot:"ŀ",Lmidot:"Ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lne:"⪇",lnE:"≨",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",longleftarrow:"⟵",Longleftarrow:"⟸",LongLeftArrow:"⟵",longleftrightarrow:"⟷",Longleftrightarrow:"⟺",LongLeftRightArrow:"⟷",longmapsto:"⟼",longrightarrow:"⟶",Longrightarrow:"⟹",LongRightArrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",lopf:"𝕝",Lopf:"𝕃",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",lscr:"𝓁",Lscr:"ℒ",lsh:"↰",Lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",lstrok:"ł",Lstrok:"Ł",lt:"<",Lt:"≪",LT:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",map:"↦",Map:"⤅",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",mcy:"м",Mcy:"М",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",mfr:"𝔪",Mfr:"𝔐",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",mopf:"𝕞",Mopf:"𝕄",mp:"∓",mscr:"𝓂",Mscr:"ℳ",mstpos:"∾",mu:"μ",Mu:"Μ",multimap:"⊸",mumap:"⊸",nabla:"∇",nacute:"ń",Nacute:"Ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",ncaron:"ň",Ncaron:"Ň",ncedil:"ņ",Ncedil:"Ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",ncy:"н",Ncy:"Н",ndash:"–",ne:"≠",nearhk:"⤤",nearr:"↗",neArr:"⇗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:`
`,nexist:"∄",nexists:"∄",nfr:"𝔫",Nfr:"𝔑",nge:"≱",ngE:"≧̸",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",ngt:"≯",nGt:"≫⃒",ngtr:"≯",nGtv:"≫̸",nharr:"↮",nhArr:"⇎",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",njcy:"њ",NJcy:"Њ",nlarr:"↚",nlArr:"⇍",nldr:"‥",nle:"≰",nlE:"≦̸",nleftarrow:"↚",nLeftarrow:"⇍",nleftrightarrow:"↮",nLeftrightarrow:"⇎",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nlt:"≮",nLt:"≪⃒",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",nopf:"𝕟",Nopf:"ℕ",not:"¬",Not:"⫬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrarr:"↛",nrArr:"⇏",nrarrc:"⤳̸",nrarrw:"↝̸",nrightarrow:"↛",nRightarrow:"⇏",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",nscr:"𝓃",Nscr:"𝒩",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsube:"⊈",nsubE:"⫅̸",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupe:"⊉",nsupE:"⫆̸",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",ntilde:"ñ",Ntilde:"Ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",nu:"ν",Nu:"Ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nvdash:"⊬",nvDash:"⊭",nVdash:"⊮",nVDash:"⊯",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwarr:"↖",nwArr:"⇖",nwarrow:"↖",nwnear:"⤧",oacute:"ó",Oacute:"Ó",oast:"⊛",ocir:"⊚",ocirc:"ô",Ocirc:"Ô",ocy:"о",Ocy:"О",odash:"⊝",odblac:"ő",Odblac:"Ő",odiv:"⨸",odot:"⊙",odsold:"⦼",oelig:"œ",OElig:"Œ",ofcir:"⦿",ofr:"𝔬",Ofr:"𝔒",ogon:"˛",ograve:"ò",Ograve:"Ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",omacr:"ō",Omacr:"Ō",omega:"ω",Omega:"Ω",omicron:"ο",Omicron:"Ο",omid:"⦶",ominus:"⊖",oopf:"𝕠",Oopf:"𝕆",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",or:"∨",Or:"⩔",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",oscr:"ℴ",Oscr:"𝒪",oslash:"ø",Oslash:"Ø",osol:"⊘",otilde:"õ",Otilde:"Õ",otimes:"⊗",Otimes:"⨷",otimesas:"⨶",ouml:"ö",Ouml:"Ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",pcy:"п",Pcy:"П",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",pfr:"𝔭",Pfr:"𝔓",phi:"φ",Phi:"Φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",pi:"π",Pi:"Π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",popf:"𝕡",Popf:"ℙ",pound:"£",pr:"≺",Pr:"⪻",prap:"⪷",prcue:"≼",pre:"⪯",prE:"⪳",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",prime:"′",Prime:"″",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",pscr:"𝓅",Pscr:"𝒫",psi:"ψ",Psi:"Ψ",puncsp:" ",qfr:"𝔮",Qfr:"𝔔",qint:"⨌",qopf:"𝕢",Qopf:"ℚ",qprime:"⁗",qscr:"𝓆",Qscr:"𝒬",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",quot:'"',QUOT:'"',rAarr:"⇛",race:"∽̱",racute:"ŕ",Racute:"Ŕ",radic:"√",raemptyv:"⦳",rang:"⟩",Rang:"⟫",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",rarr:"→",rArr:"⇒",Rarr:"↠",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",rarrtl:"↣",Rarrtl:"⤖",rarrw:"↝",ratail:"⤚",rAtail:"⤜",ratio:"∶",rationals:"ℚ",rbarr:"⤍",rBarr:"⤏",RBarr:"⤐",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",rcaron:"ř",Rcaron:"Ř",rcedil:"ŗ",Rcedil:"Ŗ",rceil:"⌉",rcub:"}",rcy:"р",Rcy:"Р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",reg:"®",REG:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",rfr:"𝔯",Rfr:"ℜ",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",rho:"ρ",Rho:"Ρ",rhov:"ϱ",RightAngleBracket:"⟩",rightarrow:"→",Rightarrow:"⇒",RightArrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",ropf:"𝕣",Ropf:"ℝ",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",rscr:"𝓇",Rscr:"ℛ",rsh:"↱",Rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",sacute:"ś",Sacute:"Ś",sbquo:"‚",sc:"≻",Sc:"⪼",scap:"⪸",scaron:"š",Scaron:"Š",sccue:"≽",sce:"⪰",scE:"⪴",scedil:"ş",Scedil:"Ş",scirc:"ŝ",Scirc:"Ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",scy:"с",Scy:"С",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",searr:"↘",seArr:"⇘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",sfr:"𝔰",Sfr:"𝔖",sfrown:"⌢",sharp:"♯",shchcy:"щ",SHCHcy:"Щ",shcy:"ш",SHcy:"Ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",sigma:"σ",Sigma:"Σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",softcy:"ь",SOFTcy:"Ь",sol:"/",solb:"⧄",solbar:"⌿",sopf:"𝕤",Sopf:"𝕊",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",square:"□",Square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",sscr:"𝓈",Sscr:"𝒮",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",star:"☆",Star:"⋆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",sub:"⊂",Sub:"⋐",subdot:"⪽",sube:"⊆",subE:"⫅",subedot:"⫃",submult:"⫁",subne:"⊊",subnE:"⫋",subplus:"⪿",subrarr:"⥹",subset:"⊂",Subset:"⋐",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",sum:"∑",Sum:"∑",sung:"♪",sup:"⊃",Sup:"⋑",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supe:"⊇",supE:"⫆",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supne:"⊋",supnE:"⫌",supplus:"⫀",supset:"⊃",Supset:"⋑",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swarr:"↙",swArr:"⇙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"	",target:"⌖",tau:"τ",Tau:"Τ",tbrk:"⎴",tcaron:"ť",Tcaron:"Ť",tcedil:"ţ",Tcedil:"Ţ",tcy:"т",Tcy:"Т",tdot:"⃛",telrec:"⌕",tfr:"𝔱",Tfr:"𝔗",there4:"∴",therefore:"∴",Therefore:"∴",theta:"θ",Theta:"Θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",thorn:"þ",THORN:"Þ",tilde:"˜",Tilde:"∼",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",topf:"𝕥",Topf:"𝕋",topfork:"⫚",tosa:"⤩",tprime:"‴",trade:"™",TRADE:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",tscr:"𝓉",Tscr:"𝒯",tscy:"ц",TScy:"Ц",tshcy:"ћ",TSHcy:"Ћ",tstrok:"ŧ",Tstrok:"Ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",uacute:"ú",Uacute:"Ú",uarr:"↑",uArr:"⇑",Uarr:"↟",Uarrocir:"⥉",ubrcy:"ў",Ubrcy:"Ў",ubreve:"ŭ",Ubreve:"Ŭ",ucirc:"û",Ucirc:"Û",ucy:"у",Ucy:"У",udarr:"⇅",udblac:"ű",Udblac:"Ű",udhar:"⥮",ufisht:"⥾",ufr:"𝔲",Ufr:"𝔘",ugrave:"ù",Ugrave:"Ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",umacr:"ū",Umacr:"Ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",uogon:"ų",Uogon:"Ų",uopf:"𝕦",Uopf:"𝕌",uparrow:"↑",Uparrow:"⇑",UpArrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",updownarrow:"↕",Updownarrow:"⇕",UpDownArrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",upsi:"υ",Upsi:"ϒ",upsih:"ϒ",upsilon:"υ",Upsilon:"Υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",uring:"ů",Uring:"Ů",urtri:"◹",uscr:"𝓊",Uscr:"𝒰",utdot:"⋰",utilde:"ũ",Utilde:"Ũ",utri:"▵",utrif:"▴",uuarr:"⇈",uuml:"ü",Uuml:"Ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",varr:"↕",vArr:"⇕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",vBar:"⫨",Vbar:"⫫",vBarv:"⫩",vcy:"в",Vcy:"В",vdash:"⊢",vDash:"⊨",Vdash:"⊩",VDash:"⊫",Vdashl:"⫦",vee:"∨",Vee:"⋁",veebar:"⊻",veeeq:"≚",vellip:"⋮",verbar:"|",Verbar:"‖",vert:"|",Vert:"‖",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",vfr:"𝔳",Vfr:"𝔙",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",vopf:"𝕧",Vopf:"𝕍",vprop:"∝",vrtri:"⊳",vscr:"𝓋",Vscr:"𝒱",vsubne:"⊊︀",vsubnE:"⫋︀",vsupne:"⊋︀",vsupnE:"⫌︀",Vvdash:"⊪",vzigzag:"⦚",wcirc:"ŵ",Wcirc:"Ŵ",wedbar:"⩟",wedge:"∧",Wedge:"⋀",wedgeq:"≙",weierp:"℘",wfr:"𝔴",Wfr:"𝔚",wopf:"𝕨",Wopf:"𝕎",wp:"℘",wr:"≀",wreath:"≀",wscr:"𝓌",Wscr:"𝒲",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",xfr:"𝔵",Xfr:"𝔛",xharr:"⟷",xhArr:"⟺",xi:"ξ",Xi:"Ξ",xlarr:"⟵",xlArr:"⟸",xmap:"⟼",xnis:"⋻",xodot:"⨀",xopf:"𝕩",Xopf:"𝕏",xoplus:"⨁",xotime:"⨂",xrarr:"⟶",xrArr:"⟹",xscr:"𝓍",Xscr:"𝒳",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",yacute:"ý",Yacute:"Ý",yacy:"я",YAcy:"Я",ycirc:"ŷ",Ycirc:"Ŷ",ycy:"ы",Ycy:"Ы",yen:"¥",yfr:"𝔶",Yfr:"𝔜",yicy:"ї",YIcy:"Ї",yopf:"𝕪",Yopf:"𝕐",yscr:"𝓎",Yscr:"𝒴",yucy:"ю",YUcy:"Ю",yuml:"ÿ",Yuml:"Ÿ",zacute:"ź",Zacute:"Ź",zcaron:"ž",Zcaron:"Ž",zcy:"з",Zcy:"З",zdot:"ż",Zdot:"Ż",zeetrf:"ℨ",ZeroWidthSpace:"​",zeta:"ζ",Zeta:"Ζ",zfr:"𝔷",Zfr:"ℨ",zhcy:"ж",ZHcy:"Ж",zigrarr:"⇝",zopf:"𝕫",Zopf:"ℤ",zscr:"𝓏",Zscr:"𝒵",zwj:"‍",zwnj:"‌"},x={aacute:"á",Aacute:"Á",acirc:"â",Acirc:"Â",acute:"´",aelig:"æ",AElig:"Æ",agrave:"à",Agrave:"À",amp:"&",AMP:"&",aring:"å",Aring:"Å",atilde:"ã",Atilde:"Ã",auml:"ä",Auml:"Ä",brvbar:"¦",ccedil:"ç",Ccedil:"Ç",cedil:"¸",cent:"¢",copy:"©",COPY:"©",curren:"¤",deg:"°",divide:"÷",eacute:"é",Eacute:"É",ecirc:"ê",Ecirc:"Ê",egrave:"è",Egrave:"È",eth:"ð",ETH:"Ð",euml:"ë",Euml:"Ë",frac12:"½",frac14:"¼",frac34:"¾",gt:">",GT:">",iacute:"í",Iacute:"Í",icirc:"î",Icirc:"Î",iexcl:"¡",igrave:"ì",Igrave:"Ì",iquest:"¿",iuml:"ï",Iuml:"Ï",laquo:"«",lt:"<",LT:"<",macr:"¯",micro:"µ",middot:"·",nbsp:" ",not:"¬",ntilde:"ñ",Ntilde:"Ñ",oacute:"ó",Oacute:"Ó",ocirc:"ô",Ocirc:"Ô",ograve:"ò",Ograve:"Ò",ordf:"ª",ordm:"º",oslash:"ø",Oslash:"Ø",otilde:"õ",Otilde:"Õ",ouml:"ö",Ouml:"Ö",para:"¶",plusmn:"±",pound:"£",quot:'"',QUOT:'"',raquo:"»",reg:"®",REG:"®",sect:"§",shy:"­",sup1:"¹",sup2:"²",sup3:"³",szlig:"ß",thorn:"þ",THORN:"Þ",times:"×",uacute:"ú",Uacute:"Ú",ucirc:"û",Ucirc:"Û",ugrave:"ù",Ugrave:"Ù",uml:"¨",uuml:"ü",Uuml:"Ü",yacute:"ý",Yacute:"Ý",yen:"¥",yuml:"ÿ"},T={0:"�",128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},R=[1,2,3,4,5,6,7,8,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,64976,64977,64978,64979,64980,64981,64982,64983,64984,64985,64986,64987,64988,64989,64990,64991,64992,64993,64994,64995,64996,64997,64998,64999,65e3,65001,65002,65003,65004,65005,65006,65007,65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111],_=String.fromCharCode,F={},N=F.hasOwnProperty,C=function(V,J){return N.call(V,J)},M=function(V,J){for(var ve=-1,de=V.length;++ve<de;)if(V[ve]==J)return!0;return!1},L=function(V,J){if(!V)return J;var ve={},de;for(de in J)ve[de]=C(V,de)?V[de]:J[de];return ve},I=function(V,J){var ve="";return V>=55296&&V<=57343||V>1114111?(J&&$("character reference outside the permissible Unicode range"),"�"):C(T,V)?(J&&$("disallowed character reference"),T[V]):(J&&M(R,V)&&$("disallowed character reference"),V>65535&&(V-=65536,ve+=_(V>>>10&1023|55296),V=56320|V&1023),ve+=_(V),ve)},U=function(V){return"&#x"+V.toString(16).toUpperCase()+";"},q=function(V){return"&#"+V+";"},$=function(V){throw Error("Parse error: "+V)},X=function(V,J){J=L(J,X.options);var ve=J.strict;ve&&m.test(V)&&$("forbidden code point");var de=J.encodeEverything,De=J.useNamedReferences,Ie=J.allowUnsafeSymbols,Ne=J.decimal?q:U,Be=function($e){return Ne($e.charCodeAt(0))};return de?(V=V.replace(o,function($e){return De&&C(h,$e)?"&"+h[$e]+";":Be($e)}),De&&(V=V.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;").replace(/&#x66;&#x6A;/g,"&fjlig;")),De&&(V=V.replace(l,function($e){return"&"+h[$e]+";"}))):De?(Ie||(V=V.replace(d,function($e){return"&"+h[$e]+";"})),V=V.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;"),V=V.replace(l,function($e){return"&"+h[$e]+";"})):Ie||(V=V.replace(d,Be)),V.replace(a,function($e){var et=$e.charCodeAt(0),rt=$e.charCodeAt(1),Ge=(et-55296)*1024+rt-56320+65536;return Ne(Ge)}).replace(u,Be)};X.options={allowUnsafeSymbols:!1,encodeEverything:!1,strict:!1,useNamedReferences:!1,decimal:!1};var ie=function(V,J){J=L(J,ie.options);var ve=J.strict;return ve&&g.test(V)&&$("malformed character reference"),V.replace(v,function(de,De,Ie,Ne,Be,$e,et,rt,Ge){var nt,B,se,xe,Ae,ge;return De?(Ae=De,E[Ae]):Ie?(Ae=Ie,ge=Ne,ge&&J.isAttributeValue?(ve&&ge=="="&&$("`&` did not start a character reference"),de):(ve&&$("named character reference was not terminated by a semicolon"),x[Ae]+(ge||""))):Be?(se=Be,B=$e,ve&&!B&&$("character reference was not terminated by a semicolon"),nt=parseInt(se,10),I(nt,ve)):et?(xe=et,B=rt,ve&&!B&&$("character reference was not terminated by a semicolon"),nt=parseInt(xe,16),I(nt,ve)):(ve&&$("named character reference was not terminated by a semicolon"),de)})};ie.options={isAttributeValue:!1,strict:!1};var ne=function(V){return V.replace(d,function(J){return p[J]})},ue={version:"1.2.0",encode:X,decode:ie,escape:ne,unescape:ie};if(r&&!r.nodeType)if(n)n.exports=ue;else for(var re in ue)C(ue,re)&&(r[re]=ue[re]);else t.he=ue})(A3)}(ml,ml.exports)),ml.exports}var S3=x3();const b3=Fa(S3);var Ec={exports:{}},Kx={};/*! http://mths.be/fromcodepoint v0.2.1 by @mathias */var Wx;function T3(){return Wx||(Wx=1,String.fromCodePoint||function(){var i=function(){try{var n={},s=Object.defineProperty,a=s(n,n,n)&&s}catch{}return a}(),e=String.fromCharCode,t=Math.floor,r=function(n){var s=16384,a=[],o,u,l=-1,h=arguments.length;if(!h)return"";for(var d="";++l<h;){var p=Number(arguments[l]);if(!isFinite(p)||p<0||p>1114111||t(p)!=p)throw RangeError("Invalid code point: "+p);p<=65535?a.push(p):(p-=65536,o=(p>>10)+55296,u=p%1024+56320,a.push(o,u)),(l+1==h||a.length>s)&&(d+=e.apply(null,a),a.length=0)}return d};i?i(String,"fromCodePoint",{value:r,configurable:!0,writable:!0}):String.fromCodePoint=r}()),Kx}var Yx;function D3(){return Yx||(Yx=1,function(i,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,T3();var t=/\\(u\{([0-9A-Fa-f]+)\}|u([0-9A-Fa-f]{4})|x([0-9A-Fa-f]{2})|([1-7][0-7]{0,2}|[0-7]{2,3})|(['"tbrnfv0\\]))|\\U([0-9A-Fa-f]{8})/g,r={0:"\0",b:"\b",f:"\f",n:`
`,r:"\r",t:"	",v:"\v","'":"'",'"':'"',"\\":"\\"},n=function(u){return String.fromCodePoint(parseInt(u,16))},s=function(u){return String.fromCodePoint(parseInt(u,8))},a=function(u){return u.replace(t,function(l,h,d,p,g,m,v,E){return d!==void 0?n(d):p!==void 0?n(p):g!==void 0?n(g):m!==void 0?s(m):E!==void 0?n(E):r[v]})};e.default=a,i.exports=e.default}(Ec,Ec.exports)),Ec.exports}var R3=D3();const I3=Fa(R3);class Ut{static appendSubtitle(e,t,r){return e.end=t.end,e.dur=e.end-e.start,r?e.text+=" "+t.text:e.text+=t.text,e}static convertVttEntriesToSubtitles(e){const t=[],r=[];let n=!1;for(let s=0;s<e.length;s++){const a=e[s],o=this.createSubtitle(a),u=this.createSubtitle(a);!n&&this.hasPunctuation(o.text)&&(n=!0),t.push(o),r.push(u)}return{hasPunctuation:n,subtitles:t,originSubtitles:r}}static convertDropboxSegmentsToSubtitles(e){const t=[],r=[];let n=!1;for(let s=0;s<e.length;s++){const a=e[s],o=this.createSubtitleBySegment(a),u=this.createSubtitleBySegment(a);!n&&this.hasPunctuation(o.text)&&(n=!0),t.push(o),r.push(u)}return{hasPunctuation:n,subtitles:t,originSubtitles:r}}static createSubtitleBySegment(e){return{start:e.startTime,end:e.endTime,dur:e.endTime-e.startTime,text:this.normalizeSubtitleText(e.text),processPunctuation:!0}}static createSubtitle(e){return{start:e.startTime,end:e.endTime,dur:e.endTime-e.startTime,text:this.normalizeSubtitleText(e.text),processPunctuation:!0}}static normalizeSubtitleText(e){let t=e.replaceAll(`
`," ");return t=I3(t),t=b3.decode(t),t=Hx(t).result,t=t.replace(/[^\p{L}\p{N}\p{P}\p{Zs}]/gu,""),t=t.replace(/(\s+|^)uh,?/gi,"$1"),t}static hasPunctuation(e){for(let t=0;t<e.length;t++){const r=e.charAt(t);if(cr.isPunctuation(r))return!0}return!1}static hasAnyPunctuation(e){for(let t of e)if(Ut.hasPunctuation(t.text))return!0;return!1}static copyToSubtitleRequests(e){return e.map(t=>({text:t.text,start:t.start,end:t.end,dur:t.dur}))}static copyToSubtitles(e){return e.map(t=>({text:t.text,start:t.start,end:t.end,dur:t.dur,processPunctuation:!0}))}static findFirstWord(e){let t="";const r=e.text.trim();for(let n=0;n<r.length;n++){const s=r.charAt(n);if(t+=s,cr.isPunctuation(s)||cr.isWeakPunctuation(s)||s.trim().length===0)return t}return t}static findLastWord(e){let t=[];for(let r=e.text.length-1;r>=0;r--){const n=e.text.charAt(r);if(!(t.length===0&&(cr.isPunctuation(n)||cr.isWeakPunctuation(n)||n.trim().length===0))&&(t.push(n),t.length!==0&&(cr.isPunctuation(n)||cr.isWeakPunctuation(n)||n.trim().length===0)))break}return t.reverse().join("")}static isSoundEffectMarker(e){return e.startsWith("[")&&e.endsWith("]")}}class Ac{constructor(){fe(this,"MAX_TEXT_LENGTH",80);fe(this,"MIN_TEXT_LENGTH",20)}segmentSubtitlesBySentence(e){let t=this.segmentSubtitlesByMainPunctuation(e);return t=this.segmentSubtitlesByWeakPunctuation(t),t=this.mergeSubtitlesByWordBoundary(t),this.validateProcessedSubtitlesOrFallback(t,e)}mergeSubtitlesByWordBoundary(e){if(e.length<=1)return e;const t=[];let r=e[0];for(let n=0;n<e.length-1;n++){const s=e[n+1],a=Ut.findLastWord(r).trim(),o=Ut.findFirstWord(s).trim();a&&o&&a===o?Ut.appendSubtitle(r,s,!0):this.isDecimalNumberSplit(r,s)||cr.containsOnlyPunctuationAndSpaces(s.text)?Ut.appendSubtitle(r,s,!1):(t.push(r),r=s)}return t.push(r),t}segmentSubtitlesByMainPunctuation(e){const t=[];let r=!1,n;for(let s=0;s<e.length;s++){const a=e[s];a.text=a.text.replaceAll('"',"").replaceAll("'","");const o=this.segmentSubtitlesByPunctuation(a);mt.isEmpty(o)||(t.length===0?t.push(...o):r?t.push(...o):(Ut.appendSubtitle(n,o[0],!0),o.length>1&&t.push(...o.slice(1))),n=mt.last(t),r=cr.endsWithPunctuation(n.text))}return t}segmentSubtitlesByWeakPunctuation(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r];if(n.text.length<=this.MAX_TEXT_LENGTH){t.push(n);continue}t.push(...this.segmentSubtitleByWeakPunctuation(n))}return t}segmentSubtitleByWeakPunctuation(e){const t=[],r=this.computeCharTime(e);let n=0,s=e.start;for(let a=0;a<e.text.length;a++){const o=e.text.charAt(a);if((cr.isWeakPunctuation(o)||cr.isPunctuation(o))&&a-n+1>=this.MIN_TEXT_LENGTH){const u=this.sliceSubtitleByIndex(e,n,a,r,s);t.push(u),n=a+1,s=u.end}}if(n<e.text.length){const a=this.sliceSubtitleByIndex(e,n,e.text.length-1,r,s);t.push(a)}return t}segmentSubtitlesByPunctuation(e){const t=this.computeCharTime(e),r=[];let n=0,s=e.start;for(let a=0;a<e.text.length;a++){const o=e.text.charAt(a);if(cr.isPunctuation(o)){const u=this.sliceSubtitleByIndex(e,n,a,t,s);n=a+1,s=u.end,cr.containsOnlyPunctuationAndSpaces(u.text.trim())&&r.length>0?Ut.appendSubtitle(mt.last(r),u,!1):r.push(u)}}if(n<e.text.length){const a=this.sliceSubtitleByIndex(e,n,e.text.length-1,t,s);r.push(a)}return r}isDecimalNumberSplit(e,t){const r=e.text.trim(),n=r.substring(r.length-2)+t.text.trim().charAt(0);return mt.isNumber(Number(n))&&!mt.isNaN(Number(n))}sliceSubtitleByIndex(e,t,r,n,s){const a=e.text.substring(t,r+1),u=this.computeCharCount(a)*n,l=s+u;return{text:a,start:s,end:l,dur:u,processPunctuation:!0}}computeCharTime(e){const t=this.computeCharCount(e.text);return t>0?e.dur/t:0}computeCharCount(e){let t=0;for(let r=0;r<e.length;r++){const n=e.charAt(r);!cr.isPunctuation(n)&&n!==" "&&t++}return t}validateProcessedSubtitlesOrFallback(e,t){let r=!1;for(let n of e)if(n.text.length>=300){r=!0;break}if(r){for(let n of t)n.processPunctuation=!1;return t}else return e}postProcessParsedResult(e,t){return e.hasPunctuation&&(e.subtitles=this.segmentSubtitlesBySentence(e.subtitles)),t.subtitleTimeUnit==="millisecond"&&(e.subtitles=this.convertSubtitlesToSeconds(e.subtitles),e.originSubtitles=this.convertSubtitlesToSeconds(e.originSubtitles)),e}convertSubtitlesToSeconds(e){return e.forEach(t=>{t.start=t.start/1e3,t.end=t.end/1e3,t.dur=t.dur/1e3}),e}}class xp{constructor(){fe(this,"punctuationSubtitleService",new Ac)}async parse(e,t){const r=await this.parseSubtitle(e,t);return this.punctuationSubtitleService.postProcessParsedResult(r,t)}}const _n={BadSignature:1,BadTimestamp:2,BadSettingValue:3,BadFormat:4,UnknownSetting:5};class Mn extends Error{constructor(t){super(t.reason);fe(this,"code");fe(this,"line");this.code=t.code,this.line=t.line}}const w3=/\r?\n|\r/gm;async function Xx(i,e){const t=new ReadableStream({start(r){const n=i.split(w3);for(const s of n)r.enqueue(s);r.close()}});return C3(t,e)}async function C3(i,e){const t="vtt";let r;switch(t){case"srt":r=(await Promise.resolve().then(()=>VF)).default;break;case"ssa":case"ass":r=(await Promise.resolve().then(()=>WF)).default;break;default:r=(await Promise.resolve().then(function(){return X3})).default}let n;const s=i.getReader(),a=r();await a.init({strict:!1,...e,errors:!1,type:t,cancel(){s.cancel(),n=a.done(!0)}});let u=1;for(;;){const{value:l,done:h}=await s.read();if(h){a.parse("",u),n=a.done(!1);break}a.parse(l,u),u++}return n}const N3=window.VTTCue;class Sp extends N3{constructor(){super(...arguments);fe(this,"region",null);fe(this,"vertical","");fe(this,"snapToLines",!0);fe(this,"line","auto");fe(this,"lineAlign","start");fe(this,"position","auto");fe(this,"positionAlign","auto");fe(this,"size",100);fe(this,"align","center");fe(this,"style")}}class L3{constructor(){fe(this,"id","");fe(this,"width",100);fe(this,"lines",3);fe(this,"regionAnchorX",0);fe(this,"regionAnchorY",100);fe(this,"viewportAnchorX",0);fe(this,"viewportAnchorY",100);fe(this,"scroll","")}}const zx=",",_3="%";function M3(i){const e=parseInt(i,10);return Number.isNaN(e)?null:e}function yl(i){const e=parseInt(i.replace(_3,""),10);return!Number.isNaN(e)&&e>=0&&e<=100?e:null}function jx(i){if(!i.includes(zx))return null;const[e,t]=i.split(zx).map(yl);return e!==null&&t!==null?[e,t]:null}function O3(i){const e=parseFloat(i);return Number.isNaN(e)?null:e}const P3="WEBVTT",Jx=",",k3="%",lo=/[:=]/,F3=/^[\s\t]*(region|vertical|line|position|size|align)[:=]/,B3="NOTE",U3="REGION",$3=/^REGION:?[\s\t]+/,vl=/[\s\t]+/,G3="-->",q3=/[\s\t]*-->[\s\t]+/,H3=/start|center|end|left|right/,V3=/start|center|end/,K3=/line-(?:left|right)|center|auto/,W3=/^(?:(\d{1,2}):)?(\d{2}):(\d{2})(?:\.(\d{1,3}))?$/;var El=(i=>(i[i.None=0]="None",i[i.Header=1]="Header",i[i.Cue=2]="Cue",i[i.Region=3]="Region",i[i.Note=4]="Note",i))(El||{});class bp{constructor(){fe(this,"f");fe(this,"c",0);fe(this,"g",{});fe(this,"h",{});fe(this,"j",[]);fe(this,"a",null);fe(this,"b",null);fe(this,"k",[]);fe(this,"d");fe(this,"l","")}async init(e){this.f=e,e.strict&&(this.c=1),e.errors&&(this.d=(await Promise.resolve().then(()=>pS)).ParseErrorBuilder)}parse(e,t){var r,n,s,a,o,u;if(e==="")this.a?(this.j.push(this.a),(n=(r=this.f).onCue)==null||n.call(r,this.a),this.a=null):this.b?(this.h[this.b.id]=this.b,(a=(s=this.f).onRegion)==null||a.call(s,this.b),this.b=null):this.c===1&&(this.i(e,t),(u=(o=this.f).onHeaderMetadata)==null||u.call(o,this.g)),this.c=0;else if(this.c)switch(this.c){case 1:this.i(e,t);break;case 2:if(this.a){const l=this.a.text.length>0;!l&&F3.test(e)?this.m(e.split(vl),t):this.a.text+=(l?`
`:"")+e}break;case 3:this.n(e.split(vl),t);break}else if(e.startsWith(B3))this.c=4;else if(e.startsWith(U3))this.c=3,this.b=new L3,this.n(e.replace($3,"").split(vl),t);else if(e.includes(G3)){const l=this.o(e,t);l&&(this.a=new Sp(l[0],l[1],""),this.a.id=this.l,this.m(l[2],t)),this.c=2}else t===1&&this.i(e,t);this.l=e}done(){return{metadata:this.g,cues:this.j,regions:Object.values(this.h),errors:this.k}}i(e,t){var r;if(t>1){if(lo.test(e)){const[n,s]=e.split(lo);n&&(this.g[n]=(s||"").replace(vl,""))}}else e.startsWith(P3)?this.c=1:this.e((r=this.d)==null?void 0:r.p())}o(e,t){var l,h,d;const[r,n=""]=e.split(q3),[s,...a]=n.split(vl),o=Al(r),u=Al(s);if(o!==null&&u!==null&&u>o)return[o,u,a];o===null&&this.e((l=this.d)==null?void 0:l.q(r,t)),u===null&&this.e((h=this.d)==null?void 0:h.r(s,t)),o!=null&&u!==null&&u>o&&this.e((d=this.d)==null?void 0:d.s(o,u,t))}n(e,t){var n,s;let r;for(let a=0;a<e.length;a++)if(lo.test(e[a])){r=!1;const[o,u]=e[a].split(lo);switch(o){case"id":this.b.id=u;break;case"width":const l=yl(u);l!==null?this.b.width=l:r=!0;break;case"lines":const h=M3(u);h!==null?this.b.lines=h:r=!0;break;case"regionanchor":const d=jx(u);d!==null?(this.b.regionAnchorX=d[0],this.b.regionAnchorY=d[1]):r=!0;break;case"viewportanchor":const p=jx(u);p!==null?(this.b.viewportAnchorX=p[0],this.b.viewportAnchorY=p[1]):r=!0;break;case"scroll":u==="up"?this.b.scroll="up":r=!0;break;default:this.e((n=this.d)==null?void 0:n.t(o,u,t))}r&&this.e((s=this.d)==null?void 0:s.u(o,u,t))}}m(e,t){var n,s;let r;for(let a=0;a<e.length;a++)if(r=!1,lo.test(e[a])){const[o,u]=e[a].split(lo);switch(o){case"region":const l=this.h[u];l&&(this.a.region=l);break;case"vertical":u==="lr"||u==="rl"?(this.a.vertical=u,this.a.region=null):r=!0;break;case"line":const[h,d]=u.split(Jx);if(h.includes(k3)){const E=yl(h);E!==null?(this.a.line=E,this.a.snapToLines=!1):r=!0}else{const E=O3(h);E!==null?this.a.line=E:r=!0}V3.test(d)?this.a.lineAlign=d:d&&(r=!0),this.a.line!=="auto"&&(this.a.region=null);break;case"position":const[p,g]=u.split(Jx),m=yl(p);m!==null?this.a.position=m:r=!0,g&&K3.test(g)?this.a.positionAlign=g:g&&(r=!0);break;case"size":const v=yl(u);v!==null?(this.a.size=v,v<100&&(this.a.region=null)):r=!0;break;case"align":H3.test(u)?this.a.align=u:r=!0;break;default:this.e((n=this.d)==null?void 0:n.v(o,u,t))}r&&this.e((s=this.d)==null?void 0:s.w(o,u,t))}}e(e){var t,r;if(e){if(this.k.push(e),this.f.strict)throw this.f.cancel(),e;(r=(t=this.f).onError)==null||r.call(t,e)}}}function Al(i){const e=i.match(W3);if(!e)return null;const t=e[1]?parseInt(e[1],10):0,r=parseInt(e[2],10),n=parseInt(e[3],10),s=e[4]?parseInt(e[4].padEnd(3,"0"),10):0,a=t*3600+r*60+n+s/1e3;return t<0||r<0||n<0||s<0||r>59||n>59?null:a}function Y3(){return new bp}var X3=Object.freeze({__proto__:null,VTTBlock:El,VTTParser:bp,default:Y3,parseVTTTimestamp:Al});class z3 extends xp{async parseSubtitle(e,t){const r=this.removeVttHeader(e),n=await Xx(r);return Ut.convertVttEntriesToSubtitles(n.cues)}removeVttHeader(e){let t=e.trimStart();return t.startsWith(`WEBVTT
`)&&(t=t.replace(`WEBVTT
`,"")),t}}class j3 extends xp{async parseSubtitle(e,t){if(t.subtitleFormat==="vtt"||t.subtitleFormat==="srt")throw console.error("CustomFormatSubtitleParser does not support standard subtitle formats, please use SrtVttSubtitleParser for vtt/srt formats",{subtitleFormat:t.subtitleFormat,domain:t.domain}),new Error(`CustomFormatSubtitleParser does not support ${t.subtitleFormat} format, standard subtitle formats should be handled by SrtVttSubtitleParser`);const r=t.subtitleFormat,n=JSON.parse(e),s=wi(n,r.subtitleListJsonPath),a=[],o=[];let u=!1;for(let l=0;l<s.length;l++){const h=s[l],d=this.createSubtitle(h,r),p=this.createSubtitle(h,r);!u&&Ut.hasPunctuation(d.text)&&(u=!0);const g=h;g[r.subtitleTextName].startsWith("♪")&&g[r.subtitleTextName].endsWith("♪")||g[r.subtitleTextName].trim()==="音乐"||a.push(d),o.push(p)}if(!u)for(let l of a)l.processPunctuation=!1;return{hasPunctuation:u,subtitles:a,originSubtitles:o}}createSubtitle(e,t){const r=e[t.subtitleStartTimeName],n=t.timeType==="end"?e[t.subtitleEndTimeName]:r+e[t.subtitleEndTimeName];return{start:r,end:n,dur:n-r,text:Ut.normalizeSubtitleText(e[t.subtitleTextName]),processPunctuation:!0}}}var js=(i=>(i[i.GREEN=0]="GREEN",i[i.YELLOW=1]="YELLOW",i[i.RED=2]="RED",i))(js||{});class ln{observeMediaMetadata(e){return this.createMetadataObservable(e).pipe(Ar(r=>this.transformMetadata(r,e.siteDubbingRules)))}extractMediaMetadata(e,t,r){var o;const n=Or.extractVideoId(e.videoIdExtract,t),s=Or.extractTitle(e.titleExtract,t),a=this.getBestSubtitle(e,t);return{videoId:n,title:s,subtitleMetadata:a,subtitleLevel:a!=null&&a.isAsr?js.RED:js.YELLOW,videoLanguage:Or.extractVideoLanguage(e,t),isPrivate:e.isPrivateExtract?new $O().getIsPrivate(e.isPrivateExtract,t):!1,channelId:e.channelIdExtract?new GO().getChannelId(e.channelIdExtract,t):"",duration:e.durationExtract?new qO().extractDuration(e.durationExtract,t):((o=t.media)==null?void 0:o.duration)??0,isLiveVideo:r,supportLanguageCode:e.supportedLanguageExtract?new HO().extractSupportLanguage(e.supportedLanguageExtract,t):["SG"],subtitles:[],originSubtitles:[]}}getBestSubtitle(e,t){return new k1().getBestSubtitle(e.subtitleExtract,t)}async transformMetadata(e,t){if(e.subtitleMetadata===void 0)return e;const r=await fetch(e.subtitleMetadata.url);if(r.ok){const n=await r.text(),s=await this.parseSubtitle(n,t);e.originSubtitles=s.originSubtitles,e.subtitles=s.subtitles,e.subtitleMetadata.hasPunctuation=s.hasPunctuation}return e}async parseSubtitle(e,t){return t.subtitleFormat==="vtt"||t.subtitleFormat==="srt"?new z3().parse(e,t):new j3().parse(e,t)}matchUrl(e,t){return t.urlMatchType==="includes"?e.includes(t.url):!e.startsWith("https")||t.urlExclude&&new as(t.urlExclude).includes(e)?!1:new as(t.url).includes(e)}filterRequest(e,t,r,n){return r.urlRequestMethod.toLowerCase()===e.toLowerCase()&&this.matchUrl(t,r)&&n.dubbingPages.some(s=>new as(s).includes(window.location.href))}}class J3 extends ln{createMetadataObservable(e){if(e.siteDubbingRules.domTrackConfig===void 0)throw console.error("DomBasedMediaMetadataService: domTrackConfig is undefined for site",e.siteDubbingRules),new Error("the website is missing the domTrackConfig configuration.");const t=e.siteDubbingRules.mediaSelector;return ya(200).pipe(fr(()=>{const n=document.querySelector(t);return n?n.src:null}),Jt(n=>n!=null&&n!==""),rR()).pipe(Ar(n=>{console.log("enter dom switchMap, src changed to:",n);const s=document.querySelector(t),a=new Ti(s,e.tabTitle);return e.siteDubbingRules.domTrackConfig.parseConfig.isLiveVideoExtract?Gr(new hx().getIsLive(e.siteDubbingRules.domTrackConfig.parseConfig.isLiveVideoExtract,a)).pipe(fr(o=>this.extractMediaMetadata(e.siteDubbingRules.domTrackConfig.parseConfig,a,o))):Rr(this.extractMediaMetadata(e.siteDubbingRules.domTrackConfig.parseConfig,a,!1))}))}extractMediaMetadata(e,t,r){var n;return{videoId:Or.extractVideoId(e.videoIdExtract,t),title:Or.extractTitle(e.titleExtract,t),subtitleMetadata:new IE().getBestSubtitle(e.subtitleExtract,t),subtitleLevel:js.YELLOW,videoLanguage:Or.extractVideoLanguage(e,t),isPrivate:!1,channelId:"",duration:((n=t.media)==null?void 0:n.duration)??0,isLiveVideo:r,supportLanguageCode:["SG"],subtitles:[],originSubtitles:[]}}}class xl{async getIsLive(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract live video status using JSONPath",t),Error("Context vo object is missing, unable to extract live video status using JSONPath");if(mt.isEmpty(e.values))throw console.error("Live video extraction configuration is missing JSONPath values property",e),new Error("Live video extraction configuration is missing JSONPath values property");return Or.extractBooleanByJsonPath(e.values,e.computeType,t.data)}}class Qx extends ln{createMetadataObservable(e){var a;if(e.siteDubbingRules.windowVariableConfig===void 0)throw console.error("WindowBasedMediaMetadataService: windowVariableConfig is undefined for site",e.siteDubbingRules),new Error("The website is missing the windowVariableConfig configuration.");const t=document.querySelector(e.siteDubbingRules.mediaSelector),r=e.siteDubbingRules.windowVariableConfig,n=wi(window,r.variableJsonPath);if(!n)return kh;const s=new Ti(t,e.tabTitle,n);return(a=r.parseConfig)!=null&&a.isLiveVideoExtract?Gr(new xl().getIsLive(r.parseConfig.isLiveVideoExtract,s)).pipe(fr(o=>this.extractMediaMetadata(r.parseConfig,s,o))):Rr(this.extractMediaMetadata(r.parseConfig,s,!1))}}var On=["load","loadend","timeout","error","readystatechange","abort"],Js="__origin_xhr";function Tp(i,e){var t={};for(var r in i)t[r]=i[r];return t.target=t.currentTarget=e,t}function Q3(i,e){e=e||window;var t=e.XMLHttpRequest,r=!0,n=function(){for(var l=new t,h=0;h<On.length;++h){var d="on"+On[h];l[d]===void 0&&(l[d]=null)}for(var p in l){var g="";try{g=typeof l[p]}catch{}g==="function"?this[p]=o(p):p!==Js&&Object.defineProperty(this,p,{get:s(p),set:a(p),enumerable:!0})}var m=this;l.getProxy=function(){return m},this[Js]=l};n.prototype=t.prototype,n.prototype.constructor=n,e.XMLHttpRequest=n,Object.assign(e.XMLHttpRequest,{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4});function s(l){return function(){var h=this[Js][l];if(r){var d=this.hasOwnProperty(l+"_")?this[l+"_"]:h,p=(i[l]||{}).getter;return p&&p(d,this)||d}else return h}}function a(l){return function(h){var d=this[Js];if(r){var p=this,g=i[l];if(l.substring(0,2)==="on")p[l+"_"]=h,d[l]=function(v){v=Tp(v,p);var E=i[l]&&i[l].call(p,d,v);E||h.call(p,v)};else{var m=(g||{}).setter;h=m&&m(h,p)||h,this[l+"_"]=h;try{d[l]=h}catch{}}}else d[l]=h}}function o(l){return function(){var h=[].slice.call(arguments);if(i[l]&&r){var d=i[l].call(this,h,this[Js]);if(d)return d}return this[Js][l].apply(this[Js],h)}}function u(){r=!1,e.XMLHttpRequest===n&&(e.XMLHttpRequest=t,n.prototype.constructor=t,t=void 0)}return{originXhr:t,unHook:u}}var Z3=On[0],Zx=On[1],eF=On[2],tF=On[3],Dp=On[4],rF=On[5],xc="prototype";function iF(i,e){return e=e||window,lF(i,e)}function nF(i){return i.replace(/^\s+|\s+$/g,"")}function eS(i){return i.watcher||(i.watcher=document.createElement("a"))}function uo(i,e){var t=i.getProxy(),r="on"+e+"_",n=Tp({type:e},t);t[r]&&t[r](n);var s;typeof Event=="function"?s=new Event(e,{bubbles:!1}):(s=document.createEvent("Event"),s.initEvent(e,!1,!0)),eS(i).dispatchEvent(s)}function Rp(i){this.xhr=i,this.xhrProxy=i.getProxy()}Rp[xc]=Object.create({resolve:function(e){var t=this.xhrProxy,r=this.xhr;t.readyState=4,r.resHeader=e.headers,t.response=t.responseText=e.response,t.statusText=e.statusText,t.status=e.status,uo(r,Dp),uo(r,Z3),uo(r,Zx)},reject:function(e){this.xhrProxy.status=0,uo(this.xhr,e.type),uo(this.xhr,Zx)}});function Ip(i){function e(t){Rp.call(this,t)}return e[xc]=Object.create(Rp[xc]),e[xc].next=i,e}var sF=Ip(function(i){var e=this.xhr;i=i||e.config,e.withCredentials=i.withCredentials,e.open(i.method,i.url,i.async!==!1,i.user,i.password);for(var t in i.headers)e.setRequestHeader(t,i.headers[t]);e.send(i.body)}),aF=Ip(function(i){this.resolve(i)}),oF=Ip(function(i){this.reject(i)});function lF(i,e){var t=i.onRequest,r=i.onResponse,n=i.onError;function s(g){var m=g.responseType;if(!m||m==="text")return g.responseText;var v=g.response;if(m==="json"&&!v)try{return JSON.parse(g.responseText)}catch(E){console.warn(E)}return v}function a(g,m){var v=new aF(g),E={response:s(m),status:m.status,statusText:m.statusText,config:g.config,headers:g.resHeader||g.getAllResponseHeaders().split(`\r
`).reduce(function(x,T){if(T==="")return x;var R=T.split(":");return x[R.shift()]=nF(R.join(":")),x},{})};if(!r)return v.resolve(E);r(E,v)}function o(g,m,v,E){var x=new oF(g);v={config:g.config,error:v,type:E},n?n(v,x):x.next(v)}function u(){return!0}function l(g){return function(m,v){return o(m,this,v,g),!0}}function h(g,m){return g.readyState===4&&g.status!==0?a(g,m):g.readyState!==4&&uo(g,Dp),!0}var{originXhr:d,unHook:p}=Q3({onload:u,onloadend:u,onerror:l(tF),ontimeout:l(eF),onabort:l(rF),onreadystatechange:function(g){return h(g,this)},open:function(m,v){var E=this,x=v.config={headers:{}};x.method=m[0],x.url=m[1],x.async=m[2],x.user=m[3],x.password=m[4],x.xhr=v;var T="on"+Dp;if(v[T]||(v[T]=function(){return h(v,E)}),t)return!0},send:function(g,m){var v=m.config;if(v.withCredentials=m.withCredentials,v.body=g[0],t){var E=function(){t(v,new sF(m))};return v.async===!1?E():setTimeout(E),!0}},setRequestHeader:function(g,m){if(m.config.headers[g[0].toLowerCase()]=g[1],t)return!0},addEventListener:function(g,m){var v=this;if(On.indexOf(g[0])!==-1){var E=g[1];return eS(m).addEventListener(g[0],function(x){var T=Tp(x,v);T.type=g[0],T.isTrusted=!0,E.call(v,T)}),!0}},getAllResponseHeaders:function(g,m){var v=m.resHeader;if(v){var E="";for(var x in v)E+=x+": "+v[x]+`\r
`;return E}},getResponseHeader:function(g,m){var v=m.resHeader;if(v)return v[(g[0]||"").toLowerCase()]}},e);return{originXhr:d,unProxy:p}}class co{static fromMutationObserver(e,t){return ZD(r=>{const n=new MutationObserver(s=>r(s));return n.observe(e,t),n},(r,n)=>n.disconnect())}static fromAttributeChanges(e,t){return this.fromMutationObserver(e,{attributes:!0,attributeFilter:t})}static createXhrAjaxObservable(e){if(document.head.querySelector('meta[http-equiv="Content-Security-Policy"]'))return{observable:new dr,unregister:()=>{}};const t=new Os,r=XMLHttpRequest.prototype.open,n=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(a,o,...u){const l=this;return l._method=a,l._url=o,r.apply(this,arguments)},XMLHttpRequest.prototype.send=function(a){const o=this,u=o._method||"GET",l=o._url||"";return e(u,l)&&(o.addEventListener("load",function(){try{t.next({type:"response",url:l,ok:o.status>=200&&o.status<300,responseText:o.responseText})}catch(h){t.next({type:"error",error:h instanceof Error?h.message:"Unknown error during response processing"})}}),o.addEventListener("error",function(){t.next({type:"error",error:"Network error"})})),n.apply(this,arguments)};const s=()=>{XMLHttpRequest.prototype.open=r,XMLHttpRequest.prototype.send=n};return{observable:t.asObservable(),unregister:s}}static createAjaxObservable(e){const t=new Os,{unProxy:r}=iF({onRequest:(n,s)=>{s.next(n)},onResponse:(n,s)=>{const a=n.config.method.toUpperCase(),o=n.config.url;e(a,o)&&t.next({type:"response",url:o,ok:n.status>=200&&n.status<300,responseText:n.response}),s.next(n)},onError:(n,s)=>{const a=n.config.method.toUpperCase(),o=n.config.url;e(a,o)&&t.next({type:"error",error:n.type+": Unknown error"}),s.next(n)}});return{observable:t.asObservable(),unregister:()=>{r()}}}static async waitForPunctuation(e){const t=$h(0,200).pipe(Jt(()=>e()),Ps(1));await Bh(t)}}class tS extends ln{createMetadataObservable(e){const t=e.siteDubbingRules.apiInterceptConfig;if(t===void 0)throw console.error("ApiInterceptBasedMediaMetadataService: apiInterceptConfig is undefined for site",e.siteDubbingRules),new Error("The website is missing the apiInterceptConfig configuration.");return da(t.urlRequestType).with("ajax",()=>co.createAjaxObservable((n,s)=>this.filterRequest(n,s,t,e.siteDubbingRules))).exhaustive().observable.pipe(Jt(n=>n.type==="response"),Ar(n=>{var u;const s=document.querySelector(e.siteDubbingRules.mediaSelector),a=JSON.parse(n.responseText),o=new Ti(s,e.tabTitle,a);return(u=t.parseConfig)!=null&&u.isLiveVideoExtract?Gr(new xl().getIsLive(t.parseConfig.isLiveVideoExtract,o)).pipe(fr(l=>this.extractMediaMetadata(t.parseConfig,o,l))):Rr(this.extractMediaMetadata(t.parseConfig,o,!1))}))}}class uF extends ln{constructor(){super();fe(this,"windowBasedService");fe(this,"apiInterceptService");this.windowBasedService=new Qx,this.apiInterceptService=new tS}createMetadataObservable(t){const r=this.windowBasedService.createMetadataObservable(t).pipe(Ps(1)),n=this.apiInterceptService.createMetadataObservable(t);return Fm(r,n)}}class wp{convertToOriginSubtitles(e,t=!0){var n;const r=[];for(let s=0;s<e.length;s++){const a=e[s];if(a.segs===void 0)continue;if(a.segs.length===1){if(a.segs[0].utf8===`
`)continue;if(Ut.isSoundEffectMarker(a.segs[0].utf8))continue;if(mt.isEmpty((n=a.segs[0].utf8)==null?void 0:n.trim()))continue}const o=this.convertOriginSubtitle(a);r.push(o)}if(t)for(let s of r)s.start=s.start/1e3,s.end=s.end/1e3,s.dur=s.dur/1e3;return r}convertOriginSubtitle(e){const t=e.segs;let r="";for(let n of t)r+=n.utf8+" ";return{start:e.tStartMs,end:e.tStartMs+e.dDurationMs,dur:e.dDurationMs,text:r,processPunctuation:!0}}}class cF{constructor(){fe(this,"youtubeOriginSubtitleService",new wp)}async parse(e,t){const n=JSON.parse(e).events;let s={hasPunctuation:!1,subtitles:[],originSubtitles:[]};s.originSubtitles=this.youtubeOriginSubtitleService.convertToOriginSubtitles(n);for(let a=0;a<n.length;a++){const o=n[a];if(o.segs===void 0)continue;if(o.segs.length===1){if(o.segs[0].utf8===`
`)continue;if(this.isSoundEffectMarker(o.segs[0].utf8))continue}const u=n[a+1],l=this.convertSubtitles(o,u);s.subtitles.push(l)}return s}isSoundEffectMarker(e){return e.startsWith("[")&&e.endsWith("]")}convertSubtitles(e,t){if(e.segs===void 0)throw new Error("Subtitle events must be provided");const r=e.segs;let n;for(let s=0;s<r.length;s++){const a=r[s];if(n===void 0)n=this.createSubtitle(e,a,s,t);else{const o=this.createSubtitle(e,a,s,t);n=Ut.appendSubtitle(n,o,!0)}}return n&&(n.text=Ut.normalizeSubtitleText(n.text)),n}createSubtitle(e,t,r,n){let s=e.tStartMs;t.tOffsetMs!==void 0&&(s+=t.tOffsetMs),s=s/1e3;let a=this.calculateSegmentEndTime(e,r+1,n)/1e3;return{start:s,end:a,dur:a-s,text:t.utf8,processPunctuation:!1}}calculateSegmentEndTime(e,t,r){if(e.segs===void 0)throw new Error("Subtitle events must be provided");let s=e.segs[t];return s!==void 0?e.tStartMs+s.tOffsetMs:r!==void 0?r.tStartMs:e.tStartMs+e.dDurationMs}}class hF extends xp{constructor(){super(...arguments);fe(this,"youtubeOriginSubtitleService",new wp)}async parseSubtitle(t,r){const s=JSON.parse(t).events;let a=this.youtubeOriginSubtitleService.convertToOriginSubtitles(s,!1);const o=[];let u=!1;for(let l=0;l<s.length;l++){const h=s[l],d=h.segs;if(d===void 0||mt.isEmpty(d))continue;const p=this.createSubtitle(h,d[0]);!u&&Ut.hasPunctuation(p.text)&&(u=!0),o.push(p)}return{subtitles:o,hasPunctuation:u,originSubtitles:a}}createSubtitle(t,r){return{start:t.tStartMs,end:t.tStartMs+t.dDurationMs,dur:t.dDurationMs,text:Ut.normalizeSubtitleText(r.utf8),processPunctuation:!0}}}class dF{constructor(){fe(this,"punctuationSubtitleService",new Ac);fe(this,"youtubeOriginSubtitleService",new wp)}async parse(e,t){const n=JSON.parse(e).events;let s={hasPunctuation:!0,subtitles:[],originSubtitles:[]};return s.originSubtitles=this.youtubeOriginSubtitleService.convertToOriginSubtitles(n),s.subtitles=this.segmentYouTubeAsrSubtitles(n),s.subtitles=this.punctuationSubtitleService.segmentSubtitlesBySentence(s.subtitles),s}segmentYouTubeAsrSubtitles(e){var r;const t=[];for(let n=0;n<e.length;n++){const s=e[n];if(s.segs===void 0)continue;if(s.segs.length===1){if(s.segs[0].utf8===`
`)continue;if(Ut.isSoundEffectMarker(s.segs[0].utf8))continue;if(mt.isEmpty((r=s.segs[0].utf8)==null?void 0:r.trim()))continue}const a=e[n+1],o=this.convertSubtitles(s,a);if(!mt.isEmpty(o))if(mt.isEmpty(t))t.push(...o);else{const u=mt.last(t);cr.endsWithPunctuation(u.text)?t.push(...o):(Ut.appendSubtitle(u,o[0],!0),o.length>1&&t.push(...o.slice(1)))}}return t}convertSubtitles(e,t){if(e.segs===void 0)throw new Error("Subtitle events must be provided");const r=e.segs,n=[];let s;for(let a=0;a<r.length;a++){const o=r[a];if(s===void 0)s=this.createSubtitle(e,o,a,t);else{const u=this.createSubtitle(e,o,a,t);s=Ut.appendSubtitle(s,u,!1)}cr.endsWithPunctuation(s.text)&&(s.text=Ut.normalizeSubtitleText(s.text),n.push(s),s=void 0)}return s!==void 0&&(s.text=Ut.normalizeSubtitleText(s.text),n.push(s)),n}createSubtitle(e,t,r,n){let s=e.tStartMs;t.tOffsetMs!==void 0&&(s+=t.tOffsetMs),s=s/1e3;let a=this.calculateSegmentEndTime(e,r+1,n)/1e3;return{start:s,end:a,dur:a-s,text:t.utf8,processPunctuation:!0}}calculateSegmentEndTime(e,t,r){if(e.segs===void 0)throw new Error("Subtitle events must be provided");let s=e.segs[t];return s!==void 0?e.tStartMs+s.tOffsetMs:r!==void 0?r.tStartMs:e.tStartMs+e.dDurationMs}}class Qs{static getPlayerId(){return new as("*://*.youtube.com/shorts/*").includes(window.location.href)?"shorts-player":"movie_player"}static createWatchAdsObservable(){const e=Ue(".html5-video-player");if(e.hasClass("ad-showing")){const t=e[0];return co.fromAttributeChanges(t,["class"]).pipe(Jt(r=>r.some(()=>!e.hasClass("ad-showing"))))}}static createPlayerClassObservable(){const t=Ue(".html5-video-player")[0];return co.fromAttributeChanges(t,["class"])}}class fF extends ln{constructor(){super(...arguments);fe(this,"lastVideoId")}createMetadataObservable(t){return console.log("[debug-metadata] enter createMetadataObservable"),ya(200).pipe(fr(()=>{var n,s;const r=document.getElementById(Qs.getPlayerId());if(!(!r||r.getPlayerState()===3))return(s=(n=r.getPlayerResponse())==null?void 0:n.videoDetails)==null?void 0:s.videoId}),Jt(r=>r!=null),Jt(r=>this.lastVideoId===void 0||r!==this.lastVideoId),va(r=>this.lastVideoId=r),Ar(r=>{const n=document.getElementById(Qs.getPlayerId());if(console.log("[debug-metadata] enter createMetadataObservable switch map, videoId == ["+r+"], player state == "+n.getPlayerState()),n.getPlayerState()===-1||n.getPlayerState()===2){const s=Ue(`#${Qs.getPlayerId()} > div.html5-video-container > video`)[0];return console.log("[debug-metadata] start youtube play"),s.play().catch(a=>console.error("try play media occur error",a)),Rr(r)}else return Rr(r)}),Ar(r=>{var l;console.log("[debug-metadata] enter createMetadataObservable switch map videoId == "+r);const s=document.getElementById(Qs.getPlayerId()).getPlayerResponse(),a=Ue(`#${Qs.getPlayerId()} > div.html5-video-container > video`)[0],o=t.siteDubbingRules.windowVariableConfig,u=new Ti(a,t.tabTitle,s);return(l=o==null?void 0:o.parseConfig)!=null&&l.isLiveVideoExtract?Gr(new xl().getIsLive(o.parseConfig.isLiveVideoExtract,u)).pipe(fr(h=>this.extractMediaMetadata(o.parseConfig,u,h))):Rr(this.extractMediaMetadata(o.parseConfig,u,!1))}))}async transformMetadata(t,r){if(t.subtitleMetadata===void 0)return t;const n=t.subtitleMetadata.language,s=document.getElementById(Qs.getPlayerId());if(!s)return t;console.log("[debug-metadata] enter transformMetadata, videoId == "+t.videoId+", player state == "+s.getPlayerState());const a=co.createXhrAjaxObservable((l,h)=>this.filterYouTubeRequest(l,h,n)).observable.pipe(km(1e3),Gh(l=>l instanceof Pm?(console.log("[debug-metadata] 超时，调用enableCaptionsWithReset兜底"),this.enableCaptionsWithReset(s,n),Mm(()=>l)):Mm(()=>l)),sR({delay:0}),Jt(l=>l.type==="response"),Jt(l=>l.responseText.length>0),Ar(l=>{console.log("[debug-metadata] enter switchMap, videoId == "+t.videoId);const h=Iw.parse(l.url);return Gr(this.parseYouTubeSubtitle(l.responseText,r,t.subtitleMetadata.isAsr,h.variant==="punctuated")).pipe(fr(d=>(console.log("[debug-metadata] enter after parseYouTubeSubtitle, videoId == "+t.videoId),t.originSubtitles=d.originSubtitles,t.subtitles=d.subtitles,t.subtitleMetadata.hasPunctuation=d.hasPunctuation,t)))})),o=Bh(a),u=()=>{console.log(`[debug-metadata] onReady triggered, videoId: ${t.videoId}`),this.enableCaptionsWithReset(s,n),s.removeEventListener("onReady",u)};return s.addEventListener("onReady",u),this.enableCaptionsWithReset(s,n),s.addEventListener("onApiChange",()=>{console.log("[debug-metadata] enter onApiChange, videoId == "+t.videoId),this.enableCaptionsWithReset(s,n)}),o}enableCaptionsWithReset(t,r){const n=t.getOption("captions","track")||{};!!n.languageCode&&(console.log(`已启用，先禁用再启用: ${n.languageCode} -> {}`),t.setOption("captions","track",{})),t.unloadModule("captions"),t.loadModule("captions"),t.setOption("captions","track",{languageCode:r})}parseYouTubeSubtitle(t,r,n,s){return n||this.isAsrSubtitle(t)?s||!n?new dF().parse(t,r):new cF().parse(t,r):new hF().parse(t,r)}isAsrSubtitle(t){const n=JSON.parse(t).events;return this.findFirstSegArray(n).length>1}findFirstSegArray(t){for(let r=0;r<t.length;r++){const n=t[r];if(n.segs&&n.segs.length>0)return n.segs}return[]}filterYouTubeRequest(t,r,n){return t.toLowerCase()!=="get"||!r.includes("/api/timedtext")?!1:Nf.parse(new URL(r).search.substring(1)).lang===n}}class gF{static findTrack(e,t,r){for(let n of e)if(n.kind===r&&n.language===t)return n}}class pF extends xu{getSubtitles(e,t){let r=[];const n=this.findMuxVideoByMedia(t.media);if(!n)throw console.error("Failed to find mux-video element in Shadow Root, cannot extract subtitles"),new Error("MuxBasedExtractSubtitleService: Unable to locate mux-video element required for subtitle extraction");for(let s of t.media.textTracks)s.kind==="subtitles"&&r.push(this.buildSubtitleMediaData(s,n));return r}buildSubtitleMediaData(e,t){return{url:t.src,language:e.language,isAsr:!1,hasPunctuation:!0}}postProcessSubtitle(e,t){if(e===void 0)return;const r=gF.findTrack(t.media.textTracks,e.language,"subtitles");return r&&(r.mode="showing"),e}findMuxVideoByMedia(e){const t=e.shadowRoot;if(!t)console.error("未找到 Shadow Root");else{const r=t.querySelector("mux-video");if(r)return console.log("找到 mux-video 元素: ",r),r;console.error("在 Shadow Root 中未找到 mux-video")}}}class rS{static async fetchText(e){const t=await fetch(e,{headers:{Referer:window.location.href}});if(!t.ok)throw new Error(`主 M3U8 fetch 失败: ${t.status}`);return t.text()}}var Cp=function(){function i(){this.listeners={}}var e=i.prototype;return e.on=function(r,n){this.listeners[r]||(this.listeners[r]=[]),this.listeners[r].push(n)},e.off=function(r,n){if(!this.listeners[r])return!1;var s=this.listeners[r].indexOf(n);return this.listeners[r]=this.listeners[r].slice(0),this.listeners[r].splice(s,1),s>-1},e.trigger=function(r){var n=this.listeners[r];if(n)if(arguments.length===2)for(var s=n.length,a=0;a<s;++a)n[a].call(this,arguments[1]);else for(var o=Array.prototype.slice.call(arguments,1),u=n.length,l=0;l<u;++l)n[l].apply(this,o)},e.dispose=function(){this.listeners={}},e.pipe=function(r){this.on("data",function(n){r.push(n)})},i}();function ho(){return ho=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},ho.apply(null,arguments)}var Np,iS;function mF(){if(iS)return Np;iS=1;var i;return typeof window<"u"?i=window:typeof Ci<"u"?i=Ci:typeof self<"u"?i=self:i={},Np=i,Np}var yF=mF();const nS=Fa(yF);var vF=function(e){return nS.atob?nS.atob(e):Buffer.from(e,"base64").toString("binary")};function EF(i){for(var e=vF(i),t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}/*! @name m3u8-parser @version 7.2.0 @license Apache-2.0 */class AF extends Cp{constructor(){super(),this.buffer=""}push(e){let t;for(this.buffer+=e,t=this.buffer.indexOf(`
`);t>-1;t=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)}}const xF="	",Lp=function(i){const e=/([0-9.]*)?@?([0-9.]*)?/.exec(i||""),t={};return e[1]&&(t.length=parseInt(e[1],10)),e[2]&&(t.offset=parseInt(e[2],10)),t},SF=function(){const t="(?:"+"[^=]*"+")=(?:"+'"[^"]*"|[^,]*'+")";return new RegExp("(?:^|,)("+t+")")},Pr=function(i){const e={};if(!i)return e;const t=i.split(SF());let r=t.length,n;for(;r--;)t[r]!==""&&(n=/([^=]*)=(.*)/.exec(t[r]).slice(1),n[0]=n[0].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^['"](.*)['"]$/g,"$1"),e[n[0]]=n[1]);return e},sS=i=>{const e=i.split("x"),t={};return e[0]&&(t.width=parseInt(e[0],10)),e[1]&&(t.height=parseInt(e[1],10)),t};class bF extends Cp{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(e){let t,r;if(e=e.trim(),e.length===0)return;if(e[0]!=="#"){this.trigger("data",{type:"uri",uri:e});return}this.tagMappers.reduce((s,a)=>{const o=a(e);return o===e?s:s.concat([o])},[e]).forEach(s=>{for(let a=0;a<this.customParsers.length;a++)if(this.customParsers[a].call(this,s))return;if(s.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:s.slice(1)});return}if(s=s.replace("\r",""),t=/^#EXTM3U/.exec(s),t){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(t=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(s),t){r={type:"tag",tagType:"inf"},t[1]&&(r.duration=parseFloat(t[1])),t[2]&&(r.title=t[2]),this.trigger("data",r);return}if(t=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(s),t){r={type:"tag",tagType:"targetduration"},t[1]&&(r.duration=parseInt(t[1],10)),this.trigger("data",r);return}if(t=/^#EXT-X-VERSION:([0-9.]*)?/.exec(s),t){r={type:"tag",tagType:"version"},t[1]&&(r.version=parseInt(t[1],10)),this.trigger("data",r);return}if(t=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(s),t){r={type:"tag",tagType:"media-sequence"},t[1]&&(r.number=parseInt(t[1],10)),this.trigger("data",r);return}if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(s),t){r={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(r.number=parseInt(t[1],10)),this.trigger("data",r);return}if(t=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(s),t){r={type:"tag",tagType:"playlist-type"},t[1]&&(r.playlistType=t[1]),this.trigger("data",r);return}if(t=/^#EXT-X-BYTERANGE:(.*)?$/.exec(s),t){r=ho(Lp(t[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",r);return}if(t=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(s),t){r={type:"tag",tagType:"allow-cache"},t[1]&&(r.allowed=!/NO/.test(t[1])),this.trigger("data",r);return}if(t=/^#EXT-X-MAP:(.*)$/.exec(s),t){if(r={type:"tag",tagType:"map"},t[1]){const a=Pr(t[1]);a.URI&&(r.uri=a.URI),a.BYTERANGE&&(r.byterange=Lp(a.BYTERANGE))}this.trigger("data",r);return}if(t=/^#EXT-X-STREAM-INF:(.*)$/.exec(s),t){r={type:"tag",tagType:"stream-inf"},t[1]&&(r.attributes=Pr(t[1]),r.attributes.RESOLUTION&&(r.attributes.RESOLUTION=sS(r.attributes.RESOLUTION)),r.attributes.BANDWIDTH&&(r.attributes.BANDWIDTH=parseInt(r.attributes.BANDWIDTH,10)),r.attributes["FRAME-RATE"]&&(r.attributes["FRAME-RATE"]=parseFloat(r.attributes["FRAME-RATE"])),r.attributes["PROGRAM-ID"]&&(r.attributes["PROGRAM-ID"]=parseInt(r.attributes["PROGRAM-ID"],10))),this.trigger("data",r);return}if(t=/^#EXT-X-MEDIA:(.*)$/.exec(s),t){r={type:"tag",tagType:"media"},t[1]&&(r.attributes=Pr(t[1])),this.trigger("data",r);return}if(t=/^#EXT-X-ENDLIST/.exec(s),t){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(t=/^#EXT-X-DISCONTINUITY/.exec(s),t){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(t=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(s),t){r={type:"tag",tagType:"program-date-time"},t[1]&&(r.dateTimeString=t[1],r.dateTimeObject=new Date(t[1])),this.trigger("data",r);return}if(t=/^#EXT-X-KEY:(.*)$/.exec(s),t){r={type:"tag",tagType:"key"},t[1]&&(r.attributes=Pr(t[1]),r.attributes.IV&&(r.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(r.attributes.IV=r.attributes.IV.substring(2)),r.attributes.IV=r.attributes.IV.match(/.{8}/g),r.attributes.IV[0]=parseInt(r.attributes.IV[0],16),r.attributes.IV[1]=parseInt(r.attributes.IV[1],16),r.attributes.IV[2]=parseInt(r.attributes.IV[2],16),r.attributes.IV[3]=parseInt(r.attributes.IV[3],16),r.attributes.IV=new Uint32Array(r.attributes.IV))),this.trigger("data",r);return}if(t=/^#EXT-X-START:(.*)$/.exec(s),t){r={type:"tag",tagType:"start"},t[1]&&(r.attributes=Pr(t[1]),r.attributes["TIME-OFFSET"]=parseFloat(r.attributes["TIME-OFFSET"]),r.attributes.PRECISE=/YES/.test(r.attributes.PRECISE)),this.trigger("data",r);return}if(t=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(s),t){r={type:"tag",tagType:"cue-out-cont"},t[1]?r.data=t[1]:r.data="",this.trigger("data",r);return}if(t=/^#EXT-X-CUE-OUT:(.*)?$/.exec(s),t){r={type:"tag",tagType:"cue-out"},t[1]?r.data=t[1]:r.data="",this.trigger("data",r);return}if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(s),t){r={type:"tag",tagType:"cue-in"},t[1]?r.data=t[1]:r.data="",this.trigger("data",r);return}if(t=/^#EXT-X-SKIP:(.*)$/.exec(s),t&&t[1]){r={type:"tag",tagType:"skip"},r.attributes=Pr(t[1]),r.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(r.attributes["SKIPPED-SEGMENTS"]=parseInt(r.attributes["SKIPPED-SEGMENTS"],10)),r.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(r.attributes["RECENTLY-REMOVED-DATERANGES"]=r.attributes["RECENTLY-REMOVED-DATERANGES"].split(xF)),this.trigger("data",r);return}if(t=/^#EXT-X-PART:(.*)$/.exec(s),t&&t[1]){r={type:"tag",tagType:"part"},r.attributes=Pr(t[1]),["DURATION"].forEach(function(a){r.attributes.hasOwnProperty(a)&&(r.attributes[a]=parseFloat(r.attributes[a]))}),["INDEPENDENT","GAP"].forEach(function(a){r.attributes.hasOwnProperty(a)&&(r.attributes[a]=/YES/.test(r.attributes[a]))}),r.attributes.hasOwnProperty("BYTERANGE")&&(r.attributes.byterange=Lp(r.attributes.BYTERANGE)),this.trigger("data",r);return}if(t=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(s),t&&t[1]){r={type:"tag",tagType:"server-control"},r.attributes=Pr(t[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(a){r.attributes.hasOwnProperty(a)&&(r.attributes[a]=parseFloat(r.attributes[a]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(a){r.attributes.hasOwnProperty(a)&&(r.attributes[a]=/YES/.test(r.attributes[a]))}),this.trigger("data",r);return}if(t=/^#EXT-X-PART-INF:(.*)$/.exec(s),t&&t[1]){r={type:"tag",tagType:"part-inf"},r.attributes=Pr(t[1]),["PART-TARGET"].forEach(function(a){r.attributes.hasOwnProperty(a)&&(r.attributes[a]=parseFloat(r.attributes[a]))}),this.trigger("data",r);return}if(t=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(s),t&&t[1]){r={type:"tag",tagType:"preload-hint"},r.attributes=Pr(t[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(a){if(r.attributes.hasOwnProperty(a)){r.attributes[a]=parseInt(r.attributes[a],10);const o=a==="BYTERANGE-LENGTH"?"length":"offset";r.attributes.byterange=r.attributes.byterange||{},r.attributes.byterange[o]=r.attributes[a],delete r.attributes[a]}}),this.trigger("data",r);return}if(t=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(s),t&&t[1]){r={type:"tag",tagType:"rendition-report"},r.attributes=Pr(t[1]),["LAST-MSN","LAST-PART"].forEach(function(a){r.attributes.hasOwnProperty(a)&&(r.attributes[a]=parseInt(r.attributes[a],10))}),this.trigger("data",r);return}if(t=/^#EXT-X-DATERANGE:(.*)$/.exec(s),t&&t[1]){r={type:"tag",tagType:"daterange"},r.attributes=Pr(t[1]),["ID","CLASS"].forEach(function(o){r.attributes.hasOwnProperty(o)&&(r.attributes[o]=String(r.attributes[o]))}),["START-DATE","END-DATE"].forEach(function(o){r.attributes.hasOwnProperty(o)&&(r.attributes[o]=new Date(r.attributes[o]))}),["DURATION","PLANNED-DURATION"].forEach(function(o){r.attributes.hasOwnProperty(o)&&(r.attributes[o]=parseFloat(r.attributes[o]))}),["END-ON-NEXT"].forEach(function(o){r.attributes.hasOwnProperty(o)&&(r.attributes[o]=/YES/i.test(r.attributes[o]))}),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(o){r.attributes.hasOwnProperty(o)&&(r.attributes[o]=r.attributes[o].toString(16))});const a=/^X-([A-Z]+-)+[A-Z]+$/;for(const o in r.attributes){if(!a.test(o))continue;const u=/[0-9A-Fa-f]{6}/g.test(r.attributes[o]),l=/^\d+(\.\d+)?$/.test(r.attributes[o]);r.attributes[o]=u?r.attributes[o].toString(16):l?parseFloat(r.attributes[o]):String(r.attributes[o])}this.trigger("data",r);return}if(t=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(s),t){this.trigger("data",{type:"tag",tagType:"independent-segments"});return}if(t=/^#EXT-X-I-FRAMES-ONLY/.exec(s),t){this.trigger("data",{type:"tag",tagType:"i-frames-only"});return}if(t=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(s),t){r={type:"tag",tagType:"content-steering"},r.attributes=Pr(t[1]),this.trigger("data",r);return}if(t=/^#EXT-X-I-FRAME-STREAM-INF:(.*)$/.exec(s),t){r={type:"tag",tagType:"i-frame-playlist"},r.attributes=Pr(t[1]),r.attributes.URI&&(r.uri=r.attributes.URI),r.attributes.BANDWIDTH&&(r.attributes.BANDWIDTH=parseInt(r.attributes.BANDWIDTH,10)),r.attributes.RESOLUTION&&(r.attributes.RESOLUTION=sS(r.attributes.RESOLUTION)),r.attributes["AVERAGE-BANDWIDTH"]&&(r.attributes["AVERAGE-BANDWIDTH"]=parseInt(r.attributes["AVERAGE-BANDWIDTH"],10)),r.attributes["FRAME-RATE"]&&(r.attributes["FRAME-RATE"]=parseFloat(r.attributes["FRAME-RATE"])),this.trigger("data",r);return}if(t=/^#EXT-X-DEFINE:(.*)$/.exec(s),t){r={type:"tag",tagType:"define"},r.attributes=Pr(t[1]),this.trigger("data",r);return}this.trigger("data",{type:"tag",data:s.slice(4)})})}addParser({expression:e,customType:t,dataParser:r,segment:n}){typeof r!="function"&&(r=s=>s),this.customParsers.push(s=>{if(e.exec(s))return this.trigger("data",{type:"custom",data:r(s),customType:t,segment:n}),!0})}addTagMapper({expression:e,map:t}){const r=n=>e.test(n)?t(n):n;this.tagMappers.push(r)}}const TF=i=>i.toLowerCase().replace(/-(\w)/g,e=>e[1].toUpperCase()),ms=function(i){const e={};return Object.keys(i).forEach(function(t){e[TF(t)]=i[t]}),e},_p=function(i){const{serverControl:e,targetDuration:t,partTargetDuration:r}=i;if(!e)return;const n="#EXT-X-SERVER-CONTROL",s="holdBack",a="partHoldBack",o=t&&t*3,u=r&&r*2;t&&!e.hasOwnProperty(s)&&(e[s]=o,this.trigger("info",{message:`${n} defaulting HOLD-BACK to targetDuration * 3 (${o}).`})),o&&e[s]<o&&(this.trigger("warn",{message:`${n} clamping HOLD-BACK (${e[s]}) to targetDuration * 3 (${o})`}),e[s]=o),r&&!e.hasOwnProperty(a)&&(e[a]=r*3,this.trigger("info",{message:`${n} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[a]}).`})),r&&e[a]<u&&(this.trigger("warn",{message:`${n} clamping PART-HOLD-BACK (${e[a]}) to partTargetDuration * 2 (${u}).`}),e[a]=u)};class DF extends Cp{constructor(e={}){super(),this.lineStream=new AF,this.parseStream=new bF,this.lineStream.pipe(this.parseStream),this.mainDefinitions=e.mainDefinitions||{},this.params=new URL(e.uri,"https://a.com").searchParams,this.lastProgramDateTime=null;const t=this,r=[];let n={},s,a,o=!1;const u=function(){},l={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},h="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";let d=0;this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],iFramePlaylists:[],segments:[]};let p=0,g=0;const m={};this.on("end",()=>{n.uri||!n.parts&&!n.preloadHints||(!n.map&&s&&(n.map=s),!n.key&&a&&(n.key=a),!n.timeline&&typeof d=="number"&&(n.timeline=d),this.manifest.preloadSegment=n)}),this.parseStream.on("data",function(v){let E,x;if(t.manifest.definitions){for(const T in t.manifest.definitions)if(v.uri&&(v.uri=v.uri.replace(`{$${T}}`,t.manifest.definitions[T])),v.attributes)for(const R in v.attributes)typeof v.attributes[R]=="string"&&(v.attributes[R]=v.attributes[R].replace(`{$${T}}`,t.manifest.definitions[T]))}({tag(){({version(){v.version&&(this.manifest.version=v.version)},"allow-cache"(){this.manifest.allowCache=v.allowed,"allowed"in v||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const T={};"length"in v&&(n.byterange=T,T.length=v.length,"offset"in v||(v.offset=p)),"offset"in v&&(n.byterange=T,T.offset=v.offset),p=T.offset+T.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),v.title&&(n.title=v.title),v.duration>0&&(n.duration=v.duration),v.duration===0&&(n.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=r},key(){if(!v.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(v.attributes.METHOD==="NONE"){a=null;return}if(!v.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(v.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:v.attributes};return}if(v.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:v.attributes.URI};return}if(v.attributes.KEYFORMAT===h){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(v.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(v.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),v.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(v.attributes.KEYID&&v.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:v.attributes.KEYFORMAT,keyId:v.attributes.KEYID.substring(2)},pssh:EF(v.attributes.URI.split(",")[1])};return}v.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),a={method:v.attributes.METHOD||"AES-128",uri:v.attributes.URI},typeof v.attributes.IV<"u"&&(a.iv=v.attributes.IV)},"media-sequence"(){if(!isFinite(v.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+v.number});return}this.manifest.mediaSequence=v.number},"discontinuity-sequence"(){if(!isFinite(v.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+v.number});return}this.manifest.discontinuitySequence=v.number,d=v.number},"playlist-type"(){if(!/VOD|EVENT/.test(v.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+v.playlist});return}this.manifest.playlistType=v.playlistType},map(){s={},v.uri&&(s.uri=v.uri),v.byterange&&(s.byterange=v.byterange),a&&(s.key=a)},"stream-inf"(){if(this.manifest.playlists=r,this.manifest.mediaGroups=this.manifest.mediaGroups||l,!v.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}n.attributes||(n.attributes={}),ho(n.attributes,v.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||l,!(v.attributes&&v.attributes.TYPE&&v.attributes["GROUP-ID"]&&v.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}const T=this.manifest.mediaGroups[v.attributes.TYPE];T[v.attributes["GROUP-ID"]]=T[v.attributes["GROUP-ID"]]||{},E=T[v.attributes["GROUP-ID"]],x={default:/yes/i.test(v.attributes.DEFAULT)},x.default?x.autoselect=!0:x.autoselect=/yes/i.test(v.attributes.AUTOSELECT),v.attributes.LANGUAGE&&(x.language=v.attributes.LANGUAGE),v.attributes.URI&&(x.uri=v.attributes.URI),v.attributes["INSTREAM-ID"]&&(x.instreamId=v.attributes["INSTREAM-ID"]),v.attributes.CHARACTERISTICS&&(x.characteristics=v.attributes.CHARACTERISTICS),v.attributes.FORCED&&(x.forced=/yes/i.test(v.attributes.FORCED)),E[v.attributes.NAME]=x},discontinuity(){d+=1,n.discontinuity=!0,this.manifest.discontinuityStarts.push(r.length)},"program-date-time"(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=v.dateTimeString,this.manifest.dateTimeObject=v.dateTimeObject),n.dateTimeString=v.dateTimeString,n.dateTimeObject=v.dateTimeObject;const{lastProgramDateTime:T}=this;this.lastProgramDateTime=new Date(v.dateTimeString).getTime(),T===null&&this.manifest.segments.reduceRight((R,_)=>(_.programDateTime=R-_.duration*1e3,_.programDateTime),this.lastProgramDateTime)},targetduration(){if(!isFinite(v.duration)||v.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+v.duration});return}this.manifest.targetDuration=v.duration,_p.call(this,this.manifest)},start(){if(!v.attributes||isNaN(v.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:v.attributes["TIME-OFFSET"],precise:v.attributes.PRECISE}},"cue-out"(){n.cueOut=v.data},"cue-out-cont"(){n.cueOutCont=v.data},"cue-in"(){n.cueIn=v.data},skip(){this.manifest.skip=ms(v.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",v.attributes,["SKIPPED-SEGMENTS"])},part(){o=!0;const T=this.manifest.segments.length,R=ms(v.attributes);n.parts=n.parts||[],n.parts.push(R),R.byterange&&(R.byterange.hasOwnProperty("offset")||(R.byterange.offset=g),g=R.byterange.offset+R.byterange.length);const _=n.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${_} for segment #${T}`,v.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((F,N)=>{F.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${N} lacks required attribute(s): LAST-PART`})})},"server-control"(){const T=this.manifest.serverControl=ms(v.attributes);T.hasOwnProperty("canBlockReload")||(T.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),_p.call(this,this.manifest),T.canSkipDateranges&&!T.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const T=this.manifest.segments.length,R=ms(v.attributes),_=R.type&&R.type==="PART";n.preloadHints=n.preloadHints||[],n.preloadHints.push(R),R.byterange&&(R.byterange.hasOwnProperty("offset")||(R.byterange.offset=_?g:0,_&&(g=R.byterange.offset+R.byterange.length)));const F=n.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${F} for segment #${T}`,v.attributes,["TYPE","URI"]),!!R.type)for(let N=0;N<n.preloadHints.length-1;N++){const C=n.preloadHints[N];C.type&&C.type===R.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${F} for segment #${T} has the same TYPE ${R.type} as preload hint #${N}`})}},"rendition-report"(){const T=ms(v.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(T);const R=this.manifest.renditionReports.length-1,_=["LAST-MSN","URI"];o&&_.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${R}`,v.attributes,_)},"part-inf"(){this.manifest.partInf=ms(v.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",v.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),_p.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(ms(v.attributes));const T=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${T}`,v.attributes,["ID","START-DATE"]);const R=this.manifest.dateRanges[T];R.endDate&&R.startDate&&new Date(R.endDate)<new Date(R.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),R.duration&&R.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),R.plannedDuration&&R.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});const _=!!R.endOnNext;if(_&&!R.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),_&&(R.duration||R.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),R.duration&&R.endDate){const N=R.startDate.getTime()+R.duration*1e3;this.manifest.dateRanges[T].endDate=new Date(N)}if(!m[R.id])m[R.id]=R;else{for(const N in m[R.id])if(R[N]&&JSON.stringify(m[R.id][N])!==JSON.stringify(R[N])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}const F=this.manifest.dateRanges.findIndex(N=>N.id===R.id);this.manifest.dateRanges[F]=ho(this.manifest.dateRanges[F],R),m[R.id]=ho(m[R.id],R),this.manifest.dateRanges.pop()}},"independent-segments"(){this.manifest.independentSegments=!0},"i-frames-only"(){this.manifest.iFramesOnly=!0,this.requiredCompatibilityversion(this.manifest.version,4)},"content-steering"(){this.manifest.contentSteering=ms(v.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",v.attributes,["SERVER-URI"])},define(){this.manifest.definitions=this.manifest.definitions||{};const T=(R,_)=>{if(R in this.manifest.definitions){this.trigger("error",{message:`EXT-X-DEFINE: Duplicate name ${R}`});return}this.manifest.definitions[R]=_};if("QUERYPARAM"in v.attributes){if("NAME"in v.attributes||"IMPORT"in v.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}const R=this.params.get(v.attributes.QUERYPARAM);if(!R){this.trigger("error",{message:`EXT-X-DEFINE: No query param ${v.attributes.QUERYPARAM}`});return}T(v.attributes.QUERYPARAM,decodeURIComponent(R));return}if("NAME"in v.attributes){if("IMPORT"in v.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}if(!("VALUE"in v.attributes)||typeof v.attributes.VALUE!="string"){this.trigger("error",{message:`EXT-X-DEFINE: No value for ${v.attributes.NAME}`});return}T(v.attributes.NAME,v.attributes.VALUE);return}if("IMPORT"in v.attributes){if(!this.mainDefinitions[v.attributes.IMPORT]){this.trigger("error",{message:`EXT-X-DEFINE: No value ${v.attributes.IMPORT} to import, or IMPORT used on main playlist`});return}T(v.attributes.IMPORT,this.mainDefinitions[v.attributes.IMPORT]);return}this.trigger("error",{message:"EXT-X-DEFINE: No attribute"})},"i-frame-playlist"(){this.manifest.iFramePlaylists.push({attributes:v.attributes,uri:v.uri,timeline:d}),this.warnOnMissingAttributes_("#EXT-X-I-FRAME-STREAM-INF",v.attributes,["BANDWIDTH","URI"])}}[v.tagType]||u).call(t)},uri(){n.uri=v.uri,r.push(n),this.manifest.targetDuration&&!("duration"in n)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),n.duration=this.manifest.targetDuration),a&&(n.key=a),n.timeline=d,s&&(n.map=s),g=0,this.lastProgramDateTime!==null&&(n.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=n.duration*1e3),n={}},comment(){},custom(){v.segment?(n.custom=n.custom||{},n.custom[v.customType]=v.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[v.customType]=v.data)}})[v.type].call(t)})}requiredCompatibilityversion(e,t){(e<t||!e)&&this.trigger("warn",{message:`manifest must be at least version ${t}`})}warnOnMissingAttributes_(e,t,r){const n=[];r.forEach(function(s){t.hasOwnProperty(s)||n.push(s)}),n.length&&this.trigger("warn",{message:`${e} lacks required attribute(s): ${n.join(", ")}`})}push(e){this.lineStream.push(e)}end(){this.lineStream.push(`
`),this.manifest.dateRanges.length&&this.lastProgramDateTime===null&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}}const mr=[];for(let i=0;i<256;++i)mr.push((i+256).toString(16).slice(1));function RF(i,e=0){return(mr[i[e+0]]+mr[i[e+1]]+mr[i[e+2]]+mr[i[e+3]]+"-"+mr[i[e+4]]+mr[i[e+5]]+"-"+mr[i[e+6]]+mr[i[e+7]]+"-"+mr[i[e+8]]+mr[i[e+9]]+"-"+mr[i[e+10]]+mr[i[e+11]]+mr[i[e+12]]+mr[i[e+13]]+mr[i[e+14]]+mr[i[e+15]]).toLowerCase()}let Mp;const IF=new Uint8Array(16);function wF(){if(!Mp){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Mp=crypto.getRandomValues.bind(crypto)}return Mp(IF)}const aS={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function CF(i,e,t){var n;if(aS.randomUUID&&!i)return aS.randomUUID();i=i||{};const r=i.random??((n=i.rng)==null?void 0:n.call(i))??wF();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,RF(r)}class Op{constructor(){fe(this,"punctuationSubtitleService",new Ac)}async parserSubtitle(e,t){const r=await this.parseMasterManifest(e);return this.parserSubtitleByManifest(r,t)}async parserSubtitleByManifest(e,t){var s;const r=(s=e.mediaGroups)==null?void 0:s.SUBTITLES;if(!r||Object.keys(r).length===0){console.log("No subtitle tracks found");return}const n=this.getSubtitleUrl(r,t);if(!n){console.error(`Subtitle track not found for language: ${t}`),console.log(`Subtitle track not found for language: ${t}`);return}return await this.parserSubtitlesBySubtitleUrl(n)}async parserSubtitlesBySubtitleUrl(e){const t=await this.parseMasterManifest(e),r=await this.extractSegmentUrls(t,e);let n=Ut.convertVttEntriesToSubtitles(r);return n.hasPunctuation?{hasPunctuation:!0,subtitles:this.punctuationSubtitleService.segmentSubtitlesBySentence(n.subtitles),originSubtitles:n.originSubtitles}:n}extractSegmentUrls(e,t){return mn.of(e.segments).map(r=>this.resolveSegmentUrl(r,t)).map(r=>rS.fetchText(r).then(n=>Xx(n)).then(n=>(console.log("cues === ",n.cues),n.cues))).flatten().map(r=>r).distinct(r=>r.id&&r.id.length>0?r.id:CF()).toArray()}resolveSegmentUrl(e,t){let r=e.uri;return r.startsWith("https://")||(r=new URL(r,t).href),r}async parseMasterManifest(e){const t=await rS.fetchText(e);return this.parseManifest(t)}parseManifest(e){const t=new DF;return t.push(e),t.end(),t.manifest}getSubtitleUrl(e,t){for(const[r,n]of Object.entries(e))for(const[s,a]of Object.entries(n))if(a.language===t)return a.uri}parserSubtitleMetadataArray(e){var a;const t=e.getParam("m3u8Manifest"),r=e.getParam("mediaUrl"),n=(a=t.mediaGroups)==null?void 0:a.SUBTITLES;if(!n||Object.keys(n).length===0)return console.log("No subtitles tracks found"),[];const s=[];for(const[o,u]of Object.entries(n))for(const[l,h]of Object.entries(u))s.push({url:bn.resolveUrl(h.uri,r),language:h.language,isAsr:!1,hasPunctuation:!0});return s}}class NF extends ln{constructor(){super(...arguments);fe(this,"m3u8ParserService",new Op);fe(this,"lastPlaybackId")}createMetadataObservable(t){if(t.siteDubbingRules.muxConfig===void 0)throw console.error("MuxBasedMediaMetadataService: muxConfig is undefined for site",t.siteDubbingRules),new Error("the website is missing the muxConfig configuration.");return ya(200).pipe(fr(r=>{const n=document.querySelector(t.siteDubbingRules.mediaSelector);return n?Ue(n).attr("playback-id"):null}),Jt(r=>r!=null),Jt(r=>this.lastPlaybackId===void 0||r!==this.lastPlaybackId),va(r=>{this.lastPlaybackId=r}),Ar(r=>{const n=document.querySelector(t.siteDubbingRules.mediaSelector);return n&&Ue(n).attr("playback-id")===r?this.handleMediaLoadStat(n,t):kh}))}handleMediaLoadStat(t,r){return t.readyState>=1?this.createObservableFromLoadedMedia(t,r):Uh(t,"loadedmetadata").pipe(Ps(1),Ar(()=>this.createObservableFromLoadedMedia(t,r)))}createObservableFromLoadedMedia(t,r){const n=new Ti(t,r.tabTitle);if(r.siteDubbingRules.muxConfig===void 0)throw console.error("MuxBasedMediaMetadataService: muxConfig is undefined for site",r.siteDubbingRules),new Error("the website is missing the muxConfig configuration.");return r.siteDubbingRules.muxConfig.parseConfig.isLiveVideoExtract?Gr(new hx().getIsLive(r.siteDubbingRules.muxConfig.parseConfig.isLiveVideoExtract,n)).pipe(fr(s=>this.extractMediaMetadata(r.siteDubbingRules.muxConfig.parseConfig,n,s))):Rr(this.extractMediaMetadata(r.siteDubbingRules.muxConfig.parseConfig,n,!1))}extractMediaMetadata(t,r,n){var s;return{videoId:Or.extractVideoId(t.videoIdExtract,r),title:Or.extractTitle(t.titleExtract,r),subtitleMetadata:new pF().getBestSubtitle(t.subtitleExtract,r),subtitleLevel:js.YELLOW,videoLanguage:Or.extractVideoLanguage(t,r),isPrivate:!1,channelId:"",duration:((s=r.media)==null?void 0:s.duration)??0,isLiveVideo:n,supportLanguageCode:["SG"],subtitles:[],originSubtitles:[]}}async transformMetadata(t,r){if(t.subtitleMetadata===void 0)return t;const n=await this.m3u8ParserService.parserSubtitle(t.subtitleMetadata.url,t.subtitleMetadata.language);return n&&(t.originSubtitles=n.originSubtitles,t.subtitles=n.subtitles,t.subtitleMetadata.hasPunctuation=n.hasPunctuation),t}}class LF extends ln{createMetadataObservable(e){if(e.siteDubbingRules.windowVariableConfig===void 0)throw console.error("BiliBasedMediaMetadataService: windowVariableConfig is undefined for site",e.siteDubbingRules),new Error("The website is missing the windowVariableConfig configuration.");if(e.siteDubbingRules.apiInterceptConfig===void 0)throw console.error("BiliBasedMediaMetadataService: apiInterceptConfig is undefined for site",e.siteDubbingRules),new Error("The website is missing the apiInterceptConfig configuration.");const t=e.siteDubbingRules.apiInterceptConfig,r=co.createAjaxObservable((a,o)=>this.filterRequest(a,o,t,e.siteDubbingRules)).observable.pipe(Jt(a=>a.type==="response"),Ar(a=>{var h;const o=document.querySelector(e.siteDubbingRules.mediaSelector),u=JSON.parse(a.responseText);console.log("enter api switch map, data == ",u);const l=new Ti(o,e.tabTitle,u);return(h=t.parseConfig)!=null&&h.isLiveVideoExtract?Gr(new xl().getIsLive(t.parseConfig.isLiveVideoExtract,l)).pipe(fr(d=>this.extractMediaMetadata(t.parseConfig,l,d))):Rr(this.extractMediaMetadata(t.parseConfig,l,!1))})),n=e.siteDubbingRules.windowVariableConfig.variableJsonPath,s=wi(window,n);if(s===void 0)return r;{const a=Gr(fetch(`https://api.bilibili.com/x/player/wbi/v2?aid=${s.aid}&cid=${s.cid}`,{credentials:"include"}).then(o=>o.json())).pipe(Ar(o=>{var h;console.log("enter window switch map");const u=document.querySelector(e.siteDubbingRules.mediaSelector),l=new Ti(u,e.tabTitle,o);return(h=t.parseConfig)!=null&&h.isLiveVideoExtract?Gr(new xl().getIsLive(t.parseConfig.isLiveVideoExtract,l)).pipe(fr(d=>this.extractMediaMetadata(t.parseConfig,l,d))):Rr(this.extractMediaMetadata(t.parseConfig,l,!1))}),Ps(1));return Fm(a,r)}}}class _F extends ln{createMetadataObservable(e){if(e.siteDubbingRules.videoJsConfig===void 0)throw console.error("AjaxVttBasedMediaMetadataService: videoJsConfig is undefined for site",e.siteDubbingRules),new Error("The website is missing the videoJsConfig configuration.");return ya(200).pipe(fr(()=>{var t;return(t=document.querySelector("div.video-js"))==null?void 0:t.player}),Jt(t=>t!=null&&t.readyState()>=1),Ps(1),Ar(t=>{const r=t.textTracks().tracks_;console.log("enter videoJs have player, tracks.length == ",r.length);const n=document.querySelector(e.siteDubbingRules.mediaSelector),s=new Ti(n,e.tabTitle);return r.length>1&&s.setParam("subtitleUrl",r[0].src),Rr(this.extractMediaMetadata(e.siteDubbingRules.videoJsConfig.parseConfig,s,!1))}))}getBestSubtitle(e,t){if(t.getParam("subtitleUrl"))return{url:t.getParam("subtitleUrl"),language:"auto",isAsr:!1,hasPunctuation:!0}}}var Pp={exports:{}};/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.11.1
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2025
 * @license MIT
 */var oS;function MF(){return oS||(oS=1,function(i){(function(){var e="input is invalid type",t=typeof window=="object",r=t?window:{};r.JS_SHA256_NO_WINDOW&&(t=!1);var n=!t&&typeof self=="object",s=!r.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node&&process.type!="renderer";s?r=Ci:n&&(r=self);var a=!r.JS_SHA256_NO_COMMON_JS&&!0&&i.exports,o=!r.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",u="0123456789abcdef".split(""),l=[-2147483648,8388608,32768,128],h=[24,16,8,0],d=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],p=["hex","array","digest","arrayBuffer"],g=[];(r.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(N){return Object.prototype.toString.call(N)==="[object Array]"}),o&&(r.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(N){return typeof N=="object"&&N.buffer&&N.buffer.constructor===ArrayBuffer});var m=function(N,C){return function(M){return new R(C,!0).update(M)[N]()}},v=function(N){var C=m("hex",N);s&&(C=E(C,N)),C.create=function(){return new R(N)},C.update=function(I){return C.create().update(I)};for(var M=0;M<p.length;++M){var L=p[M];C[L]=m(L,N)}return C},E=function(N,C){var M=Pd,L=Pd.Buffer,I=C?"sha224":"sha256",U;L.from&&!r.JS_SHA256_NO_BUFFER_FROM?U=L.from:U=function($){return new L($)};var q=function($){if(typeof $=="string")return M.createHash(I).update($,"utf8").digest("hex");if($==null)throw new Error(e);return $.constructor===ArrayBuffer&&($=new Uint8Array($)),Array.isArray($)||ArrayBuffer.isView($)||$.constructor===L?M.createHash(I).update(U($)).digest("hex"):N($)};return q},x=function(N,C){return function(M,L){return new _(M,C,!0).update(L)[N]()}},T=function(N){var C=x("hex",N);C.create=function(I){return new _(I,N)},C.update=function(I,U){return C.create(I).update(U)};for(var M=0;M<p.length;++M){var L=p[M];C[L]=x(L,N)}return C};function R(N,C){C?(g[0]=g[16]=g[1]=g[2]=g[3]=g[4]=g[5]=g[6]=g[7]=g[8]=g[9]=g[10]=g[11]=g[12]=g[13]=g[14]=g[15]=0,this.blocks=g):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],N?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=N}R.prototype.update=function(N){if(!this.finalized){var C,M=typeof N;if(M!=="string"){if(M==="object"){if(N===null)throw new Error(e);if(o&&N.constructor===ArrayBuffer)N=new Uint8Array(N);else if(!Array.isArray(N)&&(!o||!ArrayBuffer.isView(N)))throw new Error(e)}else throw new Error(e);C=!0}for(var L,I=0,U,q=N.length,$=this.blocks;I<q;){if(this.hashed&&(this.hashed=!1,$[0]=this.block,this.block=$[16]=$[1]=$[2]=$[3]=$[4]=$[5]=$[6]=$[7]=$[8]=$[9]=$[10]=$[11]=$[12]=$[13]=$[14]=$[15]=0),C)for(U=this.start;I<q&&U<64;++I)$[U>>>2]|=N[I]<<h[U++&3];else for(U=this.start;I<q&&U<64;++I)L=N.charCodeAt(I),L<128?$[U>>>2]|=L<<h[U++&3]:L<2048?($[U>>>2]|=(192|L>>>6)<<h[U++&3],$[U>>>2]|=(128|L&63)<<h[U++&3]):L<55296||L>=57344?($[U>>>2]|=(224|L>>>12)<<h[U++&3],$[U>>>2]|=(128|L>>>6&63)<<h[U++&3],$[U>>>2]|=(128|L&63)<<h[U++&3]):(L=65536+((L&1023)<<10|N.charCodeAt(++I)&1023),$[U>>>2]|=(240|L>>>18)<<h[U++&3],$[U>>>2]|=(128|L>>>12&63)<<h[U++&3],$[U>>>2]|=(128|L>>>6&63)<<h[U++&3],$[U>>>2]|=(128|L&63)<<h[U++&3]);this.lastByteIndex=U,this.bytes+=U-this.start,U>=64?(this.block=$[16],this.start=U-64,this.hash(),this.hashed=!0):this.start=U}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},R.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var N=this.blocks,C=this.lastByteIndex;N[16]=this.block,N[C>>>2]|=l[C&3],this.block=N[16],C>=56&&(this.hashed||this.hash(),N[0]=this.block,N[16]=N[1]=N[2]=N[3]=N[4]=N[5]=N[6]=N[7]=N[8]=N[9]=N[10]=N[11]=N[12]=N[13]=N[14]=N[15]=0),N[14]=this.hBytes<<3|this.bytes>>>29,N[15]=this.bytes<<3,this.hash()}},R.prototype.hash=function(){var N=this.h0,C=this.h1,M=this.h2,L=this.h3,I=this.h4,U=this.h5,q=this.h6,$=this.h7,X=this.blocks,ie,ne,ue,re,V,J,ve,de,De,Ie,Ne;for(ie=16;ie<64;++ie)V=X[ie-15],ne=(V>>>7|V<<25)^(V>>>18|V<<14)^V>>>3,V=X[ie-2],ue=(V>>>17|V<<15)^(V>>>19|V<<13)^V>>>10,X[ie]=X[ie-16]+ne+X[ie-7]+ue<<0;for(Ne=C&M,ie=0;ie<64;ie+=4)this.first?(this.is224?(de=300032,V=X[0]-1413257819,$=V-150054599<<0,L=V+24177077<<0):(de=704751109,V=X[0]-210244248,$=V-1521486534<<0,L=V+143694565<<0),this.first=!1):(ne=(N>>>2|N<<30)^(N>>>13|N<<19)^(N>>>22|N<<10),ue=(I>>>6|I<<26)^(I>>>11|I<<21)^(I>>>25|I<<7),de=N&C,re=de^N&M^Ne,ve=I&U^~I&q,V=$+ue+ve+d[ie]+X[ie],J=ne+re,$=L+V<<0,L=V+J<<0),ne=(L>>>2|L<<30)^(L>>>13|L<<19)^(L>>>22|L<<10),ue=($>>>6|$<<26)^($>>>11|$<<21)^($>>>25|$<<7),De=L&N,re=De^L&C^de,ve=$&I^~$&U,V=q+ue+ve+d[ie+1]+X[ie+1],J=ne+re,q=M+V<<0,M=V+J<<0,ne=(M>>>2|M<<30)^(M>>>13|M<<19)^(M>>>22|M<<10),ue=(q>>>6|q<<26)^(q>>>11|q<<21)^(q>>>25|q<<7),Ie=M&L,re=Ie^M&N^De,ve=q&$^~q&I,V=U+ue+ve+d[ie+2]+X[ie+2],J=ne+re,U=C+V<<0,C=V+J<<0,ne=(C>>>2|C<<30)^(C>>>13|C<<19)^(C>>>22|C<<10),ue=(U>>>6|U<<26)^(U>>>11|U<<21)^(U>>>25|U<<7),Ne=C&M,re=Ne^C&L^Ie,ve=U&q^~U&$,V=I+ue+ve+d[ie+3]+X[ie+3],J=ne+re,I=N+V<<0,N=V+J<<0,this.chromeBugWorkAround=!0;this.h0=this.h0+N<<0,this.h1=this.h1+C<<0,this.h2=this.h2+M<<0,this.h3=this.h3+L<<0,this.h4=this.h4+I<<0,this.h5=this.h5+U<<0,this.h6=this.h6+q<<0,this.h7=this.h7+$<<0},R.prototype.hex=function(){this.finalize();var N=this.h0,C=this.h1,M=this.h2,L=this.h3,I=this.h4,U=this.h5,q=this.h6,$=this.h7,X=u[N>>>28&15]+u[N>>>24&15]+u[N>>>20&15]+u[N>>>16&15]+u[N>>>12&15]+u[N>>>8&15]+u[N>>>4&15]+u[N&15]+u[C>>>28&15]+u[C>>>24&15]+u[C>>>20&15]+u[C>>>16&15]+u[C>>>12&15]+u[C>>>8&15]+u[C>>>4&15]+u[C&15]+u[M>>>28&15]+u[M>>>24&15]+u[M>>>20&15]+u[M>>>16&15]+u[M>>>12&15]+u[M>>>8&15]+u[M>>>4&15]+u[M&15]+u[L>>>28&15]+u[L>>>24&15]+u[L>>>20&15]+u[L>>>16&15]+u[L>>>12&15]+u[L>>>8&15]+u[L>>>4&15]+u[L&15]+u[I>>>28&15]+u[I>>>24&15]+u[I>>>20&15]+u[I>>>16&15]+u[I>>>12&15]+u[I>>>8&15]+u[I>>>4&15]+u[I&15]+u[U>>>28&15]+u[U>>>24&15]+u[U>>>20&15]+u[U>>>16&15]+u[U>>>12&15]+u[U>>>8&15]+u[U>>>4&15]+u[U&15]+u[q>>>28&15]+u[q>>>24&15]+u[q>>>20&15]+u[q>>>16&15]+u[q>>>12&15]+u[q>>>8&15]+u[q>>>4&15]+u[q&15];return this.is224||(X+=u[$>>>28&15]+u[$>>>24&15]+u[$>>>20&15]+u[$>>>16&15]+u[$>>>12&15]+u[$>>>8&15]+u[$>>>4&15]+u[$&15]),X},R.prototype.toString=R.prototype.hex,R.prototype.digest=function(){this.finalize();var N=this.h0,C=this.h1,M=this.h2,L=this.h3,I=this.h4,U=this.h5,q=this.h6,$=this.h7,X=[N>>>24&255,N>>>16&255,N>>>8&255,N&255,C>>>24&255,C>>>16&255,C>>>8&255,C&255,M>>>24&255,M>>>16&255,M>>>8&255,M&255,L>>>24&255,L>>>16&255,L>>>8&255,L&255,I>>>24&255,I>>>16&255,I>>>8&255,I&255,U>>>24&255,U>>>16&255,U>>>8&255,U&255,q>>>24&255,q>>>16&255,q>>>8&255,q&255];return this.is224||X.push($>>>24&255,$>>>16&255,$>>>8&255,$&255),X},R.prototype.array=R.prototype.digest,R.prototype.arrayBuffer=function(){this.finalize();var N=new ArrayBuffer(this.is224?28:32),C=new DataView(N);return C.setUint32(0,this.h0),C.setUint32(4,this.h1),C.setUint32(8,this.h2),C.setUint32(12,this.h3),C.setUint32(16,this.h4),C.setUint32(20,this.h5),C.setUint32(24,this.h6),this.is224||C.setUint32(28,this.h7),N};function _(N,C,M){var L,I=typeof N;if(I==="string"){var U=[],q=N.length,$=0,X;for(L=0;L<q;++L)X=N.charCodeAt(L),X<128?U[$++]=X:X<2048?(U[$++]=192|X>>>6,U[$++]=128|X&63):X<55296||X>=57344?(U[$++]=224|X>>>12,U[$++]=128|X>>>6&63,U[$++]=128|X&63):(X=65536+((X&1023)<<10|N.charCodeAt(++L)&1023),U[$++]=240|X>>>18,U[$++]=128|X>>>12&63,U[$++]=128|X>>>6&63,U[$++]=128|X&63);N=U}else if(I==="object"){if(N===null)throw new Error(e);if(o&&N.constructor===ArrayBuffer)N=new Uint8Array(N);else if(!Array.isArray(N)&&(!o||!ArrayBuffer.isView(N)))throw new Error(e)}else throw new Error(e);N.length>64&&(N=new R(C,!0).update(N).array());var ie=[],ne=[];for(L=0;L<64;++L){var ue=N[L]||0;ie[L]=92^ue,ne[L]=54^ue}R.call(this,C,M),this.update(ne),this.oKeyPad=ie,this.inner=!0,this.sharedMemory=M}_.prototype=new R,_.prototype.finalize=function(){if(R.prototype.finalize.call(this),this.inner){this.inner=!1;var N=this.array();R.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(N),R.prototype.finalize.call(this)}};var F=v();F.sha256=F,F.sha224=v(!0),F.sha256.hmac=T(),F.sha224.hmac=T(!0),a?i.exports=F:(r.sha256=F.sha256,r.sha224=F.sha224)})()}(Pp)),Pp.exports}var OF=MF();class PF extends xu{constructor(){super(...arguments);fe(this,"m3u8ParserService",new Op)}getSubtitles(t,r){return this.m3u8ParserService.parserSubtitleMetadataArray(r)}}class kF extends ln{constructor(){super(...arguments);fe(this,"m3u8ParserService",new Op);fe(this,"m3u8ExtractSubtitleService",new PF);fe(this,"domExtractSubtitleService",new IE)}createMetadataObservable(t){const r=this.createMediaElementReadyObservable(t),n=this.createM3u8InterceptBasedMetadataObservable(t,r),s=this.createMediaBasedMetadataObservable(t,r);return n.pipe(nR(s))}createMediaBasedMetadataObservable(t,r){const n=new mm(!0);return r.pipe(Jt(s=>{const a=s.src||"";return bn.endsWith(a,".mp4")||bn.endsWith(a,".mp3")}),Jt(()=>n.value),va(()=>n.next(!1)),va(s=>this.syncMediaElementSrc(t,s.src,s)),Ar(s=>{const a=new Ti(document.querySelector(t.siteDubbingRules.mediaSelector),t.tabTitle);return a.setParam("mediaType","mp4"),a.setParam("mediaUrl",s.src),Rr(this.extractMediaMetadata(t.siteDubbingRules.mediaParseConfig.parseConfig,a,!1))}))}createM3u8InterceptBasedMetadataObservable(t,r){const n=new mm(!0);return co.createXhrAjaxObservable(this.filterM3u8Request).observable.pipe(Jt(s=>s.type==="response"),tR(()=>r.pipe(Ps(1))),Jt(s=>s.length>0),Jl(s=>Gr(s)),Jt(()=>n.value),va(()=>n.next(!1)),va(s=>this.syncMediaElementSrc(t,s.url)),Ar(s=>{const a=this.m3u8ParserService.parseManifest(s.responseText);console.log(`m3u8 manifest == ${JSON.stringify(a)}`);const o=new Ti(document.querySelector(t.siteDubbingRules.mediaSelector),t.tabTitle);return o.setParam("mediaType","m3u8"),o.setParam("m3u8Manifest",a),o.setParam("mediaUrl",s.url),Rr(this.extractMediaMetadata(t.siteDubbingRules.mediaParseConfig.parseConfig,o,!1))}))}computeVideoId(t,r){const n=`${bn.removeQueryParams(t)}:${bn.removeQueryParams(r)}`;return"common_"+OF.sha256(n)}extractMediaMetadata(t,r,n){var s;return{videoId:this.extractVideoId(t,r),title:r.tabTitle,subtitleMetadata:this.getM3u8BestSubtitle(r),subtitleLevel:js.YELLOW,videoLanguage:ci.fromLanguage,isPrivate:!1,channelId:"",duration:((s=r.media)==null?void 0:s.duration)??0,isLiveVideo:n,supportLanguageCode:["SG"],subtitles:[],originSubtitles:[],mediaUrl:r.getParam("mediaUrl")}}async transformMetadata(t,r){if(t.subtitleMetadata===void 0)return t;let n;return bn.endsWith(t.mediaUrl,".m3u8")?(n=await this.m3u8ParserService.parserSubtitlesBySubtitleUrl(t.subtitleMetadata.url),t.originSubtitles=n.originSubtitles,t.subtitles=n.subtitles,t.subtitleMetadata.hasPunctuation=n.hasPunctuation,t):super.transformMetadata(t,r)}getM3u8BestSubtitle(t){const r={subtitleLanguageName:"srclang"};return t.getParam("mediaType")==="mp4"?this.domExtractSubtitleService.getBestSubtitle(r,t):this.m3u8ExtractSubtitleService.getBestSubtitle(r,t)}syncMediaElementSrc(t,r,n){const s=n??document.querySelector(t.siteDubbingRules.mediaSelector);if(s){const a=s.getAttribute("youtube-dubbing-src");if(!a||a!==s.src){const o=this.computeVideoId(r,window.location.href);s.setAttribute("youtube-dubbing-src",s.src),s.setAttribute("youtube-dubbing-videoId",o)}}}createMediaElementReadyObservable(t){return ya(1e3).pipe(fr(()=>document.querySelector(t.siteDubbingRules.mediaSelector)),lR((r,n)=>r?!0:!(n>=5)),Jt(r=>!!r&&r.duration>0),oR(1))}filterM3u8Request(t,r){return t.toLowerCase()==="get"&&bn.endsWith(r,".m3u8")}extractVideoId(t,r){return t.videoIdExtract.type==="undefined"?r.media.getAttribute("youtube-dubbing-videoId"):Or.extractVideoId(t.videoIdExtract,r)}}class FF extends ln{constructor(){super(...arguments);fe(this,"punctuationSubtitleService",new Ac)}createMetadataObservable(t){var n,s,a;const r=new Os;return(n=window.pageContentRpc)==null||n.onMessage("sendRequestInfo",o=>{console.log("requestInfo === ",o.data),o.data.type==="dropbox"&&r.next(o.data)}),(s=window.pageContentRpc)==null||s.onMessage("onUrlChange",o=>{var u;(u=window.pageContentRpc)==null||u.sendMessage("getRequestMetadata","dropbox").then()}),(a=window.pageContentRpc)==null||a.sendMessage("getRequestMetadata","dropbox").then(),r.asObservable().pipe(Ar(o=>{const u={credentials:"include"};return o.headers&&o.headers.length>0&&(u.headers=o.headers),Gr(fetch(o.url,u))}),Ar(o=>{if(!o.ok)throw new Error(`Fetch 失败: ${o.status}`);return Gr(o.json())}),Ar(o=>{const u=document.querySelector(t.siteDubbingRules.mediaSelector),l=new Ti(u,t.tabTitle);return l.setParam("subtitleJson",o),l.setParam("rules",t.siteDubbingRules),Rr(this.extractMediaMetadata(t.siteDubbingRules.dropboxConfig.parseConfig,l,!1))}))}extractMediaMetadata(t,r,n){var u;const s=r.getParam("subtitleJson"),a=r.getParam("rules");let o=Ut.convertDropboxSegmentsToSubtitles(s.segments);return o=this.punctuationSubtitleService.postProcessParsedResult(o,a),{videoId:Or.extractVideoId(t.videoIdExtract,r),title:r.tabTitle,subtitleMetadata:{url:void 0,language:s.transcriptLocale,isAsr:!1,hasPunctuation:o.hasPunctuation},subtitleLevel:js.YELLOW,videoLanguage:ci.fromLanguage,isPrivate:!1,channelId:"",duration:((u=r.media)==null?void 0:u.duration)??0,isLiveVideo:n,supportLanguageCode:["SG"],subtitles:o.subtitles,originSubtitles:o.originSubtitles,mediaUrl:r.getParam("mediaUrl")}}async transformMetadata(t,r){return t}}const BF=Ls(()=>{console.log("[debug-metadata] enter inject script",ZT),window.pageContentRpc.onMessage("sendRuleToInjectScript",i=>{if(console.log("[debug-metadata] enter sendRuleToInjectScript",i.data),i.data.className!=="InjectScriptParam")return;const e=i.data;ci.fromLanguage=e.fromLanguage,da(e.siteDubbingRules.subtitleFetchMethod).with("domTrack",()=>new J3().observeMediaMetadata(e)).with("apiIntercept",()=>new tS().observeMediaMetadata(e)).with("windowVariable",()=>new Qx().observeMediaMetadata(e)).with("hybrid",()=>new uF().observeMediaMetadata(e)).with("youtube",()=>new fF().observeMediaMetadata(e)).with("mux",()=>new NF().observeMediaMetadata(e)).with("bili",()=>new LF().observeMediaMetadata(e)).with("videojs",()=>new _F().observeMediaMetadata(e)).with("mediaParse",()=>new kF().observeMediaMetadata(e)).with("dropbox",()=>new FF().observeMediaMetadata(e)).exhaustive().subscribe(r=>{Ue(document.body).attr("youtube-dubbing-player-videoId",r.videoId),window.pageContentRpc.sendMessage("sendMetadataToContentScript",r)})}),window.pageContentRpc.onMessage("hideSubtitle",()=>{document.getElementById(Qs.getPlayerId()).setOption("captions","track",{})}),console.log("[debug-metadata] start sendMessage onload"),window.pageContentRpc.sendMessage("onload").then()});function d$(){}function Sc(i,...e){}const UF={debug:(...i)=>Sc(console.debug,...i),log:(...i)=>Sc(console.log,...i),warn:(...i)=>Sc(console.warn,...i),error:(...i)=>Sc(console.error,...i)},$F=(async()=>{try{return await BF.main()}catch(i){throw UF.error('The unlisted script "injectScript" crashed on startup!',i),i}})(),GF=/,/g,qF="-->";class lS extends bp{parse(e,t){var r,n;if(e==="")this.a&&(this.j.push(this.a),(n=(r=this.f).onCue)==null||n.call(r,this.a),this.a=null),this.c=El.None;else if(this.c===El.Cue)this.a.text+=(this.a.text?`
`:"")+e;else if(e.includes(qF)){const s=this.o(e,t);s&&(this.a=new Sp(s[0],s[1],s[2].join(" ")),this.a.id=this.l,this.c=El.Cue)}this.l=e}o(e,t){return super.o(e.replace(GF,"."),t)}}function HF(){return new lS}const VF=Object.freeze(Object.defineProperty({__proto__:null,SRTParser:lS,default:HF},Symbol.toStringTag,{value:"Module"})),bc=/^Format:[\s\t]*/,uS=/^Style:[\s\t]*/,cS=/^Dialogue:[\s\t]*/,Tc=/[\s\t]*,[\s\t]*/,hS=/\{[^}]+\}/g,dS=/\\N/g,fS=/^\[(.*)[\s\t]?Styles\]$/,kp=/^\[(.*)[\s\t]?Events\]$/;class gS{constructor(){fe(this,"f");fe(this,"O",0);fe(this,"a",null);fe(this,"j",[]);fe(this,"k",[]);fe(this,"N",null);fe(this,"d");fe(this,"P",{})}async init(e){this.f=e,e.errors&&(this.d=(await Promise.resolve().then(()=>pS)).ParseErrorBuilder)}parse(e,t){var r,n;if(this.O)switch(this.O){case 1:if(e==="")this.O=0;else if(uS.test(e))if(this.N){const s=e.replace(uS,"").split(Tc);this.S(s)}else this.e((r=this.d)==null?void 0:r.T("Style",t));else bc.test(e)?this.N=e.replace(bc,"").split(Tc):kp.test(e)&&(this.N=null,this.O=2);break;case 2:if(e==="")this.Q();else if(cS.test(e))if(this.Q(),this.N){const s=e.replace(cS,"").split(Tc),a=this.U(s,t);a&&(this.a=a)}else this.e((n=this.d)==null?void 0:n.T("Dialogue",t));else this.a?this.a.text+=`
`+e.replace(hS,"").replace(dS,`
`):bc.test(e)?this.N=e.replace(bc,"").split(Tc):fS.test(e)?(this.N=null,this.O=1):kp.test(e)&&(this.N=null)}else e===""||(fS.test(e)?(this.N=null,this.O=1):kp.test(e)&&(this.N=null,this.O=2))}done(){return{metadata:{},cues:this.j,regions:[],errors:this.k}}Q(){var e,t;this.a&&(this.j.push(this.a),(t=(e=this.f).onCue)==null||t.call(e,this.a),this.a=null)}S(e){let t="Default",r={},n,s="center",a="bottom",o,u=1.2,l,h,d=3,p=[];for(let g=0;g<this.N.length;g++){const m=this.N[g],v=e[g];switch(m){case"Name":t=v;break;case"Fontname":r["font-family"]=v;break;case"Fontsize":r["font-size"]=`calc(${v} / var(--overlay-height))`;break;case"PrimaryColour":const E=Fp(v);E&&(r["--cue-color"]=E);break;case"BorderStyle":d=parseInt(v,10);break;case"BackColour":h=Fp(v);break;case"OutlineColour":const x=Fp(v);x&&(l=x);break;case"Bold":parseInt(v)&&(r["font-weight"]="bold");break;case"Italic":parseInt(v)&&(r["font-style"]="italic");break;case"Underline":parseInt(v)&&(r["text-decoration"]="underline");break;case"StrikeOut":parseInt(v)&&(r["text-decoration"]="line-through");break;case"Spacing":r["letter-spacing"]=v+"px";break;case"AlphaLevel":r.opacity=parseFloat(v);break;case"ScaleX":p.push(`scaleX(${parseFloat(v)/100})`);break;case"ScaleY":p.push(`scaleY(${parseFloat(v)/100})`);break;case"Angle":p.push(`rotate(${v}deg)`);break;case"Shadow":u=parseInt(v,10)*1.2;break;case"MarginL":r["--cue-width"]="auto",r["--cue-left"]=parseFloat(v)+"px";break;case"MarginR":r["--cue-width"]="auto",r["--cue-right"]=parseFloat(v)+"px";break;case"MarginV":o=parseFloat(v);break;case"Outline":n=parseInt(v,10);break;case"Alignment":const T=parseInt(v,10);switch(T>=4&&(a=T>=7?"top":"center"),T%3){case 1:s="start";break;case 2:s="center";break;case 3:s="end";break}}}if(r.R=a,r["--cue-white-space"]="normal",r["--cue-line-height"]="normal",r["--cue-text-align"]=s,a==="center"?(r["--cue-top"]="50%",p.push("translateY(-50%)")):r[`--cue-${a}`]=(o||0)+"px",d===1&&(r["--cue-padding-y"]="0"),(d===1||h)&&(r["--cue-bg-color"]=d===1?"none":h),d===3&&l&&(r["--cue-outline"]=`${n}px solid ${l}`),d===1&&typeof n=="number"){const g=h??"#000";r["--cue-text-shadow"]=[l&&Bp(n*1.2,u*1.2,l),l?Bp(n*(n/2),u*(n/2),g):Bp(n,u,g)].filter(Boolean).join(", ")}p.length&&(r["--cue-transform"]=p.join(" ")),this.P[t]=r}U(e,t){const r=this.V(e),n=this.o(r.Start,r.End,t);if(!n)return;const s=new Sp(n[0],n[1],""),a={...this.P[r.Style]||{}},o=r.Name?`<v ${r.Name}>`:"",u=a.R,l=r.MarginL&&parseFloat(r.MarginL),h=r.MarginR&&parseFloat(r.MarginR),d=r.MarginV&&parseFloat(r.MarginV);return l&&(a["--cue-width"]="auto",a["--cue-left"]=l+"px"),h&&(a["--cue-width"]="auto",a["--cue-right"]=h+"px"),d&&u!=="center"&&(a[`--cue-${u}`]=d+"px"),s.text=o+e.slice(this.N.length-1).join(", ").replace(hS,"").replace(dS,`
`),delete a.R,Object.keys(a).length&&(s.style=a),s}V(e){const t={};for(let r=0;r<this.N.length;r++)t[this.N[r]]=e[r];return t}o(e,t,r){var a,o,u;const n=Al(e),s=Al(t);if(n!==null&&s!==null&&s>n)return[n,s];n===null&&this.e((a=this.d)==null?void 0:a.q(e,r)),s===null&&this.e((o=this.d)==null?void 0:o.r(t,r)),n!=null&&s!==null&&s>n&&this.e((u=this.d)==null?void 0:u.s(n,s,r))}e(e){var t,r;if(e){if(this.k.push(e),this.f.strict)throw this.f.cancel(),e;(r=(t=this.f).onError)==null||r.call(t,e)}}}function Fp(i){const e=parseInt(i.replace("&H",""),16);if(e>=0){const r=(e>>24&255^255)/255,n=e>>16&255,s=e>>8&255;return"rgba("+[e&255,s,n,r].join(",")+")"}return null}function Bp(i,e,t){const r=Math.ceil(2*Math.PI*i);let n="";for(let s=0;s<r;s++){const a=2*Math.PI*s/r;n+=i*Math.cos(a)+"px "+e*Math.sin(a)+"px 0 "+t+(s==r-1?"":",")}return n}function KF(){return new gS}const WF=Object.freeze(Object.defineProperty({__proto__:null,SSAParser:gS,default:KF},Symbol.toStringTag,{value:"Module"})),pS=Object.freeze(Object.defineProperty({__proto__:null,ParseErrorBuilder:{p(){return new Mn({code:_n.BadSignature,reason:"missing WEBVTT file header",line:1})},q(i,e){return new Mn({code:_n.BadTimestamp,reason:`cue start timestamp \`${i}\` is invalid on line ${e}`,line:e})},r(i,e){return new Mn({code:_n.BadTimestamp,reason:`cue end timestamp \`${i}\` is invalid on line ${e}`,line:e})},s(i,e,t){return new Mn({code:_n.BadTimestamp,reason:`cue end timestamp \`${e}\` is greater than start \`${i}\` on line ${t}`,line:t})},w(i,e,t){return new Mn({code:_n.BadSettingValue,reason:`invalid value for cue setting \`${i}\` on line ${t} (value: ${e})`,line:t})},v(i,e,t){return new Mn({code:_n.UnknownSetting,reason:`unknown cue setting \`${i}\` on line ${t} (value: ${e})`,line:t})},u(i,e,t){return new Mn({code:_n.BadSettingValue,reason:`invalid value for region setting \`${i}\` on line ${t} (value: ${e})`,line:t})},t(i,e,t){return new Mn({code:_n.UnknownSetting,reason:`unknown region setting \`${i}\` on line ${t} (value: ${e})`,line:t})},T(i,e){return new Mn({code:_n.BadFormat,reason:`format missing for \`${i}\` block on line ${e}`,line:e})}}},Symbol.toStringTag,{value:"Module"}));return $F}();
injectscript;